(()=>{var __webpack_modules__={253:(__unused_webpack_module,exports)=>{var __webpack_unused_export__;if(void 0===abc2svg)var abc2svg={};abc2svg.C={BLEN:1536,BAR:0,CLEF:1,CUSTOS:2,SM:3,GRACE:4,KEY:5,METER:6,MREST:7,NOTE:8,PART:9,REST:10,SPACE:11,STAVES:12,STBRK:13,TEMPO:14,BLOCK:16,REMARK:17,FULL:0,EMPTY:1,OVAL:2,OVALBARS:3,SQUARE:4,SL_ABOVE:1,SL_BELOW:2,SL_AUTO:3,SL_HIDDEN:4,SL_DOTTED:8,SL_ALI_MSK:112,SL_ALIGN:16,SL_CENTER:32,SL_CLOSE:64},abc2svg.sym_name=["bar","clef","custos","smark","grace","key","meter","Zrest","note","part","rest","yspace","staves","Break","tempo","","block","remark"],abc2svg.keys=[new Int8Array([-1,-1,-1,-1,-1,-1,-1]),new Int8Array([-1,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,0]),new Int8Array([0,0,0,1,0,0,0]),new Int8Array([1,0,0,1,0,0,0]),new Int8Array([1,0,0,1,1,0,0]),new Int8Array([1,1,0,1,1,0,0]),new Int8Array([1,1,0,1,1,1,0]),new Int8Array([1,1,1,1,1,1,0]),new Int8Array([1,1,1,1,1,1,1])],abc2svg.p_b40=new Int8Array([2,8,14,19,25,31,37]),abc2svg.b40_p=new Int8Array([0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6]),abc2svg.b40_a=new Int8Array([-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2]),abc2svg.b40_m=new Int8Array([-2,-1,0,1,2,0,0,1,2,3,4,0,2,3,4,5,6,3,4,5,6,7,0,5,6,7,8,9,0,7,8,9,10,11,0,9,10,11,12,13]),abc2svg.b40k=new Int8Array([36,1,2,3,8,2,2,7,8,13,14,2,8,13,14,19,20,13,14,19,20,25,2,19,24,25,30,31,2,25,30,31,36,37,2,31,36,37,2,3]),abc2svg.b40sf=new Int8Array([-2,-7,0,7,2,88,0,-5,2,-3,4,88,2,-3,4,-1,6,-3,4,-1,6,1,88,-1,-6,1,-4,3,88,1,-4,3,-2,5,88,3,-2,5,0,7]),abc2svg.isb40=new Int8Array([0,1,6,11,12,17,18,23,28,29,34,35]),abc2svg.ifb40=new Int8Array([0,5,6,11,12,17,22,23,28,29,34,39]),abc2svg.pab40=function(e,t){var n=40*((e+=19)/7|0)+abc2svg.p_b40[e%7];return t&&3!=t&&(n+=t),n},abc2svg.b40p=function(e){return 7*(e/40|0)+abc2svg.b40_p[e%40]-19},abc2svg.b40a=function(e){return abc2svg.b40_a[e%40]},abc2svg.b40m=function(e){return 12*(e/40|0)+abc2svg.b40_m[e%40]},abc2svg.ch_alias={maj:"",min:"m","-":"m","°":"dim","+":"aug","+5":"aug",maj7:"M7",Δ7:"M7",Δ:"M7",min7:"m7","-7":"m7",ø7:"m7b5","°7":"dim7","min+7":"m+7",aug7:"+7","7+5":"+7","7#5":"+7",sus:"sus4","7sus":"7sus4"},abc2svg.ft_w={thin:100,extralight:200,light:300,regular:400,medium:500,semi:600,demi:600,semibold:600,demibold:600,bold:700,extrabold:800,ultrabold:800,black:900,heavy:900},abc2svg.ft_re=new RegExp("-?Thin|-?Extra Light|-?Light|-?Regular|-?Medium|-?[DS]emi|-?[DS]emi[ -]?Bold|-?Bold|-?Extra[ -]?Bold|-?Ultra[ -]?Bold|-?Black|-?Heavy/","i"),abc2svg.rat=function(e,t){for(var n,r,s=0,o=0,i=1,a=1;0!=t;)r=t,n=e/t|0,t=e%t,e=r,r=s+n*i,s=i,i=r,r=a+n*o,a=o,o=r;return[i,o]},abc2svg.pitcmp=function(e,t){return e.pit-t.pit},abc2svg.Abc=function(user){"use strict";var C=abc2svg.C,require=empty_function,system=empty_function,write=empty_function,XMLHttpRequest=empty_function,OPEN_BRACE=1,CLOSE_BRACE=2,OPEN_BRACKET=4,CLOSE_BRACKET=8,OPEN_PARENTH=16,CLOSE_PARENTH=32,STOP_BAR=64,FL_VOICE=128,OPEN_BRACE2=256,CLOSE_BRACE2=512,OPEN_BRACKET2=1024,CLOSE_BRACKET2=2048,MASTER_VOICE=4096,IN=96,CM=37.8,YSTEP,errs={bad_char:"Bad character '$1'",bad_grace:"Bad character in grace note sequence",bad_transp:"Bad transpose value",bad_val:"Bad value in $1",bar_grace:"Cannot have a bar in grace notes",ignored:"$1: inside tune - ignored",misplaced:"Misplaced '$1' in %%score",must_note:"!$1! must be on a note",must_note_rest:"!$1! must be on a note or a rest",nonote_vo:"No note in voice overlay",not_ascii:"Not an ASCII character",not_enough_n:"Not enough notes/rests for %%repeat",not_enough_m:"Not enough measures for %%repeat",not_enough_p:"Not enough parameters in %%map",not_in_tune:"Cannot have '$1' inside a tune",notransp:"Cannot transpose with a temperament"},self=this,glovar={meter:{type:C.METER,wmeasure:1,a_meter:[]}},info={},parse={ctx:{},prefix:"%",state:0,ottava:[],line:new scanBuf},tunes=[],psvg;function clone(e,t){if(!e)return e;var n=new e.constructor;for(var r in e)e.hasOwnProperty(r)&&(t&&"object"==typeof e[r]?n[r]=clone(e[r],t-1):n[r]=e[r]);return n}function errbld(e,t,n,r){var s,o,i,a,c;if(user.errbld){switch(e){case 0:e="warn";break;case 1:e="error";break;default:e="fatal"}user.errbld(e,t,n,r)}else{if(null!=r&&r>=0){for(s=i=0;!((o=parse.file.indexOf("\n",s))<0||o>r);)i++,s=o+1;a=r-s}switch(c="",n&&(c=n,i&&(c+=":"+(i+1)+":"+(a+1)),c+=" "),e){case 0:c+="Warning: ";break;case 1:c+="Error: ";break;default:c+="Internal bug: "}user.errmsg(c+t,i,a)}}function error(e,t,n,r,s,o,i){var a;if(e||!cfmt.quiet){if(t){if(t.err)return;t.err=!0}user.textrans&&(a=user.textrans[n])&&(n=a),arguments.length>3&&(n=n.replace(/\$./g,(function(e){switch(e){case"$1":return r;case"$2":return s;case"$3":return o;default:return i}}))),t&&t.fname?errbld(e,n,t.fname,t.istart):errbld(e,n)}}function scanBuf(){this.index=0,scanBuf.prototype.char=function(){return this.buffer[this.index]},scanBuf.prototype.next_char=function(){return this.buffer[++this.index]},scanBuf.prototype.get_int=function(){for(var e=0,t=this.buffer[this.index];t>="0"&&t<="9";)e=10*e+Number(t),t=this.next_char();return e}}function syntax(e,t,n,r,s,o){error(e,{fname:parse.fname,istart:parse.istart+parse.line.index},t,n,r,s,o)}function js_inject(js){/eval *\(|Function|setTimeout|setInterval/.test(js)?syntax(1,"Unsecure code"):eval('"use strict";\n'+js)}var dd_tb={},a_de,cross,decos={dot:"0 stc 6 1 1",tenuto:"0 emb 6 3 3",slide:"1 sld 3 7 0",arpeggio:"2 arp 12 10 2",roll:"3 roll 3,3 6 6",emphasis:"3 accent 3.5,3.5 4 4",lowermordent:"3 lmrd 4,4 5 5",uppermordent:"3 umrd 4,4 5 5",trill:"3 trl 14 5 5",upbow:"3 upb 10 5 5",downbow:"3 dnb 9 5 5",gmark:"3 grm 6 5 5",wedge:"0 wedge 8 3 3",longphrase:"3 lphr 0 1 1",mediumphrase:"3 mphr 0 1 1",shortphrase:"3 sphr 0 1 1",turnx:"3 turnx 5,5 6 6",invertedturn:"3 turn 5,5 6 6",0:"3 fng 5,5 3 3 0",1:"3 fng 5,5 3 3 1",2:"3 fng 5,5 3 3 2",3:"3 fng 5,5 3 3 3",4:"3 fng 5,5 3 3 4",5:"3 fng 5,5 3 3 5",plus:"3 dplus 7 3 3","+":"3 dplus 7 3 3",accent:"3 accent 3.5,3.5 4 4",">":"3 accent 3.5,3.5 4 4",marcato:"3 marcato 9 3 3","^":"3 marcato 9 3 3",mordent:"3 lmrd 4,4 5 5",open:"3 opend 10 3 3",snap:"3 snap 14 3 3",thumb:"3 thumb 14 3 3",turn:"3 turn 5,5 6 6","trill(":"3 ltr 8 4 0","trill)":"3 ltr 8 4 0","8va(":"5 8va 12 6 6","8va)":"5 8va 12 6 6","8vb(":"7 8vb 12 6 6","8vb)":"7 8vb 12 6 6","15ma(":"5 15ma 12 9 9","15ma)":"5 15ma 12 9 9","15mb(":"7 15mb 12 9 9","15mb)":"7 15mb 12 9 9",breath:"5 brth 0 1 20",caesura:"5 caes 0 1 10",short:"5 short 0 1 4",tick:"5 tick 0 1 4",coda:"5 coda 24 10 10",dacapo:"5 dacs 16 20 20 Da Capo",dacoda:"5 dacs 16 20 20 Da Coda","D.C.":"5 dcap 16 10 10","D.S.":"5 dsgn 16 10 10","D.C.alcoda":"5 dacs 16 38 38 D.C. al Coda","D.S.alcoda":"5 dacs 16 38 38 D.S. al Coda","D.C.alfine":"5 dacs 16 38 38 D.C. al Fine","D.S.alfine":"5 dacs 16 38 38 D.S. al Fine",fermata:"3 hld 12 7 7",fine:"5 dacs 16 10 10 Fine",invertedfermata:"4 hld 12 7 7",segno:"5 sgno 22 8 8",f:"6 f 18 4 4",ff:"6 ff 18 6 6",fff:"6 fff 18 9 9",ffff:"6 ffff 18 12 12",mf:"6 mf 18 9 9",mp:"6 mp 18 10 10",p:"6 p 18 5 5",pp:"6 pp 18 9 9",ppp:"6 ppp 18 13 13",pppp:"6 pppp 18 17 17",pralltriller:"3 umrd 4,4 5 5",sfz:"6 sfz 18 8 8",ped:"7 ped 18 6 10","ped-up":"7 pedoff 12 4 4","ped(":"7 lped 20 5 5","ped)":"7 lped 20 5 5","crescendo(":"6 cresc 18 0 0","crescendo)":"6 cresc 18 0 0","<(":"6 cresc 18 0 0","<)":"6 cresc 18 0 0","diminuendo(":"6 dim 18 0 0","diminuendo)":"6 dim 18 0 0",">(":"6 dim 18 0 0",">)":"6 dim 18 0 0","-(":"8 gliss 0 0 0","-)":"8 gliss 0 0 0","~(":"8 glisq 0 0 0","~)":"8 glisq 0 0 0",invisible:"32 0 0 0 0",beamon:"33 0 0 0 0",trem1:"34 0 0 0 0",trem2:"34 0 0 0 0",trem3:"34 0 0 0 0",trem4:"34 0 0 0 0",xstem:"35 0 0 0 0",beambr1:"36 0 0 0 0",beambr2:"36 0 0 0 0",rbstop:"37 0 0 0 0","/":"38 0 0 6 6","//":"38 0 0 6 6","///":"38 0 0 6 6","beam-accel":"39 0 0 0 0","beam-rall":"39 0 0 0 0",stemless:"40 0 0 0 0",rbend:"41 0 0 0 0",editorial:"42 0 0 0 0","sacc-1":"3 sacc-1 6,4 4 4",sacc3:"3 sacc3 6,5 4 4",sacc1:"3 sacc1 6,4 4 4",courtesy:"43 0 0 0 0","cacc-1":"3 cacc-1 0 0 0",cacc3:"3 cacc3 0 0 0",cacc1:"3 cacc1 0 0 0","tie(":"44 0 0 0 0","tie)":"44 0 0 0 0"},f_near=[d_near,d_slide,d_arp],f_note=[null,null,null,d_upstaff,d_upstaff],f_staff=[null,null,null,null,null,d_upstaff,d_pf,d_upstaff];function y_get(e,t,n,r){var s,o=staff_tb[e],i=n/2|0,a=(n+r)/2|0;if(i<0&&(i=0),a>=YSTEP&&i>(a=YSTEP-1)&&(i=a),t)for(s=o.top[i++];i<=a;)s<o.top[i]&&(s=o.top[i]),i++;else for(s=o.bot[i++];i<=a;)s>o.bot[i]&&(s=o.bot[i]),i++;return s}function y_set(e,t,n,r,s){var o=staff_tb[e],i=n/2|0,a=(n+r)/2|0;if(i<0&&(i=0),a>=YSTEP&&i>(a=YSTEP-1)&&(i=a),t)for(;i<=a;)o.top[i]<s&&(o.top[i]=s),i++;else for(;i<=a;)o.bot[i]>s&&(o.bot[i]=s),i++}function up3(e,t){switch(7&t){case C.SL_ABOVE:return 1;case C.SL_BELOW:return 0}return!e.second}function up6(e,t){switch(7&t){case C.SL_ABOVE:return!0;case C.SL_BELOW:return!1}return e.multi?e.multi>0:!!e.p_v.have_ly&&(7&e.pos.voc)!=C.SL_ABOVE}function d_arp(e){var t,n,r,s=e.s,o=e.dd,i=o.wr;if(s.type==C.NOTE)for(t=0;t<=s.nhd;t++){if(s.notes[t].acc)r=s.notes[t].shac;else switch(r=1-s.notes[t].shhd,s.head){case C.SQUARE:r+=3.5;break;case C.OVALBARS:case C.OVAL:r+=2}r>i&&(i=r)}(n=3*(s.notes[s.nhd].pit-s.notes[0].pit)+4)<(t=o.h)&&(n=t),e.has_val=!0,e.val=n,e.x-=i,e.y=3*((s.notes[0].pit+s.notes[s.nhd].pit)/2-18)-n/2-3}function d_cresc(e){if(!e.ldst){var t,n,r,s,o,i=e.dd,a=e.s,c=e.start,l=c.s,u=l.x+3;for(e.st=a.st,e.lden=!1,e.has_val=!0,"^"==i.ty?t=1:"_"!=i.ty&&(t=up6(a,a.pos.dyn)),t&&(e.up=!0),s=c.ix;--s>=0&&(o=a_de[s])&&o.s==l;);for(;s++,(o=a_de[s])&&o.s==l;)if(o!=e&&o!=c&&!(e.up^o.up)&&f_staff[o.dd.func]){(r=o.x+o.dd.wr+2)>u&&(u=r);break}if(e.defl.noen)(n=e.x-u)<20&&(u=e.x-20-3,n=20);else{for(r=a.x,s=e.ix;--s>0&&(o=a_de[s])&&o.s==a;);for(;s++,(o=a_de[s])&&o.s==a;)if(o!=e&&o!=c&&!(e.up^o.up)&&f_staff[o.dd.func]){r-=o.dd.wl;break}(n=r-u-4)<20&&(u-=.5*(20-n),n=20)}e.val=n,e.x=u,e.y=y_get(e.st,t,u,n),t?e.y+=i.hd:e.y-=i.h}}function d_near(e){var t,n,r=e.s,s=e.dd;s.str||((t=(n="^"==s.ty?1:"_"==s.ty?0:r.multi?r.multi>0:r.stem<0)?r.ymx:r.ymn)>0&&t<24&&(t=6*((t+9)/6|0)-6),n?(t+=s.hd,r.ymx=t+s.h):"w"==s.name[0]?(e.inv=!0,t-=s.h,r.ymn=t):(t-=s.h,r.ymn=t-s.hd),e.y=t,r.type==C.NOTE&&(e.x+=r.notes[r.stem>=0?0:r.nhd].shhd),"d"==s.name[0]&&(r.beam_st&&r.beam_end?n&&r.stem>0&&(t=r.y+.6*(t-r.y))>=27&&(e.y=t,r.ymx=e.y+s.h):n?r.stem>0&&(e.x+=3.5):r.stem<0&&(e.x-=3.5)))}function d_pf(e){var t,n,r,s,o,i=e.s,a=e.dd;e.ldst||((e.pos&C.SL_ALI_MSK)==C.SL_CLOSE||0==(e.pos&C.SL_ALI_MSK)&&i.fmt.dynalign<0?d_upstaff(e):e.start?d_cresc(e):(e.val=a.wl+a.wr,(s=up6(i,e.pos))&&(e.up=!0),r=i.x,e.ix>0&&(o=a_de[e.ix-1]).s==i&&(e.up&&!o.up||!e.up&&o.up)&&(t=o.dd,f_staff[t.func]&&(n=o.x+o.val+4)>r&&(r=n)),e.x=r,e.y=y_get(i.st,s,r-a.wl,e.val),s?e.y+=a.hd:e.y-=a.h))}function d_slide(e){var t,n,r=e.s,s=r.notes[0].pit,o=5;for(t=0;t<=r.nhd;t++){if(r.notes[t].acc)n=4+r.notes[t].shac;else switch(n=5-r.notes[t].shhd,r.head){case C.SQUARE:n+=3.5;break;case C.OVALBARS:case C.OVAL:n+=2}r.notes[t].pit<=s+3&&n>o&&(o=n)}e.x-=o,e.y=3*(s-18)}function d_trill(e){if(!e.ldst){var t,n,r,s,o=e.dd,i=e.prev,a=e.s,c=a.st,l=e.start.s,u=l.x;switch(i&&(u=i.s.x+e.dd.wl+2,i.val-=i.dd.wr,i.val<8&&(i.val=8)),e.st=c,o.func){case 5:t=1;break;case 4:case 7:break;case 3:case 6:t=6==o.func?up6(l,e.pos):up3(l,e.pos)}if("^"==o.ty?t=1:"_"==o.ty&&(t=0),e.defl.noen?(r=e.x-u)<20&&(u=e.x-20-3,r=20):(r=a.x-u-6,a.type==C.NOTE&&(r-=6),r<10&&(u-=10-r,r=10)),n=y_get(c,t,u-o.wl-5,r),t?n<(s=staff_tb[l.st].topbar+2)&&(n=s):(n>(s=staff_tb[l.st].botbar-2)&&(n=s),n-=o.h),i)if(t)n<i.y&&(n=i.y);else if(n>=i.y)n=i.y;else do{i.y=n,i=i.prev}while(i);e.lden=!1,e.has_val=!0,e.val=r,e.x=u,e.y=n,e.up=t,t&&(n+=o.h),y_set(c,t,u,r,n),t?l.ymx=a.ymx=n:l.ymn=a.ymn=n}}function d_upstaff(e){if(!e.ldst)if(e.start)d_trill(e);else{var t,n,r=e.s,s=e.dd,o=e.x,i=s.wl+s.wr,a=staff_tb[r.st].topbar+2+s.hd,c=staff_tb[r.st].botbar-2-s.h;switch(s.glyph){case"brth":case"caes":case"lphr":case"mphr":case"sphr":case"short":case"tick":if(t=a,r.type==C.BAR)r.invis=1;else{for("brth"==s.glyph&&t<r.ymx&&(t=r.ymx),r=r.ts_next;r&&!r.seqst;r=r.ts_next);o+=.45*((r?r.x:realwidth)-o)}return e.x=o,void(e.y=t)}switch(r.nhd&&(o+=r.notes[r.stem>=0?0:r.nhd].shhd),e.up=n=4==s.func||7==s.func?0:6==s.func?up6(r,e.pos):up3(r,e.pos),s.ty){case"@":case"<":case">":t=e.y}null==t&&(n?((t=y_get(r.st,!0,o-s.wl,i)+s.hd)<a&&(t=a),e.y>t&&(t=e.y),r.ymx=t+s.h):((t=y_get(r.st,!1,o-s.wl,i)-s.h)>c&&(t=c),e.y<t&&(t=e.y),"fermata"!=s.name&&"accent"!=s.glyph&&"roll"!=s.glyph||(e.inv=1),r.ymn=t-s.hd)),6!=s.func&&(t>=a?y_set(r.st,1,o-s.wl,i,t+s.h):t<=c&&y_set(r.st,0,o-s.wl,i,t-s.hd)),e.x=o,e.y=t}}function deco_add(e){var t=e.match(/(\S*)\s+(.*)/);decos[t[1]]=t[2]}function deco_def(e,t){t||(t=e);var n,r,s,o,i,a,c,l=decos[t];if(!l&&/\d[()]$/.test(t)&&(l=decos[t.replace(/\d/,"")]),l)if(n=l.match(/(\d+)\s+(.+?)\s+([0-9.,]+)\s+([0-9.]+)\s+([0-9.]+)/)){var u=Number(n[1]),f=n[3],d=parseFloat(n[4]),p=parseFloat(n[5]);if(isNaN(u))error(1,null,"%%deco: bad C function value '$1'",n[1]);else if(u>10&&(u<32||u>44))error(1,null,"%%deco: bad C function index '$1'",u);else{if(f.indexOf(",")>0?(c=(f=f.split(","))[1],f=f[0]):c=0,!(f>50||d>80||p>80)){if((r=dd_tb[e])||(r={name:e},dd_tb[e]=r),r.func=0==e.indexOf("head-")?9:u,r.glyph=n[2],r.h=Number(f),r.hd=Number(c),r.wl=d,r.wr=p,a=l.replace(n[0],"").trim()){if('"'==a[0]&&(a=a.slice(1,-1)),"@"==a[0]&&!a.match(/^@([0-9.-]+),([0-9.-]+);?/))return void error(1,null,"%%deco: bad position '$1'",a);r.str=a}return 6==r.func&&null==r.str&&(r.str=e),("("==(i=e.slice(-1))||")"==i&&e.indexOf("(")<0)&&(r.str=null,o=e.slice(0,-1)+("("==i?")":"("),(s=dd_tb[o])&&("("==i?(r.dd_en=s,s.dd_st=r):(r.dd_st=s,s.dd_en=r))),r}error(1,null,"%%deco: abnormal h/wl/wr value '$1'",l)}}else error(1,null,"Invalid decoration '$1'",e);else cfmt.decoerr&&error(1,null,"Unknown decoration '$1'",e)}function do_ctie(e,t,n){var r=cross[e],s=e.slice(0,-1)+("("==e.slice(-1)?")":"(");r?error(1,t,"Conflict on !$1!",e):(n.s=t,(r=cross[s])?(")"==e.slice(-1)&&(r=n,n=cross[s]),cross[s]=null,n.midi!=r.midi||n.s.time+n.s.dur!=r.s.time?error(1,t,"Bad tie"):(n.tie_ty=C.SL_AUTO,n.tie_e=r,r.tie_s=n,n.s.ti1=r.s.ti2=!0)):cross[e]=n)}function get_dd(e){var t,n,r=dd_tb[e];return r||("<>^_@".indexOf(e[0])>=0&&!/^([>^]|[<>]\d?[()])$/.test(e)?("@"==(t=e[0])&&(t=(n=e.match(/@([-\d]+),([-\d]+)/))?n[0]:""),r=deco_def(e,e.replace(t,""))):r=deco_def(e),r?(t&&("@"==t[0]&&(r.x=Number(n[1]),r.y=Number(n[2]),t="@"),r.ty=t),r):void 0)}function deco_cnv(e,t){for(var n,r,s,o,i;s=a_dcn.shift();)if(r=get_dd(s)){switch(r.func){case 0:if(e.type==C.BAR&&"dot"==s){e.bar_dotted=!0;continue}case 1:case 2:if(!e.notes){error(1,e,errs.must_note_rest,s);continue}break;case 8:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}(o=e.notes[e.nhd]).a_dd||(o.a_dd=[]),o.a_dd.push(r);continue;case 9:if(!e.notes){error(1,e,errs.must_note_rest,s);continue}for(n=0;n<=e.nhd;n++)(o=e.notes[n]).invis=!0,o.a_dd||(o.a_dd=[]),o.a_dd.push(r);continue;case 10:if(e.notes)for(n=0;n<=e.nhd;n++)e.notes[n].color=s;else e.color=s;break;case 32:e.invis=!0;break;case 33:if(e.type!=C.BAR){error(1,e,"!beamon! must be on a bar");continue}e.beam_on=!0;break;case 34:if(e.type!=C.NOTE||!t||t.type!=C.NOTE||e.dur!=t.dur){error(1,e,"!$1! must be on the last of a couple of notes",s);continue}for(e.trem2=!0,e.beam_end=!0,e.beam_st=!1,t.beam_st=!0,t.beam_end=!1,e.ntrem=t.ntrem=Number(s[4]),n=0;n<=e.nhd;n++)e.notes[n].dur*=2;for(n=0;n<=t.nhd;n++)t.notes[n].dur*=2;break;case 35:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.xstem=!0;break;case 36:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}"1"==s[6]?e.beam_br1=!0:e.beam_br2=!0;break;case 37:e.rbstop=1;break;case 38:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.trem1=!0,e.ntrem=s.length;break;case 39:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.feathered_beam="a"==s[5]?1:-1;break;case 40:e.stemless=!0;break;case 41:e.rbstop=2;break;case 42:if(!e.notes[0].acc)continue;if(s="sacc"+e.notes[0].acc.toString(),!(r=dd_tb[s])&&!(r=deco_def(s))){error(1,e,errs.bad_val,"!editorial!");continue}delete e.notes[0].acc,curvoice.acc[e.notes[0].pit+19]=0;break;case 43:if(n=curvoice.acc[e.notes[0].pit+19],e.notes[0].acc||!n)continue;i=1;break;case 44:do_ctie(s,e,e.notes[0]);continue}e.a_dd||(e.a_dd=[]),e.a_dd.push(r)}i&&(a_dcn.push("cacc"+n),dh_cnv(e,e.notes[0]))}function dh_cnv(e,t){for(var n,r;n=a_dcn.shift();)if(r=get_dd(n)){switch(r.func){case 0:case 1:case 3:case 4:case 8:break;default:error(1,e,"Cannot have !$1! on a head",n);continue;case 9:case 32:t.invis=!0;break;case 10:t.color=n;continue;case 40:e.stemless=!0;continue;case 44:do_ctie(n,e,t);continue}t.a_dd||(t.a_dd=[]),t.a_dd.push(r)}}function deco_update(e,t){var n,r,s=a_de.length;for(n=0;n<s;n++)(r=a_de[n]).s==e&&(r.x+=t)}function deco_width(e){var t,n,r,s=0,o=e.a_dd,i=o.length;for(n=0;n<i;n++)switch((t=o[n]).func){case 1:s<7&&(s=7);break;case 2:s<14&&(s=14);break;case 3:switch(t.glyph){case"brth":case"lphr":case"mphr":case"sphr":e.wr<20&&(e.wr=20)}default:switch(t.ty){case"<":s<(r=t.wl+t.wr+6)&&(s=r);break;case">":r=t.wl+t.wr+8,e.wr<r&&(e.wr=r)}}return s&&e.prev&&e.prev.type==C.BAR&&(s-=3),s}function deco_wch(e){var t,n,r,s=0,o=e.a_dd.length;for(t=0;t<o;t++)"<"==(r=e.a_dd[t]).ty&&(n=r.wl+r.wr+8)>s&&(s=n);return s}function draw_deco_near(){var e,t;function n(e,t){var n,r,s,o=e.notes[t],i=o.a_dd.length,a=e.x;for(r=0;r<i;r++)n={s:e,dd:s=o.a_dd[r],st:e.st,m:t,ix:0,defl:{},x:a,y:3*(o.pit-18)},s.ty&&("@"==s.ty?(n.x+=s.x,n.y+=s.y):(n.y-=(s.h-s.hd)/2,"<"==s.ty?n.x-=s.wr+8:">"==s.ty&&(n.x+=s.wr+8))),a_de.push(n),s.dd_en?n.ldst=!0:s.dd_st&&(n.lden=!0,n.defl.nost=!0)}function r(e){if((!e.invis||!e.play)&&(e.a_dd&&function(e){var t,n,r,s,o,i,a=e.a_dd.length;for(null==e.y&&(e.y=0),n=0;n<a;n++){switch(t=e.a_dd[n],o=e.x,i=e.y,t.func){default:if(t.func>=10)continue;r=0;break;case 3:case 4:case 5:case 7:r=e.pos.orn;break;case 6:r=e.pos.vol;break;case 7:r=e.pos.dyn}switch(t.ty){case"^":r=-8&r|C.SL_ABOVE;break;case"_":r=-8&r|C.SL_BELOW;break;case"<":case">":r=7&r|C.SL_CLOSE,"<"==t.ty?(o-=t.wr+8,e.notes[0].acc&&(o-=5.5)):o+=t.wl+8,i=3*(e.notes[0].pit-18)-(t.h-t.hd)/2;break;case"@":o+=t.x,i+=t.y}(7&r)!=C.SL_HIDDEN&&(s={s:e,dd:t,st:e.st,ix:a_de.length,defl:{},x:o,y:i,pos:r},t.name.indexOf("inverted")>=0&&(s.inv=1),e.type!=C.BAR||t.ty||(s.x-=e.wl/2-2),a_de.push(s),t.dd_en?s.ldst=!0:t.dd_st&&(s.lden=!0,s.defl.nost=!0),f_near[t.func]&&f_near[t.func](s))}}(e),e.notes))for(var t=0;t<e.notes.length;t++)e.notes[t].a_dd&&n(e,t)}for(e=tsfirst;e;e=e.ts_next){switch(e.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(a_de.length&&function(e){var t,n,r=e.x-e.wl,s=a_de.length;for(t=0;t<s;t++)(n=a_de[t]).ix=t,n.s.x=n.x=r,n.defl.nost=!0}(e);e;e=e.ts_next){switch(e.type){case C.BAR:case C.MREST:case C.NOTE:case C.REST:case C.SPACE:break;case C.GRACE:for(t=e.extra;t;t=t.next)r(t);break;default:continue}r(e)}!function(){var e,t,n,r,s,o,i,a,c,l=a_de.length;for(e=0;e<l;e++)if((n=a_de[e]).ldst){for(o=n.dd.dd_en,i=(a=n.s).v,t=e+1;t<l&&((r=a_de[t]).start||r.dd!=o||r.s.v!=i);t++);if(t==l)for(c=a.st,t=e+1;t<l&&((r=a_de[t]).start||r.dd!=o||r.s.st!=c);t++);for(t==l&&((r={s:a,st:n.st,dd:o,ix:a_de.length-1,x:realwidth-6,y:a.y,cont:!0,lden:!0,defl:{noen:!0}}).x<a.x+10&&(r.x=a.x+10),null!=n.m&&(r.m=n.m),a_de.push(r)),r.start=n,r.defl.nost=n.defl.nost,t=e;--t>=0;)if((s=a_de[t]).start){if(s.s.time<a.time)break;if(s.dd.name==r.dd.name){r.prev=s;break}}}for(e=0;e<l;e++)(r=a_de[e]).lden&&!r.start&&((n={s:prev_scut(a=r.s),st:r.st,dd:r.dd.dd_st,ix:a_de.length-1,y:a.y,ldst:!0}).x=n.s.x,null!=r.m&&(n.m=r.m),a_de.push(n),r.start=n)}()}function draw_deco_note(){var e,t,n,r=a_de.length;for(e=0;e<r;e++)n=(t=a_de[e]).dd.func,f_note[n]&&null==t.m&&f_note[n](t)}function draw_deco_staff(){var e,t,n,r,s,o,i=new Array(nstaff+1),a=a_de.length;function c(e){var t,n,r,s,o,i,a,c;for(s=staff_tb[e.st].topbar+15,t=e.sym;t;t=t.next)if(t.type==C.BAR&&t.rbstart&&!t.norepbra){if(!t.next)break;for(c||(c=t,set_font("repeat")),n=t;t.next&&!(t=t.next).rbstop;);s<(o=y_get(e.st,!0,n.x,t.x-n.x)+2)&&(s=o),2==n.rbstart&&s<(o=y_get(e.st,!0,n.x,3)+10)&&(s=o),2==t.rbstop&&s<(o=y_get(e.st,!0,t.x-3,3)+10)&&(s=o),n.text&&(a=strwh(n.text),s<(o=y_get(e.st,!0,n.x+4,a[0])+a[1])&&(s=o)),t.rbstart&&(t=t.prev)}if(t=c)for(set_dscale(e.st,!0),o=s*staff_tb[e.st].staffscale;t;t=t.next)if(t.rbstart&&!t.norepbra){for(n=t;t.next&&!(t=t.next).rbstop;);if(n==t)break;r=n.x,cfmt.measurenb>0&t.bar_num&&t.bar_num%cfmt.measurenb&&(r+=6),i=t.type!=C.BAR?t.rbstop?0:t.x-realwidth+4:t.bar_type.length>1&&"[]"!=t.bar_type||"]"==t.bar_type?n.st>0&&!(cur_sy.staves[n.st-1].flags&STOP_BAR)?t.wl:":"==t.bar_type.slice(-1)?12:":"!=t.bar_type[0]?0:8:t.rbstop&&!t.rbstart?0:8,i=t.x-r-i,t.next||t.rbstop||e.bar_start||(e.bar_start=_bar(t),e.bar_start.bar_type="",e.bar_start.rbstart=1),n.text&&xy_str(r+4,o-gene.curfont.size-2,n.text),xypath(r,o),2==n.rbstart&&(output+="m0 10v-10"),output+="h"+i.toFixed(1),2==t.rbstop&&(output+="v10"),output+='"/>\n',y_set(n.st,!0,r,i,s+2),t.rbstart&&(t=t.prev.prev)}}for(n=0;n<=nstaff;n++)i[n]={ymin:0,ymax:0};for(n=0;n<a;n++)(o=(s=a_de[n]).dd)&&f_staff[o.func]&&null==s.m&&(f_staff[o.func](s),o.dd_en||((s.pos&C.SL_ALI_MSK)==C.SL_ALIGN||0==(s.pos&C.SL_ALI_MSK)&&s.s.fmt.dynalign>0)&&(s.up?s.y>i[s.st].ymax&&(i[s.st].ymax=s.y):s.y<i[s.st].ymin&&(i[s.st].ymin=s.y)));for(n=0;n<a;n++)(o=(s=a_de[n]).dd)&&!o.dd_en&&f_staff[o.func]&&(6==o.func&&((s.pos&C.SL_ALI_MSK)==C.SL_ALIGN||0==(s.pos&C.SL_ALI_MSK)&&s.s.fmt.dynalign>0)?(t=s.up?i[s.st].ymax:i[s.st].ymin,s.y=t):t=s.y,s.up&&(t+=o.h),y_set(s.st,s.up,s.x,s.val,t));for(draw_all_chsy(),r=0;r<voice_tb.length;r++)(e=voice_tb[r]).second||!e.sym||e.ignore||c(e)}function draw_measnb(){var e,t,n,r,s,o,i,a,c,l=cur_sy;for(t=0;t<=nstaff&&!l.st_print[t];t++);if(!(t>nstaff)){if(set_dscale(t),1!=staff_tb[t].staffscale&&param_set_font("measurefont","* "+((a=get_font("measure").size)/staff_tb[t].staffscale).toString()),set_font("measure"),c=cwidf("0"),e=tsfirst,(n=gene.nbar)>1)if(0==cfmt.measurenb)i=!0,(s=y_get(t,!0,0,20))<staff_tb[t].topbar+14&&(s=staff_tb[t].topbar+14),xy_str(0,s,n.toString()),y_set(t,!0,0,20,s+gene.curfont.size+2);else if(n%cfmt.measurenb==0){for(;;e=e.ts_next){switch(e.type){case C.CLEF:case C.KEY:case C.METER:case C.STBRK:continue}break}e.type==C.BAR&&e.bar_num||(i=!0,o=c,n>=10&&(o*=n>=100?3:2),gene.curfont.pad&&(o+=2*gene.curfont.pad),(s=y_get(t,!0,r=e.x-e.wl+2,o))<staff_tb[t].topbar+6&&(s=staff_tb[t].topbar+6),xy_str(r,s+=2+gene.curfont.pad,n.toString()),y_set(t,!0,r,o,s+=gene.curfont.size+gene.curfont.pad))}for(;e;e=e.ts_next){switch(e.type){case C.STAVES:for(l=e.sy,t=0;t<nstaff&&!l.st_print[t];t++);set_dscale(t);continue;default:continue;case C.BAR:if(!e.bar_num||e.bar_num<=1)continue}n=e.bar_num,0!=cfmt.measurenb&&n%cfmt.measurenb==0&&e.next&&!e.bar_mrep&&(i||(i=!0),o=c,n>=10&&(o*=n>=100?3:2),gene.curfont.pad&&(o+=2*gene.curfont.pad),(s=y_get(t,!0,r=e.x,o))<staff_tb[t].topbar+6&&(s=staff_tb[t].topbar+6),e.next.type==C.NOTE&&(e.next.stem>0?s<e.next.ys-gene.curfont.size&&(s=e.next.ys-gene.curfont.size):s<e.next.y&&(s=e.next.y)),xy_str(r,s+=2+gene.curfont.pad,n.toString()),y_set(t,!0,r,o,s+=gene.curfont.size+gene.curfont.pad))}gene.nbar=n,a&&param_set_font("measurefont","* "+a.toString())}}function draw_partempo(e,t){var n,r,s,o,i,a,c,l=0,u=0,f=staff_tb[e].topbar+8,d=0,p=1,h=-100;for(n=tsfirst;n;n=n.ts_next)n.type!=C.TEMPO||n.invis||(o||(o=n),a=n.tempo_wh[0],0==n.time&&n.x>40&&(n.x=40),(c=y_get(e,!0,n.x-16,a))>f&&(f=c),h>=n.x-16&&!(d&p>>1)&&(d|=p),p<<=1,h=n.x-16+a);if(o)for(set_sscale(-1),set_font("tempo"),i=(c=2-(u=gene.curfont.size+8))-u,0!=d&&(u*=2),t<f+u&&(l=f+u-t),n=o;n;n=n.ts_next)n.type!=C.TEMPO||n.invis||((user.anno_start||user.anno_stop)&&(n.wl=16,n.wr=30,n.ymn=1&d?i:c,n.ymx=n.ymn+14,anno_start(n)),writempo(n,n.x-16,1&d?i:c),anno_stop(n),d>>=1);for(f=staff_tb[e].topbar+6,n=tsfirst;n;n=n.ts_next)(r=n.part)&&!r.invis&&(s||(s=n,set_font("parts"),i=gene.curfont.size+2+2*gene.curfont.pad),null==r.x&&(r.x=n.x-10),a=strwh(r.text)[0],f<(c=y_get(e,!0,r.x,a+3))&&(f=c));if(s)for(set_sscale(-1),t+l<f+(u+=i)&&(l=f+u-t),n=s;n;n=n.ts_next)(r=n.part)&&!r.invis&&((user.anno_start||user.anno_stop)&&(r.type=C.PART,r.p_v=n.p_v,r.v=n.v,r.st=r.wl=0,r.wr=strwh(r.text)[0],r.ymn=-u,r.ymx=r.ymn+i,anno_start(r)),xy_str(r.x,2-u,r.text),anno_stop(r));return l/staff_tb[0].staffscale}Abc.prototype.draw_all_deco=function(){if(a_de.length){var e,t,n,r,s,o,i,a,c,l,u,f,d,p,h=[],m=[];for(a=staff_tb[o=nstaff].y;--o>=0;)c=staff_tb[o].y,m[o]=.5*(a+24+c),a=c;for(;e=a_de.shift();)(t=e.dd)&&(t.dd_en||(n=e.s,(f=(s=t.glyph).indexOf("/"))>0&&(s=n.stem>=0?s.slice(0,f):s.slice(f+1)),f_staff[t.func]?set_sscale(n.st):set_scale(n),o=e.st,staff_tb[o].topbar&&(i=e.x,a=e.y+staff_tb[o].y,null!=e.m?(r=n.notes[e.m]).shhd&&(i+=r.shhd*stv_g.scale):6==t.func&&((e.pos&C.SL_ALI_MSK)==C.SL_CENTER||0==(e.pos&C.SL_ALI_MSK)&&!n.fmt.dynalign)&&(e.up&&o>0||!e.up&&o<nstaff)&&(l=e.up?m[--o]:m[o++],l-=.5*t.h,(e.up&&a<l||!e.up&&a>l)&&(c=y_get(o,!e.up,e.x,e.val)+staff_tb[o].y,e.up&&(c-=t.h),(e.up&&c>l||!e.up&&c<l)&&(a=l,1!=stv_g.scale&&(a+=stv_g.dy/2)))),(u=user[s])&&"function"==typeof u?u(i,a,e):self.psdeco(s,i,a,e)||(anno_start(n,"deco"),e.inv&&(g_open(i,a=a+t.h-t.hd,0,1,-1),i=a=0),e.has_val?(2!=t.func||stv_g.st<0?out_deco_val(i,a,s,e.val/stv_g.scale,e.defl):out_deco_val(i,a,s,e.val,e.defl),e.cont&&h.push(e.start)):null!=t.str?("@"==(d=t.str)[0]&&(p=d.match(/^@([0-9.-]+),([0-9.-]+);?/),i+=Number(p[1]),a+=Number(p[2]),d=d.replace(p[0],"")),out_deco_str(i,a,s,d)):e.lden?out_deco_long(i,a,e):xygl(i,a,s),stv_g.g&&g_close(),anno_stop(n,"deco")))));a_de=h}};var STEM_MIN=16,STEM_MIN2=14,STEM_MIN3=12,STEM_MIN4=10,STEM_CH_MIN=14,STEM_CH_MIN2=10,STEM_CH_MIN3=9,STEM_CH_MIN4=9,BEAM_DEPTH=3.2,BEAM_OFFSET=.25,BEAM_SHIFT=5,BEAM_STUB=7,SLUR_SLOPE=.5,GSTEM=15,GSTEM_XOFF=2.3,cache,anno_a=[];function b_pos(e,t,n,r){var s,o,i,a,c=e?3.5:BEAM_SHIFT,l=e?1.8:BEAM_DEPTH;function u(e){return 6*Math.round((e+12)/6)-12-e}if(t>0){if((o=r-(n-1)*c-l)>26)return 0;s=r}else{if((s=r+(n-1)*c+l)<-2)return 0;o=r}return(i=u(s-BEAM_OFFSET))*i>(a=u(o+BEAM_OFFSET))*a?a:i}function sym_dup(e){var t;for((e=clone(e)).invis=!0,delete e.extra,delete e.text,delete e.a_gch,delete e.a_ly,delete e.a_dd,delete e.tp,e.notes=clone(e.notes),t=0;t<=e.nhd;t++)delete(e.notes[t]=clone(e.notes[t])).a_dd;return e}var min_tb=[[STEM_MIN,STEM_MIN,STEM_MIN2,STEM_MIN3,STEM_MIN4,STEM_MIN4],[STEM_CH_MIN,STEM_CH_MIN,STEM_CH_MIN2,STEM_CH_MIN3,STEM_CH_MIN4,STEM_CH_MIN4]];function draw_beams(e){var t,n,r,s,o,i,a,c,l,u,f,d,p,h=e.s1,m=e.s2;function y(e,t,n,r,s,o){var i,a,c=s.s1,l=c.nflags;if(c.ntrem&&(l-=c.ntrem),c.trem2&&o>l)if(c.dur>=C.BLEN/2)e=c.x+6,t=s.s2.x-6;else if(c.dur<C.BLEN/4){var u=t-e;u<16?(e+=u/4,t-=u/4):(e+=5,t-=6)}i=s.a*e+s.b-n,t-=e,t/=stv_g.scale,a=s.a*t*stv_g.scale,xypath(e,i,!0),output+="l"+t.toFixed(1)+" "+(-a).toFixed(1)+"v"+r.toFixed(1)+"l"+(-t).toFixed(1)+" "+a.toFixed(1)+'z"/>\n'}for(anno_start(h,"beam"),h.grace?(o=3.5,i=3.2,s=.29,a=1.8):(o=BEAM_SHIFT,i=BEAM_STUB,s=.34,a=BEAM_DEPTH),a/=stv_g.scale,r=h.stem,h.stem!=m.stem&&h.nflags<m.nflags&&(r=m.stem),r<0&&(a=-a),y(h.xs-s,m.xs+s,0,a,e,1),c=0,t=h;t.type==C.NOTE&&t.stem!=r&&(t.ys=e.a*t.xs+e.b-staff_tb[t.st].y+o*(t.nflags-1)*t.stem-a),t!=m;t=t.next);for(h.feathered_beam&&(c=o/(m.xs-h.xs),o=h.feathered_beam>0?(c=-c)*h.xs:c*m.xs,c*=r),s=0,n=2;n<=e.nflags;n++)for(s+=o,0!=c&&(e.a+=c),t=h;;t=t.next)if(t.type!=C.NOTE||t.nflags<n){if(t==m)break}else if(t.trem1&&n>t.nflags-t.ntrem){if(y((p=t.dur>=C.BLEN/2?t.x:t.xs)-5,p+5,(s+2.5)*r,a,e,n),t==m)break}else{for(f=t;t!=m;){if((u=t.next).type==C.NOTE||u.type==C.REST)if(u.trem1){if(u.nflags-u.ntrem<n)break}else if(u.nflags<n)break;if(u.beam_br1||u.beam_br2&&n>2)break;t=u}for(d=t;d.type!=C.NOTE;)d=d.prev;if(p=f.xs,l=r,f==d){if(f==h)p+=i;else if(f==m)p-=i;else if(f.beam_br1||f.beam_br2&&n>2)p+=i;else{for(u=f.next;u.type!=C.NOTE;)u=u.next;if(u.beam_br1||u.beam_br2&&n>2)p-=i;else{for(f=f.prev;f.type!=C.NOTE;)f=f.prev;f.nflags<u.nflags||f.nflags==u.nflags&&f.dots<u.dots?p+=i:p-=i}}f.stem!=r&&(l=f.stem,f.ys=e.a*f.xs+e.b-staff_tb[f.st].y-a)}if(y(p,d.xs,s*l,a,e,n),t==m)break}h.tmp?unlksym(h):m.tmp&&unlksym(m),anno_stop(h,"beam")}function draw_lstaff(e){var t,n,r,s,o,i=cur_sy.nstaff,a=0;function c(e,t,n){for(var r,s,o,i;!cur_sy.st_print[t];){if(cur_sy.staves[t].flags&n)return;t++}for(r=s=t;cur_sy.st_print[r]&&(s=r),!(cur_sy.staves[r].flags&n);)r++;o=staff_tb[t].y+staff_tb[t].topbar*staff_tb[t].staffscale,i=staff_tb[s].y+staff_tb[s].botbar*staff_tb[s].staffscale,n&(CLOSE_BRACE|CLOSE_BRACE2)?out_brace(e,i,o-i):out_bracket(e,o,o-i)}for(t=0;((o=cur_sy.staves[t].flags)&(OPEN_BRACE|OPEN_BRACKET)&&a++,!cur_sy.st_print[t])&&(o&(CLOSE_BRACE|CLOSE_BRACKET)&&a--,t!=i);t++);for(n=i;n>t&&!cur_sy.st_print[n];n--);if(t!=n||0!=a)for(r=staff_tb[n].y+staff_tb[n].botbar*staff_tb[n].staffscale,s=staff_tb[t].y+staff_tb[t].topbar*staff_tb[t].staffscale-r,xypath(e,r),output+="v"+(-s).toFixed(1)+'"/>\n',t=0;t<=i;t++)(o=cur_sy.staves[t].flags)&OPEN_BRACE&&c(e,t,CLOSE_BRACE),o&OPEN_BRACKET&&c(e,t,CLOSE_BRACKET),o&OPEN_BRACE2&&c(e-6,t,CLOSE_BRACE2),o&OPEN_BRACKET2&&c(e-6,t,CLOSE_BRACKET2)}function draw_meter(e){if(e.a_meter){var t,n,r,s=e.st,o=staff_tb[s],i=o.y;for("|||||"!=o.stafflines&&(i+=(o.topbar+o.botbar)/2-12),t=0;t<e.a_meter.length;t++)n=e.a_meter[t],r=e.x+e.x_meter[t],n.bot?out_XYAB('<g transform="translate(X,Y)" text-anchor="middle">\n <text y="-12">A</text>\n <text>B</text>\n</g>\n',r,i+6,m_gl(n.top),m_gl(n.bot)):out_XYAB('<text x="X" y="Y" text-anchor="middle">A</text>\n',r,i+12,m_gl(n.top))}}Abc.prototype.calculate_beam=function(e,t){var n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g,A,_,v,b,x,w,E;for(t.beam_st||(lkvsym(n=sym_dup(t),t),lktsym(n,t),n.x-=12,n.x>t.prev.x+12&&(n.x=t.prev.x+12),n.beam_st=!0,delete n.beam_end,n.tmp=!0,delete n.sls,t=n),o=i=0,l=u=!1,a=t.st,c=t.v,b=t.grace?GSTEM_XOFF:3.5,r=t;r.type!=C.NOTE||(r.nflags>i&&(i=r.nflags),o++,r.st!=a&&(l=!0),r.stem!=t.stem&&(u=!0),w||r.invis||r.stemless&&!r.trem2||(w=!0),!r.beam_end);r=r.next)if(!r.next){for(;r.type!=C.NOTE;r=r.prev);(n=sym_dup(r)).next=r.next,n.next&&(n.next.prev=n),r.next=n,n.prev=r,n.ts_next=r.ts_next,n.ts_next&&(n.ts_next.ts_prev=n),r.ts_next=n,n.ts_prev=r,delete n.beam_st,n.beam_end=!0,n.tmp=!0,delete n.sls,n.x+=12,n.x<realwidth-12&&(n.x=realwidth-12),r=n,o++;break}if(!w)return!1;if(e.s2=r,0==staff_tb[a].y){if(l)return!1}else if(!l)return e.s1=t,e.a=(t.ys-r.ys)/(t.xs-r.xs),e.b=t.ys-t.xs*e.a+staff_tb[a].y,e.nflags=i,!0;for(v=t,A=100,_=0,n=t;n.type!=C.NOTE||(1==(x=n.p_v.scale)&&(x=staff_tb[n.st].staffscale),n.stem>=0?(f=b+n.notes[0].shhd,n.notes[n.nhd].pit>_&&(_=n.notes[n.nhd].pit,v=n)):(f=-b+n.notes[n.nhd].shhd,n.notes[0].pit<A&&(A=n.notes[0].pit,v=n)),n.xs=n.x+f*x,n!=r);n=n.next);if((n.grace&&t.fmt.flatbeams||!u&&o>=3&&v!=t&&v!=r)&&(h=0),d=t.ys+staff_tb[a].y,null==h&&(h=(r.ys+staff_tb[r.st].y-d)/(r.xs-t.xs)),0!=h&&(h=t.fmt.beamslope*h/(t.fmt.beamslope+Math.abs(h)))>-.04&&h<.04&&(h=0),m=(d+r.ys+staff_tb[r.st].y)/2-h*(r.xs+t.xs)/2,g=0,n=t,u)p=.5*((t.grace?3.5:BEAM_SHIFT)*(i-1)+BEAM_DEPTH),t.nflags==r.nflags||(t.stem!=r.stem&&t.nflags<r.nflags?m+=p*r.stem:m+=p*t.stem);else if(t.grace)for(;p=h*n.xs+m-staff_tb[n.st].y,y=GSTEM-2,n.stem>0?y-=p-3*(n.notes[n.nhd].pit-18):y+=p-3*(n.notes[0].pit-18),(y+=3*(n.nflags-1))>g&&(g=y),n!=r;n=n.next);else{for(var k=BEAM_DEPTH+BEAM_SHIFT*(i-1);n.ts_prev&&n.ts_prev.type==C.NOTE&&n.ts_prev.time==n.time&&n.ts_prev.x>t.xs;)n=n.ts_prev;for(;n&&n.time<=r.time;n=n.ts_next)if(!(n.type!=C.NOTE||n.invis||n.st!=a&&n.v!=c)){if(p=h*(f=n.v==c?n.xs:n.x)+m-staff_tb[n.st].y,n.v==c)y=min_tb[0==n.nhd?0:1][n.nflags],n.stem>0?(n.notes[n.nhd].pit>26&&(y-=2,n.notes[n.nhd].pit>28&&(y-=2)),y-=p-3*(n.notes[n.nhd].pit-18)):(n.notes[0].pit<18&&(y-=2,n.notes[0].pit<16&&(y-=2)),y-=3*(n.notes[0].pit-18)-p),y+=BEAM_DEPTH+BEAM_SHIFT*(n.nflags-1);else{if(t.stem>0)if(n.stem>0){if(n.ymn>p+4||n.ymx<p-k-2)continue;y=n.v>c?n.ymx-p:n.ymn+8-p}else y=n.ymx-p;else if(n.stem<0){if(n.ymx<p-4||n.ymn>p-k-2)continue;y=n.v<c?p-n.ymn:p-n.ymx+8}else y=p-n.ymn;y+=2+k}y>g&&(g=y)}}if(g>0&&(m+=t.stem*g),!l&&!u)for(n=t.next;;n=n.next){switch(n.type){case C.REST:if(!n.multi)break;if(!(s=n.ts_next)||s.st!=a||s.type!=C.NOTE&&s.type!=C.REST)break;case C.BAR:if(n.invis)break;case C.CLEF:d=h*n.x+m,t.stem>0?(d=n.ymx-d+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(m+=d):(d=n.ymn-d-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(m+=d);break;case C.GRACE:for(s=n.extra;s;s=s.next)d=h*s.x+m,t.stem>0?(d=s.ymx-d+BEAM_DEPTH+BEAM_SHIFT*(i-1)+2)>0&&(m+=d):(d=s.ymn-d-BEAM_DEPTH-BEAM_SHIFT*(i-1)-2)<0&&(m+=d)}if(n==r)break}for(0==h&&(m+=b_pos(t.grace,t.stem,i,m-staff_tb[a].y)),n=t;;n=n.next){switch(n.type){case C.NOTE:n.ys=h*n.xs+m-staff_tb[n.st].y,n.stem>0?(n.ymx=n.ys+2.5,n.ts_prev&&n.ts_prev.stem>0&&n.ts_prev.st==n.st&&n.ts_prev.ymn<n.ymx&&n.ts_prev.x==n.x&&0==n.notes[0].shhd&&(n.ts_prev.x-=3,n.ts_prev.xs-=3)):n.ymn=n.ys-2.5;break;case C.REST:if(d=h*n.x+m-staff_tb[n.st].y,E=BEAM_DEPTH+BEAM_SHIFT*(i-1)+(n.head!=C.FULL?4:9),t.stem>0){if(d-=E,0==t.multi&&d>12&&(d=12),n.y<=d)break}else if(d+=E,0==t.multi&&d<12&&(d=12),n.y>=d)break;n.head!=C.FULL&&(d=6*((d+3+12)/6|0)-12),n.y=d}if(n==r)break}return 0!=staff_tb[a].y&&(e.s1=t,e.a=h,e.b=m,e.nflags=i,!0)};var acc_nd={};function draw_acc(e,t,n){if("object"==typeof n){var r,s=n[0],o=n[1];(n=acc_nd[r=s+"_"+o])||(o=(n=abc2svg.rat(Math.abs(s),o))[1],n=(s<0?-n[0]:n[0]).toString(),1!=o&&(n+="_"+o),acc_nd[r]=n)}xygl(e,t,"acc"+n)}function set_hl(e,t,n,r,s){var o,i;for(t>=0?(i=e.hlu[t])||(i=e.hlu[t]=[]):(i=e.hld[-t])||(i=e.hld[-t]=[]),o=0;o<i.length&&!(n>=i[o][0]);o++);o==i.length?i.push([n,r,s]):n>i[o][0]?i.splice(++o,0,[n,r,s]):(r<i[o][1]&&(i[o][1]=r),s>i[o][2]&&(i[o][2]=s))}Abc.prototype.draw_hl=function(e){var t,n,r,s,o=[],i=e.st,a=staff_tb[i];if(a.hll&&!e.invis){for(t=0;t<=e.nhd;t++)s=e.notes[t],a.hlmap[s.pit-a.hll]||o.push([s.pit-18,s.shhd*stv_g.scale]);if(r=o.length){var c,l,u,f,d=a.stafflines,p=d.length-1,h=p,m=a.botline/6,y=m,g=e.grace?4:1.3*hw_tb[e.head];for(u=(s=e.notes[e.stem<0?e.nhd:0]).shhd,t=0;t<o.length;t++)f=o[t][0],c=(o[t][1]<u?o[t][1]:u)-g,l=(o[t][1]>u?o[t][1]:u)+g,f<2*m?(f<2*y&&(y=++f>>1),r--):f>2*p&&(h=f>>1,r--),set_hl(a,f>>1,e.x,c,l);for(c=u-g,l=u+g;++y<m;)set_hl(a,y,e.x,c,l);for(;--h>p;)set_hl(a,h,e.x,c,l);if(r){for(t=y,n=h;t>m&&"-"==d[t];)t--;for(;n<p&&"-"==d[n];)n++;for(;t<n;t++)"-"==d[t]&&set_hl(a,t,e.x,c,l)}}}};var sharp_cl=new Int8Array([24,9,15,21,6,12,18]),flat_cl=new Int8Array([12,18,24,9,15,21,6]),sharp1=new Int8Array([-9,12,-9,-9,12,-9]),sharp2=new Int8Array([12,-9,12,-9,12,-9]),flat1=new Int8Array([9,-12,9,-12,9,-12]),flat2=new Int8Array([-12,9,-12,9,-12,9]);function nrep_out(e,t,n){t-=3,n<10?xygl(e-4,t,"mtr"+n):(xygl(e-10,t,"mtr"+(n/10|0)),xygl(e-2,t,"mtr"+n%10))}function center_rest(e){var t,n;for(e.dur<2*C.BLEN?e.nflags=-2:e.dur<4*C.BLEN?e.nflags=-3:e.nflags=-4,e.dots=0,t=e.ts_next;t.time!=e.time+e.dur&&t.ts_next;)t=t.ts_next;for(n=t.x-t.wl,t=e;!t.seqst;)t=t.ts_prev;n=(n+(t=t.ts_prev).x+t.wr)/2,e.a_dd&&deco_update(e,n-e.x),e.x=n}Abc.prototype.draw_keysig=function(e,t){var n,r,s,o=t.k_old_sf,i=t.st,a=staff_tb[i].y,c=t.k_y_clef;for(1&c&&(c+=7),c/=2;c<0;)c+=7;if(c%=7,t.k_a_acc){if(t.k_a_acc.length){var l,u=t.k_a_acc[0].acc,f=100,d={st:i,nhd:0,notes:[{}]};for(n=0;n<t.k_a_acc.length;n++){for(l=t.k_a_acc[n],r=3*(t.k_y_clef+l.pit-18);r<-3;)r+=21;for(;r>27;)r-=21;0!=n&&(r>f+18||r<f-18)?e-=5.5:l.acc!=u&&(e+=3),u=l.acc,d.x=e,d.notes[0].pit=r/3+18,f=r,draw_acc(e,a+r,l.acc),e+=5.5}}}else{if((t.fmt.cancelkey||0==t.k_sf)&&(0==t.k_sf||o*t.k_sf<0)){for(s=(r=sharp_cl[c])>9?sharp1:sharp2,n=0;n<o;n++)xygl(e,a+r,"acc3"),r+=s[n],e+=5.5;for(s=(r=flat_cl[c])<18?flat1:flat2,n=0;n>o;n--)xygl(e,a+r,"acc3"),r+=s[-n],e+=5.5;0!=t.k_sf&&(e+=3)}if(t.k_sf>0){for(s=(r=sharp_cl[c])>9?sharp1:sharp2,n=0;n<t.k_sf;n++)xygl(e,a+r,"acc1"),r+=s[n],e+=5.5;if(t.fmt.cancelkey&&n<o)for(e+=2;n<o;n++)xygl(e,a+r,"acc3"),r+=s[n],e+=5.5}if(t.k_sf<0){for(s=(r=flat_cl[c])<18?flat1:flat2,n=0;n>t.k_sf;n--)xygl(e,a+r,"acc-1"),r+=s[-n],e+=5.5;if(t.fmt.cancelkey&&n>o)for(e+=2;n>o;n--)xygl(e,a+r,"acc3"),r+=s[-n],e+=5.5}}};var rest_tb=["r128","r64","r32","r16","r8","r4","r2","r1","r0","r00"];function draw_rest(e){var t,n,r,s=staff_tb[e.st],o=s.y,i=e.x;if(e.notes[0].shhd&&(i+=e.notes[0].shhd*stv_g.scale),e.rep_nb)return set_sscale(e.st),anno_start(e),"|||||"==s.stafflines?o+=12:o+=(s.topbar+s.botbar)/2,e.rep_nb<0?xygl(i,o,"srep"):(xygl(i,o,"mrep"),e.rep_nb>2&&e.v==cur_sy.top_voice&&e.fmt.measrepnb>0&&!(e.rep_nb%e.fmt.measrepnb)&&nrep_out(i,o+s.topbar,e.rep_nb)),void anno_a.push(e);if(set_scale(e),anno_start(e),e.notes[0].color&&set_color(e.notes[0].color),r=e.y,7==(t=5-e.nflags)&&12==r&&s.stafflines.length<=2&&(r-=6),e.notes[0].invis||xygl(i,r+o,rest_tb[t]),e.dots)for(i+=8,r+=o+3,n=e.dots,t=e.dur_orig/12>>5-e.nflags-n;n-- >0;)xygl(i,r,t&1<<n?"dot":"dot+"),i+=3.5;set_color(),anno_a.push(e)}function draw_mrest(e){var t,n,r,s=staff_tb[e.st],o=s.y+(s.topbar+s.botbar)/2,i=e.nmes.toString();if(e.next){for(set_scale(e),r=e;!r.seqst;)r=r.ts_prev;for(r=r.ts_prev;!r.seqst;)r=r.ts_prev;t=r.x+20,n=e.next.x-20,e.x=(t+n)/2,anno_start(e),out_XYAB('<path d="mX Y',t+.6,o-2.7),output+="v2.7h-1.4v-10.8h1.4v2.7h"+((n-t-2.8)/stv_g.scale).toFixed(1)+'v-2.7h1.4v10.8h-1.4v-2.7z"/>\n',out_XYAB('<text x ="X" y="Y" text-anchor="middle">A</text>\n',e.x,o+22,m_gl(i)),anno_a.push(e)}else error(1,e,"Lack of bar after multi-measure rest")}function grace_slur(e){for(var t,n,r,s,o,i,a,c,l,u,f,d=e,p=e.extra;p.next;)p=p.next;if(u=p,f=(p.stem>=0||e.multi<0)&&p.notes[0].pit<=28||p.notes[0].pit<16){for(t=127,p=e.extra;p;p=p.next)p.y<t&&(t=p.y,u=p);n=u.x,r=u.y-5,e.extra!=u&&(n-=4,r+=1),s=(e=e.next).x-1,e.stem<0&&e.nflags>-2&&(s-=4),(c=.4*(s-n))>3&&(c=3),l=c,i=.2,a=.8,r>(o=3*(e.notes[0].pit-18)-5)+7?(n=u.x-1,r+=.5,o+=6.5,s=e.x-5.5,c=.8*(r-o),l=.2*(r-o),i=0):o>r+4&&(o=r+4,n=u.x+2,r=u.y-4)}else{for(t=-127,p=e.extra;p;p=p.next)p.y>t&&(t=p.y,u=p);n=u.x,r=u.y+5,e.extra!=u&&(n-=4,r-=1),s=(e=e.next).x-1,e.stem>=0&&e.nflags>-2&&(s-=2),(c=.4*(n-s))<-3&&(c=-3),l=c,i=.2,a=.8,r<(o=3*(e.notes[e.nhd].pit-18)+5)-7?(n=u.x-1,r-=.5,o-=6.5,s=e.x-5.5,c=.8*(r-o),l=.2*(r-o),i=0):o<r-4&&(o=r-4,n=u.x+2,r=u.y+4)}d.slur={x0:n,y0:r,x1:i*s+(1-i)*n-n,y1:r-i*o-(1-i)*r+c,x2:a*s+(1-a)*n-n,y2:r-a*o-(1-a)*r+l,x3:s-n,y3:r-o},r-=d.slur.y1,p=d.extra,f?r<p.ymn&&(p.ymn=r):r>p.ymx&&(p.ymx=r)}function draw_gracenotes(e){for(var t,n,r,s={},o=e.extra;o.beam_st&&!o.beam_end&&self.calculate_beam(s,o)&&draw_beams(s),anno_start(o),draw_note(o,!s.s2),o==s.s2&&(s.s2=null),anno_a.push(e),o.next;)o=o.next;e.sappo&&((o=e.extra).next?(t=.5*(o.next.x-o.x)+4,n=.5*(o.ys+o.next.ys)-o.y,o.stem>0?n-=1:n+=1):(t=9,n=o.stem>0?5:-5),out_acciac(x_head(o,r=o.notes[o.stem<0?0:o.nhd]),y_head(o,r),t,n,o.stem>0)),(o=e.slur)&&(anno_start(e,"slur"),xypath(o.x0,o.y0+staff_tb[e.st].y),output+="c"+o.x1.toFixed(1)+" "+o.y1.toFixed(1)+" "+o.x2.toFixed(1)+" "+o.y2.toFixed(1)+" "+o.x3.toFixed(1)+" "+o.y3.toFixed(1)+'"/>\n',anno_stop(e,"slur"))}function setdoty(e,t){var n,r,s;for(n=0;n<=e.nhd;n++)(s=3*(e.notes[n].pit-18))%6==0&&(e.dot_low?s-=3:s+=3),t[n]=s;for(n=0;n<e.nhd;n++)if(!(t[n+1]>t[n])){for(r=n;r>0&&!(t[r]>t[r-1]+6);)r--;if(3*(e.notes[r].pit-18)-t[r]<t[n+1]-3*(e.notes[n+1].pit-18))for(;r<=n;)t[r++]-=6;else t[n+1]=t[n]+6}}function x_head(e,t){return e.x+t.shhd*stv_g.scale}function y_head(e,t){return staff_tb[e.st].y+3*(t.pit-18)}function draw_basic_note(e,t,n){var r,s,o,i,a,c=!1,l=e.notes[t],u=staff_tb[e.st].y,f=e.x,d=3*(l.pit-18),p=f+l.shhd*stv_g.scale,h=d+u,m=identify_note(e,l.dur),y=m[0],g=m[1],A=m[2];if(l.invis);else if(e.grace)s="ghd",p-=4.5*stv_g.scale;else if(l.map&&l.map[0])r=e.head,(s=l.map[0][r])||(s=l.map[0][l.map[0].length-1]),(r=s.indexOf("/"))>=0&&(s=e.stem>=0?s.slice(0,r):s.slice(r+1));else if(e.type==C.CUSTOS)s="custos";else switch(y){case C.OVAL:s="HD";break;case C.OVALBARS:if(e.head!=C.SQUARE){s="HDD";break}case C.SQUARE:A>-4?s="breve":(s="longa",a=e.stem>0),tsnext||!e.next||e.next.type!=C.BAR||e.next.next||(g=0),p+=1;break;case C.EMPTY:s="Hd";break;default:s="hd"}if(null!=l.color&&(c=set_color(l.color)),s&&(a&&(g_open(p,h,0,1,-1),p=h=0),self.psxygl(p,h,s)||xygl(p,h,s),a&&g_close()),g)for(o=f+(7.7+e.xmx)*stv_g.scale,null==n[t]&&(n[t]=3*(e.notes[t].pit-18),0==(1&e.notes[t].pit)&&(n[t]+=3)),i=n[t]+u,r=l.dur/12>>5-A-g;g-- >0;)xygl(o,i,r&1<<g?"dot":"dot+"),o+=3.5;l.acc&&(f-=l.shac*stv_g.scale,e.grace?(g_open(f,d+u,0,.75),draw_acc(0,0,l.acc),g_close()):draw_acc(f,d+u,l.acc)),0!=c&&set_color(c)}function draw_note(e,t){var n,r,s,o,i=new Array(e.nhd+1),a=e.notes[e.stem<0?e.nhd:0],c=x_head(e,a),l=y_head(e,a),u=staff_tb[e.st].y;if(e.dots&&setdoty(e,i),e.stemless?e.xstem&&(s=((n=e.ts_prev).stem>0?n.y:n.ys)-e.y,out_stem(c,l,s+=staff_tb[n.st].y-u)):(s=e.ys-e.y,o=e.nflags,e.ntrem&&(o-=e.ntrem),!t||o<=0?(e.nflags>0&&(e.stem>=0?s-=1:s+=1),out_stem(c,l,s,e.grace)):out_stem(c,l,s,e.grace,o,e.fmt.straightflags)),t&&e.trem1){var f=e.ntrem||0,d=c;s=3*(e.notes[e.stem>0?e.nhd:0].pit-18),e.head==C.FULL||e.head==C.EMPTY?(d+=(e.grace?GSTEM_XOFF:3.5)*e.stem,e.stem>0?s+=6+5.4*f:s-=11.4):e.stem>0?s+=5+5.4*f:s-=10.4,out_trem(d,u+(s/=e.p_v.scale),f)}for(r=0;r<=e.nhd;r++)draw_basic_note(e,r,i)}function prev_scut(e){for(;e.prev;)if((e=e.prev).rbstart)return e;for(e=e.p_v.sym;e.type!=C.CLEF;)e=e.ts_prev;return e.next&&e.next.type==C.KEY&&(e=e.next),e.next&&e.next.type==C.METER?e.next:e}function slur_direction(e,t){var n,r,s,o,i,a;if(e.grace&&e.stem>0)return-1;if(a=t,o=(i=e).multi?i.multi:a.multi?a.multi:0)return o;for(n=e;;n=n.next){if(n.type==C.NOTE){if(!n.stemless){if(n.stem<0)return 1;r=!0}n.notes[0].pit<22&&(s=!0)}if(n.time==t.time)break}return r||s?-1:1}function slur_out(e,t,n,r,s,o,i){var a,c,l,u=.3,f=.45;(c=r-t)<0&&(c=-c),(a=n-e)>40&&c/a<.7&&(u=.3+.002*(a-40))>.7&&(u=.7);var d=.5*(e+n),p=.5*(t+r),h=d+u*(e-d),m=p+u*(t-p)+o;h=e+f*(h-e),m=t+f*(m-t);var y=d+u*(n-d),g=p+u*(r-p)+o;y=n+f*(y-n),g=r+f*(g-r),c=2*s,(l=.2+.001*a)>.6&&(l=.6),l*=s,a*=.03;output+=i?'<path class="stroke" stroke-dasharray="5,5" d="M':'<path d="M',out_sxsy(e," ",t),output+="c"+((h-e)/stv_g.scale).toFixed(1)+" "+((t-m)/1).toFixed(1)+" "+((y-e)/stv_g.scale).toFixed(1)+" "+((t-g)/1).toFixed(1)+" "+((n-e)/stv_g.scale).toFixed(1)+" "+((t-r)/1).toFixed(1),i||(output+="\n\tv"+(-l).toFixed(1)+"c"+((y-a-n)/stv_g.scale).toFixed(1)+" "+((r+l-g-c)/1).toFixed(1)+" "+((h+a-n)/stv_g.scale).toFixed(1)+" "+((r+l-m-c)/1).toFixed(1)+" "+((e-n)/stv_g.scale).toFixed(1)+" "+((r-t)/1).toFixed(1)),output+='"/>\n'}function draw_slur(e,t,n){var r,s,o,i,a,c,l,u,f,d,p,h,m,y,g,A=n.ty,_=(7&A)==C.SL_ABOVE?1:-1,v=e.length,b=v-1,x=e[0],w=e[b],E=1,k=x.st,$=!1;for(set_dscale(x.st),r=1;r<v;r++)(s=e[r]).type!=C.NOTE&&s.type!=C.REST||(E++,s.st!=k&&($=!0,s.st<k&&(k=s.st)));if($&&error(2,x,"*** multi-staves slurs not treated yet"),i=x.x,x.notes&&x.notes[0].shhd&&(i+=x.notes[0].shhd),c=w.x,w.notes&&(c+=w.notes[0].shhd),t?(a=3*(t.pit-18)+2*_,i+=3):(a=_>0?x.ymx+2:x.ymn-2,x.type==C.NOTE&&(_>0?x.stem>0?(i+=5,x.beam_end&&x.nflags>=-1&&!x.in_tuplet?x.nflags>0?(i+=2,a=x.ys-3):a=x.ys-6:a=x.ys+3):a=x.y+8:x.stem<0?(i-=1,w.grace?a=x.y-8:x.beam_end&&x.nflags>=-1&&(!x.in_tuplet||x.ys<a+3)?x.nflags>0?(i+=2,a=x.ys+3):a=x.ys+6:a=x.ys-3):a=x.y-8)),n.is_note?(l=3*(n.note.pit-18)+2*_,c-=3):(l=_>0?w.ymx+2:w.ymn-2,w.type==C.NOTE&&(_>0?w.stem>0?(c+=1,l=w.beam_st&&w.nflags>=-1&&!w.in_tuplet?w.ys-6:w.ys+3):l=w.y+8:w.stem<0?(c-=5,l=w.beam_st&&w.nflags>=-1&&!w.in_tuplet?w.ys+6:w.ys-3):l=w.y-8)),x.type!=C.NOTE&&(a=l+1.2*_,(i=x.x+.5*x.wr)>c-12&&(i=c-12)),w.type!=C.NOTE&&(l=x.type==C.NOTE?a+1.2*_:a,x!=w&&(c=w.x-.3*w.wl)),E>=3&&((s=e[1]).type!=C.BAR&&s.x<i+48&&(_>0?a<(p=s.ymx-2)&&(a=p):a>(p=s.ymn+2)&&(a=p)),(s=e[b-1]).type!=C.BAR&&s.x>c-48&&(_>0?l<(p=s.ymx-2)&&(l=p):l>(p=s.ymn+2)&&(l=p))),((d=(l-a)/(c-i))>SLUR_SLOPE||d<-SLUR_SLOPE)&&((d=d>SLUR_SLOPE?SLUR_SLOPE:-SLUR_SLOPE)*_>0?a=l-d*(c-i):l=a+d*(c-i)),(p=l-a)>8?p=8:p<-8&&(p=-8),(h=p)<0&&(h=-h),y=.5*h,g=.3*p,p*_>0?(c-=y,l-=g):(i+=y,a+=g),x.grace&&(i=x.x-.5*GSTEM_XOFF),w.grace&&(c=w.x+1.5*GSTEM_XOFF),m=0,d=(l-a)/(c-i),x!=w&&x.v==w.v){for(f=a-d*i,r=1;r<b;r++)if((s=e[r]).st==k)switch(s.type){case C.NOTE:case C.REST:_>0?((p=3*(s.notes[s.nhd].pit-18)+6)<s.ymx&&(p=s.ymx),(p-=d*s.x+f)>m&&(m=p)):((p=3*(s.notes[0].pit-18)-6)>s.ymn&&(p=s.ymn),(p-=d*s.x+f)<m&&(m=p));break;case C.GRACE:for(o=s.extra;o;o=o.next)_>0?((p=3*(o.notes[o.nhd].pit-18)+6)<o.ymx&&(p=o.ymx),(p-=d*o.x+f)>m&&(m=p)):((p=3*(o.notes[0].pit-18)-6)>o.ymn&&(p=o.ymn),(p-=d*o.x+f)<m&&(m=p))}a+=.45*m,l+=.45*m,m*=.65}for(u=E>3?(.08*(c-i)+12)*_:(.03*(c-i)+8)*_,_>0?(u<3*m&&(u=3*m),u>40&&(u=40)):(u>3*m&&(u=3*m),u<-40&&(u=-40)),(p=l-a)<0&&(p=-p),_>0?u<.8*p&&(u=.8*p):u>-.8*p&&(u=-.8*p),slur_out(i,a,c,l,_,u*=x.fmt.slurheight,A&C.SL_DOTTED),f=a-(d=(l-a)/(y=c-i))*i,u>0?f+=4*Math.sqrt(u)-2:f-=4*Math.sqrt(-u)-2,r=0;r<b;r++)(s=e[r]).st==k&&s.type!=C.BAR&&(p=d*s.x+f,s.ymx<p?s.ymx=p:s.ymn>p&&(s.ymn=p),r==b-1?(y=c,w.sl1&&(y-=5),r&&(p-=u/3)):y=e[r+1].x,0!=r?i=s.x:p-=u/3,y_set(k,_>0,i,y-=i,p))}function draw_slurs(e,t){var n,r,s,o,i,a;function c(e,r,s){var o,i,a,c,l,u=[],f=r.note.s;if(!(t&&f.time>t.time)){switch(r.loc){case"i":for(e=l=e.ts_prev;e;e=e.ts_prev)if(e.dur){if(e.v==f.v){l=e;break}if(e.st==f.st){l=e;continue}l||(l=e)}else l||(l=e);e=l;break;case"o":for(l=e;l.ts_next;l=l.ts_next);for(f=l;l;l=l.ts_prev){if(l.v==e.v){f=l;break}if(l.st==e.st&&(f=l),l.ts_prev.time!=f.time)break}}if(tsnext&&f.time>=tsnext.time){if(l=null,f.grace&&f.time==tsnext.time){for(l=tsnext;l.time==f.time&&l.type!=C.GRACE;l=l.ts_next);l.type!=C.GRACE&&(l=null)}if(l){for(e.p_v.sls.push(r),f=e.p_v.s_next.prev;f.next;)f=f.next;(r=Object.create(r)).note={s:f}}}switch(7&r.ty){case C.SL_ABOVE:c=1;break;case C.SL_BELOW:c=-1;break;default:c=e.v!=f.v?1:slur_direction(e,f),r.ty&=-8,r.ty|=c>0?C.SL_ABOVE:C.SL_BELOW}if(e.v==f.v&&(i=e.v),i=cur_sy.voices[e.v]&&cur_sy.voices[f.v]?c*(cur_sy.voices[e.v].range<=cur_sy.voices[f.v].range?1:-1)>0?e.v:f.v:e.v>f.v?e.v:f.v,!n||f.grace&&e.v==f.v&&e.time==f.time)u.push(e),e=e.grace?e.next:e.ts_next;else{do{u.push(e),e=e.next}while(e);e=n.next}if(f.grace)if(e.grace)for(;u.push(e),e!=f;)e=e.next;else{for(o=f;o.prev;)o=o.prev;for(;e.v==i&&u.push(e),e.extra!=o;)e=e.ts_next;for(e=o;u.push(e),e!=f;)e=e.next}else for(;e&&(e.v==i&&u.push(e),e!=f);)e=e.ts_next;for(a=1;a<u.length-1;a++)((e=u[a]).sls||e.sl1)&&draw_slurs(e,t),e.tp&&draw_tuplet(e);return draw_slur(u,s,r),1}}for(;;){if(!e||e==t){if(!n||!(e=n.next)||e==t)break;n=null}if(e.type!=C.GRACE){if(e.sls){for(i=e.sls,e.sls=null,a=[],r=0;r<i.length;r++)c(e,i[r])||a.push(i[r]);a.length&&(e.sls=a)}if(e.sl1)for(s=0;s<=e.nhd;s++)if((o=e.notes[s]).sls){for(i=o.sls,o.sls=null,a=[],r=0;r<i.length;r++)c(e,i[r],o)||a.push(i[r]);a.length&&(o.sls=a)}e=e.next}else n=e,e=e.extra}}function draw_tuplet(e){var t,n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g,A,_=e.tp.shift();for(e.tp.length||delete e.tp,s=e.st,set_dscale(e.st),t=e;t;t=t.next){switch(t.type){case C.GRACE:for(r=t.extra;r;r=r.next)(r.sls||r.sl1)&&draw_slurs(r);default:continue;case C.NOTE:case C.REST:}if((t.sls||t.sl1)&&draw_slurs(t),t.st<s&&(s=t.st),t.tp&&draw_tuplet(t),t.tpe)break}if(t&&t.tpe--,1!=_.f[0])if(t){if(!(g=_.f[3])){for(n=e;n&&!n.stem;)n=n.next;g=n&&n.stem<0?C.SL_BELOW:C.SL_ABOVE}if(e==t||2==_.f[1])o=!0;else if(1==_.f[1])o=!0,draw_slur([e,t],null,{ty:g});else if(2!=_.f[0]&&e.type==C.NOTE&&t.type==C.NOTE){for(o=!0,n=e;;n=n.next){if(n.type!=C.NOTE&&n.type!=C.REST){if(n.type==C.GRACE||n.type==C.SPACE)continue;o=!1;break}if(n==t)break;if(n.beam_end){o=!1;break}}if(o&&!e.beam_st&&!e.beam_br1&&!e.beam_br2)for(n=e.prev;n;n=n.prev)if(n.type==C.NOTE||n.type==C.REST){n.nflags>=e.nflags&&(o=!1);break}if(o&&!t.beam_end)for(n=t.next;n;n=n.next)if(n.type==C.NOTE||n.type==C.REST){!n.beam_br1&&!n.beam_br2&&n.nflags>=t.nflags&&(o=!1);break}}if(o){if(1==_.f[2])return;for(set_font("tuplet"),u=(t.x+e.x)/2,f=g==C.SL_ABOVE?y_get(s,1,u-4,8):y_get(s,0,u-4,8)-gene.curfont.size,e.stem*t.stem>0&&(e.stem>0?u+=1.5:u-=1.5),0==_.f[2]?xy_str(u,f,_.p.toString(),"c"):xy_str(u,f,_.p+":"+_.q,"c"),n=e;!(n.x>=u);n=n.next);g==C.SL_ABOVE?(f+=gene.curfont.size,n.ymx<f&&(n.ymx=f),y_set(s,!0,u-3,6,f)):(n.ymn>f&&(n.ymn=f),y_set(s,!1,u-3,6,f))}else{if(i=e.x-4,t.dur>t.prev.dur){if(!(n=t.next)||n.time!=t.time+t.dur)for(n=t.ts_next;n&&!(n.seqst&&n.time>=t.time+t.dur);n=n.ts_next);a=n?n.x-n.wl-5:realwidth-6}else a=t.x+4,A=t.stem>=0?0:t.nhd,t.notes[A].shhd>0&&(a+=t.notes[A].shhd),t.st==s&&t.stem>0&&(a+=3.5);if(g==C.SL_ABOVE){if(e.st==t.st?c=l=staff_tb[s].topbar+2:(c=e.ymx,l=t.ymx),e.st==s){for(n=e;!n.dur;n=n.next);(f=y_get(s,1,n.x-4,8))>c&&(c=f),e.stem>0&&(i+=3)}if(t.st==s){for(n=t;!n.dur;n=n.prev);(f=y_get(s,1,n.x-4,8))>l&&(l=f)}for(u=.5*(i+a),f=.5*(c+l),y=(l-c)/(a-i),(d=3*(t.notes[t.nhd].pit-e.notes[e.nhd].pit)/(a-i))>0?y<0?y=0:y>d&&(y=d):y>0?y=0:y<d&&(y=d),(y=e.fmt.beamslope*y/(e.fmt.beamslope+Math.abs(y)))*y<.1*.1&&(y=0),m=0,n=e;;n=n.next)if(n.dur&&n.st==s){if(p=f+(n.x-u)*y,(h=y_get(s,1,n.x-4,8)+2)-p>m&&(m=h-p),n==t)break}else if(n==t)break;for(c=(f+=m)+y*(i-u),l=f+y*(a-u),f+=6,n=e;n.st==s&&(p=f+(n.x-u)*y,n.ymx<p&&(n.ymx=p),y_set(s,!0,n.x-3,6,p)),n!=t;n=n.next);}else{if(e.stem<0&&(i-=2),e.st==s){for(n=e;!n.dur;n=n.next);c=y_get(s,0,n.x-4,8)}else c=0;if(t.st==s){for(n=t;!n.dur;n=n.prev);l=y_get(s,0,n.x-4,8)}else l=0;for(u=.5*(i+a),f=.5*(c+l),y=(l-c)/(a-i),(d=3*(t.notes[0].pit-e.notes[0].pit)/(a-i))>0?(y<0?y=0:y>d&&(y=d),y>.35&&(y=.35)):(y>0?y=0:y<d&&(y=d),y<-.35&&(y=-.35)),y*y<.1*.1&&(y=0),m=0,n=e;;n=n.next)if(n.dur&&n.st==s){if(p=f+(n.x-u)*y,(h=y_get(s,0,n.x-4,8))-p<m&&(m=h-p),n==t)break}else if(n==t)break;for(c=(f+=m-8)+y*(i-u),l=f+y*(a-u),f-=2,n=e;n.st==s&&(p=f+(n.x-u)*y,n.ymn>p&&(n.ymn=p),y_set(s,!1,n.x-3,6,p)),n!=t;n=n.next);}1!=_.f[2]?(out_tubrn(i,c,a-i,l-c,g==C.SL_ABOVE,0==_.f[2]?_.p.toString():_.p+":"+_.q),g==C.SL_ABOVE?y_set(s,!0,u-3,6,p+2):y_set(s,!1,u-3,6,p)):out_tubr(i,c+4,a-i,l-c,g==C.SL_ABOVE)}}else error(1,e,"No end of tuplet in this music line")}function draw_tie(e,t,n){var r,s,o,i=2==n?e.pit:t.pit,a=(7&e.tie_ty)==C.SL_ABOVE?1:-1,c=e.s,l=c.st,u=t.s,f=u.x,d=e.shhd;for(r=0;r<c.nhd&&c.notes[r]!=e;r++);if(a>0?r<c.nhd&&i+1==c.notes[r+1].pit&&c.notes[r+1].shhd>d&&(d=c.notes[r+1].shhd):r>0&&i==c.notes[r-1].pit+1&&c.notes[r-1].shhd>d&&(d=c.notes[r-1].shhd),s=c.x+d,2!=n){for(r=0;r<u.nhd&&u.notes[r]!=t;r++);d=u.notes[r].shhd,a>0?r<u.nhd&&i+1==u.notes[r+1].pit&&u.notes[r+1].shhd<d&&(d=u.notes[r+1].shhd):r>0&&i==u.notes[r-1].pit+1&&u.notes[r-1].shhd<d&&(d=u.notes[r-1].shhd),f+=d}switch(n){default:(i<t.pit||a<0)&&(i=e.pit);break;case 3:a=-a;case 1:s=u.prev?u.prev.x+u.wr:c.x,c.st!=u.st&&(l=u.st),(s+=.4*(f-s))>f-20&&(s=f-20);break;case 2:(f=c.next?c.next.x:realwidth)!=realwidth&&(f-=.4*(f-s)),f<s+16&&(f=s+16)}f-s>20?(s+=3.5,f-=3.5):(s+=1.5,f-=1.5),!c.dots||1&e.pit||!(a>0&&!c.dot_low||a<0&&c.dot_low)||(s+=5),slur_out(s,o=staff_tb[l].y+3*(i-18)+a,f,o,a,(.03*(f-s)+16)*a*c.fmt.tieheight,e.tie_ty&C.SL_DOTTED)}function draw_all_ties(e){var t,n,r,s,o,i,a,c=0;for(set_color((n=e.sym).color);n;n=n.next){if(n.ti2&&n.time!=c)for(o=0;o<=n.nhd;o++)(i=(a=n.notes[o]).tie_s)&&i.s.v==n.v&&draw_tie(i,a,1);if(n.ti1)if(n.type!=C.GRACE)for(o=0;o<=n.nhd;o++)if(a=(i=n.notes[o]).tie_e)if(r=a.s,tsnext&&r.time>=tsnext.time)draw_tie(i,a,2);else{for(c=r.time,t=n.ts_next;t!=r;t=t.ts_next)if(t.st==n.st&&t.type==C.CLEF){s=!0;break}s||n.st!=r.st?(draw_tie(i,a,2),draw_tie(i,a,3),s=!1):draw_tie(i,a)}else i.tie_ty&&draw_tie(i,i,2);else for(t=n.extra;t;t=t.next)for(o=0;o<=n.nhd;o++)(a=(i=t.notes[o]).tie_e)&&(draw_tie(i,a),c=a.s.time)}}function draw_sym_near(){var e,t,n,r,s,o,i,a,c,l,u,f,d,p,h=output;function m(e,t){var n,r=realwidth/YSTEP,s=e.x/r|0,o=t.x/r|0,i=(e.ys-t.ys)/(e.xs-t.xs),a=e.ys-e.xs*i,c=staff_tb[e.st];if(r*=i,e.stem>0)for(;s<=o;)n=r*s+a,c.top[s]<n&&(c.top[s]=n),s++;else for(;s<=o;)n=r*s+a,c.bot[s]>n&&(c.bot[s]=n),s++}for(output="",YSTEP=Math.ceil(realwidth/2),c=0;c<=nstaff;c++)for((t=staff_tb[c]).top=new Float32Array(YSTEP),t.bot=new Float32Array(YSTEP),a=0;a<YSTEP;a++)t.top[a]=0,t.bot[a]=24;for(r=0;r<voice_tb.length;r++){var y={},g=!0;for(n=(e=voice_tb[r]).sym;n;n=n.next)if(n.type===C.GRACE){for(p=0,o=n.extra;o;o=o.next)o.beam_st&&!o.beam_end&&(self.calculate_beam(y,o),y.s2&&m(o,y.s2)),(o.sls||o.sl1)&&p++;n.p_v.ckey.k_bagpipe||!n.fmt.graceslurs||n.gr_shift||p||n.ti1||!n.next||n.next.type!=C.NOTE||grace_slur(n)}for(n=e.sym;n;n=n.next)if(n.type===C.NOTE)(n.beam_st&&!n.beam_end||g&&!n.beam_st)&&(g=!1,self.calculate_beam(y,n),y.s2&&m(n,y.s2))}for(set_tie_room(),draw_deco_near(),n=tsfirst;n;n=n.ts_next)if(!n.invis){switch(n.type){case C.GRACE:for(o=n.extra;o;o=o.next)y_set(n.st,!0,o.x-2,4,o.ymx+1),y_set(n.st,!1,o.x-2,4,o.ymn-5);continue;case C.MREST:y_set(n.st,!0,n.x+16,32,n.ymx+2);continue;default:y_set(n.st,!0,n.x-n.wl,n.wl+n.wr,n.ymx+2),y_set(n.st,!1,n.x-n.wl,n.wl+n.wr,n.ymn-2);continue;case C.NOTE:}n.stem>0?(n.stemless?(l=-5,i=10):n.beam_st?(l=3,i=n.beam_end?4:10):(l=-8,i=n.beam_end?11:16),y_set(n.st,!0,n.x+l,i,n.ymx),d=n.ymn,n.notes[0].acc&&d>3*(n.notes[0].pit-18)-9&&(d=3*(n.notes[0].pit-18)-9),y_set(n.st,!1,n.x-n.wl,n.wl+n.wr,d)):(y_set(n.st,!0,n.x-n.wl,n.wl+n.wr,n.ymx),n.stemless?(l=-5,i=10):n.beam_st?(l=-6,i=n.beam_end?4:10):(l=-8,i=n.beam_end?5:16),l+=n.notes[0].shhd,y_set(n.st,!1,n.x+l,i,n.ymn)),n.notes[n.nhd].acc&&(s=n.y+8,n.ymx<s&&(n.ymx=s),y_set(n.st,!0,n.x,0,s)),n.notes[0].acc&&(s=n.y,1==n.notes[0].acc||3==n.notes[0].acc?s-=7:s-=5,n.ymn>s&&(n.ymn=s),y_set(n.st,!1,n.x,0,s))}for(draw_deco_note(),r=0;r<voice_tb.length;r++)if(n=(e=voice_tb[r]).sym)for(set_color(n.color),c=e.st;n;n=n.next)n.play||(n.tp&&draw_tuplet(n),(n.sls||n.sl1)&&draw_slurs(n));for(set_color(),c=0;c<=nstaff;c++)for(u=(t=staff_tb[c]).topbar+2,f=t.botbar-2,a=0;a<YSTEP;a++)u>t.top[a]&&(t.top[a]=u),f<t.bot[a]&&(t.bot[a]=f);for(cfmt.measurenb>=0&&draw_measnb(),set_dscale(-1),r=0;r<voice_tb.length;r++)if((e=voice_tb[r]).have_ly){draw_all_lyrics();break}draw_deco_staff(),set_dscale(-1),output=h}function draw_vname(e,t){var n,r,s,o,i,a,c,l,u,f=[];for(s=t.length;s>=0&&!t[s];s--);if(!(s<0)){for(o=0;o<voice_tb.length;o++)n=voice_tb[o],cur_sy.voices[o]&&t[s=cur_sy.voices[o].st]&&gene.vnt&&(a=2==gene.vnt?n.nm:n.snm)&&(delete n.new_name,f[s]?f[s]+="\n"+a:f[s]=a);if(f.length)for(set_font("voice"),u=(l=gene.curfont.size)/2,e=.5*-e,s=0;s<f.length;s++)if(f[s])for(i=f[s].split("\n"),c=staff_tb[s].y+.5*staff_tb[s].topbar*staff_tb[s].staffscale+u*(i.length-2),cur_sy.staves[s].flags&OPEN_BRACE&&s+1<staff_tb.length&&cur_sy.staves[s+1].flags&CLOSE_BRACE&&!f[s+1]&&(c-=.5*(staff_tb[s].y-staff_tb[s+1].y)),r=0;r<i.length;r++)xy_str(e,c,a=i[r],"c"),c-=l}}function set_staff(){var e,t,n,r,s,o,i,a,c,l,u,f,d=tsfirst.fmt,p=cur_sy;for(r=0;r<voice_tb.length;r++)1!=(u=voice_tb[r]).scale&&(u.scale_str='transform="scale('+u.scale.toFixed(2)+')"');for(t=0;t<=nstaff&&!gene.st_print[t];t++);for(s=0,t>nstaff&&(t--,f=staff_tb[t]),f=staff_tb[t],e=0;e<YSTEP;e++)s<(l=f.top[e])&&(s=l);for(s+=draw_partempo(t,s),(s*=f.staffscale)<(o=.5*d.staffsep+f.topbar*f.staffscale)&&(s=o),s<f.ann_top&&(s=f.ann_top),f.y=-s,n=0;n<t;n++)staff_tb[n].y=-s;if(!gene.st_print[t])return s;var h=p.staves[n];for(t++;t<=nstaff;t++)if(gene.st_print[t]){if(f=staff_tb[t],o=h.sep||cfmt.sysstaffsep,a=h.maxsep||cfmt.maxsysstaffsep,i=0,f.staffscale==staff_tb[n].staffscale){for(e=0;e<YSTEP;e++)i<(l=f.top[e]-staff_tb[n].bot[e])&&(i=l);i*=f.staffscale}else for(e=0;e<YSTEP;e++)i<(l=f.top[e]*f.staffscale-staff_tb[n].bot[e]*staff_tb[n].staffscale)&&(i=l);for(i<(o+=f.topbar*f.staffscale)&&(i=o),i>(a+=f.topbar*f.staffscale)&&(i=a),s+=i,f.y=-s;!gene.st_print[++n];)staff_tb[n].y=-s;for(;!(h=p.staves[n]);)p=p.next}for(c=0,e=0;e<YSTEP;e++)c>(l=staff_tb[n].bot[e])&&(c=l);for(c>f.ann_bot&&(c=f.ann_bot),c*=staff_tb[n].staffscale,t=0;t<=nstaff;t++)i=(f=staff_tb[t]).y,1!=f.staffscale&&(f.scale_str='transform="translate(0,'+(posy-i).toFixed(1)+") scale("+f.staffscale.toFixed(2)+')"');if(0==c){for(t=nstaff;t>=0&&!gene.st_print[t];t--);if(t<0)return s}return(i=-c)<(o=.5*d.staffsep)&&(i=o),i>(a=.5*d.maxstaffsep)&&(i=a),s+i}function draw_systems(e){var t,n,r,s,o,i,a=[],c=[],l=[],u=[],f=[],d="",p="";function h(){var e,t,n,r,s=0;for(e=0;e<=cur_sy.nstaff;e++)a[e]<0?l[e]=u[e]=0:(t=staff_tb[e].staffscale,n=staff_tb[e].topbar*t,r=staff_tb[e].botbar*t,0==s&&(s=staff_tb[e].y+n),l[e]=staff_tb[e].y+r,u[e]=s-l[e],s=cur_sy.staves[e].flags&STOP_BAR?0:l[e])}function m(e,t,n){var r,s,o,i,a,c=0,l="",u=staff_tb[e].stafflines,f=u.length,d=6*staff_tb[e].staffscale;if(/[\[|]/.test(u))if(r=n-t,set_sscale(-1),s=r/staff_tb[e].staffscale,cache&&cache.st_l==u&&cache.st_ws==(0|s))xygl(t,staff_tb[e].y,"stdef"+cfmt.fullsvg);else{for(o=0;o<f;o++,c-=d)if("."!=u[o]){for(i=0;o<f;o++,c-=d,i-=d){switch(u[o]){case".":case"-":continue;case a:l+="m-"+r.toFixed(1)+" "+i+"h"+r.toFixed(1),i=0;continue}null!=a&&(l+='"/>\n'),l+='<path class="'+("["==(a=u[o])?"slthW":"slW")+'" d="m0 '+c+"h"+r.toFixed(1),i=0}l+='"/>'}if(c=staff_tb[e].y,!cache&&r>get_lwidth()-10)return cache={st_l:u,st_ws:0|s},o="stdef"+cfmt.fullsvg,l.indexOf("<path",1)<0?glyphs[o]=l.replace("path",'path id="'+o+'"'):glyphs[o]='<g id="'+o+'">\n'+l+"\n</g>",void xygl(t,c,o);out_XYAB('<g transform="translate(X, Y)">\n'+l+"\n</g>\n",t,c)}}function y(e,t,n){var r,s,o,i=e.bar_type,a=e.st,c=staff_tb[a],l=e.x;if(0!=a&&e.ts_prev&&e.ts_prev.type!=C.BAR&&(n=c.topbar*c.staffscale),e.ymx=e.ymn+n,set_sscale(-1),anno_start(e),e.color&&set_color(e.color),o=c.y+12,"|||||"!=c.stafflines&&(o+=(c.topbar+c.botbar)/2-12),e.bar_mrep){if(set_sscale(a),1==e.bar_mrep){for(s=e.prev;s.type!=C.REST;s=s.prev);xygl(s.x,o,"mrep")}else xygl(l,o,"mrep2"),e.v==cur_sy.top_voice&&nrep_out(l,o+c.topbar,e.bar_mrep);set_sscale(-1)}for("||:"==i&&(i="[|:"),r=i.length;--r>=0;){switch(i[r]){case"|":e.bar_dotted?out_XYAB('<path class="bW" stroke-dasharray="A,A" d="MX Yv-G"/>\n',l,t,(5*c.staffscale).toFixed(1),n):e.color?out_XYAB('<path class="bW" d="MX Yv-F"/>\n',l,t,n):d+="M"+sx(l).toFixed(1)+" "+self.sy(t).toFixed(1)+"v-"+n.toFixed(1);break;default:l-=3,e.color?out_XYAB('<path class="bthW" d="MX Yv-F"/>\n',l+1.5,t,n):p+="M"+sx(l+1.5).toFixed(1)+" "+self.sy(t).toFixed(1)+"v-"+n.toFixed(1);break;case":":l-=2,set_sscale(a),xygl(l+1,o-12,"rdots"),set_sscale(-1)}l-=3}set_color(),anno_stop(e)}function g(e){var t,n=staff_tb[e.st],r=5-e.nflags,s=e.x,o=e.y;if(!(r<6)){switch(7==r&&12==o&&n.stafflines.length<=2&&(o-=6),t=o/6,r){default:switch(n.stafflines[t+1]){case"|":case"[":break;default:set_hl(n,t+1,s,-7,7)}9==r&&(o-=6,t--);break;case 7:o+=6,t++;case 6:}switch(n.stafflines[t]){case"|":case"[":break;default:set_hl(n,t,s,-7,7)}}}for(r=0;r<=nstaff;r++)a[r]=cur_sy.st_print[r]?0:-1,c[r]=cur_sy.st_print[r];for(h(),draw_lstaff(0),t=tsfirst;t;t=t.ts_next)switch(t.type){case C.STAVES:for(i=t.sy,r=0;r<=nstaff;r++)(s=a[r])<0?i.st_print[r]&&(t.ts_prev.bar_type?a[r]=t.ts_prev.x:t.ts_next.bar_type?a[r]=t.x:a[r]=t.ts_prev.x+t.ts_prev.wr,c[r]=!0):i.st_print[r]&&i.staves[r].stafflines==cur_sy.staves[r].stafflines||(t.ts_prev.bar_type?o=t.ts_prev.x:(o=(t.ts_prev.x+t.x)/2,a[r]=-1),m(r,s,o),a[r]=i.st_print[r]?o:-1);cur_sy=i,h();continue;case C.BAR:if(t.invis||!t.bar_type||!cur_sy.st_print[t.st])break;if(t.second&&(!t.ts_prev||t.ts_prev.type==C.BAR&&t.ts_prev.st==t.st))break;f.push([t,l[t.st],u[t.st]]);break;case C.STBRK:if(cur_sy.voices[t.v]&&0==cur_sy.voices[t.v].range&&t.xmx>14){for(var A=0,_=0;_<voice_tb.length;_++)cur_sy.voices[_]&&cur_sy.voices[_].range>0&&A++;for(n=t.ts_next;n&&n.type==C.STBRK;n=n.ts_next)A--;0==A&&draw_lstaff(t.x)}if(r=t.st,(s=a[r])>=0){if(!(n=t.prev))break;if(s>=(o=n.type==C.BAR?n.x:t.x-t.xmx))break;m(r,s,o),a[r]=t.x}break;case C.GRACE:for(n=t.extra;n;n=n.next)self.draw_hl(n);break;case C.NOTE:t.invis||self.draw_hl(t);break;case C.REST:(t.fmr||t.rep_nb&&t.rep_nb>=0)&&center_rest(t),t.invis||g(t)}for(r=0;r<=nstaff;r++)(s=a[r])<0||s>=realwidth||m(r,s,realwidth);draw_all_hl(),function(){var e,t,n,r=f.length;for(set_font("annotation"),(n=gene.curfont.box)&&(gene.curfont.box=0),e=0;e<r;e++)y((t=f[e])[0],t[1],t[2]);n&&(gene.curfont.box=n),set_sscale(-1),d&&(output+='<path class="bW" d="'+d+'"/>\n'),p&&(output+='<path class="bthW" d="'+p+'"/>\n')}(),draw_vname(e,c)}function draw_all_sym(){var e,t,n=voice_tb.length;for(t=0;t<n;t++)(e=voice_tb[t]).sym&&null!=e.sym.x&&(self.draw_symbols(e),draw_all_ties(e),set_color());self.draw_all_deco(),glout(),anno_put(),set_sscale(-1)}function set_tie_dir(e){for(var t,n,r,s,o,i,a;e;e=e.next)if(e.ti1){for(s=n=0,o=128,t=0;t<=e.nhd;t++)e.notes[t].tie_ty&&(n++,o<128&&e.notes[t].pit<=o+1&&s++,o=e.notes[t].pit,a=e.notes[t].tie_e);if(r=a&&e.stem*a.stem<0?o>=22?C.SL_ABOVE:C.SL_BELOW:e.multi?e.multi>0?C.SL_ABOVE:C.SL_BELOW:e.stem<0?C.SL_ABOVE:C.SL_BELOW,e.multi)for(t=0;t<=e.nhd;t++)(7&(i=e.notes[t].tie_ty))==C.SL_AUTO&&(e.notes[t].tie_ty=i&C.SL_DOTTED|r);else if(n<=1){for(t=0;t<=e.nhd;t++)if(i=e.notes[t].tie_ty){(7&i)==C.SL_AUTO&&(e.notes[t].tie_ty=i&C.SL_DOTTED|r);break}}else if(s){for(o=128,t=0;t<=e.nhd;t++)if(e.notes[t].tie_ty){if(o<128&&e.notes[t].pit<=o+1){n=t;break}o=e.notes[t].pit}for(r=C.SL_BELOW,t=0;t<=e.nhd;t++)(i=e.notes[t].tie_ty)&&(n==t&&(r=C.SL_ABOVE),(7&i)==C.SL_AUTO&&(e.notes[t].tie_ty=i&C.SL_DOTTED|r))}else{if(1&n){for(n=(n-1)/2,r=C.SL_BELOW,t=0;t<=e.nhd;t++)(i=e.notes[t].tie_ty)&&(0==n&&e.notes[t].pit>=22&&(r=C.SL_ABOVE),(7&i)==C.SL_AUTO&&(e.notes[t].tie_ty=i&C.SL_DOTTED|r),0==n--&&(r=C.SL_ABOVE));continue}for(n/=2,r=C.SL_BELOW,t=0;t<=e.nhd;t++)(i=e.notes[t].tie_ty)&&((7&i)==C.SL_AUTO&&(e.notes[t].tie_ty=i&C.SL_DOTTED|r),0==--n&&(r=C.SL_ABOVE))}}}function set_tie_room(){var e,t,n,r,s,o;for(n=0;n<voice_tb.length;n++)if((e=voice_tb[n].sym)&&(e=e.next))for(set_tie_dir(e);e;e=e.next)if(e.ti1){if(e.notes[0].pit<20&&e.notes[0].tie_ty&&(7&e.notes[0].tie_ty)==C.SL_BELOW);else if(!(e.notes[e.nhd].pit>24&&e.notes[e.nhd].tie_ty&&(7&e.notes[e.nhd].tie_ty)==C.SL_ABOVE))continue;for(t=e.next;t&&t.type!=C.NOTE;)t=t.next;if(t){if(t.st!=e.st)continue;r=t.x-e.x-10}else r=realwidth-e.x-10;o=r<100?9:r<300?12:16,e.notes[e.nhd].pit>24&&(s=3*(e.notes[e.nhd].pit-18)+o,e.ymx<s&&(e.ymx=s),t&&t.ymx<s&&(t.ymx=s),y_set(e.st,!0,e.x+5,r,s)),e.notes[0].pit<20&&(s=3*(e.notes[0].pit-18)-o,e.ymn>s&&(e.ymn=s),t&&t.ymn>s&&(t.ymn=s),y_set(e.st,!1,e.x+5,r,s))}}Abc.prototype.draw_symbols=function(e){var t,n,r,s,o={};for(t=e.sym;t;t=t.next){if(t.invis)switch(t.type){case C.KEY:e.ckey=t;default:continue;case C.NOTE:}switch(s=t.st,n=t.x,set_color(t.color),t.type){case C.NOTE:set_scale(t),t.beam_st&&!t.beam_end&&self.calculate_beam(o,t)&&draw_beams(o),t.invis||(anno_start(t),draw_note(t,!o.s2),anno_a.push(t)),t==o.s2&&(o.s2=null);break;case C.REST:if(!gene.st_print[s])break;draw_rest(t);break;case C.BAR:break;case C.CLEF:if(t.time>=staff_tb[s].clef.time&&(staff_tb[s].clef=t),t.second||!staff_tb[s].topbar)break;set_color(),set_sscale(s),anno_start(t),r=staff_tb[s].y,t.clef_name?xygl(n,r+t.y,t.clef_name):t.clef_small?xygl(n,r+t.y,"s"+t.clef_type+"clef"):xygl(n,r+t.y,t.clef_type+"clef"),t.clef_octave&&(t.clef_octave>0?(r+=t.ymx-10,t.clef_small&&(r-=1)):(r+=t.ymn+6,t.clef_small&&(r+=1)),xygl(n-2,r,7==t.clef_octave||-7==t.clef_octave?"oct":"oct2")),anno_a.push(t);break;case C.METER:if(e.meter=t,t.second||!staff_tb[t.st].topbar)break;set_color(),set_sscale(t.st),anno_start(t),draw_meter(t),anno_a.push(t);break;case C.KEY:if(e.ckey=t,t.second||!staff_tb[t.st].topbar)break;set_color(),set_sscale(t.st),anno_start(t),self.draw_keysig(n,t),anno_a.push(t);break;case C.MREST:draw_mrest(t);break;case C.GRACE:set_scale(t),draw_gracenotes(t);break;case C.SPACE:case C.STBRK:break;case C.CUSTOS:set_scale(t),draw_note(t,0);break;case C.BLOCK:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,t,"draw_symbols - Cannot draw symbol "+t.type)}}set_scale(e.sym)};var musicfont='url("data:application/octet-stream;base64,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Ngd1bmlFMDg3B3VuaUUwODgHdW5pRTA4OQd1bmlFMDhBB3VuaUUwOEIHdW5pRTA4Qwd1bmlFMDk0B3VuaUUwOTUHdW5pRTBBMAd1bmlFMEExB3VuaUUwQTIHdW5pRTBBMwd1bmlFMEE0B3VuaUUwQTkHdW5pRTBCMwd1bmlFMTAxB3VuaUUxQjkHdW5pRTFCQgd1bmlFMUU3B3VuaUUxRjIHdW5pRTFGNAd1bmlFMUY3B3VuaUUxRjkHdW5pRTFGQwd1bmlFMUZFB3VuaUUxRkYHdW5pRTIwMAd1bmlFMjQwB3VuaUUyNDEHdW5pRTI0Mgd1bmlFMjQzB3VuaUUyNDQHdW5pRTI0NQd1bmlFMjQ2B3VuaUUyNDcHdW5pRTI0OAd1bmlFMjQ5B3VuaUUyNjAHdW5pRTI2MQd1bmlFMjYyB3VuaUUyNjMHdW5pRTI2NAd1bmlFMjZhB3VuaUUyNmIHdW5pRTI4MAd1bmlFMjgxB3VuaUUyODIHdW5pRTI4Mwd1bmlFNEEwB3VuaUU0QTIHdW5pRTRBNAd1bmlFNEE4B3VuaUU0QUMHdW5pRTRDMAd1bmlFNENFB3VuaUU0RDEHdW5pRTRFMQd1bmlFNEUyB3VuaUU0RTMHdW5pRTRFNAd1bmlFNEU1B3VuaUU0RTYHdW5pRTRFNwd1bmlFNEU4B3VuaUU0RTkHdW5pRTRFQQd1bmlFNTAwB3VuaUU1MDEHdW5pRTUyMAd1bmlFNTIxB3VuaUU1MjIHdW5pRTUyMwd1bmlFNTI0B3VuaUU1MjUHdW5pRTUyOQd1bmlFNTJBB3VuaUU1MkIHdW5pRTUyQwd1bmlFNTJEB3VuaUU1MkYHdW5pRTUzMAd1bmlFNTMxB3VuaUU1MzkHdW5pRTU2Ngd1bmlFNTY3B3VuaUU1NjkHdW5pRTU2Qwd1bmlFNTZEB3VuaUU1ODIHdW5pRTVEMAd1bmlFNUUyB3VuaUU2MTAHdW5pRTYxMgd1bmlFNjE0B3VuaUU2MTgHdW5pRTYyNAd1bmlFNjMwB3VuaUU2NTAHdW5pRTY1NQd1bmlFOTEwB3VuaUU5MTEHdW5pRTkxMgd1bmlFOTE0B3VuaUU5MTUHdW5pRTkxOAd1bmlFOTIwB3VuaUU5MjUHdW5pRTk1RAd1bmlFQTAyB3VuaUVBQTQHdW5pRUNBMgd1bmlFQ0EzB3VuaUVDQTUHdW5pRUNBNwd1bmlFQ0E5B3VuaUVDQjcAAAAAAAAB//8AAgABAAAAAAAAAAwAFAAEAAAAAgAAAAEAAAABAAAAAAABAAAAAN2HW+gAAAAA0ZciFwAAAADeLXWv") format("truetype")',font_tb=[],font_st={},font_scale_tb={serif:1,serifBold:1,"sans-serif":1,"sans-serifBold":1,Palatino:1.1,monospace:1.35},txt_ff="text,serif",fmt_lock={},cfmt={"abc-version":"1",annotationfont:{name:"text,sans-serif",size:12},aligncomposer:1,beamslope:.4,bardef:{"[":"","[]":"","|:":"[|:","|::":"[|::","|:::":"[|:::",":|":":|]","::|":"::|]",":::|":":::|]","::":":][:"},breaklimit:.7,breakoneoln:!0,cancelkey:!0,composerfont:{name:txt_ff,style:"italic",size:14},composerspace:6,decoerr:!0,dynalign:!0,footerfont:{name:txt_ff,size:16},fullsvg:"",gchordfont:{name:"text,sans-serif",size:12},gracespace:new Float32Array([6,8,11]),graceslurs:!0,headerfont:{name:txt_ff,size:16},historyfont:{name:txt_ff,size:16},hyphencont:!0,indent:0,infofont:{name:txt_ff,style:"italic",size:14},infoname:'R "Rhythm: "\nB "Book: "\nS "Source: "\nD "Discography: "\nN "Notes: "\nZ "Transcription: "\nH "History: "',infospace:0,keywarn:!0,leftmargin:1.4*CM,lineskipfac:1.1,linewarn:!0,maxshrink:.65,maxstaffsep:2e3,maxsysstaffsep:2e3,measrepnb:1,measurefont:{name:txt_ff,style:"italic",size:10},measurenb:-1,musicfont:{name:"music",src:musicfont,size:24},musicspace:6,partsfont:{name:txt_ff,size:15},parskipfac:.4,partsspace:8,pagewidth:21*CM,printmargin:0,rightmargin:1.4*CM,rbmax:4,rbmin:2,repeatfont:{name:txt_ff,size:9},scale:1,slurheight:1,spatab:new Float32Array([10.2,13.3,17.3,22.48,29.2,38,49.4,64.2,83.5,108.5]),staffsep:46,stemheight:21,stretchlast:.25,stretchstaff:!0,subtitlefont:{name:txt_ff,size:16},subtitlespace:3,sysstaffsep:34,tempofont:{name:txt_ff,weight:"bold",size:12},textfont:{name:txt_ff,size:16},textspace:14,tieheight:1,titlefont:{name:txt_ff,size:20},titlespace:6,titletrim:!0,topspace:22,tuplets:[0,0,0,0],tupletfont:{name:txt_ff,style:"italic",size:12},vocalfont:{name:txt_ff,weight:"bold",size:13},vocalspace:10,voicefont:{name:txt_ff,weight:"bold",size:13},writefields:"CMOPQsTWw",wordsfont:{name:txt_ff,size:16},wordsspace:5},sfmt={bardef:!0,barsperstaff:!0,beamslope:!0,breaklimit:!0,bstemdown:!0,cancelkey:!0,dynalign:!0,flatbeams:!0,gracespace:!0,hyphencont:!0,keywarn:!0,maxshrink:!0,maxstaffsep:!0,measrepnb:!0,rbmax:!0,rbmin:!0,shiftunison:!0,slurheight:!0,squarebreve:!0,staffsep:!0,stemheight:!0,stretchlast:!0,stretchstaff:!0,tieheight:!0,timewarn:!0,vocalspace:!0};function get_bool(e){return!e||!/^(0|n|f)/i.test(e)}function get_font_scale(e){var t=info_split(e);if(!(t.length<=1)){var n=+t[t.length-1];isNaN(n)||n<=.5?syntax(1,"Bad scale value in %%font"):font_scale_tb[t[0]]=n}}function set_font_fac(e){var t=font_scale_tb[e.fname||e.name];t||(t=1.1),e.swfac=e.size*t}function param_set_font(e,t){var n,r,s;if("-"==e[e.length-2]){if((r=e[e.length-1])<"1"||r>"9")return;e="u"+r+"font"}if(n=(n=cfmt[e])?{name:n.name,size:n.size,box:n.box,pad:n.pad||0}:{pad:0},cfmt[e]=n,(s=t.match(/\s+(no)?box(\s|$)/))&&(s[1]?(n.box=!1,n.pad=0):(n.box=!0,n.pad=.4*n.size-3),t=t.replace(s[0],s[2])),(s=t.match(/\s+padding=([\d.]+)(\s|$)/))&&(n.pad=s[1]?+s[1]:0,t=t.replace(s[0],s[2])),(s=t.match(/\s+class=(.*?)(\s|$)/))&&(n.class=s[1],t=t.replace(s[0],s[2])),s=t.match(/\s+wadj=(.*?)(\s|$)/)){if("undefined"==typeof document)switch(s[1]){case"none":n.wadj="";break;case"space":n.wadj="spacing";break;case"glyph":n.wadj="spacingAndGlyphs";break;default:syntax(1,errs.bad_val,"%%"+e)}t=t.replace(s[0],s[2])}if((s=t.match(/\s+([0-9.]+|\*)$/))&&("*"!=s[1]&&(n.size=+s[1]),t=t.replace(s[0],"")),n.fname=t,"u"==t[0]&&"url("==t.slice(0,4)){if((r=t.indexOf(")",1))<0)return void syntax(1,"No end of url in font family");t=t.slice(0,r+1),n.src=t,n.fid=font_tb.length,font_tb.push(n),n.normal=!0,t="ft"+n.fid}else{if('"'==t[0]){if((r=t.indexOf('"',1))<0)return void syntax(1,"No end of string in font family");t=t.slice(1,r)}switch((s=t.match(/[- ]?[nN]ormal/))&&(n.normal=!0,t=t.replace(s[0],"")),(s=t.match(abc2svg.ft_re))&&(n.weight=abc2svg.ft_w[s[0].replace(/[ -]/,"").toLowerCase()],t=t.replace(s[0],"")),(s=t.match(/[- ]?[iI]talic/))&&(n.style="italic",t=t.replace(s[0],"")),(s=t.match(/[- ]?[oO]blique/))&&(n.style="oblique",t=t.replace(s[0],"")),t=t.trim()){case"":case"*":return;case"Times-Roman":case"Times":t="serif";break;case"Helvetica":t="sans-serif";break;case"Courier":t="monospace";break;case"music":t=cfmt.musicfont.name;break;default:t.indexOf("Fig")>0&&(n.figb=!0)}}n.name=t,n.size?set_font_fac(n):n.swfac=0}function get_unit(e){var t=e.toLowerCase().match(/(-?[\d.]+)(.*)/);if(!t)return NaN;switch(t[1]=+t[1],t[2]){case"cm":return t[1]*CM;case"in":return t[1]*IN;case"pt":return.75*t[1];case"px":case"":return t[1]}return NaN}function set_infoname(e){for(var t=cfmt.infoname.split("\n"),n=e[0],r=0;r<t.length;r++){if(t[r][0]==n)return 1==e.length?t.splice(r,1):t[r]=e,void(cfmt.infoname=t.join("\n"))}cfmt.infoname+="\n"+e}var textopt={align:"j",center:"c",fill:"f",justify:"j",obeylines:"l",ragged:"f",right:"r",skip:"s"};function get_textopt(e){var t=e.indexOf(" ");return t>0&&(e=e.slice(0,t)),textopt[e]}var posval={above:C.SL_ABOVE,auto:0,below:C.SL_BELOW,down:C.SL_BELOW,hidden:C.SL_HIDDEN,opposite:C.SL_HIDDEN,under:C.SL_BELOW,up:C.SL_ABOVE};function set_pos(e,t){"ste"==(e=e.slice(0,3))&&(e="stm"),set_v_param("pos",'"'+e+" "+t+'"')}function set_writefields(e){var t,n,r=e.split(/\s+/);if(get_bool(r[1]))for(n=0;n<r[0].length;n++)t=r[0][n],cfmt.writefields.indexOf(t)<0&&(cfmt.writefields+=t);else for(n=0;n<r[0].length;n++)t=r[0][n],cfmt.writefields.indexOf(t)>=0&&(cfmt.writefields=cfmt.writefields.replace(t,""))}function set_v_param(e,t){e=[e+"=",t],parse.state<3?memo_kv_parm(curvoice?curvoice.id:"*",e):curvoice?set_kv_parm(e):memo_kv_parm("*",e)}function set_page(){img.chg&&(img.chg=!1,img.lm=cfmt.leftmargin-cfmt.printmargin,img.lm<0&&(img.lm=0),img.rm=cfmt.rightmargin-cfmt.printmargin,img.rm<0&&(img.rm=0),img.width=cfmt.pagewidth-2*cfmt.printmargin,img.width-img.lm-img.rm<100&&(error(0,void 0,"Bad staff width"),img.width=img.lm+img.rm+150),set_posx())}function st_font(e){var t=e.name,n="";return e.weight&&(n+=e.weight+" "),e.style&&(n+=e.style+" "),t.indexOf('"')<0&&t.indexOf(" ")>0&&(t='"'+t+'"'),n+e.size.toFixed(1)+"px "+t}function style_font(e){return"font:"+st_font(e)}function font_class(e){var t="f"+e.fid+cfmt.fullsvg;return e.class&&(t+=" "+e.class),e.box&&(t+=" box"),t}function use_font(e){e.used||(e.used=!0,null==e.fid&&(e.fid=font_tb.length,font_tb.push(e),e.swfac||set_font_fac(e),e.pad||(e.pad=0)),add_fstyle(".f"+e.fid+(cfmt.fullsvg||"")+"{"+style_font(e)+"}"),e.src&&add_fstyle("@font-face{\n font-family:"+e.name+";\n src:"+e.src+"}"),e==cfmt.musicfont&&add_fstyle(".f"+e.fid+(cfmt.fullsvg||"")+" text,tspan{white-space:pre}"))}function get_font(e){var t,n,r,s;if(!(t=cfmt[e+="font"]))return syntax(1,"Unknown font $1",e),gene.curfont;if(!t.name||!t.size){if(n=Object.create(gene.deffont),t.name&&(n.name=t.name),t.normal?(n.weight&&(n.weight=null),n.style&&(n.style=null)):(t.weight&&(n.weight=t.weight),t.style&&(n.style=t.style)),t.src&&(n.src=t.src),t.size&&(n.size=t.size),s=st_font(n),t.class&&(n.class=t.class,s+=" "+t.class),null!=(r=font_st[s]))return font_tb[r];font_st[s]=font_tb.length,n.fid=n.used=void 0,t=n}return use_font(t),t}Abc.prototype.set_format=function(e,t){var n,r,s,o;if(/.+font(-[\d])?$/.test(e))"soundfont"==e?cfmt.soundfont=t:param_set_font(e,t);else{switch(sfmt[e]&&parse.ufmt&&(cfmt=Object.create(cfmt)),e){case"aligncomposer":case"barsperstaff":case"infoline":case"measurenb":case"rbmax":case"rbmin":case"measrepnb":case"shiftunison":if(s=parseInt(t),isNaN(s)){syntax(1,"Bad integer value");break}cfmt[e]=s;break;case"abc-version":case"bgcolor":case"fgcolor":case"titleformat":cfmt[e]=t;break;case"beamslope":case"breaklimit":case"lineskipfac":case"maxshrink":case"pagescale":case"parskipfac":case"scale":case"slurheight":case"stemheight":case"tieheight":if(n=+t,isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}switch(e){case"scale":n/=.75;case"pagescale":e="scale",img.chg=!0}cfmt[e]=n;break;case"annotationbox":case"gchordbox":case"measurebox":case"partsbox":param_set_font(e.replace("box","font"),"* * "+(get_bool(t)?"box":"nobox"));break;case"altchord":case"bstemdown":case"breakoneoln":case"cancelkey":case"checkbars":case"contbarnb":case"custos":case"decoerr":case"flatbeams":case"graceslurs":case"graceword":case"hyphencont":case"keywarn":case"linewarn":case"quiet":case"singleline":case"squarebreve":case"splittune":case"straightflags":case"stretchstaff":case"timewarn":case"titlecaps":case"titleleft":cfmt[e]=get_bool(t);break;case"dblrepbar":t=":: "+t;case"bardef":2!=(s=t.split(/\s+/)).length?syntax(1,errs.bad_val,"%%bardef"):(parse.ufmt&&(cfmt.bardef=Object.create(cfmt.bardef)),cfmt.bardef[s[0]]=s[1]);break;case"chordalias":(s=t.split(/\s+/)).length?abc2svg.ch_alias[s[0]]=s[1]||"":syntax(1,errs.bad_val,"%%chordalias");break;case"composerspace":case"indent":case"infospace":case"maxstaffsep":case"maxsysstaffsep":case"musicspace":case"partsspace":case"staffsep":case"subtitlespace":case"sysstaffsep":case"textspace":case"titlespace":case"topspace":case"vocalspace":case"wordsspace":n=get_unit(t),isNaN(n)?syntax(1,errs.bad_val,"%%"+e):cfmt[e]=n;break;case"page-format":user.page_format=get_bool(t);break;case"print-leftmargin":syntax(0,"$1 is deprecated - use %%printmargin instead","%%"+e),e="printmargin";case"printmargin":case"leftmargin":case"pagewidth":case"rightmargin":if(n=get_unit(t),isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=n,img.chg=!0;break;case"concert-score":"play"!=cfmt.sound&&(cfmt.sound="concert");break;case"writefields":set_writefields(t);break;case"dynamic":case"gchord":case"gstemdir":case"ornament":case"stemdir":case"vocal":case"volume":set_pos(e,t);break;case"font":get_font_scale(t);break;case"fullsvg":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%fullsvg");break}cfmt[e]=t;break;case"gracespace":for(s=t.split(/\s+/),o=0;o<3;o++)if(isNaN(+s[o])){syntax(1,errs.bad_val,"%%gracespace");break}for(parse.ufmt&&(cfmt[e]=new Float32Array(3)),o=0;o<3;o++)cfmt[e][o]=+s[o];break;case"tuplets":(n=(s=t.split(/\s+/))[3])&&(n=posval[n]),n&&(s[3]=n),curvoice?curvoice.tup=s:cfmt[e]=s;break;case"infoname":set_infoname(t);break;case"notespacingfactor":if((s=t.match(/([.\d]+)[,\s]*(\d+)?/))&&(n=+s[1],isNaN(n)||n<1||n>2?n=0:s[2]?(r=+s[2],isNaN(n)&&(n=0)):r=cfmt.spatab[5]),!n){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=t,cfmt.spatab=new Float32Array(10),o=5;do{cfmt.spatab[o]=r,r/=n}while(--o>=0);for(o=5,r=cfmt.spatab[o];++o<cfmt.spatab.length;)r*=n,cfmt.spatab[o]=r;break;case"play":cfmt.sound="play";break;case"pos":if(!(e=t.match(/(\w*)\s+(.*)/))||!e[2]){syntax(1,"Error in %%pos");break}if("tup"==e[1].slice(0,3)&&curvoice){switch(curvoice.tup?curvoice.tup=Object.create(curvoice.tup):curvoice.tup=cfmt.tuplets,s=posval[e[2]]){case C.SL_ABOVE:curvoice.tup[3]=1;break;case C.SL_BELOW:curvoice.tup[3]=2;break;case C.SL_HIDDEN:curvoice.tup[2]=1}break}set_pos(e[1],e[2]);break;case"sounding-score":"play"!=cfmt.sound&&(cfmt.sound="sounding");break;case"staffwidth":if(s=get_unit(t),isNaN(s)){syntax(1,errs.bad_val,"%%"+e);break}if(s<100){syntax(1,"%%staffwidth too small");break}if((s=cfmt.pagewidth-s-cfmt.leftmargin)<2){syntax(1,"%%staffwidth too big");break}cfmt.rightmargin=s,img.chg=!0;break;case"textoption":cfmt[e]=get_textopt(t);break;case"dynalign":case"stretchlast":case"titletrim":if(s=+t,isNaN(s)&&(s=get_bool(t)?0:1),"s"==e[0]&&(s<0||s>1)){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=s;break;case"combinevoices":syntax(1,"%%combinevoices is deprecated - use %%voicecombine instead");break;case"voicemap":set_v_param("map",t);break;case"voicescale":set_v_param("scale",t);break;case"rbdbstop":(s=get_bool(t))&&cfmt["abc-version"]>="2.2"?cfmt["abc-version"]="1":!s&&cfmt["abc-version"]<"2.2"&&(cfmt["abc-version"]="2.2");break;default:parse.state||(cfmt[e]=t)}sfmt[e]&&parse.ufmt&&(parse.ufmt=!1)}},Abc.prototype.style_font=style_font;var sav={},mac={},maci={},abc_utf={"=D":"Đ","=H":"Ħ","=T":"Ŧ","=d":"đ","=h":"ħ","=t":"ŧ","/O":"Ø","/o":"ø","/L":"Ł","/l":"ł",vL:"Ľ",vl:"ľ",vd:"ď",".i":"ı",AA:"Å",aa:"å",AE:"Æ",ae:"æ",DH:"Ð",dh:"ð",OE:"Œ",oe:"œ",ss:"ß",TH:"Þ",th:"þ"},oct_acc={1:"♯",2:"♭",3:"♮",4:"&#x1d12a;",5:"&#x1d12b;"};function cnv_escape(e,t){for(var n,r,s,o="",i=0;!((s=e.indexOf("\\",i))<0);){if(o+=e.slice(i,s),!(n=e[++s]))return o+"\\";switch(n){case"0":case"2":if("0"!=e[s+1])break;if(r=oct_acc[e[s+2]]){o+=r,i=s+3;continue}break;case"u":if(i=Number("0x"+e.slice(s+1,s+5)),isNaN(i)||i<32){o+=e[++s]+"̆",i=s+1;continue}if("\\"==(n=String.fromCharCode(i))){s+=4;break}o+=n,i=s+5;continue;case"t":o+="\t",i=s+1;continue;case"n":o+="\n",i=s+1;continue;default:if(r=abc_utf[e.slice(s,s+2)]){o+=r,i=s+2;continue}if(!(r=e[s+1]))break;if(!/[A-Za-z]/.test(r))break;switch(n){case"`":o+=r+"̀",i=s+2;continue;case"'":o+=r+"́",i=s+2;continue;case"^":o+=r+"̂",i=s+2;continue;case"~":o+=r+"̃",i=s+2;continue;case"=":o+=r+"̄",i=s+2;continue;case"_":o+=r+"̅",i=s+2;continue;case".":o+=r+"̇",i=s+2;continue;case'"':o+=r+"̈",i=s+2;continue;case"o":o+=r+"̊",i=s+2;continue;case"H":o+=r+"̋",i=s+2;continue;case"v":o+=r+"̌",i=s+2;continue;case"c":o+=r+"̧",i=s+2;continue;case";":o+=r+"̨",i=s+2;continue}}"w"==t&&(o+="\\"),o+=n,i=s+1}return o+e.slice(i)}var include=0,gene,staff_tb,nstaff,tsnext,realwidth,insert_meter,spf_last,smallest_duration;function do_include(e){var t,n;user.read_file?include>2?syntax(1,"Too many include levels"):(t=user.read_file(e))?(include++,n=clone(parse),tosvg(e,t),n.state=parse.state,parse=n,include--):syntax(1,"Cannot read file '$1'",e):syntax(1,"No read_file support")}function tosvg(e,t,n,r){var s,o,i,a,c,l,u,f,d,p,h,m,y="\n";function g(){var e,s,i=t.indexOf("K:",n);return!(i<0)&&(i=t.indexOf("\n",i),!!parse.select.test(t.slice(parse.bol,i))||((e=/\n\w*\n/).lastIndex=i,s=e.exec(t),o=s?e.lastIndex:r,!1))}function A(e,t){if(!e)return e;var n=e.indexOf("%");return 0==n?"":(n>0&&(e=e.replace(/([^\\])%.*/,"$1").replace(/\\%/g,"%")),e=e.replace(/\s+$/,""),t&&e.indexOf("\\")>=0?cnv_escape(e,t):e)}function _(){generate(),cfmt=sav.cfmt,info=sav.info,char_tb=sav.char_tb,glovar=sav.glovar,maps=sav.maps,mac=sav.mac,maci=sav.maci,parse.tune_v_opts=null,parse.scores=null,parse.ufmt=!1,delete parse.ctrl,init_tune(),img.chg=!0,set_page()}function v(e,n){var r,s;if("end"!=e){for(n?(parse.tune_v_opts||(parse.tune_v_opts={}),r=parse.tune_v_opts):(parse.voice_opts||(parse.voice_opts={}),r=parse.voice_opts),r[e]=[];s=++o,"%"==t[s];)if(o=t.indexOf("\n",o),t[s+1]==l){switch(s+=2,d=o<0?t.slice(s):t.slice(s,o),(p=d.match(/\S+/))[0]){default:r[e].push(A(d,!0));continue;case"score":case"staves":case"tune":case"voice":s-=2}break}o=parse.eol=s-1}}function b(){var e,r,s,o,i=t.indexOf("K:",n);for(i in i=t.indexOf("\n",i),o=t.slice(parse.bol,i),parse.tune_opts)if(parse.tune_opts.hasOwnProperty(i)&&new RegExp(i).test(o)){for(e=parse.tune_opts[i],r=0;r<e.t_opts.length;r++)switch((s=e.t_opts[r]).match(/\S+/)[0]){case"score":case"staves":parse.scores||(parse.scores=[]),parse.scores.push(s);break;default:self.do_pscom(s)}if(e=e.v_opts)for(r in e)e.hasOwnProperty(r)&&(parse.tune_v_opts||(parse.tune_v_opts={}),parse.tune_v_opts[r]?parse.tune_v_opts[r]=parse.tune_v_opts[r].concat(e[r]):parse.tune_v_opts[r]=e[r])}}for(abc2svg.modules&&(abc2svg.modules.hooks.length||abc2svg.modules.g_hooks.length)&&set_hooks(),parse.file=t,parse.fname=e,null==n&&(n=0),r||(r=t.length),"%abc-"==t.slice(n,n+5)&&(cfmt["abc-version"]=/[1-9.]+/.exec(t.slice(n+5,n+10)));n<r;n=parse.eol+1){for(((o=t.indexOf("\n",n))<0||o>r)&&(o=r),parse.eol=o;;){switch(o--,t[o]){case" ":case"\t":continue}break}if(++o!=n){if(parse.istart=parse.bol=n,parse.iend=o,parse.line.index=0,c=t[n],l=t[n+1],"%"==c){if(parse.prefix.indexOf(l)<0)continue;"a"==t[n+2]&&"b"==t[n+3]&&"c"==t[n+4]&&" "==t[n+5]?(c=t[n+=6],l=t[n+1]):m=!0}else"I"==c&&":"==l&&(m=!0);if(m){if(m=!1,n+=2,d=t.slice(n,o),!(p=d.match(/([^\s]+)\s*(.*)/))||"%"==p[1][0])continue;switch(p[1]){case"abcm2ps":case"ss-pref":parse.prefix=p[2];continue;case"abc-include":do_include(A(p[2]));continue}if("begin"==p[1].slice(0,5)){if(h=p[1].substr(5),i="\n"+c+l+"end"+h,(s=t.indexOf(i,o))<0){syntax(1,"No $1 after %%$2",i.slice(1),p[1]),parse.eol=r;continue}self.do_begin_end(h,A(p[2]),t.slice(o+1,s).replace(/\n%[^%].*$/gm,"").replace(/^%%/gm,"")),parse.eol=t.indexOf("\n",s+6),parse.eol<0&&(parse.eol=r);continue}switch(p[1]){case"select":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%select");continue}if('"'==(a=A(d.slice(7)))[0]&&(a=a.slice(1,-1)),!a){delete parse.select;continue}a=(a=a.replace(/\(/g,"\\(")).replace(/\)/g,"\\)"),parse.select=new RegExp(a,"m");continue;case"tune":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%tune");continue}if(!(a=A(p[2]))){parse.tune_opts={};continue}if("end"==a)continue;for(parse.tune_opts||(parse.tune_opts={}),parse.tune_opts[a]=f={t_opts:[]};n=++o,"%"==t[n];)if(o=t.indexOf("\n",o),t[n+1]==l){switch(n+=2,d=o<0?t.slice(n):t.slice(n,o),(p=d.match(/([^\s]+)\s*(.*)/))[1]){case"tune":break;case"voice":v(A(p[2],!0),!0);continue;default:f.t_opts.push(A(d,!0));continue}break}parse.tune_v_opts&&(f.v_opts=parse.tune_v_opts,parse.tune_v_opts=null),parse.eol=n-1;continue;case"voice":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%voice");continue}if(!(a=A(p[2]))){parse.voice_opts=null;continue}v(a);continue}self.do_pscom(A(d,!0))}else if(":"==l&&/[A-Za-z+]/.test(c)){for(n+=2;;){switch(t[n]){case" ":case"\t":n++;continue}break}if("+"==c){if(!u){syntax(1,"+: without previous info field");continue}y=" ",c=u}switch(d=A(t.slice(n,o),c),c){case"X":if(0!=parse.state){syntax(1,errs.ignored,c);continue}if(parse.select&&!g()){(o=t.indexOf("\nX:",parse.eol))<0&&(o=r),parse.eol=o;continue}sav.cfmt=clone(cfmt),sav.info=clone(info,2),sav.char_tb=clone(char_tb),sav.glovar=clone(glovar),sav.maps=clone(maps,1),sav.mac=clone(mac),sav.maci=clone(maci),info.X=d,parse.state=1,user.page_format&&blkdiv<1&&(blkdiv=1),parse.tune_opts&&b();continue;case"T":switch(parse.state){case 0:continue;case 1:case 2:null==info.T?info.T=d:info.T+="\n"+d;continue}new_block("title").text=d;continue;case"K":switch(parse.state){case 0:continue;case 1:info.K=d}do_info(c,d);continue;case"W":if(0==parse.state||cfmt.writefields.indexOf(c)<0)break;null==info.W?info.W=d:info.W+=y+d;break;case"m":if(parse.state>=2){syntax(1,errs.ignored,c);continue}if(!(p=d.match(/(.*?)[= ]+(.*)/))||!p[2]){syntax(1,errs.bad_val,"m:");continue}mac[p[1]]=p[2],maci[p[1][0]]=!0;break;case"s":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;get_sym(d," "==y);break;case"w":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;get_lyrics(d," "==y);break;case"|":if(parse.state<2)continue;parse.line.buffer=d,parse_music_line();continue;default:if("ABCDFGHNOSZ".indexOf(c)>=0){if(parse.state>=2){syntax(1,errs.ignored,c);continue}info[c]?info[c]+=y+d:info[c]=d;break}do_info(c,d);continue}y="\n",u=c}else{if(u=void 0,parse.state<2)continue;parse.line.buffer=A(t.slice(n,o)),parse.line.buffer&&parse_music_line()}}else 1==parse.state?(parse.istart=n,syntax(1,"Empty line in tune header - ignored")):parse.state>=2&&(_(),parse.state=0,parse.select&&((o=t.indexOf("\nX:",parse.eol))<0&&(o=r),parse.eol=o))}include||(parse.state>=2&&_(),parse.state=0)}Abc.prototype.tosvg=tosvg;var dx_tb=new Float32Array([10,10,11,13,15]),hw_tb=new Float32Array([4.7,5,6,7.2,7.5]),w_note=new Float32Array([3.5,3.7,5,6,7]);function identify_note(e,t){var n,r,s=0,o=t;for(o%12!=0&&error(1,e,"Invalid note duration $1",o),(o/=12)||error(1,e,"Note too short"),r=5;o&&!(1&o);o>>=1,r--);for((o>>=1)+1&o&&(e.type==C.REST&&t==e.p_v.wmeasure||error(0,e,"Non standard note duration $1",t));o>>s>0;)s++;if((r-=s)>=0)n=C.FULL;else switch(r){default:error(1,e,"Note too long"),r=-4;case-4:n=C.SQUARE;break;case-3:n=e.fmt.squarebreve?C.SQUARE:C.OVALBARS;break;case-2:n=C.OVAL;break;case-1:n=C.EMPTY}return[n,s,r]}function set_head_shift(e){var t,n,r,s,o,i,a=dx_tb[e.head],c=e.stem,l=e.nhd;if(l){i=.74*a,e.grace&&(i*=.6),c>=0?(n=1,r=l+1,o=e.notes[0].pit):(i=-i,n=l-1,r=-1,o=e.notes[l].pit);var u=!1,f=0;for(t=n;t!=r;t+=c){if(s=e.notes[t].pit-o,o=e.notes[t].pit,!s){if(u){var d=e.notes[t].shhd=e.notes[t-c].shhd+i;f<d&&(f=d);continue}if(t+c!=r&&o+c==e.notes[t+c].pit){e.notes[t].shhd=-i,f<-i&&(f=-i);continue}}s<0&&(s=-s),s>3||s>=2&&e.head!=C.SQUARE?u=!1:(u=!u)&&(e.notes[t].shhd=i,f<i&&(f=i))}e.xmx=f}}function acc_shift(e,t){var n,r,s,o,i,a,c,l,u,f=e.length;for(n=f-1;--n>=0;)if((o=e[n].shhd)&&!(o>0))for(o=t-o,c=e[n].pit,r=f;--r>=0;)if(e[r].acc){if((l=e[r].pit)<c-3)break;l>c+3||e[r].shac<o&&(e[r].shac=o)}for(r=f;--r>=0;)if(e[r].acc){l=e[r].pit,(i=e[r].shac)||(i=(i=e[r].shhd)<0?t-i:t);break}if(!(r<0)){for(s=0;s<r;s++)if(e[s].acc){c=e[s].pit,(a=e[s].shac)||(a=(a=e[s].shhd)<0?t-a:t);break}if(r!=s){for(l>c+4?(i>a&&(a=i),e[r].shac=e[s].shac=a):(e[r].shac=i,i+=7,e[s].shac=a=i),a+=7,n=r;--n>s;)if(u=e[n].acc){for((o=e[n].shac)<a&&(o=a),c=e[n].pit,r=f;--r>n;)e[r].acc&&((l=e[r].pit)>=c+4&&(l>c+4||u<0||e[r].acc<0)||o>e[r].shac-6&&(i=e[r].shac+7)>o&&(o=i));e[n].shac=o}}else e[r].shac=i}}function set_acc_shft(){var e,t,n,r,s,o,i,a;for(e=tsfirst;e;)if(e.type!=C.NOTE||e.invis)e=e.ts_next;else{for(s=e.st,o=e.time,r=!1,t=e;t&&(t.time==o&&t.type==C.NOTE&&t.st==s);t=t.ts_next)if(!r)for(n=0;n<=t.nhd;n++)if(t.notes[n].acc){r=!0;break}if(r){for(i=dx_tb[e.head],a=[];e!=t;e=e.ts_next)Array.prototype.push.apply(a,e.notes);a.sort(abc2svg.pitcmp),acc_shift(a,i)}else e=t}}function lkvsym(e,t){e.next=t,e.prev=t.prev,e.prev?e.prev.next=e:e.p_v.sym=e,t.prev=e}function lktsym(e,t){var n;e.ts_next=t,t?(e.ts_prev=t.ts_prev,e.ts_prev&&(e.ts_prev.ts_next=e),t.ts_prev=e):(error(2,e,"Bad linkage"),e.ts_prev=null),e.seqst=!e.ts_prev||e.time!=e.ts_prev.time||w_tb[e.ts_prev.type]!=w_tb[e.type]&&w_tb[e.ts_prev.type],t&&(t.seqst=t.time!=e.time||w_tb[e.type]!=w_tb[t.type]&&w_tb[e.type],t.seqst&&(n=t.wl,self.set_width(t),t.a_ly&&ly_set(t),t.shrink?t.shrink+=t.wl-n:(t.shrink=t.wl,t.prev&&(t.shrink+=t.prev.wr)),t.space=0))}function unlksym(e){e.next&&(e.next.prev=e.prev),e.prev?e.prev.next=e.next:e.p_v.sym=e.next,e.ts_next&&(e.seqst?e.ts_next.seqst?(e.ts_next.shrink+=e.shrink,e.ts_next.space+=e.space):(e.ts_next.seqst=!0,e.ts_next.shrink=e.shrink,e.ts_next.space=e.space):e.ts_next.seqst&&e.ts_prev&&e.ts_prev.seqst&&!w_tb[e.ts_prev.type]&&(e.ts_next.seqst=!1,e.shrink=e.ts_next.shrink,e.space=e.ts_next.space),e.ts_next.ts_prev=e.ts_prev),e.ts_prev&&(e.ts_prev.ts_next=e.ts_next),tsfirst==e&&(tsfirst=e.ts_next),tsnext==e&&(tsnext=e.ts_next)}function insert_clef(e,t,n){var r,s=e.p_v,o=e.st;for(e.type==C.BAR&&e.prev&&e.prev.type==C.BAR&&":"!=e.prev.bar_type[0]&&(e=e.prev),s.last_sym=e.prev,s.last_sym||(s.sym=null),s.time=e.time,(r=sym_add(s,C.CLEF)).next=e,e.prev=r,r.clef_type=t,r.clef_line=n,r.st=o,r.clef_small=!0,delete r.second,r.notes=[],r.notes[0]={pit:e.notes[0].pit},r.nhd=0;!e.seqst;)e=e.ts_prev;return lktsym(r,e),e.soln&&(r.soln=!0,delete e.soln),r}function set_float(){var e,t,n,r,s,o,i,a;for(r=0;r<voice_tb.length;r++)for(n=!1,t=(e=voice_tb[r]).st,s=e.sym;s;s=s.next){if(!s.floating){for(;s&&!s.floating;)s=s.next;if(!s)break;n=!1}if(s.dur)if(s.notes[0].pit>=19)n=!1;else if(s.notes[s.nhd].pit<=12)n=!0,s.st++;else{for(i=127,o=s.ts_prev;o&&(o.st==t&&o.v!=s.v);o=o.ts_prev)o.type==C.NOTE&&o.notes[0].pit<i&&(i=o.notes[0].pit);if(127!=i)if(s.notes[s.nhd].pit>i-3)n=!1;else{for(a=-127,o=s.ts_next;o&&(o.st==t+1&&o.v!=s.v);o=o.ts_next)o.type==C.NOTE&&o.notes[o.nhd].pit>a&&(a=o.notes[o.nhd].pit);if(-127!=a)if(s.notes[0].pit<a+3)n=!0,s.st++;else{if(i-=s.notes[s.nhd].pit,a=s.notes[0].pit-a,n){if(i<a-3){n=!1;continue}}else{if(i<a+3)continue;n=!0}s.st++}else n&&s.st++}else n&&s.st++}else n&&s.st++}}function set_graceoffs(e){var t,n,r,s,o=e.fmt.gracespace[0],i=e.fmt.gracespace[1],a=e.fmt.gracespace[2],c=e.extra;for(e.prev&&e.prev.type==C.BAR&&(o-=3),s=o,c.beam_st=!0;;c=c.next){for(set_head_shift(c),acc_shift(c.notes,6.5),r=0,n=c.nhd;n>=0;n--)c.notes[n].shac-2>r&&(r=c.notes[n].shac-2);if(s+=r,c.x=s,c.nflags<=0&&(c.beam_st=c.beam_end=!0),!(t=c.next)){c.beam_end=!0;break}t.nflags<=0&&(c.beam_end=!0),c.beam_end&&(t.beam_st=!0,s+=i/4),c.nflags<=0&&(s+=i/4),c.y>t.y+8&&(s-=1.5),s+=i}return(t=e.next)&&t.type==C.NOTE&&(c.y>=3*(t.notes[t.nhd].pit-18)?a-=1:c.beam_st&&c.y<3*(t.notes[t.nhd].pit-18)-4&&(a+=2)),s+=a}function set_w_chs(e){var t,n,r,s,o,i=0,a=0;for(set_font("vocal");e;e=e.ts_next)if(e.shrink&&(i+=e.shrink,a++),e.a_ly&&ly_set(e),e.a_gch)for(t=0;t<e.a_gch.length;t++)if(!("g"!=(n=e.a_gch[t]).type||n.y<0)){if(r&&r>i+n.x)for(e.prev&&e.prev.seqst&&e.prev.type==C.BAR&&a--,o=(r-i-n.x)/a;(s=s.ts_next).shrink&&(s.shrink+=o),s!=e&&s.type!=C.BAR;);s=e,r=n.text.wh[0],a=0,i=0;break}}function gchord_width(e,t,n){var r,s,o,i=0;for(o=0;o<e.a_gch.length;o++)switch((r=e.a_gch[o]).type){case"<":(s=r.text.wh[0]+t)>n&&(n=s);break;case">":(s=r.text.wh[0]+e.wr)>i&&(i=s)}return e.wr<i&&(e.wr=i),n}function time2space(e,t){var n,r,s;return smallest_duration>=C.BLEN/2?smallest_duration>=C.BLEN?t/=4:t/=2:!e.next&&t>=C.BLEN&&(t/=2),n=t>=C.BLEN/4?t<C.BLEN/2?5:t<C.BLEN?6:t<2*C.BLEN?7:t<4*C.BLEN?8:9:t>=C.BLEN/8?4:t>=C.BLEN/16?3:t>=C.BLEN/32?2:t>=C.BLEN/64?1:0,r=t-(C.BLEN/16/8<<n),s=cfmt.spatab[n],r&&(r<0?s=cfmt.spatab[0]*t/(C.BLEN/16/8):(n>=9&&(n=8),s+=(cfmt.spatab[n+1]-cfmt.spatab[n])*r/(C.BLEN/16/8<<n))),s}function set_space(e,t){var n,r,s,o;if(!(r=e.time-t))return e.type===C.MREST?e.wl:0;if(e.ts_prev.type==C.MREST)return 71;for(n=time2space(e,r);!e.dur;){switch(e.type){case C.BAR:return e.next||(n*=.9),.9*n-3;case C.CLEF:return n-e.wl-e.wr;case C.BLOCK:case C.REMARK:case C.STAVES:case C.TEMPO:if(!(e=e.ts_next))return n;continue}break}if(e.dur&&r<=C.BLEN/4)for(s=e;s;){if(!s.beam_st){n*=.9;break}if(!(s=s.ts_next)||s.seqst)break}if(e.type==C.NOTE&&e.nflags>=-1&&e.stem>0){for(o=!0,s=e.ts_prev;s&&s.time==t;s=s.ts_prev)if(s.type==C.NOTE&&(s.nflags<-1||s.stem>0)){o=!1;break}if(o){for(s=e.ts_next;s&&s.time==e.time;s=s.ts_next)if(s.type==C.NOTE&&(s.nflags<-1||s.stem<0)){o=!1;break}o&&(n*=.9)}}return n}function set_sp_tup(e,t){for(var n=e.time,r=t.time-n,s=time2space(e,r),o=e,i=0;(o=o.ts_next).seqst&&(i+=o.space,o.bar_type&&(i+=10)),o!=t;);for(s=(s+i)/2/r;(e=e.ts_next).seqst&&(e.space=s*(e.time-n),n=e.time),e!=t;);}function _bar(e){return{type:C.BAR,bar_type:"|",fname:e.fname,istart:e.istart,iend:e.iend,v:e.v,p_v:e.p_v,st:e.st,dur:0,time:e.time+(e.dur||0),nhd:0,notes:[{pit:e.notes?e.notes[0].pit:22}],seqst:!0,invis:!0,prev:e,fmt:e.fmt}}function add_end_bar(e){var t=_bar(e),n=e.ts_next;return t.wl=0,t.wr=0,t.ts_prev=e,t.next=e.next,t.ts_next=e.ts_next,t.shrink=e.wr+3,e.next&&(e.next.prev=t),e.ts_next.ts_prev=t,e.next=e.ts_next=t,t.space=.9*n.space-3,t}function set_allsymwidth(){for(var e,t,n,r,s,o=tsfirst,i=o,a=0,c=[],l=[],u=a,f=o.time;;){s=0;do{!o.a_gch&&!o.a_ly||n||(n=o),self.set_width(o),null==c[t=o.st]&&(c[t]=0),null==l[t]&&(l[t]=0),(e=c[t]+l[t]+o.wl)>u&&(u=e),o.dur&&o.dur!=o.notes[0].dur&&(s=1),o=o.ts_next}while(o&&!o.seqst);if(i.shrink=u-a,i.space=i.ts_prev?set_space(i,f):0,0==i.space&&i.ts_prev&&i.ts_prev.type==C.SPACE&&i.ts_prev.seqst&&(i.space=i.ts_prev.space/=2),s?r||(r=i):r&&r.v==i.v&&(set_sp_tup(r,i),r=null),i.shrink||(i.space||i.type!=C.CLEF?i.dur&&(i.shrink=10):(delete i.seqst,i.time=f)),f=i.time,!o)break;for(t=0;t<l.length;t++)l[t]=0;a=u;do{c[t=i.st]=a,i.wr>l[t]&&(l[t]=i.wr),i=i.ts_next}while(!i.seqst)}r&&set_sp_tup(r,i),n&&set_w_chs(n)}function to_rest(e){var t=clone(e);return t.prev.next=e.ts_prev=e.prev=t.ts_prev.ts_next=t,t.next=t.ts_next=e,e.seqst=!1,e.invis=e.play=!0,t.type=C.REST,delete t.in_tuplet,delete t.tp,delete t.sl1,delete t.a_dd,delete t.a_gch,delete t.sls,t}function set_repeat(e){var t,n,r,s,o,i=e.repeat_n,a=e.repeat_k,c=e.st,l=e.v;if(e.repeat_n=0,i<0){for(r=i=-i,n=e.prev;n;n=n.prev)if(n.dur){if(--r<=0)break}else if(n.type==C.BAR)return void error(1,n,"Bar in repeat sequence");if(!n)return void error(1,e,errs.not_enough_n);for(o=e.time-n.time,r=a*i,t=e;t;t=t.next)if(t.dur){if(--r<=0)break}else if(t.type==C.BAR)return void error(1,t,"Bar in repeat sequence");if(!t||!t.next)return void error(1,e,errs.not_enough_n);for(t=e.prev;t!=n;t=t.prev)if(t.type==C.NOTE){t.beam_end=!0;break}for(s=a;--s>=0;){for(r=i,e.dur&&r--,t=e.ts_next;r>0;)t.st==c&&(t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1),t.v==l&&t.dur&&r--),t=t.ts_next;for((e=to_rest(e)).dur=e.notes[0].dur=o,e.rep_nb=-1,e.beam_st=!0,self.set_width(e),e.head=C.SQUARE,e=t;e&&(e.st!=c||e.v!=l||!e.dur);e=e.ts_next);}}else{for(r=i,t=e.prev.prev;t&&(t.type!=C.BAR&&t.time!=tsfirst.time||!(--r<=0));t=t.prev);if(t){for(o=e.time-t.time,r=1==i?a:i,t=e;t&&!(t.type==C.BAR&&--r<=0);t=t.next);if(t){if(r=a,2==i&&r>1){if(!(t=t.next))return void error(1,e,errs.not_enough_m);t.repeat_n=i,t.repeat_k=--r}if(o/=i,2==i){for(n=e,t=e.ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;for((n=to_rest(n)).dur=n.notes[0].dur=o,n.invis=!0,t.bar_mrep=2,t=(n=t.next).ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;return(n=to_rest(n)).dur=n.notes[0].dur=o,n.invis=!0,void self.set_width(n)}for(n=e,s=a;--s>=0;){for(t=n.ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;if((n=to_rest(n)).dur=n.notes[0].dur=o,n.beam_st=!0,1==a){n.rep_nb=1;break}n.rep_nb=a-s+1,n=t.next}}else error(1,e,errs.not_enough_m)}else error(1,e,errs.not_enough_m)}}function custos_add(e){for(var t,n,r,s=e;s.type!=C.NOTE;)if(!(s=s.next))return;for((t=e.p_v).last_sym=e.prev,t.time=e.time,(n=sym_add(t,C.CUSTOS)).next=e,e.prev=n,n.wl=0,n.wr=4,lktsym(n,e),n.shrink=e.shrink,n.shrink<12&&(n.shrink=12),n.space=s.space,n.head=C.FULL,n.stem=s.stem,n.nhd=s.nhd,n.notes=[],r=0;r<s.notes.length;r++)n.notes[r]={pit:s.notes[r].pit,shhd:0,dur:C.BLEN/4};n.stemless=!0}function set_nl(e){var t,n;function r(e){cfmt.custos&&1==voice_tb.length&&custos_add(e),e.nl=!0,(e=e.ts_prev).type!=C.BAR&&add_end_bar(e)}if(function(e){var t,n,r,s;for(n=e;n;n=n.ts_next){switch(n.type){case C.KEY:if(!e.fmt.keywarn||n.invis)continue;for(t=e.ts_prev;t&&t.type==C.METER;t=t.ts_prev);case C.METER:if(n.type==C.METER){if(!e.fmt.timewarn)continue;t=e.ts_prev}case C.CLEF:if(!n.prev)continue;if(n.type==C.CLEF)for(t=e.ts_prev;t;t=t.ts_prev){switch(t.type){case C.BAR:if(":"==t.bar_type[0])break;case C.KEY:case C.METER:continue}break}for(lktsym(r=clone(n),t.ts_next),t=r;(t=t.ts_next).v!=n.v;);if(lkvsym(r,t),r.seqst){for(self.set_width(r),r.shrink=r.wl,s=r.ts_prev;!s.seqst;)s=s.ts_prev;for(r.shrink+=s.wr,r.space=0,s=r.ts_next;!s.seqst;)s=s.ts_next;s.shrink=r.wr+s.wl}delete r.part;continue}if(w_tb[n.type])break}}(e=function(e){var t,n,r,s,o,i;function a(e){var t=e.bar_type.match(/(:*)([^:]*)(:*)/);t[3]?t[1]?(i=t[2].length/2|0,s=t[1]+"|"+t[2].slice(0,i),o=t[2].slice(i)+"|"+t[3]):(s="||",o="[|"+t[3]):(s=t[1]+t[2],o="[")}for(t=e;t.ts_prev&&t.ts_prev.time==e.time;)(t=t.ts_prev).bar_type&&("["==t.bar_type[0]&&t.text&&t.ts_next==e&&(e=t),n=t);if(!n)return e;for(t=e;;t=t.ts_next){switch(t.type){case C.KEY:case C.METER:case C.CLEF:continue}break}for(;n!=e;){if(n.bar_type&&(":"==n.bar_type.slice(-1)||n.text)&&":"!=n.bar_type){for(a(n),r=clone(n),n.bar_type=s,delete n.a_gch,"|"==s&&delete n.rbstop,r.bar_type=o,lkvsym(r,n.next);!(t.type!=C.BAR||t.v>r.v);)t=t.ts_next;lktsym(r,t),n.seqst&&(r.seqst=1),t==e&&(e=r),n.text&&(r.invis=!0,delete n.text,delete n.rbstart),delete n.part,delete r.a_dd}n=n.ts_next}return e}(e)),e.ts_prev.type!=C.STAVES)return r(e),e;for(e=e.ts_prev;e&&(!e.seqst||e.type==C.CLEF);e=e.ts_prev);for(t=0,n=e.type;;e=e.ts_next){if(!e)return e;if(e.type!=n){if(n=e.type,t<0)break;switch(e.type){case C.STAVES:if(!e.ts_prev)return;if(e.ts_prev.type==C.BAR)break;for(;e.ts_next&&(!w_tb[e.ts_next.type]||e.ts_next.type==C.CLEF);)e=e.ts_next;if(!e.ts_next||e.ts_next.type!=C.BAR)continue;e=e.ts_next;case C.BAR:if(t)break;t=1;continue;case C.STBRK:e.stbrk_forced?t=-1:unlksym(e);continue;case C.CLEF:if(t)break;continue;default:if(!t||e.prev&&e.prev.type==C.GRACE)continue}break}}return r(e),e}function get_ck_width(){var e=voice_tb[0];return self.set_width(e.clef),self.set_width(e.ckey),self.set_width(e.meter),[e.clef.wl+e.clef.wr+e.ckey.wl+e.ckey.wr,e.meter.wl+e.meter.wr]}function get_width(e,t){for(var n,r,s=0,o=0,i=1-e.fmt.maxshrink;e!=t;)e.seqst&&(o+=n=e.shrink,(r=e.space)<n?s+=n:s+=n*e.fmt.maxshrink+r*i,e.x=s),e=e.ts_next;return t&&(o+=t.wr),[s,o]}function set_lines(e,t,n,r){var s,o,i,a,c,l,u,f,d,p,h,m=t?t.ts_prev:null,y=get_width(e,t);if(e.fmt.keywarn&&t&&t.type==C.KEY&&!m.dur&&(y[0]+=t.wr,y[1]+=t.wr),y[0]+r<n)return t&&(t=set_nl(t)),t||m;for(p=y[0]+r;;){if((h=Math.ceil(p/n))<=1)return t&&(t=set_nl(t)),t||m;for(o=s=e,d=(u=e.x-e.shrink-r)+n,f=u+p/h,u+=p/h*e.fmt.breaklimit,e=e.ts_next;e!=t&&!(e.x&&(e.type==C.BAR&&(o=e),e.x>=u));e=e.ts_next);if(a=e,e==t)return e&&(e=set_nl(e)),e;for(i=null;e!=t;e=e.ts_next)if(l=e.x){if(l>d)break;if(e.type==C.BAR){if(!(l<f)){(!i||l-f<f-i.x)&&(i=e);break}i=e}}if(!i){e=a;var g=0,A=o.time;for(d-=8,c=null;e!=t;e=e.ts_next)if(e.dur&&(e.beam_end?g&=~(1<<e.v):g|=1<<e.v),e.seqst){if((l=e.x)+e.wr>=d)break;g||e.in_tuplet||(c&&(f-c.x>l-f||e.dur&&(e.time+e.dur-A)%(C.BLEN/4)==0)&&(i=c),c=e)}}if(!i)for(i=e=a;e!=t;e=e.ts_next)if(l=e.x){if(l+e.wr>=d)break;if(i&&l>=f){f-i.x>l-f&&(i=e);break}i=e}for(e=i;e.ts_next&&!(e=e.ts_next).seqst;);if(e.nl)for(error(0,e,"Line split problem - adjust maxshrink and/or breaklimit"),h=2,e=e.ts_next;e!=t&&!(e.x&&--h<=0);e=e.ts_next);if(!(e=set_nl(e))||t&&e.time>=t.time)break;p-=e.x-s.x,r=0}return e}function cut_tune(e,t){var n,r,s={leftmargin:cfmt.leftmargin,rightmargin:cfmt.rightmargin,pagewidth:cfmt.pagewidth,scale:cfmt.scale},o=t[0]-t[1],i=get_ck_width(),a=tsfirst;if(e-=t[1],cfmt.indent&&cfmt.indent>t[0]&&(o+=cfmt.indent),e-=i[0],o+=i[1],cfmt.custos&&1==voice_tb.length&&(e-=12),r=a.fmt.barsperstaff)for(n=a;n;n=n.ts_next)if(n.type==C.BAR&&n.bar_num&&!(--r>0)){for(;n.ts_next&&n.ts_next.type==C.BAR;)n=n.ts_next;n.ts_next&&(n.ts_next.soln=!0),r=a.fmt.barsperstaff}for(n=a;a;a=a.ts_next){if(a.type==C.BLOCK)switch(a.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":self.set_format(a.subtype,a.param)}if(a.ts_next){if(!a.soln)continue;if(a.soln=!1,a.time==n.time)continue;for(;!a.seqst;)a=a.ts_prev}else a=null;if(!(n=set_lines(n,a,e,o)))break;a=n,o=0,set_page(),e=get_lwidth()-t[1]-i[0]}cfmt.leftmargin=s.leftmargin,cfmt.rightmargin=s.rightmargin,cfmt.pagewidth=s.pagewidth,cfmt.scale=s.scale,img.chg=1,set_page()}function set_yval(e){switch(e.type){case C.CLEF:if(e.second||e.invis){e.ymx=e.ymn=12;break}switch(e.y=6*(e.clef_line-1),e.clef_type){default:e.ymx=e.y+28,e.ymn=e.y-14;break;case"c":e.ymx=e.y+13,e.ymn=e.y-11;break;case"b":e.ymx=e.y+7,e.ymn=e.y-12}e.clef_small&&(e.ymx-=2,e.ymn+=2),e.ymx<26&&(e.ymx=26),e.ymn>-1&&(e.ymn=-1),e.clef_octave&&(e.clef_octave>0?e.ymx+=12:e.ymn-=12);break;case C.KEY:e.k_sf>2?e.ymx=34:e.k_sf>0?e.ymx=30:e.ymx=26,e.ymn=-2;break;default:e.ymx=24,e.ymn=0}}function set_ottava(){var e,t,n,r,s,o,i=nstaff+1,a=new Int16Array(new Array(2*i)),c=new Int8Array(new Array(i));function l(e,t,n){a_dcn.push((n?["15mb(","8vb(",null,"8va(","15ma("]:["15mb)","8vb)",null,"8va)","15ma)"])[2+t]),deco_cnv(e)}for(t=0;t<=nstaff;t++)a[t]=0,c[t]=0;for(e=tsfirst;e;e=e.ts_next){if(t=e.st,null!=e.ottava)for(;e.ottava.length;)(o=e.ottava.shift())?0==c[t]++&&(l(e,o,!0),a[t]=7*-o):0==--c[t]&&(l(e,-a[t]/7),a[t]=0);switch(e.type){case C.REST:if(1==voice_tb.length)break;case C.NOTE:if((n=a[t])&&!e.p_v.ckey.k_drum)for(i=e.nhd;i>=0;i--)(r=e.notes[i]).opit||(r.opit=r.pit),r.pit+=n;break;case C.GRACE:for(s=e.extra;s;s=s.next)if((n=a[t])&&!e.p_v.ckey.k_drum)for(i=0;i<=s.nhd;i++)(r=s.notes[i]).opit||(r.opit=r.pit),r.pit+=n}}}function mrest_expand(){var e,t;function n(e){for(var t,n,r,s,o,i=e.nmes,a=e.dur/i,c=e.next;!c.bar_type;)c=c.next;for(t=c;!c.bar_num;)c=c.ts_prev;for(o=c.bar_num-e.nmes,e.type=C.REST,e.notes[0].dur=e.dur=e.dur_orig=a,e.nflags=-2,e.head=C.FULL,e.fmr=1,s=e.time+a,n=c=e;--i>0;){for(delete(c=clone(t)).soln,delete c.a_gch,delete c.a_dd,delete c.text,delete c.rbstart,delete c.rbstop,lkvsym(c,t),c.time=s;n.time<s;)n=n.ts_next;for(;n&&n.v<e.v&&n.type==C.BAR;)n=n.ts_next;if(n)lktsym(c,n),n.type==C.BAR&&delete n.bar_num;else{for(n=e;n.ts_next;)n=n.ts_next;n.ts_next=c,c.ts_prev=n,c.ts_next=null}for(o++,c.seqst?(c.bar_num=o,r=c.ts_next):(delete c.bar_num,r=c.ts_prev),c.bar_type=r.bar_type||"|",r.bar_num&&!r.seqst&&delete r.bar_num,delete(r=clone(e)).a_dd,delete r.soln,delete r.a_gch,delete r.part,c.next?(r.next=c.next,r.next.prev=r):r.next=null,c.next=r,r.prev=c,r.time=s;n&&!n.dur&&n.time==s;)n=n.ts_next;for(;n&&n.v<e.v&&(!(n=n.ts_next)||!n.seqst););if(n)lktsym(r,n);else{for(n=e;n.ts_next;)n=n.ts_next;n.ts_next=r,r.ts_prev=n,r.ts_next=null}s+=a,e=n=r}}for(e=tsfirst;e;e=e.ts_next)if(e.type==C.MREST){if(!e.seqst&&w_tb[e.ts_prev.type])t=e;else for(t=e.ts_next;!t.seqst&&t.type==C.MREST&&t.nmes==e.nmes;)t=t.ts_next;if(t.seqst)e=t.ts_prev;else for(;e.type==C.MREST;)n(e),e=e.ts_next}}function set_auto_clef(e,t,n){var r,s,o,i,a=12,c=20;for(r=t;r&&(r.type!=C.STAVES||r==t);r=r.ts_next)if(r.st==e)if(r.type==C.NOTE)r.notes[0].pit<c&&(c=r.notes[0].pit),r.notes[r.nhd].pit>a&&(a=r.notes[r.nhd].pit);else if(r.type==C.CLEF){if("a"!=r.clef_type)break;unlksym(r)}if(c>=19||c>=13&&"b"!=n)return"t";if(a<=13||a<=19&&"t"!=n)return"b";"a"==n&&(n=(a+c)/2>=16?"t":"b");var l=n,u=r,f=null;for(r=t;r!=u&&(r.type!=C.STAVES||r==t);r=r.ts_next)if(r.st==e&&r.type==C.NOTE){if(s=r.time,"t"==l){if(r.notes[0].pit>12||r.notes[r.nhd].pit>20){r.notes[0].pit>20&&(f=r);continue}if((o=r.ts_prev)&&o.time==s&&o.st==e&&o.type==C.NOTE&&o.notes[0].pit>=19)continue;if((o=r.ts_next)&&o.st==e&&o.time==s&&o.type==C.NOTE&&o.notes[0].pit>=19)continue}else{if(r.notes[0].pit<=12||r.notes[r.nhd].pit<20){r.notes[r.nhd].pit<=12&&(f=r);continue}if((o=r.ts_prev)&&o.time==s&&o.st==e&&o.type==C.NOTE&&o.notes[0].pit<=13)continue;if((o=r.ts_next)&&o.st==e&&o.time==s&&o.type==C.NOTE&&o.notes[0].pit<=13)continue}if(f){for(i=r,o=r.ts_prev;o!=f;o=o.ts_prev)if(o.st==e){if(o.type==C.BAR&&o.v==r.v){i=":"!=o.bar_type[0]?o:o.next;break}o.type==C.NOTE&&o.beam_st&&!o.p_v.second&&(i=o)}i.time!=f.time?(f=r,(o=insert_clef(i,l="t"==l?"b":"t","t"==l?2:4)).clef_auto=!0):f=r}else l=n="t"==l?"b":"t",f=r}return n}function set_clefs(){var e,t,n,r,s,o,i,a,c,l=new Array(nstaff+1),u=cur_sy,f=[];for(staff_tb=new Array(nstaff+1),n=0;n<=nstaff;n++)l[n]={autoclef:!0},staff_tb[n]={output:"",sc_out:""};for(n=0;n<=u.nstaff;n++)f[n]=3*(u.staves[n].stafflines.length-1);for(e=tsfirst;e;e=e.ts_next){switch(e.repeat_n&&set_repeat(e),e.type){case C.STAVES:for(u=e.sy,n=0;n<=nstaff;n++)l[n].autoclef=!0;for(r=0;r<voice_tb.length;r++)u.voices[r]&&(s=voice_tb[r],n=u.voices[r].st,u.voices[r].second||(u.staves[n].staffnonote=s.staffnonote,s.staffscale&&(u.staves[n].staffscale=s.staffscale),u.voices[r].sep&&(u.staves[n].sep=u.voices[r].sep),u.voices[r].maxsep&&(u.staves[n].maxsep=u.voices[r].maxsep)),(t=s.clef).clef_auto||(l[n].autoclef=!1));for(n=0;n<=u.nstaff;n++)f[n]=3*(u.staves[n].stafflines.length-1);for(r=0;r<voice_tb.length;r++)if(u.voices[r]&&!u.voices[r].second)if(s=voice_tb[r],n=u.voices[r].st,(t=s.clef).clef_auto?a="t"==(i=set_auto_clef(n,e,l[n].clef?l[n].clef.clef_type:"a"))?2:4:(i=t.clef_type,a=t.clef_line),l[n].clef){if(i!=l[n].clef.clef_type||a!=l[n].clef.clef_line){for(o=e.ts_prev;o&&o.time==e.time&&(o.v!=r||o.st!=n);)o=o.ts_prev;if(!o||o.time!=e.time){for(o=e.ts_next;o&&(o.v!=r||o.st!=n);)o=o.ts_next;o&&o.time==e.time||(o=e)}o.type!=C.CLEF&&(o=insert_clef(o,i,a),t.clef_auto&&(o.clef_auto=!0)),l[n].clef=s.clef=o}}else t.clef_auto&&("a"!=t.clef_type&&(s.clef=clone(s.clef)),s.clef.clef_type=i,s.clef.clef_line=a),staff_tb[n].clef=l[n].clef=s.clef;continue;default:e.mid=f[e.st];continue;case C.CLEF:}if("a"==e.clef_type&&(e.clef_type=set_auto_clef(e.st,e.ts_next,l[e.st].clef.clef_type),e.clef_line="t"==e.clef_type?2:4),(s=e.p_v).clef=e,e.second)unlksym(e);else{if(l[n=e.st].clef){if(e.clef_type==l[n].clef.clef_type&&e.clef_line==l[n].clef.clef_line)continue}else staff_tb[n].clef=e;l[n].clef=e}}for(u=cur_sy,r=0;r<voice_tb.length;r++)if(u.voices[r]&&(t=voice_tb[r].sym)&&127==t.notes[0].pit){switch(n=u.voices[r].st,staff_tb[n].clef.clef_type){default:c=22;break;case"c":c=16;break;case"b":c=10}for(e=t;e;e=e.next)e.notes[0].pit=c}}Abc.prototype.set_width=function(e){var t,n,r,s,o,i,a,c,l,u,f,d,p,h,m,y;if(e.play)e.wl=e.wr=0;else{switch(e.type){case C.NOTE:case C.REST:for(e.wr=i=hw_tb[e.head],e.xmx>0&&(e.wr+=e.xmx+4),t=e.prev;t&&!w_tb[t.type];t=t.prev);if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:i+=3;break;case C.STBRK:i+=8}for(r=0;r<=e.nhd;r++)(s=(l=e.notes[r]).shhd)<0&&i<5-s&&(i=5-s),(c=l.acc)&&i<(y=l.shac+("object"==typeof c?5.5:3.5))&&(i=y),l.a_dd&&(i+=deco_wch(l));if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:i-=3}if(e.a_dd&&(i+=deco_width(e)),e.beam_st&&e.beam_end&&e.stem>0&&e.nflags>0&&e.wr<e.xmx+9&&(e.wr=e.xmx+9),e.dots){if(null==e.wl)switch(e.head){case C.SQUARE:case C.OVALBARS:e.xmx+=3;break;case C.OVAL:e.xmx+=1}e.wr<e.xmx+8&&(e.wr=e.xmx+8),e.dots>=2&&(e.wr+=3.5*(e.dots-1))}if(e.trem2&&e.beam_end&&i<20&&(i=20),a=i,t)switch(t.type){case C.NOTE:t.stem>0&&e.stem<0&&a<7&&(a=7),(e.y>27&&t.y>27||e.y<-3&&t.y<-3)&&a<6&&(a=6),t.tie&&a<14&&(a=14);break;case C.CLEF:if(t.second||t.clef_small)break;a+=8;break;case C.KEY:a+=4}return e.a_gch&&(a=gchord_width(e,i,a)),void(e.prev&&e.prev.type==C.GRACE?(e.prev.wl+=i-4.5,e.wl=e.prev.wl):e.wl=a);case C.SPACE:return s=e.width/2,e.wr=s,e.a_gch&&(s=gchord_width(e,s,s)),e.a_dd&&(s+=deco_width(e)),void(e.wl=s);case C.BAR:switch(u=e.bar_type){case"|":o=5;break;case"[":o=0;break;default:for(o=2+2.8*u.length,n=0;n<u.length;n++)switch(u[n]){case"[":case"]":o+=1;case":":o+=2}}for(e.wl=o,e.next&&e.next.type!=C.METER?e.wr=7:e.wr=5,(t=e.prev)&&t.type==C.GRACE&&(e.wl-=6);t;t=t.prev)if(w_tb[t.type]){t.type==C.STBRK&&(e.wl-=12);break}return e.a_dd&&(e.wl+=deco_width(e)),void(e.text&&e.text.length<4&&e.next&&e.next.a_gch&&(set_font("repeat"),e.wr+=strwh(e.text)[0]+2,cfmt.measurenb>0&e.bar_num&&e.bar_num%cfmt.measurenb&&(e.wr+=4)));case C.CLEF:return e.invis?void(e.wl=e.wr=1):(e.wl=e.clef_small?11:12,e.wr=e.clef_small?10:12,e.prev&&e.prev.type==C.STBRK&&(e.wl-=6,delete e.next.clef_small),void(e.next&&e.next.type==C.BAR&&(e.wr-=4)));case C.KEY:if(e.invis)return void(e.wl=e.wr=0);if(e.wl=3,m=4,e.k_a_acc)for(p=h=e.k_a_acc.length,h&&(d=e.k_a_acc[0].acc),n=1;n<h;n++)(c=e.k_a_acc[n]).pit>e.k_a_acc[n-1].pit+6||c.pit<e.k_a_acc[n-1].pit-6?p--:c.acc!=d&&(m+=3),d=c.acc;else(p=e.k_sf)*(h=e.k_old_sf&&(e.fmt.cancelkey||0==p)?e.k_old_sf:0)>=0?(p<0&&(p=-p),h<0&&(h=-h),h>p&&(p=h)):((p-=h)<0&&(p=-p),m+=3);return void(e.wr=5.5*p+m);case C.METER:for(a=0,e.x_meter=[],n=0;n<e.a_meter.length;n++)switch((f=e.a_meter[n]).top[0]){case"C":case"c":case"o":e.x_meter[n]=a+6,a+=12;break;case".":case"|":e.x_meter[n]=e.x_meter[n-1];break;default:for(o=0,f=!f.bot||f.top.length>f.bot.length?f.top:f.bot,r=0;r<f.length;r++)switch(f[r]){case"(":a+=4;case")":case"1":o+=4;break;default:o+=12}e.x_meter[n]=a+o/2,a+=o}return e.wl=0,void(e.wr=a+6);case C.MREST:return e.wl=6,void(e.wr=66);case C.GRACE:if(e.invis)break;return e.wl=set_graceoffs(e),e.wr=0,void(e.a_ly&&ly_set(e));case C.STBRK:return e.wl=e.xmx,void(e.wr=8);case C.CUSTOS:return void(e.wl=e.wr=4);case C.TEMPO:tempo_build(e);break;case C.BLOCK:case C.REMARK:case C.STAVES:break;default:error(2,e,"set_width - Cannot set width for symbol $1",e.type)}e.wl=e.wr=0}};var delta_tb={t:-4,c:0,b:4,p:-6},rest_sp=[[18,18],[12,18],[12,12],[0,12],[6,8],[10,10],[6,4],[10,0],[10,4],[10,10]];function set_rest_offset(){var e,t,n,r,s,o,i,a,c,l,u,f=[],d=cur_sy;for(e=tsfirst;e;e=e.ts_next)if(!e.invis&&(e.type==C.STAVES&&(d=e.sy),e.dur&&((o=f[e.v])||(o={},f[e.v]=o),o.s=e,o.st=e.st,o.end_time=e.time+e.dur,e.type==C.REST))){for(a=-127,i=127,s=l=!1,n=0;n<=f.length;n++)(o=f[n])&&o.s&&o.st==e.st&&n!=e.v&&(o.end_time<=e.time||(s=!0,t=o.s,d.voices[n].range<d.voices[e.v].range?t.time==e.time?t.ymn<i&&(i=t.ymn,t.dots&&(l=!0)):t.y<i&&(i=t.y):t.time==e.time?t.ymx>a&&(a=t.ymx,t.dots&&(l=!0)):t.y>a&&(a=t.y)));for(r=e.time+e.dur,t=e.ts_next;t&&!(t.time>=r);t=t.ts_next)t.st==e.st&&t.dur&&!t.invis&&(s=!0,d.voices[t.v].range<d.voices[e.v].range?t.time==e.time?t.ymn<i&&(i=t.ymn,t.dots&&(l=!0)):t.y<i&&(i=t.y):t.time==e.time?t.ymx>a&&(a=t.ymx,t.dots&&(l=!0)):t.y>a&&(a=t.y));if(s)if(127==i&&e.y<12&&(c=12-e.y,e.y+=c,e.ymx+=c,e.ymn+=c),-127==a&&e.y>12&&(c=e.y-12,e.y-=c,e.ymx-=c,e.ymn-=c),(c=i-e.ymx)<0){if(c=6*Math.ceil(-c/6),e.ymn-c>=a){e.y-=c,e.ymx-=c,e.ymn-=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else if((c=a-e.ymn)>0){if(c=6*Math.ceil(c/6),e.ymx+c<=i){e.y+=c,e.ymx+=c,e.ymn+=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else;else e.y=12,e.ymx=24,e.ymn=0}}function new_sym(e,t,n){e.p_v=t,e.v=t.v,e.st=t.st,e.time=n.time,t.last_sym&&(e.next=t.last_sym.next,e.next&&(e.next.prev=e),t.last_sym.next=e,e.prev=t.last_sym),t.last_sym=e,lktsym(e,n)}function init_music_line(){var e,t,n,r,s,o,i,a,c,l,u,f=voice_tb.length;for(s=0;s<f;s++)cur_sy.voices[s]&&((e=voice_tb[s]).st=cur_sy.voices[s].st,e.second=cur_sy.voices[s].second,e.last_sym=e.sym);for(l=(t=tsfirst).fmt;t;){switch(t.type){case C.CLEF:case C.KEY:case C.METER:switch(t.type){case C.CLEF:staff_tb[t.st].clef=t;break;case C.KEY:t.p_v.ckey=t;break;case C.METER:t.p_v.meter=t,!(insert_meter=cfmt.writefields.indexOf("M")>=0&&t.a_meter.length)&&t.part&&(t.next.part=t.part)}unlksym(t);case C.TEMPO:case C.BLOCK:case C.REMARK:t=t.ts_next;continue}break}for(r=tsfirst,s=0;s<f;s++)e=voice_tb[s],!cur_sy.voices[s]||cur_sy.voices[s].second&&!e.bar_start||(o=cur_sy.voices[s].st,staff_tb[o]&&staff_tb[o].clef&&((t=clone(staff_tb[o].clef)).v=s,t.p_v=e,t.st=o,t.time=tsfirst.time,t.prev=null,t.next=e.sym,t.next&&(t.next.prev=t),e.sym=e.last_sym=t,t.ts_next=r,t.ts_prev=r?r.ts_prev:null,t.ts_prev?(t.ts_prev.ts_next=t,delete t.seqst):tsfirst=t,r&&(r.ts_prev=t,r.type==C.CLEF&&delete r.seqst),delete t.clef_small,delete t.part,t.second=cur_sy.voices[s].second,cur_sy.st_print[o]||(t.invis=!0),t.fmt=l));for(s=0;s<f;s++)cur_sy.voices[s]&&!cur_sy.voices[s].second&&cur_sy.st_print[cur_sy.voices[s].st]&&((n=(e=voice_tb[s]).ckey).k_sf||n.k_a_acc)&&(new_sym(t=clone(n),e,r),delete t.invis,delete t.part,t.k_old_sf=n.k_sf,t.fmt=l);if(insert_meter){for(s=0;s<f;s++)n=(e=voice_tb[s]).meter,cur_sy.voices[s]&&!cur_sy.voices[s].second&&cur_sy.st_print[cur_sy.voices[s].st]&&(new_sym(t=clone(n),e,r),delete t.part,t.fmt=l);insert_meter=!1}for(s=0;s<f;s++)(e=voice_tb[s]).sls.length&&(new_sym(t={type:C.BAR,fname:r.fname,bar_type:"|",dur:0,multi:0,invis:!0,sls:e.sls,fmt:l},e,r),e.sls=[]);for(s=0;s<f;s++){for(n=(e=voice_tb[s]).bar_start,e.bar_start=null,t=r;t&&t.time==r.time;t=t.ts_next)if(t.rbstop){n=null;break}n&&(cur_sy.voices[s]&&cur_sy.st_print[cur_sy.voices[s].st]&&(e.last_sym.type==C.BAR?e.last_sym.rbstop||(e.last_sym.rbstart=1):(new_sym(n,e,r),n.fmt=l)))}for(self.set_pitch(r),(t=tsfirst).seqst=!0,u=0;;){n=t,c=a=0;do{self.set_width(t),(i=t.wl+u)>a&&(a=i),t.wr>c&&(c=t.wr),t=t.ts_next}while(t!=r&&!t.seqst);if(n.shrink=a,n.space=0,t==r)break;u=c}i=0,r.type==C.BAR&&n.type==C.CLEF&&(c+=4);do{self.set_width(t),t.a_ly&&ly_set(t),i<t.wl&&(i=t.wl),t=t.ts_next}while(t&&!t.seqst);r.shrink=c+i,r.space=0}function check_end_bar(){for(var e,t=tsfirst;t.ts_next;)t=t.ts_next;t.type!=C.BAR&&((e=_bar(t)).ts_prev=t,t.next=t.ts_next=e)}function set_words(e){var t,n,r,s,o,i=!0,a=127;function c(e){e.prev.trem2=!0,e.prev.head=++e.head,--e.nflags>0?e.nflags+=e.ntrem:(e.nflags<=-2&&(e.stemless=!0,e.prev.stemless=!0),e.nflags=e.ntrem),e.prev.nflags=e.nflags}for(t=e.sym;t;t=t.next)if(t.type==C.NOTE){a=t.notes[0].pit;break}for(t=e.sym;t;t=t.next){switch(t.a_gch&&self.gch_build(t),t.type){case C.MREST:i=!0;break;case C.BAR:(o=t.fmt.bardef[t.bar_type])&&(t.bar_type=o),t.beam_on||(i=!0),t.next||!t.prev||t.invis||t.prev.head!=C.OVALBARS||(t.prev.head=C.SQUARE);break;case C.GRACE:for(n=t.extra;n;n=n.next)n.notes.sort(abc2svg.pitcmp),o=identify_note(n,n.dur_orig),n.head=o[0],n.dots=o[1],n.nflags=o[2],!n.trem2||n.next&&!n.next.trem2||c(n);break;case C.NOTE:case C.REST:if(o=identify_note(t,t.dur_orig),t.head=o[0],t.dots=o[1],t.nflags=o[2],t.nflags<=-2&&(t.stemless=!0),t.xstem&&(t.nflags=0),t.trem1&&(t.nflags>0?t.nflags+=t.ntrem:t.nflags=t.ntrem),t.next&&t.next.trem2)break;if(t.trem2){c(t);break}r=t.nflags,t.ntrem&&(r+=t.ntrem),t.type==C.REST&&t.beam_end&&!t.beam_on&&(i=!0),(i||r<=0)&&(s&&(s.beam_end=!0,s=null),r<=0?t.beam_st=t.beam_end=!0:(t.type==C.NOTE||t.beam_on)&&(t.beam_st=!0,i=!1)),t.beam_end&&(i=!0),(t.type==C.NOTE||t.beam_on)&&(s=t)}if(t.type==C.NOTE)for(t.nhd&&t.notes.sort(abc2svg.pitcmp),a=t.notes[0].pit,n=t.prev;n&&n.type==C.REST;n=n.prev)n.notes[0].pit=a;else t.notes||(t.notes=[],t.notes[0]={},t.nhd=0),t.notes[0].pit=a}s&&(s.beam_end=!0)}function set_rb(e){for(var t,n,r=e.sym;r;)if(r.type==C.BAR&&r.rbstart&&!r.norepbra){for(n=0,t=null,r=r.next;r;r=r.next)if(r.type==C.BAR){if(r.rbstop)break;if(!r.next){r.rbstop=2;break}if(++n==r.fmt.rbmin&&(t=r),n==r.fmt.rbmax){t&&(r=t),r.rbstop=1;break}}}else r=r.next}Abc.prototype.set_pitch=function(e){var t,n,r,s,o,i=C.BLEN,a=nstaff+1,c=new Int16Array(new Array(2*a));for(r=0;r<=nstaff;r++)t=staff_tb[r].clef,c[r]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[r]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[r]+=t.clef_octave):t.clef_oct_transp&&(c[r]-=t.clef_octave);for(t=tsfirst;t!=e;t=t.ts_next)switch(r=t.st,t.type){case C.CLEF:c[r]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[r]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[r]+=t.clef_octave):t.clef_oct_transp&&(c[r]-=t.clef_octave),set_yval(t);break;case C.GRACE:for(n=t.extra;n;n=n.next){if((s=c[n.st])&&!t.p_v.ckey.k_drum)for(a=0;a<=n.nhd;a++)(o=n.notes[a]).opit=o.pit,o.pit+=s;n.ymn=3*(n.notes[0].pit-18)-2,n.ymx=3*(n.notes[n.nhd].pit-18)+2}set_yval(t);break;case C.KEY:t.k_y_clef=c[r];default:set_yval(t);break;case C.MREST:if(t.invis)break;t.y=12,t.ymx=39,t.ymn=-2;break;case C.REST:if(1==voice_tb.length){t.y=12,t.ymx=24,t.ymn=0;break}case C.NOTE:if((s=c[r])&&!t.p_v.ckey.k_drum)for(a=t.nhd;a>=0;a--)(o=t.notes[a]).opit=o.pit,o.pit+=s;t.type==C.REST&&(t.y=6*((t.notes[0].pit-18)/2|0),t.ymx=t.y+rest_sp[5-t.nflags][0],t.ymn=t.y-rest_sp[5-t.nflags][1]),t.dur<i&&(i=t.dur)}e||(smallest_duration=i)},Abc.prototype.set_stem_dir=function(){for(var e,t,n,r,s,o,i,a,c,l,u=[],f=tsfirst,d=cur_sy,p=d.nstaff;f;){for(r=0;r<=p;r++)u[r]=[];for(l=[],t=f;t&&t.type!=C.BAR;t=t.ts_next)if(t.type!=C.STAVES){if(!(t.type!=C.NOTE&&t.type!=C.REST||t.invis)){if((r=t.st)>p){var h="*** fatal set_stem_dir(): bad staff number "+r+" max "+p;throw error(2,null,h),new Error(h)}for((i=l[o=t.v])||(i={st1:-1,st2:-1},l[o]=i),i.st1<0?i.st1=r:i.st1!=r&&(r>i.st1?r>i.st2&&(i.st2=r):(i.st1>i.st2&&(i.st2=i.st1),i.st1=r)),a=u[r],s=d.voices[o].range,n=a.length;--n>=0&&(c=a[n]).v!=s;);if(n<0){for(c={v:s,ymx:0,ymn:24},n=0;n<a.length;n++)if(s<a[n].v){a.splice(n,0,c);break}n==a.length&&a.push(c)}t.type==C.NOTE&&(t.ymx>c.ymx&&(c.ymx=t.ymx),t.ymn<c.ymn&&(c.ymn=t.ymn),t.xstem&&(t.ts_prev.st!=r-1||t.ts_prev.type!=C.NOTE?(error(1,f,"Bad !xstem!"),t.xstem=!1):(t.ts_prev.multi=1,t.multi=1,t.stemless=!0)))}}else{if(t!=f)break;for(d=f.sy,r=p;r<=d.nstaff;r++)u[r]=[];p=d.nstaff}for(;f!=t;f=f.ts_next)if(!f.multi){switch(f.type){default:continue;case C.REST:if(null!=f.combine&&f.combine<0||!f.ts_next||f.ts_next.type!=C.REST||f.ts_next.st!=f.st||f.time!=f.ts_next.time||f.dur!=f.ts_next.dur||f.a_dd&&f.ts_next.a_dd||f.a_gch&&f.ts_next.a_gch||f.invis)break;f.ts_next.a_dd&&(f.a_dd=f.ts_next.a_dd),f.ts_next.a_gch&&(f.a_gch=f.ts_next.a_gch),unlksym(f.ts_next);case C.NOTE:case C.GRACE:}if(r=f.st,i=l[o=f.v],a=u[r],i&&i.st2>=0)r==i.st1?f.multi=-1:r==i.st2&&(f.multi=1);else if(a.length<=1)f.floating&&(f.multi=r==voice_tb[o].st?-1:1);else{for(s=d.voices[o].range,n=a.length;--n>=0&&a[n].v!=s;);n<0||(n==a.length-1?f.multi=-1:(f.multi=1,n&&n+2==a.length&&(a[n].ymn-f.fmt.stemheight>=a[n+1].ymx&&(f.multi=-1),e=f.ts_next,f.ts_prev&&f.ts_prev.time==f.time&&f.ts_prev.st==f.st&&f.notes[f.nhd].pit==f.ts_prev.notes[0].pit&&f.beam_st&&f.beam_end&&(!e||e.st!=f.st||e.time!=f.time)&&(f.multi=-1))))}}for(;f&&f.type==C.BAR;)f=f.ts_next}};var delpit=[0,-7,-14,0];function set_global(){var e,t,n=voice_tb.length,r=cur_sy,s=r.nstaff;for(insert_meter=cfmt.writefields.indexOf("M")>=0;r=r.next;)r.nstaff>s&&(s=r.nstaff);for(nstaff=s,check_end_bar(),t=0;t<n;t++)set_words(e=voice_tb[t]),e.ckey=e.key,set_rb(e);n>1&&(set_float(),glovar.mrest_p&&mrest_expand()),glovar.ottava&&"play"!=cfmt.sound&&set_ottava(),set_clefs(),self.set_pitch(null)}function get_lshift(){var e,t,n,r,s,o,i,a=0,c=0,l=voice_tb.length;function u(e,t){var n,r,s=0;for(e+="\n";!((r=e.indexOf("\n",s))<0||((n=strwh(e.slice(s,r))[0]+12)>t&&(t=n),r<0));)s=r+1;return t}for(t=0;t<l;t++)r=(n=voice_tb[t]).nm,s=n.snm,!r&&!s||o||(set_font("voice"),o=gene.deffont),r&&(i=u(r,a))>a&&(a=i),s&&(i=u(s,c))>c&&(c=i);for(i=0,e=0;e<=cur_sy.nstaff;e++){if(cur_sy.staves[e].flags&(OPEN_BRACE2|OPEN_BRACKET2)){i=12;break}cur_sy.staves[e].flags&(OPEN_BRACE|OPEN_BRACKET)&&(i=6)}return[a+=i,c+=i]}function set_indent(e){var t,n,r=0,s=voice_tb.length;for(t=0;t<s;t++)if(n=voice_tb[t],cur_sy.voices[t]&&gene.st_print[n.st]){if(n.new_name){r=2;break}n.snm&&(r=1)}return gene.vnt=r,2==r?e[0]:e[1]}function set_beams(e){var t,n,r,s,o,i,a,c,l,u=-1;for(t=e;t;t=t.next)if(t.type==C.NOTE){if(!t.stem&&t.multi&&(t.stem=t.multi),t.stem)t.beam_st&&!t.beam_end&&(r=!0);else if(a=t.mid/3+18,r)t.stem=u;else if(t.beam_st&&!t.beam_end){for(r=!0,c=t.notes[t.nhd].pit,l=t.notes[0].pit,n=t.next;n&&(n.type!=C.NOTE||((n.stem||n.multi)&&(t.stem=n.stem||n.multi),n.notes[n.nhd].pit>c&&(c=n.notes[n.nhd].pit),n.notes[0].pit<l&&(l=n.notes[0].pit),!n.beam_end));n=n.next);!t.stem&&n.beam_end&&(c+l<2*a?t.stem=1:(c+l>2*a||t.fmt.bstemdown)&&(t.stem=-1)),t.stem||(t.stem=u)}else{if((o=(t.notes[t.nhd].pit+t.notes[0].pit)/2)==a&&t.nhd>1){for(i=0;i<t.nhd&&!(t.notes[i].pit>=a);i++);o=2*i<t.nhd?a-1:a+1}o<a?t.stem=1:o>a||t.fmt.bstemdown?t.stem=-1:t.stem=u}if(t.beam_end&&(r=!1),u=t.stem,s){for(n=s.extra;n;n=n.next)n.stem=-u;s.stem=-u,s=null}}else{if(t.type!=C.GRACE)continue;if(2==(n=t.extra).stem){s=t;continue}for(t.stem||(t.stem=t.multi||1);n;n=n.next)n.stem=t.stem,n.multi=t.multi}}function same_head(e,t){var n,r,s,o,i,a,c,l,u,f,d,p=e.fmt.shiftunison||0;if(p>=3)return!1;if((s=e.dur)>=C.BLEN)return!1;if((o=t.dur)>=C.BLEN)return!1;if(e.stemless&&t.stemless)return!1;if(e.dots!=t.dots&&(1&p||e.dots*t.dots!=0))return!1;if(e.stem*t.stem>0)return!1;if(n=r=0,e.notes[0].pit>t.notes[0].pit){if(e.stem<0)return!1;for(;t.notes[r].pit!=e.notes[0].pit;)if(++r>t.nhd)return!1}else if(e.notes[0].pit<t.notes[0].pit){if(t.stem<0)return!1;for(;t.notes[0].pit!=e.notes[n].pit;)if(++n>e.nhd)return!1}if(t.notes[r].acc!=e.notes[n].acc)return!1;a=n,l=r,f=e.notes[n].shhd,d=t.notes[r].shhd;do{if(r++,++n>e.nhd)break;if(r>t.nhd)break;if(t.notes[r].acc!=e.notes[n].acc)return!1;f<e.notes[n].shhd&&(f=e.notes[n].shhd),d<t.notes[r].shhd&&(d=t.notes[r].shhd)}while(t.notes[r].pit==e.notes[n].pit);if(n<=e.nhd){if(r<=t.nhd)return!1;if(t.stem>0)return!1}else if(r<=t.nhd&&e.stem>0)return!1;if(c=n,u=r,i=0,s!=o)if(s<o&&(s=o,o=e.dur),s<C.BLEN/2)t.dots?i=2:e.dots&&(i=1);else{if(!(o<C.BLEN/4))return!1;if(2&p)return!1;i=t.dur>=C.BLEN/2?2:1}if(i||(i=e.p_v.scale<t.p_v.scale?2:1),1==i){for(r=l;r<u;r++)t.notes[r].invis=!0,delete t.notes[r].acc;for(r=0;r<=t.nhd;r++)t.notes[r].shhd+=f}else{for(n=a;n<c;n++)e.notes[n].invis=!0,delete e.notes[n].acc;for(n=0;n<=e.nhd;n++)e.notes[n].shhd+=d}return!0}function unison_acc(e,t,n,r){var s,o,i;if(i=t.notes[r].acc){for(o=2*w_note[e.head]+e.xmx+t.notes[r].shac+2,"object"==typeof i&&(o+=2),e.dots&&(o+=6),s=0;s<=t.nhd;s++)t.notes[s].shhd+=o,t.notes[s].shac-=o;t.xmx+=o}else{for(o=2*w_note[t.head]+t.xmx+e.notes[n].shac+2,"object"==typeof(i=e.notes[n].acc)&&(o+=2),t.dots&&(o+=6),s=0;s<=e.nhd;s++)e.notes[s].shhd+=o,e.notes[s].shac-=o;e.xmx+=o}}var MAXPIT=96;function set_left(e){var t,n,r,s,o=w_note[e.head],i=o,a=[];for(n=0;n<MAXPIT;n++)a.push(-100);if(e.nflags>-2)for(e.stem>0?(i=-i,n=2*e.notes[0].pit,r=2*(Math.ceil((e.ymx-2)/3)+18)):(n=2*(Math.ceil((e.ymn+2)/3)+18),r=2*e.notes[e.nhd].pit),n<0&&(n=0),r>=MAXPIT&&(r=MAXPIT-1);n<=r;)a[n++]=i;for(s=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)i=-e.notes[t].shhd+o+s,(n=2*e.notes[t].pit)<0?n=0:n>=MAXPIT-1&&(n=MAXPIT-2),i>a[n]&&(a[n]=i),e.head!=C.SQUARE&&(i-=1),i>a[n-1]&&(a[n-1]=i),i>a[n+1]&&(a[n+1]=i);return a}function set_right(e){var t,n,r,s,o,i=w_note[e.head],a=i,c=e.nflags>0&&e.beam_st&&e.beam_end,l=[];for(n=0;n<MAXPIT;n++)l.push(-100);if(e.nflags>-2)for(e.stem<0?(a=-a,n=2*(Math.ceil((e.ymn+2)/3)+18),r=2*e.notes[e.nhd].pit,s=n+4):(n=2*e.notes[0].pit,r=2*(Math.ceil((e.ymx-2)/3)+18)),n<0&&(n=0),r>MAXPIT&&(r=MAXPIT);n<r;)l[n++]=a;if(c)if(e.stem>0)for(n=0==e.xmx?2*e.notes[e.nhd].pit:2*e.notes[0].pit,(n+=4)<0&&(n=0);n<MAXPIT&&n<=r-4;n++)l[n]=11;else for((n=s)<0&&(n=0);n<MAXPIT&&n<=2*e.notes[0].pit-4;n++)l[n]=3.5;for(o=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)a=e.notes[t].shhd+i-o,(n=2*e.notes[t].pit)<0?n=0:n>=MAXPIT-1&&(n=MAXPIT-2),a>l[n]&&(l[n]=a),e.head!=C.SQUARE&&(a-=1),a>l[n-1]&&(l[n-1]=a),a>l[n+1]&&(l[n+1]=a);return l}function set_overlap(){var e,t,n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g,A,_,v,b,x,w=cur_sy;function E(){t=n,n=e,f=d,b=y,x=g,h=p}for(e=tsfirst;e;e=e.ts_next)if(e.type!=C.NOTE||e.invis)e.type==C.STAVES&&(w=e.sy);else{if(e.xstem&&e.ts_prev.stem<0)for(a=0;a<=e.nhd;a++)e.notes[a].shhd-=7,e.notes[a].shac+=16;for(n=e;n=n.ts_next;){if(n.time!=e.time){n=null;break}if(n.type==C.NOTE&&!n.invis&&n.st==e.st)break}if(n&&(t=e,w.voices[t.v].range<w.voices[n.v].range?n.dot_low=!0:t.dot_low=!0,!(t.ymn>n.ymx||t.ymx<n.ymn||same_head(t,n))))if(t.dots||n.dots||!(t.stem>0&&n.stem<0&&t.notes[0].pit==n.notes[n.nhd].pit+1||t.stem<0&&n.stem>0&&t.notes[t.nhd].pit+1==n.notes[0].pit)){if(g=set_right(t),A=set_left(n),(r=t.ts_prev)&&r.time==t.time&&r.st==t.st&&r.type==C.NOTE&&!r.invis)for(v=set_right(r),s=0;s<MAXPIT;s++)v[s]>g[s]&&(g[s]=v[s]);else r=null;for(f=-10,s=0;s<MAXPIT;s++)A[s]+g[s]>f&&(f=A[s]+g[s]);if(!(f<-3)||!(1&n.notes[0].pit||!t.dots&&!n.dots)&&(t.notes[t.nhd].pit==n.notes[0].pit+2&&t.dot_low||t.notes[t.nhd].pit+2==n.notes[0].pit&&n.dot_low)){if(_=set_right(n),y=set_left(t),r)for(v=set_left(r),s=0;s<MAXPIT;s++)v[s]>y[s]&&(y[s]=v[s]);for(d=p=h=-100,s=0;s<MAXPIT;s++)y[s]+_[s]>d&&(d=y[s]+_[s]),_[s]>h&&(h=_[s]),g[s]>p&&(p=g[s]);for(l=0,o=t.nhd,i=n.nhd;;){switch(u=t.notes[o].pit-n.notes[i].pit){case 2:1&t.notes[o].pit||(t.dot_low=!1);break;case 1:1&t.notes[o].pit?n.dot_low=!0:t.dot_low=!1;break;case 0:if(t.notes[o].acc!=n.notes[i].acc){l=-1;break}n.notes[i].acc&&(t.notes[o].acc||(t.notes[o].acc=n.notes[i].acc),n.notes[i].acc=0),t.dots&&n.dots&&1&t.notes[o].pit&&(l=1);break;case-1:1&t.notes[o].pit?n.dot_low=!1:t.dot_low=!0;break;case-2:1&t.notes[o].pit||(n.dot_low=!1)}if(l<0)break;if(u>=0&&--o<0)break;if(u<=0&&--i<0)break}if(l<0)unison_acc(t,n,o,i);else{if(c=0,t.dots?n.dots?l||(c=1):E():n.dots&&d+p<f+h&&(c=1),b=A,x=_,!r&&d+p<f+h&&E(),(f+=3)<0&&(f=0),a=t.stem>=0?0:t.nhd,f+=t.notes[a].shhd,a=n.stem>=0?0:n.nhd,f-=n.notes[a].shhd,t.dots)if(m=7.7+t.xmx+3.5*t.dots-3.5+3,c){if(m<f+h+n.xmx){for(d=0,o=0;o<=t.nhd;o++)1&(s=t.notes[o].pit)||(t.dot_low?s--:s++),(s*=2)<1?s=1:s>=MAXPIT-1&&(s=MAXPIT-2),x[s]>d&&(d=x[s]),x[s-1]+1>d&&(d=x[s-1]=1),x[s+1]+1>d&&(d=x[s+1]+1);d>4.5&&7.7+t.xmx+2<f+d+n.xmx&&(n.xmx=d+3-7.7)}}else{for(d=-100,o=0;o<=t.nhd;o++)1&(s=t.notes[o].pit)||(t.dot_low?s--:s++),(s*=2)<1?s=1:s>=MAXPIT-1&&(s=MAXPIT-2),b[s]>d&&(d=b[s]),b[s-1]+1>d&&(d=b[s-1]+1),b[s+1]+1>d&&(d=b[s+1]+1);m+d+2>f&&(f=m+d+2)}for(a=n.nhd;a>=0;a--)n.notes[a].shhd+=f;n.xmx+=f,c&&(t.xmx=n.xmx)}}}else{for(t.stem<0&&(t=n,n=e),f=t.notes[0].shhd+7,a=0;a<=n.nhd;a++)n.notes[a].shhd+=f;n.xmx+=f,t.xmx=n.xmx}}}Abc.prototype.set_stems=function(){var e,t,n,r,s,o,i,a,c,l;for(e=tsfirst;e;e=e.ts_next)if(e.type==C.NOTE){if(set_head_shift(e),a=e.nflags,e.beam_st&&!e.beam_end){for(e.feathered_beam&&(a=++e.nflags),t=e.next;t.type!=C.NOTE||(e.feathered_beam&&t.nflags++,!t.beam_end);t=t.next);t.nflags>a&&(a=t.nflags)}else if(!e.beam_st&&e.beam_end){for(t=e.prev;!t.beam_st;t=t.prev);t.nflags>a&&(a=t.nflags)}switch(r=e.fmt.stemheight,a){case 2:r+=0;break;case 3:r+=4;break;case 4:r+=8;break;case 5:r+=12}1!=(s=e.p_v.scale)&&(r*=.5*(s+1)),o=3*(e.notes[0].pit-18),e.nhd>0?(r-=2,i=3*(e.notes[e.nhd].pit-18)):i=o,e.ntrem&&(r+=2*e.ntrem),e.stemless?(e.stem>=0?(e.y=o,e.ys=i):(e.ys=o,e.y=i),e.ymx=i+4,e.ymn=o-4):e.stem>=0?(e.notes[e.nhd].pit>26&&(a<=0||!e.beam_st||!e.beam_end)&&(r-=2,e.notes[e.nhd].pit>28&&(r-=2)),e.y=o,e.notes[0].tie&&(o-=3),e.ymn=o-4,e.ys=i+r,e.ys<e.mid&&(e.ys=e.mid),e.ymx=e.ys+2.5|0):(e.notes[0].pit<18&&(a<=0||!e.beam_st||!e.beam_end)&&(r-=2,e.notes[0].pit<16&&(r-=2)),e.ys=o-r,e.ys>e.mid&&(e.ys=e.mid),e.ymn=e.ys-2.5|0,e.y=i,e.notes[e.nhd].tie&&(i+=3),e.ymx=i+4)}else{if(e.type!=C.GRACE)continue;for(c=l=e.mid,n=e.extra;n;n=n.next)r=GSTEM,n.nflags>1&&(r+=1.2*(n.nflags-1)),o=3*(n.notes[0].pit-18),i=3*(n.notes[n.nhd].pit-18),e.stem>=0?(n.y=o,n.ys=i+r,i=Math.round(n.ys)):(n.y=i,n.ys=o-r,o=Math.round(n.ys)),i+=4,(o-=4)<c?c=o:i>l&&(l=i),n.ymx=i,n.ymn=o;e.ymx=l,e.ymn=c}};var blocks=[];function sym_staff_move(e){for(var t=tsfirst;t&&!t.nl;t=t.ts_next)t.st==e&&t.type!=C.CLEF&&(t.st++,t.type!=C.TEMPO&&(t.invis=!0))}function set_piece(){var e,t,n,r,s,o=[],i=[],a=cur_sy;function c(e){var t=staff_tb[e],n=a.staves[e];t||(t=staff_tb[e]={}),t.y=0,t.stafflines=n.stafflines,t.staffscale=n.staffscale,t.ann_top=t.ann_bot=0}function l(){var e,t,n,r=a.staves.length;for(e=0;e<r;e++)if(a.staves[e].flags&(OPEN_BRACE|OPEN_BRACE2)){for(n=0,t=e;e<r&&(n|=o[e]?1:2,!(a.staves[e].flags&(CLOSE_BRACE|CLOSE_BRACE2)));)e++;if(3==n)for(;t<=e;)o[t]=!0,i[t++]=!0}}for(tsfirst.type==C.STAVES&&(e=tsfirst,(tsfirst=tsfirst.ts_next).ts_prev=null,e.seqst&&(tsfirst.seqst=!0),e.p_v.sym=e.next,e.next&&(e.next.prev=null)),nstaff=a.nstaff,n=0;n<=nstaff;n++)c(n);for(e=tsfirst;e&&!e.nl;e=e.ts_next){switch(e.type){case C.STAVES:for(l(),a.st_print=new Uint8Array(o),a=e.sy;nstaff<a.nstaff;)c(++nstaff);o=[];continue;case C.BLOCK:e.play?e.ts_next&&e.ts_next.shrink&&(e.ts_next.shrink=0):(blocks.push(e),unlksym(e));continue}if((n=e.st)>nstaff){switch(e.type){case C.CLEF:staff_tb[n].clef=e;break;case C.KEY:e.p_v.ckey=e;break;case C.METER:e.p_v.meter=e}unlksym(e)}else if(!o[n]){switch(e.type){default:continue;case C.BAR:if(e.bar_mrep||a.staves[n].staffnonote>1)break;continue;case C.GRACE:break;case C.NOTE:case C.REST:case C.SPACE:case C.MREST:if(a.staves[n].staffnonote>1)break;if(e.invis)continue;if(a.staves[n].staffnonote||e.type==C.NOTE)break;continue}i[n]=o[n]=!0}}for(tsnext=e,l(),a.st_print=new Uint8Array(o),function(){var e,t,n,r,s;for(e=0;e<=nstaff;e++){for((t=staff_tb[e]).hlu=[],t.hld=[],s=t.stafflines.length,t.topbar=6*(s-1),n=0;n<s-1;n++){switch(t.stafflines[n]){case".":case"-":continue}break}if(t.botline=t.botbar=6*n,n>=s-2){if("."==t.stafflines[n]){t.botbar-=12,t.topbar+=12;continue}t.botbar-=6,t.topbar+=6}if(i[e])for(t.hll=17+2*n,t.hlmap=new Int8Array(new Array(2*(s-n+1))),r=1;n<s;n++,r+=2)switch(t.stafflines[n]){case"|":case"[":t.hlmap[r-1]=1,t.hlmap[r]=1,t.hlmap[r+1]=1}}}(),n=0;n<nstaff;n++)i[n]||sym_staff_move(n);if(i[nstaff]||(staff_tb[nstaff].topbar=0),init_music_line(),gene.st_print=new Uint8Array(i),tsnext)for(delete(e=tsnext).nl,e.ts_prev.ts_next=null,s=voice_tb.length,r=0;r<s;r++){if((t=voice_tb[r]).sym&&t.sym.time<=tsnext.time){for(e=tsnext.ts_prev;e;e=e.ts_prev)if(e.v==r){t.s_next=e.next,e.next=null;break}if(e)continue}t.s_next=t.sym,t.sym=null}}function set_sym_line(){for(var e,t,n=voice_tb.length;--n>=0;)(e=voice_tb[n]).sym&&e.s_prev&&(e.sym.prev=e.s_prev),t=e.s_next,e.sym=t,t?(t.prev&&(t.prev.next=t),e.s_prev=t.prev,t.prev=null):e.s_prev=null}function set_posx(){posx=img.lm/cfmt.scale}function gen_init(){for(var e=tsfirst,t=e.time;e;e=e.ts_next){if(e.time!=t)return void set_page();switch(e.type){case C.NOTE:case C.REST:case C.MREST:case C.SPACE:return void set_page();default:continue;case C.STAVES:cur_sy=e.sy;continue;case C.BLOCK:if(e.play)continue;self.block_gen(e)}unlksym(e),e.p_v.s_next==e&&(e.p_v.s_next=e.next)}tsfirst=null}Abc.prototype.block_gen=function(e){switch(e.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":self.set_format(e.subtype,e.param);break;case"mc_start":multicol={posy,maxy:posy,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"mc_new":if(!multicol){error(1,e,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=multicol.posy;break;case"mc_end":if(!multicol){error(1,e,"%%multicol new without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;case"ml":blk_flush(),user.img_out(e.text);break;case"newpage":if(!user.page_format)break;blk_flush(),blkdiv<0&&user.img_out("</div>"),blkdiv=2;break;case"sep":set_page(),vskip(e.sk1),output+='<path class="stroke"\n\td="M',out_sxsy((img.width-e.l)/2-img.lm," ",0),output+="h"+e.l.toFixed(1)+'"/>\n',vskip(e.sk2);break;case"text":set_font(e.font),use_font(e.font),write_text(e.text,e.opt);break;case"title":write_title(e.text,!0);break;case"vskip":vskip(e.sk)}},Abc.prototype.set_sym_glue=function(e){var t,n,r,s,o,i,a=0,c=0,l=0,u=0;for(t=tsfirst;t;t=t.ts_next)t.type!=C.GRACE||o||(o=t),t.seqst&&(a+=t.shrink,t.space?t.space<t.shrink?(u+=t.shrink,c+=t.shrink):c+=t.space:l+=t.shrink);if(c){if(r=!tsnext||tsnext.type==C.BLOCK&&!tsnext.play||blocks.length,t=tsfirst,a>=e){for(a>e&&error(1,t,"Line too much shrunk $1 $2 $3",a.toFixed(1),c.toFixed(1),e.toFixed(1)),s=0;t;t=t.ts_next)t.seqst&&(s+=t.shrink),t.x=s;spf_last=0}else if(r&&c+l>e*(1-t.fmt.stretchlast)||!r&&(c+l>e||t.fmt.stretchstaff)){c==u&&(c+=5);for(var f=4;--f>=0;){for(i=(e-l-u)/(c-u),c=0,u=0,s=0,t=tsfirst;t;t=t.ts_next)t.seqst&&(t.space?t.space*i<=t.shrink?(u+=t.shrink,c+=t.shrink,s+=t.shrink):(c+=t.space,s+=t.space*i):s+=t.shrink),t.x=s;if(Math.abs(s-e)<.1)break}spf_last=i}else for(i=1-t.fmt.maxshrink,spf_last&&c*spf_last+l<e&&(i=spf_last),s=0;t;t=t.ts_next)t.seqst&&(s+=t.space<=t.shrink?t.shrink:t.shrink*(1-i)+t.space*i),t.x=s;for(realwidth=s,t=o;t;t=t.ts_next)if(t.type==C.GRACE)for(s=t.gr_shift?t.prev.x+t.prev.wr:t.x-t.wl,n=t.extra;n;n=n.next)n.x+=s}else realwidth=0},Abc.prototype.output_music=function(){var e,t,n,r,s,o,i,a,c=voice_tb.length;for(set_global(),c>1&&self.set_stem_dir(),e=0;e<c;e++)set_beams(voice_tb[e].sym);if(self.set_stems(),gen_init(),tsfirst){for(set_acc_shft(),c>1&&(set_rest_offset(),set_overlap()),set_allsymwidth(),r=get_lshift(),cfmt.singleline?(e=get_ck_width(),t=r[0]+e[0]+e[1]+get_width(tsfirst,null)[0],img.width=t*cfmt.scale+img.lm+img.rm+2):cut_tune(t=get_lwidth(),r),o=tsfirst,e=c;--e>=0;)voice_tb[e].osym=voice_tb[e].sym;for(spf_last=0;;){if(set_piece(),n=set_indent(r),!s&&cfmt.indent&&n<cfmt.indent&&(n=cfmt.indent),self.set_sym_glue(t-n),realwidth)for(n&&(posx+=n),draw_sym_near(),s=set_staff(),draw_systems(n),draw_all_sym(),delayed_update(),output&&vskip(s),n&&(posx-=n);blocks.length;)self.block_gen(blocks.shift());if(blk_flush(),i&&(i.ts_next.ts_prev=i),!tsnext)break;if(tsnext.ts_prev.ts_next=tsfirst=tsnext,gen_init(),!tsfirst)break;i=tsfirst.ts_prev,tsfirst.ts_prev=null,set_sym_line(),t=get_lwidth()}for(tsfirst=o,e=c;--e>=0;)(a=voice_tb[e]).sym&&a.s_prev&&(a.sym.prev=a.s_prev),a.sym=a.osym}};var a_gch,a_dcn=[],multicol,maps={},qplet_tb=new Int8Array([0,1,3,2,3,0,2,0,3,0]),ntb="CDEFGABcdefgab";function set_ref(e){e.fname=parse.fname,e.istart=parse.istart,e.iend=parse.iend}function new_clef(e){var t={type:C.CLEF,clef_line:2,clef_type:"t",v:curvoice.v,p_v:curvoice,time:curvoice.time,dur:0},n=1;switch(set_ref(t),e[0]){case'"':n=e.indexOf('"',1),t.clef_name=e.slice(1,n),n++;break;case"a":if("u"==e[1]){t.clef_type="a",t.clef_auto=!0,n=4;break}n=4;case"C":t.clef_type="c",t.clef_line=3;break;case"b":n=4;case"F":t.clef_type="b",t.clef_line=4;break;case"n":n=4,t.invis=!0;break;case"t":if("e"==e[1]){t.clef_type="c",t.clef_line=4;break}n=6;case"G":break;case"p":n=4;case"P":t.clef_type="p",t.clef_line=3,curvoice.key.k_sf=0,curvoice.ckey.k_sf=0,curvoice.ckey.k_map=abc2svg.keys[7],curvoice.ckey.k_b40=2,curvoice.ckey.k_drum=!0;break;default:return void syntax(1,"Unknown clef '$1'",e)}if(e[n]>="1"&&e[n]<="9"&&(t.clef_line=+e[n],n++),delete curvoice.snd_oct,"8"!=e[n+1]&&"1"!=e[n+1])return t;switch(e[n]){case"^":t.clef_oct_transp=!0;case"+":t.clef_octave="8"==e[n+1]?7:14,t.clef_oct_transp||(curvoice.snd_oct=8==e[n+1]?12:24);break;case"_":t.clef_oct_transp=!0;case"-":t.clef_octave="8"==e[n+1]?-7:-14,t.clef_oct_transp||(curvoice.snd_oct=8==e[n+1]?-12:-24)}return t}function get_interval(e,t){var n,r,s,o;for((r=new scanBuf).buffer=e,o=[],n=0;n<2;n++)if(s=r.buffer[r.index]?parse_acc_pit(r):null){if("object"==typeof s.acc)return void syntax(1,errs.bad_transp);o[n]=abc2svg.pab40(s.pit,s.acc)}else{if(1!=n||!t)return void syntax(1,errs.bad_transp);o[n]=242}return o[1]-o[0]}function set_linebreak(e){var t,n;for(t=0;t<128;t++)"\n"==char_tb[t]&&(char_tb[t]=nil);for(e=e.split(/\s+/),t=0;t<e.length;t++){switch(n=e[t]){case"!":case"$":case"*":case";":case"?":case"@":break;case"<none>":continue;case"<EOL>":n="\n";break;default:syntax(1,"Bad value '$1' in %%linebreak - ignored",n);continue}char_tb[n.charCodeAt(0)]="\n"}}function set_user(e){var t,n,r,s=e.match(/(.)[=\s]*(\[I:.+\]|".+"|!.+!)$/);if(s)if(n=s[1],r=s[2],"\\"==n[0]&&("t"==n[1]?n="\t":n[1]||(n=" ")),(t=n.charCodeAt(0))>=128)syntax(1,errs.not_ascii);else{switch(char_tb[t][0]){case"0":case"d":case"i":case" ":break;case'"':case"!":case"[":if(char_tb[t].length>1)break;default:return void syntax(1,"Bad user character '$1'",n)}switch(r){case"!beambreak!":r=" ";break;case"!ignore!":r="i";break;case"!nil!":case"!none!":r="d"}char_tb[t]=r}else syntax(1,'Lack of starting [, ! or " in U: / %%user')}function get_st_lines(e){if(e){if(/^[\]\[|.-]+$/.test(e))return e.replace(/\]/g,"[");var t=+e;switch(t){case 0:return"...";case 1:return"..|";case 2:return".||";case 3:return".|||"}if(!(isNaN(t)||t<0||t>16))return"||||||||||||||||".slice(0,t)}}function new_block(e){var t={type:C.BLOCK,subtype:e,dur:0};return"midi"!=e.slice(0,4)&&(curvoice=voice_tb[0]),sym_link(t),t}function set_kv_parm(e){curvoice.init||(curvoice.init=!0,info.V&&(info.V[curvoice.id]&&(e=info.V[curvoice.id].concat(e)),info.V["*"]&&(e=info.V["*"].concat(e)))),e.length&&self.set_vp(e)}function memo_kv_parm(e,t){t.length&&(info.V||(info.V={}),info.V[e]?Array.prototype.push.apply(info.V[e],t):info.V[e]=t)}function new_key(e){var t,n,r,s,o,i="FCGDAEB".indexOf(e[0])-1,a=0,c={type:C.KEY,dur:0};if(set_ref(c),t=1,i<-1)switch(e[0]){case"H":if(n=!0,"p"!=e[1].toLowerCase()){syntax(1,"Unknown bagpipe-like key");break}c.k_bagpipe=e[1],i="P"==e[1]?0:2,t++,cfmt.temper||(cfmt.temper=new Float32Array([11.62,12.55,1.66,2.37,3.49,0,1.66,2.37,3.49,4.41,5.53,0,3.49,4.41,5.53,6.63,7.35,4.41,5.53,6.63,7.35,8.19,0,6.63,7.35,8.19,9.39,10.51,0,8.19,9.39,10.51,11.62,12.55,0,10.51,11.62,12.55,1.66,1.66]));break;case"P":syntax(1,"K:P is deprecated"),i=0,c.k_drum=!0,n=!0;break;case"n":if(0==e.indexOf("none")){i=0,c.k_none=!0,t=4;break}default:return c.k_map=[],c.k_mode=0,[c,info_split(e)]}if(!n){switch(e[t]){case"#":i+=7,t++;break;case"b":i-=7,t++}switch((e=e.slice(t).trim()).slice(0,3).toLowerCase()){default:if("m"!=e[0]||" "!=e[1]&&"\t"!=e[1]&&"\n"!=e[1]){n=!0;break}case"aeo":case"m":case"min":i-=3,a=5;break;case"dor":i-=2,a=1;break;case"ion":case"maj":break;case"loc":i-=5,a=6;break;case"lyd":i+=1,a=3;break;case"mix":i-=1,a=4;break;case"phr":i-=4,a=2}if(n||(e=e.replace(/\w+\s*/,"")),0==e.indexOf("exp ")&&((e=e.replace(/\w+\s*/,""))||syntax(1,"No accidental after 'exp'"),o=!0),"^"==(r=e[0])||"_"==r||"="==r){c.k_a_acc=[],(s=new scanBuf).buffer=e;do{var l=parse_acc_pit(s);if(!l)break;for(c.k_a_acc.push(l),r=e[s.index];" "==r;)r=e[++s.index]}while("^"==r||"_"==r||"="==r);o||function(e,t){var n,r,s,o,i,a=[],c=[];if(t>0)for(o=0;o<t;o++)a[o]=1,c[o]=[26,23,27,24,21,25,22][o];else for(o=0;o<-t;o++)a[o]=-1,c[o]=[22,25,21,24,20,23,26][o];for(s=e.k_a_acc.length,n=0;n<s;n++){for(i=e.k_a_acc[n],r=0;r<o;r++)if(c[r]==i.pit){a[r]=i.acc;break}r==o&&(a[r]=i.acc,c[r]=i.pit,o++)}for(n=0;n<o;n++)(i=e.k_a_acc[n])||(i=e.k_a_acc[n]={}),i.acc=a[n],i.pit=c[n]}(c,i),e=e.slice(s.index)}else o&&0==e.indexOf("none")&&(i=0,e=e.replace(/\w+\s*/,""))}if((i<-7||i>7)&&(syntax(1,"Key with double sharps/flats"),i>7?i-=12:i+=12),c.k_sf=i,c.k_a_acc)for(c.k_map=[],t=c.k_a_acc.length;--t>=0;)l=c.k_a_acc[t],c.k_map[(l.pit+19)%7]=l.acc;else c.k_map=c.k_bagpipe&&!i?abc2svg.keys[9]:abc2svg.keys[i+7];return c.k_mode=a,c.k_b40=[1,24,7,30,13,36,19,2,25,8,31,14,37,20,3][i+7],[c,info_split(e)]}function new_meter(e){var t,n,r,s,o,i,a,c={type:C.METER,dur:0,a_meter:[]},l={},u=0,f=0;if(set_ref(c),0==e.indexOf("none"))f=4,i=1;else for(i=0;f<e.length&&"="!=e[f];){switch(e[f]){case"C":l.top=e[f++],u||(u=4,s=4);break;case"c":case"o":if(l.top=e[f++],!u)switch("c"==e[f-1]?(u=2,s=4):(u=3,s=4),e[f]){case"|":s/=2;break;case".":u*=3,s*=2}break;case".":case"|":u=0,l.top=e[f++];break;case"(":for("("==e[f+1]&&(a=!0,l.top=e[f++],c.a_meter.push(l),l={}),o=f+1;o<e.length&&")"!=e[o]&&"/"!=e[o];)o++;if(")"==e[o]&&"/"==e[o+1]){f++;continue}case")":a="("==e[f],l.top=e[f++],c.a_meter.push(l),l={};continue;default:if(e[f]<="0"||e[f]>"9")return void syntax(1,"Bad char '$1' in M:",e[f]);for(s=2,l.top=e[f++];;){for(;e[f]>="0"&&e[f]<="9";)l.top+=e[f++];if(")"==e[f]){if("/"!=e[f+1])break;f++}if("/"==e[f]){if(e[++f]<="0"||e[f]>"9")return void syntax(1,"Bad char '$1' in M:",e[f]);for(l.bot=e[f++];e[f]>="0"&&e[f]<="9";)l.bot+=e[f++];break}if(" "!=e[f]&&"+"!=e[f])break;if(f>=e.length||"("==e[f+1])break;l.top+=e[f++]}u=+l.top}for(a||(l.bot&&(s=+l.bot),i+=u*C.BLEN/s),c.a_meter.push(l),l={};" "==e[f];)f++;"+"==e[f]&&(l.top=e[f++],c.a_meter.push(l),l={})}if("="==e[f]){if(!(n=e.substring(++f).match(/^(\d+)\/(\d+)$/)))return void syntax(1,"Bad duration '$1' in M:",e.substring(f));i=C.BLEN*n[1]/n[2]}if(i)if(c.wmeasure=i,cfmt.writefields.indexOf("M")<0&&(c.a_meter=[]),3!=parse.state){if(info.M=e,glovar.meter=c,parse.state)for(glovar.ulen||(i<=1||i>=3*C.BLEN/4?glovar.ulen=C.BLEN/8:glovar.ulen=C.BLEN/16),r=0;r<voice_tb.length;r++)voice_tb[r].meter=c,voice_tb[r].wmeasure=i}else for(curvoice.wmeasure=i,is_voice_sig()?curvoice.meter=c:sym_link(c),t=curvoice.voice_down;t;t=t.voice_down)t.wmeasure=i;else syntax(1,errs.bad_val,"M:")}function new_tempo(e){var t,n,r,s,o=e,i={type:C.TEMPO,dur:0};function a(e){var t,r,s=e.match(/(\d+)\/(\d+)/);if(s&&(r=+s[2])&&!isNaN(r)&&!(r&r-1)&&(t=+s[1],!isNaN(t)))return C.BLEN*t/r;syntax(1,"Invalid note duration $1",n)}if(set_ref(i),cfmt.writefields.indexOf("Q")<0&&(i.invis=!0),'"'==e[0]){if(!(n=e.match(/"([^"]*)"/)))return void syntax(1,"Unterminated string in Q:");i.tempo_str1=n[1],e=e.slice(n[0].length).replace(/^\s+/,"")}if('"'==e.slice(-1)&&(t=e.indexOf('"'),i.tempo_str2=e.slice(t+1,-1),e=e.slice(0,t).replace(/\s+$/,"")),(t=e.indexOf("="))>0){for(r=e.slice(0,t).split(/\s+/),e=e.slice(t+1).replace(/^\s+/,"");n=r.shift();){if(!(s=a(n)))return;i.tempo_notes||(i.tempo_notes=[]),i.tempo_notes.push(s)}if("ca. "==e.slice(0,4)&&(i.tempo_ca="ca. ",e=e.slice(4)),(t=e.indexOf("/"))>0){if(!(s=a(e)))return;i.new_beat=s}else if(i.tempo=+e,!i.tempo||isNaN(i.tempo))return void syntax(1,"Bad tempo value")}if(parse.state<2||!curvoice.time&&!glovar.tempo)return info.Q=o,void(glovar.tempo=i);var c=curvoice.time;glovar.tempo||syntax(0,"No previous tempo"),parse.ctrl||(parse.ctrl={}),parse.ctrl[c]||(parse.ctrl[c]={}),parse.ctrl[c].tempo=i,i.v=par_sy.top_voice,i.p_v=voice_tb[i.v],i.fmt=cfmt,i.st=i.p_v.st,i.time=c}function do_info(e,t){var n,r,s,o,i;if(curvoice&&curvoice.ignore)switch(e){default:return;case"P":case"Q":case"V":}switch(e){case"I":self.do_pscom(t);break;case"L":if(o=t.match(/^1\/(\d+)(=(\d+)\/(\d+))?$/)){if(!(r=+o[1])||0!=(r&r-1))break;r=C.BLEN/r,s=o[2]?(s=+o[4])?+o[3]/s*C.BLEN:0:r}else"auto"==t&&(r=s=-1);if(!s){syntax(1,"Bad L: value");break}parse.state<=1?glovar.ulen=r:(curvoice.ulen=r,curvoice.dur_fact=s/r);break;case"M":new_meter(t);break;case"U":set_user(t);break;case"P":if(!parse.state)break;if(1==parse.state){info.P=t;break}set_ref(n={text:t,time:i=curvoice.time}),cfmt.writefields.indexOf(e)<0&&(n.invis=!0),parse.ctrl||(parse.ctrl={}),parse.ctrl[i]||(parse.ctrl[i]={}),parse.ctrl[i].part=n,n.v=par_sy.top_voice,n.p_v=voice_tb[n.v],n.fmt=cfmt,n.st=n.p_v.st;break;case"Q":if(!parse.state)break;new_tempo(t);break;case"V":get_voice(t),3==parse.state&&(curvoice.ignore=!par_sy.voices[curvoice.v]);break;case"K":if(!parse.state)break;get_key(t);break;case"N":case"R":info[e]?info[e]+="\n"+t:info[e]=t;break;case"r":if(!user.keep_remark||3!=parse.state)break;sym_link(n={type:C.REMARK,text:t,dur:0});break;default:syntax(0,"'$1:' line ignored",e)}}function adjust_dur(e){var t,n,r,s,o;if((t=curvoice.last_sym)&&t.type!=C.MREST&&t.type!=C.BAR){for(;t.type!=C.BAR&&t.prev;)t=t.prev;if(n=t.time,r=curvoice.time-n,o=curvoice.wmeasure/r,!n){for(;t&&!t.dur;)t=t.next;t&&t.type==C.REST&&t.invis&&(n+=t.dur*o,t.prev?t.prev.next=t.next:curvoice.sym=t.next,t.next&&(t.next.prev=t.prev),t=t.next)}if(curvoice.wmeasure!=r){for(;t;t=t.next)if(t.time=n,t.dur&&!t.grace&&(t.dur*=o,t.dur_orig*=o,n+=t.dur,t.type==C.NOTE||t.type==C.REST))for(s=0;s<=t.nhd;s++)t.notes[s].dur*=o;curvoice.time=e.time=n}}}function new_bar(){var e,t,n,r=parse.line,s={type:C.BAR,fname:parse.fname,istart:parse.bol+r.index,dur:0,multi:0};for(vover&&vover.bar&&get_vover("|"),glovar.new_nbar&&(s.bar_num=glovar.new_nbar,glovar.new_nbar=0),n=r.char();;){switch(t=r.next_char()){case"|":case"[":case"]":case":":n+=t;continue}break}if(":"==n[0]&&(":"==n?(n="|",s.bar_dotted=!0):s.rbstop=2),a_gch&&csan_add(s),a_dcn.length&&deco_cnv(s),parse.ottava.length&&(e=s,curvoice.cst!=curvoice.st&&sym_link(e={type:C.SPACE,fname:parse.fname,istart:parse.bol+r.index,dur:0,multi:0,invis:!0,width:1}),e.ottava=parse.ottava,parse.ottava=[]),"["!=n.slice(-1)||/[0-9" ]/.test(t)||(n=n.slice(0,-1),r.index--,t="["),t>"0"&&t<="9")for(s.text=t;t=r.next_char(),!("0123456789,.-".indexOf(t)<0);)s.text+=t;else if('"'==t&&"["==n.slice(-1))for(s.text="";;){if(!(t=r.next_char()))return void syntax(1,"No end of repeat string");if('"'==t){r.index++;break}s.text+=t}if("]"==n[0]&&(s.rbstop=2,1!=n.length?n=n.slice(1):s.invis=!0),s.iend=parse.bol+r.index,s.text&&"["==n.slice(-1)&&"["!=n&&(n=n.slice(0,-1)),":"==n.slice(-1)&&(s.rbstop=2,s.text&&(syntax(1,"Variant ending on a left repeat bar"),delete s.text),curvoice.tie_s_rep=null),s.text&&(s.rbstart=s.rbstop=2,"1"==s.text[0]?(curvoice.tie_s_rep=curvoice.tie_s,curvoice.acc_tie?curvoice.acc_tie_rep=curvoice.acc_tie.slice():curvoice.acc_tie_rep&&(curvoice.acc_tie_rep=null)):(curvoice.tie_s=curvoice.tie_s_rep,curvoice.acc_tie_rep&&(curvoice.acc_tie=curvoice.acc_tie_rep.slice()))),s.rbstart&&curvoice.norepbra&&!curvoice.second&&(s.norepbra=!0),curvoice.ulen<0&&adjust_dur(s),("["==n||"|:"==n)&&(e=curvoice.last_sym)&&e.time==curvoice.time){do{if(e.type==C.BAR)break;if(w_tb[e.type])break;e=e.prev}while(e);if(e&&e.type==C.BAR){if("["==n&&!e.text&&(!curvoice.st||par_sy.staves[curvoice.st-1].flags&STOP_BAR||s.norepbra)||"|"==e.bar_type)return"["!=n&&(e.bar_type=n),s.text&&(e.text=s.text),s.a_gch&&(e.a_gch=s.a_gch),s.norepbra&&(e.norepbra=s.norepbra),s.rbstart&&(e.rbstart=s.rbstart),void(s.rbstop&&(e.rbstop=s.rbstop));if("|:"==n){if(":|"==e.bar_type)return e.bar_type="::",void(e.rbstop=2);if("||"==e.bar_type)return e.bar_type="||:",void(e.rbstop=2)}}}switch(n){case"[":case"[]":case"[|]":s.invis=!0,n=s.rbstart?"[":"[]";break;case":|:":case":||:":n="::";break;case"||":if(cfmt["abc-version"]>="2.2")break;case"[|":case"|]":s.rbstop=2}s.bar_type=n,curvoice.lyric_restart||(curvoice.lyric_restart=s),curvoice.sym_restart||(curvoice.sym_restart=s),sym_link(s),s.st=curvoice.st,s.rbstart&&"["!=n&&!curvoice.norepbra&&s.st>0&&!(par_sy.staves[s.st-1].flags&STOP_BAR)&&(sym_link(e={type:C.BAR,fname:s.fname,istart:s.istart,iend:s.iend,bar_type:"[",multi:0,invis:!0,text:s.text,rbstart:2}),e.st=s.st,delete s.text,s.rbstart=0),s.bar_dotted||s.invis||(curvoice.acc=[])}function parse_staves(e){var t,n,r={},s=[],o=!1,i=0,a=0,c=0,l=0,u=0,f=e.match(/[^[\]|{}()*+\s]+|[^\s]/g);if(f){for(;n=f.shift();)switch(n){case"[":if(l||a+c>=2){syntax(1,errs.misplaced,"["),o=!0;break}i|=a+c==0?OPEN_BRACKET:OPEN_BRACKET2,c++,u<<=8,u|=OPEN_BRACKET;break;case"{":if(l||a||c>=2){syntax(1,errs.misplaced,"{"),o=!0;break}i|=c?OPEN_BRACE2:OPEN_BRACE,a++,u<<=8,u|=OPEN_BRACE;break;case"(":if(l){syntax(1,errs.misplaced,"("),o=!0;break}i|=OPEN_PARENTH,l++,u<<=8,u|=OPEN_PARENTH;break;case"*":!a||l||i&(OPEN_BRACE|OPEN_BRACE2)||(i|=FL_VOICE);break;case"+":i|=MASTER_VOICE;break;case"]":case"}":case")":syntax(1,"Bad voice ID in %%score"),o=!0;break;default:for(t=n;n=f.shift();){switch(n){case"]":if(!(u&OPEN_BRACKET)){syntax(1,errs.misplaced,"]"),o=!0;break}i|=a+--c==0?CLOSE_BRACKET:CLOSE_BRACKET2,u>>=8;continue;case"}":if(!(u&OPEN_BRACE)){syntax(1,errs.misplaced,"}"),o=!0;break}a--,i|=c?CLOSE_BRACE2:CLOSE_BRACE,i&=~FL_VOICE,u>>=8;continue;case")":if(!(u&OPEN_PARENTH)){syntax(1,errs.misplaced,")"),o=!0;break}l--,i|=CLOSE_PARENTH,u>>=8;continue;case"|":i|=STOP_BAR;continue}break}if(r[t]?(syntax(1,"Double voice in %%score"),o=!0):(r[t]=!0,s.push([t,i])),i=0,!n)break;f.unshift(n)}if(0!=u&&(syntax(1,"'}', ')' or ']' missing in %%score"),o=!0),!o&&s.length)return s}else syntax(1,errs.bad_val,"%%score")}function info_split(e){if(!e)return[];var t=e.match(/[^\s"=]+=?|"[^"]+"/g);return t||(syntax(1,"Unterminated string"),[])}Abc.prototype.set_vp=function(e){for(var t,n,r,s,o,i;n=e.shift();){if("="==n.slice(-1)&&!e.length){syntax(1,errs.bad_val,n);break}switch(n){case"clef=":t=e.shift();break;case"clefpitch=":if((n=e.shift())&&(s=ntb.indexOf(n[0]))>=0){switch(n[1]){case"'":s+=7;break;case",":s-=7,","==n[2]&&(s-=7)}o=4-s;break}syntax(1,errs.bad_val,n);break;case"octave=":s=+e.shift(),isNaN(s)?syntax(1,errs.bad_val,n):curvoice.octave=s;break;case"cue=":curvoice.scale="on"==e.shift()?.7:1;break;case"instrument=":if((s=(n=e.shift()).indexOf("/"))<0){if(null==(s=get_interval("c"+n)))break;curvoice.sndtran=s,s=0}else{if(null==(s=get_interval("c"+n.slice(s+1))))break;if(curvoice.sndtran=s,null==(s=get_interval(n.replace("/",""))))break}curvoice.transp=cfmt.sound?curvoice.sndtran:s,i=1;break;case"map=":curvoice.map=e.shift();break;case"name=":case"nm=":curvoice.nm=e.shift(),'"'==curvoice.nm[0]&&(curvoice.nm=cnv_escape(curvoice.nm.slice(1,-1))),curvoice.new_name=!0;break;case"stem=":case"pos=":if(n="pos="==n?e.shift().slice(1,-1).split(" "):["stm",e.shift()],null==(s=posval[n[1]])){syntax(1,errs.bad_val,"%%pos");break}switch(n[2]){case"align":s|=C.SL_ALIGN;break;case"center":s|=C.SL_CENTER;break;case"close":s|=C.SL_CLOSE}r||(r={}),r[n[0]]=s;break;case"scale=":s=+e.shift(),isNaN(s)||s<.5||s>2?syntax(1,errs.bad_val,"%%voicescale"):curvoice.scale=s;break;case"score=":if(cfmt.nedo){syntax(1,errs.notransp);break}if(n=e.shift(),cfmt.sound)break;null!=(s=get_interval(n,!0))&&(curvoice.transp=s,i=1);break;case"shift=":if(cfmt.nedo){syntax(1,errs.notransp);break}null!=(s=get_interval(e.shift()))&&(curvoice.shift=curvoice.sndsh=s,i=1);break;case"sound=":if(cfmt.nedo){syntax(1,errs.notransp);break}if(null==(s=get_interval(e.shift())))break;curvoice.sndtran=s,cfmt.sound&&(curvoice.transp=s),i=1;break;case"subname=":case"sname=":case"snm=":curvoice.snm=e.shift(),'"'==curvoice.snm[0]&&(curvoice.snm=curvoice.snm.slice(1,-1));break;case"stafflines=":null==(s=get_st_lines(e.shift()))?syntax(1,"Bad %%stafflines value"):null!=curvoice.st?par_sy.staves[curvoice.st].stafflines=s:curvoice.stafflines=s;break;case"staffnonote=":s=+e.shift(),isNaN(s)?syntax(1,"Bad %%staffnonote value"):curvoice.staffnonote=s;break;case"staffscale=":s=+e.shift(),isNaN(s)||s<.3||s>2?syntax(1,"Bad %%staffscale value"):curvoice.staffscale=s;break;case"transpose=":if(cfmt.nedo){syntax(1,errs.notransp);break}null==(s=get_transp(e.shift()))?syntax(1,errs.bad_transp):(curvoice.sndtran=s,cfmt.sound&&(curvoice.transp=s),i=1);break;default:switch(n.slice(0,4)){case"treb":case"bass":case"alto":case"teno":case"perc":t=n;break;default:"GFC".indexOf(n[0])>=0?t=n:"="==n.slice(-1)&&e.shift()}}}if(r)for(n in curvoice.pos=clone(curvoice.pos),r)r.hasOwnProperty(n)&&(curvoice.pos[n]=r[n]);t&&(t=new_clef(t))&&(o&&(t.clefpit=o),get_clef(t)),i&&set_transp()};var reg_dur=/(\d*)(\/*)(\d*)/g;function parse_dur(e){var t,n,r;return reg_dur.lastIndex=e.index,(t=reg_dur.exec(e.buffer))[0]?(n=t[1]||1,r=t[3]||1,t[3]||(r*=1<<t[2].length),e.index=reg_dur.lastIndex,[n,r]):[1,1]}function parse_acc_pit(e){var t,n,r,s,o=e.char();switch(o){case"^":"^"==(o=e.next_char())?(n=2,o=e.next_char()):n=1;break;case"=":n=3,o=e.next_char();break;case"_":"_"==(o=e.next_char())?(n=-2,o=e.next_char()):n=-1}if(1!=n&&-1!=n||(o>="1"&&o<="9"||"/"==o)&&(s=parse_dur(e),n<0&&(s[0]=-s[0]),cfmt.nedo&&1==s[1]&&(s[0]*=12,s[1]*=cfmt.nedo),n=s,o=e.char()),r=ntb.indexOf(o)+16,o=e.next_char(),!(r<16)){for(;"'"==o;)r+=7,o=e.next_char();for(;","==o;)r-=7,o=e.next_char();return t={pit:r,shhd:0,shac:0},n&&(t.acc=n),t}syntax(1,"'$1' is not a note",e.buffer[e.index-1])}function set_map(e,t){var n=e.pit,r=not2abc(n,t),s=maps[curvoice.map];(s[r]||s[r="o"+r.replace(/[',]+/,"")]||s[r="k"+ntb[(n+75-11*curvoice.ckey.k_sf)%7]]||s[r="all"])&&(e.map=s=s[r],s[1]&&(e.pit=n=s[1].pit,e.acc=s[1].acc),s[2]&&(e.color=s[2]),(r=s[3])&&(e.midi=pit2mid(r.pit+19,r.acc)))}function parse_basic_note(e,t){var n,r=parse_acc_pit(e);if(r)return"0"==e.char()&&(parse.stemless=!0,e.index++),n=parse_dur(e),r.dur=t*n[0]/n[1],r}function parse_vpos(){var e=parse.line,t=0;switch(a_dcn.length&&"dot"==a_dcn[a_dcn.length-1]&&(t=C.SL_DOTTED,a_dcn.pop()),e.next_char()){case"'":return e.index++,t+C.SL_ABOVE;case",":return e.index++,t+C.SL_BELOW}return t+C.SL_AUTO}function slur_add(e,t){var n,r,s,o,i;for(n=curvoice.sls.length;--n>=0;)if(o=(s=curvoice.sls[n]).note,i=s.is_note,delete s.is_note,o.s!=e.s)return s.note=e,t&&(s.is_note=t),(r=i?o:o.s).sls||(r.sls=[]),r.sls.push(s),curvoice.sls.splice(n,1),i&&(o.s.sl1=!0),s.grace&&(s.grace.sl1=!0),void(e.s.grace&&(e.s.sl2=!0));for(r=e.s.prev;r;r=r.prev)if(r.type==C.BAR&&":"==r.bar_type[0]&&r.text)return r.sls||(r.sls=[]),r.sls.push({note:e,ty:C.SL_AUTO}),void(t&&(r.sls[r.sls.length-1].is_note=t));(r=e.s).sls||(r.sls=[]),r.sls.push({note:e,ty:C.SL_AUTO,loc:"i"})}function pit2mid(e,t){var n,r,s,o,i=[0,2,4,5,7,9,11][e%7],a=12*(e/7|0);if(curvoice.snd_oct&&(a+=curvoice.snd_oct),3==t&&(t=0),!t)return cfmt.temper?cfmt.temper[abc2svg.p_b40[e%7]]+a:i+a;if("object"==typeof t){if(s=t[0]/t[1],100==t[1])return i+a+s}else s=t;if(cfmt.nedo){if("object"!=typeof t)return o=abc2svg.p_b40[e%7]+t,cfmt.temper[o]+a;if(t[1]==cfmt.nedo)return o=abc2svg.p_b40[e%7],cfmt.temper[o]+a+s}else if(!cfmt.temper)return i+=a+s;return n=cfmt.temper[abc2svg.p_b40[e%7]],s>0?(r=cfmt.temper[(abc2svg.p_b40[e%7]+1)%40])<n&&(r+=12):((r=cfmt.temper[(abc2svg.p_b40[e%7]+39)%40])>n&&(r-=12),s=-s),n+a+(r-n)*s}function do_ties(e,t){var n,r,s,o,i,a,c=0,l=t.time+t.dur==curvoice.time;for(r=0;r<=e.nhd;r++)if(i=(o=e.notes[r]).midi,t.type!=C.GRACE){for(n=0;n<=t.nhd;n++)if((s=t.notes[n]).tie_ty&&!(s.midi!=i||l&&s.tie_e)){o.tie_s=s,o.s=e,l&&(s.tie_e=o,s.s=t),c++;break}}else for(a=t.extra;a;a=a.next)if((s=a.notes[0]).tie_ty&&s.midi==i){a.ti1=!0,o.tie_s=s,o.s=e,s.tie_e=o,s.s=a,c++;break}c?e.ti2=!0:error(1,t,"Bad tie")}function tp_adj(e,t){var n=e.time;for(curvoice.time=n+(curvoice.time-n)*t;;){if(e.in_tuplet=!0,e.grace||(e.time=n,e.dur&&(e.dur*=t,n+=e.dur)),!e.next){e.tpe?e.tpe++:e.tpe=1;break}e=e.next}}function get_deco(){for(var e,t=parse.line,n=t.index,r="";;){if(!(e=t.next_char()))return t.index=n,void syntax(1,"No end of decoration");if("!"==e)break;r+=e}null!=ottava[r]?(glovar.ottava=!0,parse.ottava.push(ottava[r])):a_dcn.push(r)}Abc.prototype.new_note=function(e,t){var n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g=[],A=parse.line,_=a_dcn;switch(a_dcn=[],parse.stemless=!1,(r={type:C.NOTE,fname:parse.fname,stem:0,multi:0,nhd:0,xmx:0}).istart=parse.bol+A.index,curvoice.color&&(r.color=curvoice.color),e?r.grace=!0:(curvoice.tie_s&&(a=curvoice.tie_s,curvoice.tie_s=null),a_gch&&csan_add(r),parse.repeat_n&&(r.repeat_n=parse.repeat_n,r.repeat_k=parse.repeat_k,parse.repeat_n=0)),o=A.char()){case"X":r.invis=!0;case"Z":if(r.type=C.MREST,o=A.next_char(),r.nmes=o>"0"&&o<="9"?A.get_int():1,1==curvoice.wmeasure)return void error(1,null,"multi-measure rest, but no measure!");if(r.dur=curvoice.wmeasure*r.nmes,curvoice.second)return delete curvoice.eoln,void(curvoice.time+=r.dur);1==r.nmes?(r.type=C.REST,r.dur_orig=r.dur,r.fmr=1,r.notes=[{pit:18,dur:r.dur}]):glovar.mrest_p=!0;break;case"y":r.type=C.SPACE,r.invis=!0,r.dur=0,o=A.next_char(),r.width=o>="0"&&o<="9"?A.get_int():10,a&&(curvoice.tie_s=a,a=null);break;case"x":r.invis=!0;case"z":r.type=C.REST,A.index++,d=parse_dur(A),r.dur_orig=(curvoice.ulen<0?C.BLEN:curvoice.ulen)*d[0]/d[1],r.dur=r.dur_orig*curvoice.dur_fact,r.dur==curvoice.wmeasure&&(r.fmr=1),r.notes=[{pit:18,dur:r.dur_orig}];break;case"[":s=!0,o=A.next_char();default:for(curvoice.acc_tie&&(c=curvoice.acc_tie,curvoice.acc_tie=null),r.notes=[];;){if(s)for(;o;){if((l=o.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch((i=char_tb[l])[0]){case"(":g.push(parse_vpos()),o=A.char();continue;case"!":i.length>1?a_dcn.push(i.slice(1,-1)):get_deco(),o=A.next_char();continue}break}if(!(n=parse_basic_note(A,r.grace?C.BLEN/4:curvoice.ulen<0?C.BLEN:curvoice.ulen)))return;if(curvoice.octave&&(n.pit+=7*curvoice.octave),h=n.pit+19,(l=n.acc)?curvoice.acc[h]=l:(!(l=curvoice.acc[h])&&c&&(l=c[h]),l||(l=curvoice.ckey.k_map[h%7]||0)),curvoice.map&&maps[curvoice.map]&&set_map(n,l),n.midi||(n.midi=pit2mid(h,l)),curvoice.ckey.k_sndtran&&(n.midi+=abc2svg.b40m(curvoice.ckey.k_sndtran+122)-36),g.length){for(;l=g.shift();)curvoice.sls.push({is_note:!0,note:n,ty:l});n.s=r}if(a_dcn.length&&(r.time=curvoice.time,dh_cnv(r,n)),r.notes.push(n),!s)break;for(o=A.char();;){switch(o){case")":n.s=r,slur_add(n,!0),o=A.next_char();continue;case"-":n.tie_ty=parse_vpos(),n.s=r,curvoice.tie_s=r,r.ti1=!0,(curvoice.acc[h]||c&&c[h])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[h]=curvoice.acc[h]||c[h]),o=A.char();continue;case".":switch(o=A.next_char()){case"-":case"(":a_dcn.push("dot");continue}syntax(1,"Misplaced dot")}break}if("]"==o){for(A.index++,d=parse_dur(A),r.nhd=r.notes.length-1,l=0;l<=r.nhd;l++)(n=r.notes[l]).dur=n.dur*d[0]/d[1];break}}if(t.length)for(;l=t.shift();)r.notes[0].s=r,curvoice.sls.push({note:r.notes[0],ty:l}),e&&(curvoice.sls[curvoice.sls.length-1].grace=e);r.dur_orig=r.notes[0].dur,r.dur=r.notes[0].dur*curvoice.dur_fact}if(!r.grace||r.type==C.NOTE){if(r.notes){if(e){for(m=curvoice.ckey.k_bagpipe?8:4,l=0;l<=r.nhd;l++)r.notes[l].dur/=m;r.dur/=m,r.dur_orig/=m,e.stem&&(r.stem=e.stem)}else{switch(7&curvoice.pos.stm){case C.SL_ABOVE:r.stem=1;break;case C.SL_BELOW:r.stem=-1;break;case C.SL_HIDDEN:r.stemless=!0}if(p=curvoice.brk_rhythm){if(curvoice.brk_rhythm=0,f=curvoice.last_note,p>0){for(u=2*p-1,r.dur=r.dur*u/p,r.dur_orig=r.dur_orig*u/p,l=0;l<=r.nhd;l++)r.notes[l].dur=r.notes[l].dur*u/p;for(f.dur/=p,f.dur_orig/=p,l=0;l<=f.nhd;l++)f.notes[l].dur/=p}else{for(u=2*(p=-p)-1,r.dur/=p,r.dur_orig/=p,l=0;l<=r.nhd;l++)r.notes[l].dur/=p;for(f.dur=f.dur*u/p,f.dur_orig=f.dur_orig*u/p,l=0;l<=f.nhd;l++)f.notes[l].dur=f.notes[l].dur*u/p}for(curvoice.time=f.time+f.dur,f=f.next;f;f=f.next)f.time=curvoice.time}}for(curvoice.last_note=r,o=A.char();;){switch(o){case".":if("-"!=A.buffer[A.index+1])break;a_dcn.push("dot"),A.index++;case"-":for(y=parse_vpos(),l=0;l<=r.nhd;l++)r.notes[l].tie_ty=y,r.notes[l].s=r;for(curvoice.tie_s=e||r,curvoice.tie_s.ti1=!0,l=0;l<=r.nhd;l++)h=(n=r.notes[l]).pit+19,(curvoice.acc[h]||c&&c[h])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[h]=curvoice.acc[h]||c[h]);o=A.char();continue}break}a&&do_ties(r,a)}return sym_link(r),e||(curvoice.lyric_restart||(curvoice.lyric_restart=r),curvoice.sym_restart||(curvoice.sym_restart=r)),_.length&&(a_dcn=_,deco_cnv(r,r.prev)),parse.ottava.length&&(e?e.ottava=parse.ottava:r.ottava=parse.ottava,parse.ottava=[]),parse.stemless&&(r.stemless=!0),r.iend=parse.bol+A.index,r}syntax(1,errs.bad_grace)};var nil="0",char_tb=[nil,nil,nil,nil,nil,nil,nil,nil,nil," ","\n",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil," ","!",'"',"i","\n",nil,"&",nil,"(",")","i",nil,nil,"-","!dot!",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,"|","i","<","n","<","i","i","n","n","n","n","n","n","n","!fermata!","d","d","d","!emphasis!","!lowermordent!","d","!coda!","!uppermordent!","d","d","!segno!","!trill!","d","d","d","n","d","n","[","\\","|","n","n","i","n","n","n","n","n","n","n","d","d","d","d","d","d","d","d","d","d","d","d","d","!upbow!","!downbow!","d","n","n","n","{","|","}","!gmark!",nil],ottava={"8va(":1,"8va)":0,"15ma(":2,"15ma)":0,"8vb(":-1,"8vb)":0,"15mb(":-2,"15mb)":0},sheet;function parse_music_line(){var e,t,n,r,s,o=[],i=-1,a=[],c=parse.line;function l(e){var t,n,r;for(t=1,n=c.index+1;t<e.length;t++,n++)if(e[t]!=c.buffer[n]){if("n"!=e[t])return;if((r=ntb.indexOf(c.buffer[n]))<0)return;for(;"'"==c.buffer[n+1];)r+=7,n++;for(;","==c.buffer[n+1];)r-=7,n++}return c.index=n,r}function u(e){for(var t="";e<0;)e+=7,t+=",";for(;e>=14;)e-=7,t+="'";return ntb[e]+t}function f(e,t){if(null==t)return e;var n,r,s="",o=e.length;for(r=0;r<o;r++)s+=(n=e[r])>="h"&&n<="z"?u(t+n.charCodeAt(0)-"n".charCodeAt(0)):n;return s}function d(e,t,n){var r,s,o,i,a=c,l=parse.istart;if(parse.line=c=new scanBuf,parse.istart+=a.index,cfmt.writefields.indexOf("m")<0){for(c.buffer=e.replace("n",u(n)),i=curvoice.last_sym,s=curvoice.time,p(!0),i||(i=curvoice.sym),i=i.next;i;i=i.next)i.noplay=!0;for(r=curvoice.time,curvoice=clone_voice((o=curvoice).id+"-p"),par_sy.voices[curvoice.v]||(curvoice.second=!0,par_sy.voices[curvoice.v]={st:o.st,second:!0,range:curvoice.v}),curvoice.time=s,i=curvoice.last_sym,parse.line=c=new scanBuf,parse.istart+=a.index,c.buffer=f(t,n),p(!0),curvoice.time!=r&&syntax(1,"Bad length of the macro sequence"),i||(i=curvoice.sym);i;i=i.next)i.invis=i.play=!0;curvoice=o}else c.buffer=f(t,n),p(!0);parse.line=c=a,parse.istart=l}function p(u){for(var f,p,h,m,y,g,A,_;f=c.char();){if(!u&&maci[f]){for(m in A=void 0,mac)if(mac.hasOwnProperty(m)&&m[0]==f){if(m.indexOf("n")<0){if(c.buffer.indexOf(m,c.index)!=c.index)continue;c.index+=m.length}else if(null==(A=l(m)))continue;d(m,mac[m],A),A=1;break}if(A)continue}if((p=f.charCodeAt(0))>=128){syntax(1,errs.not_ascii),c.index++;break}switch((h=char_tb[p])[0]){case" ":(y=curvoice.last_note)&&(y.beam_end=!0,e&&(e.gr_shift=!0));break;case"\n":if(cfmt.barsperstaff)break;curvoice.eoln=!0;break;case"&":if(e){syntax(1,errs.bad_grace);break}if(")"==(f=c.next_char())){get_vover(f);break}get_vover("&");continue;case"(":if((f=c.next_char())>"0"&&f<="9"){if(e){syntax(1,errs.bad_grace);break}var v=c.get_int(),b=qplet_tb[v],x=v;if(":"==(f=c.char())&&((f=c.next_char())>"0"&&f<="9"&&(b=c.get_int(),f=c.char()),":"==f)){if(!((f=c.next_char())>"0"&&f<="9")){syntax(1,"Invalid 'r' in tuplet");continue}x=c.get_int(),f=c.char()}0!=b&&null!=b||(b=curvoice.wmeasure%9==0?3:2),i<0&&(i=o.length),o.push({p:v,q:b,r:x,ro:x,f:curvoice.tup||cfmt.tuplets});continue}if("&"==f){if(e){syntax(1,errs.bad_grace);break}get_vover("(");break}c.index--,a.push(parse_vpos());continue;case")":if(y=curvoice.last_sym)switch(y.type){case C.SPACE:y.notes||(y.notes=[],y.notes[0]={});case C.NOTE:case C.REST:break;case C.GRACE:for(y=y.extra;y.next;y=y.next);break;default:y=null}if(!y){syntax(1,errs.bad_char,f);break}y.notes[0].s=y,slur_add(y.notes[0]);break;case"!":h.length>1?a_dcn.push(h.slice(1,-1)):get_deco();break;case'"':if(e){syntax(1,errs.bad_grace);break}parse_gchord(h);break;case"[":if(h.length>1){self.do_pscom(h.slice(3,-1));break}var w=c.buffer[c.index+1];if('|[]: "'.indexOf(w)>=0||w>="1"&&w<="9"){if(e){syntax(1,errs.bar_grace);break}new_bar();continue}if(":"==c.buffer[c.index+2]){if(e){syntax(1,errs.bad_grace);break}if((g=c.buffer.indexOf("]",c.index+1))<0){syntax(1,"Lack of ']'");break}_=c.buffer.slice(c.index+3,g).trim(),parse.istart=parse.bol+c.index,parse.iend=parse.bol+ ++g,c.index=0,do_info(w,_),c.index=g;continue}case"n":if(!(y=self.new_note(e,a)))continue;if(e||!y.notes)continue;if(i>=0)y.tp=o.slice(i),i=-1,s&&(y.tp[0].s=s),s=y;else if(!s)continue;if(--(m=o[o.length-1]).r>0)continue;for(;;){if(tp_adj(s,m.q/m.p),g=m.ro,m.s&&(s=m.s),o.pop(),!o.length){s=null;break}if((m=o[o.length-1]).r-=g,m.r>0)break}continue;case"<":if(!curvoice.last_note){syntax(1,"No note before '<'");break}if(e){syntax(1,"Cannot have a broken rhythm in grace notes");break}for(A="<"==f?1:-1;"<"==f||">"==f;)A*=2,f=c.next_char();curvoice.brk_rhythm=A;continue;case"i":break;case"{":if(e){syntax(1,"'{' in grace note");break}switch(t=curvoice.last_note,curvoice.last_note=null,n=a_dcn,a_dcn=[],e={type:C.GRACE,fname:parse.fname,istart:parse.bol+c.index,dur:0,multi:0},curvoice.color&&(e.color=curvoice.color),7&curvoice.pos.gst){case C.SL_ABOVE:e.stem=1;break;case C.SL_BELOW:e.stem=-1;break;case C.SL_HIDDEN:e.stem=2}if(sym_link(e),"/"==(f=c.next_char())){e.sappo=!0;break}continue;case"|":if(e){syntax(1,errs.bar_grace);break}new_bar();continue;case"}":if(curvoice.ignore){e=null;break}if(y=curvoice.last_note,!e||!y){syntax(1,errs.bad_char,f);break}if(a_dcn.length&&syntax(1,"Decoration ignored"),e.extra=e.next,e.extra.prev=null,e.next=null,curvoice.last_sym=e,e=null,!y.prev&&!curvoice.ckey.k_bagpipe){for(g=0;g<=y.nhd;g++)y.notes[g].dur*=2;y.dur*=2,y.dur_orig*=2}curvoice.last_note=t,a_dcn=n;break;case"\\":if(!c.buffer[c.index+1]){r=!0;break}default:syntax(1,errs.bad_char,f)}c.index++}}3==parse.state&&(parse.tp&&(o=parse.tp,i=parse.tpn,s=parse.tps,parse.tp=null),p(),o.length&&(parse.tp=o,parse.tps=s,parse.tpn=i),a.length&&syntax(1,"Start of slur without note"),e&&(syntax(1,"No end of grace note sequence"),curvoice.last_sym=e.prev,curvoice.last_note=t,e.prev&&(e.prev.next=null)),r||cfmt.barsperstaff||vover||"\n"!=char_tb["\n".charCodeAt(0)]||(curvoice.eoln=!0),curvoice.eoln&&cfmt.breakoneoln&&curvoice.last_note&&(curvoice.last_note.beam_end=!0))}var add_fstyle="undefined"!=typeof document?function(e){var t;if(cfmt.fullsvg&&(font_style+="\n"+e),!sheet)if(abc2svg.sheet)for(t=(sheet=abc2svg.sheet).cssRules.length;--t>=0;)sheet.deleteRule(t);else t=document.createElement("style"),document.head.appendChild(t),abc2svg.sheet=sheet=t.sheet;for(e=e.match(/[^{]+{[^}]+}/g);t=e.shift();)sheet.insertRule(t,sheet.cssRules.length)}:function(e){font_style+="\n"+e},sw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.25,.333,.408,.5,.5,.833,.778,.333,.333,.333,.5,.564,.25,.564,.25,.278,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.278,.278,.564,.564,.564,.444,.921,.722,.667,.667,.722,.611,.556,.722,.722,.333,.389,.722,.611,.889,.722,.722,.556,.722,.667,.556,.611,.722,.722,.944,.722,.722,.611,.333,.278,.333,.469,.5,.333,.444,.5,.444,.5,.444,.333,.5,.5,.278,.278,.5,.278,.778,.5,.5,.5,.5,.333,.389,.278,.5,.5,.722,.5,.5,.444,.48,.2,.48,.541,.5]),ssw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.278,.278,.355,.556,.556,.889,.667,.191,.333,.333,.389,.584,.278,.333,.278,.278,.556,.556,.556,.556,.556,.556,.556,.556,.556,.556,.278,.278,.584,.584,.584,.556,1.015,.667,.667,.722,.722,.667,.611,.778,.722,.278,.5,.667,.556,.833,.722,.778,.667,.778,.722,.667,.611,.722,.667,.944,.667,.667,.611,.278,.278,.278,.469,.556,.333,.556,.556,.5,.556,.556,.278,.556,.556,.222,.222,.5,.222,.833,.556,.556,.556,.556,.333,.5,.278,.556,.5,.722,.5,.5,.5,.334,.26,.334,.584,.512]),cw_tb=sw_tb;function cwid(e){var t=e.charCodeAt(0);if(t>=128){if(t>=768&&t<880)return 0;t=97}return cw_tb[t]}function cwidf(e){return cwid(e)*gene.curfont.swfac}var strwh="undefined"!=typeof document?(el=document.createElement("text"),el.style.position="absolute",el.style.top="-1000px",el.style.padding="0",document.body.appendChild(el),function(e){if(e.wh)return e.wh;var t,n=gene.curfont,r=n.size,s=0,o=(e.length,0),i=0;if(el.className=font_class(n),el.style.lineHeight=1,"object"==typeof e)return el.innerHTML=e,e.wh=[el.clientWidth,el.clientHeight],e.wh;for(e=e.replace(/<|>|&[^&\s]*?;|&/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;"}return e}));!((i=e.indexOf("$",i))<0);){if("0"==(t=e[i+1]))n=gene.deffont;else{if(!(t>="1"&&t<="9")){i++;continue}n=get_font("u"+t)}el.innerHTML=e.slice(o,i),s+=el.clientWidth,n.size>r&&(r=n.size),el.style.font=style_font(n).slice(5),o=i+=2}return el.innerHTML=e.slice(o),[s+=el.clientWidth,r]}):function(e){var t,n,r,s=gene.curfont,o=s.swfac,i=s.size,a=0,c=e.length;for(t=0;t<c;t++){switch(r=e[t]){case"$":if("0"==(r=e[t+1]))s=gene.deffont;else{if(!(r>="1"&&r<="9")){r="$";break}s=get_font("u"+r)}t++,o=s.swfac,s.size>i&&(i=s.size);continue;case"&":if(" "==e[t+1])break;(n=e.indexOf(";",t))>0&&n-t<10&&(t=n,r="a")}a+=cwid(r)*o}return[a,i]},el;function str2svg(e){if("object"==typeof e)return e;var t,n=gene.deffont,r=gene.curfont,s="";function o(e,t){return'<tspan\n\tclass="'+(e.class&&e.name==t.name&&e.size==t.size&&e.weight==t.weight&&e.style==t.style?e.class:font_class(e))+'">'}return r!=n&&(s=o(r,n)),s+=e.replace(/<|>|&[^&\s]*?;|&|\$./g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:if("$"!=e[0])break;if("0"==e[1])t=gene.deffont;else{if(!(e[1]>="1"&&e[1]<="9"))break;t=get_font("u"+e[1])}return e="",t==r?e:(r!=n&&(e="</tspan>"),(r=t)==n?e:e+o(r,n))}return e})),r!=n&&(s+="</tspan>"),s=new String(s),"undefined"!=typeof document?strwh(s):s.wh=strwh(e),gene.curfont=r,s}function set_font(e){"string"==typeof e&&(e=get_font(e)),cw_tb="sans"==e.name.slice(0,4)?ssw_tb:sw_tb,gene.curfont=gene.deffont=e}function out_str(e){output+=str2svg(e)}function xy_str(e,t,n,r,s,o){switch(o||(o=n.wh||strwh(n)),output+='<text class="'+font_class(gene.deffont),"j"!=r&&n.length>5&&gene.deffont.wadj&&(output+='" lengthAdjust="'+gene.deffont.wadj+'" textLength="'+o[0].toFixed(1)),output+='" x="',out_sxsy(e,'" y="',t+.2*o[1]),r){case"c":e-=o[0]/2,output+='" text-anchor="middle">';break;case"j":output+='" textLength="'+s.toFixed(1)+'">';break;case"r":e-=o[0],output+='" text-anchor="end">';break;default:output+='">'}out_str(n),output+="</text>\n"}function trim_title(e,t){var n;return cfmt.titletrim&&((n=e.lastIndexOf(", "))<0||e[n+2]<"A"||e[n+2]>"Z"?n=0:1==cfmt.titletrim?(n<e.length-7||e.indexOf(" ",n+3)>=0)&&(n=0):n<e.length-cfmt.titletrim-2&&(n=0),n&&(e=e.slice(n+2).trim()+" "+e.slice(0,n))),!t&&cfmt.writefields.indexOf("X")>=0&&(e=info.X+".  "+e),cfmt.titlecaps?e.toUpperCase():e}function get_lwidth(){return(img.width-img.lm-img.rm-2)/cfmt.scale}function write_title(e,t){var n,r;e&&(set_page(),e=trim_title(e,t),t?(set_font("subtitle"),n=cfmt.subtitlespace):(set_font("title"),n=cfmt.titlespace),(r=strwh(e))[1]+=2*gene.curfont.pad,vskip(r[1]+n+gene.curfont.pad),n=gene.curfont.pad,cfmt.titleleft?xy_str(0,n,e,null,null,r):xy_str(get_lwidth()/2,n,e,"c",null,r))}function put_inf2r(e,t,n,r,s){if(!n){if(!r)return;n=r,r=null}xy_str(e,t,r?n+" ("+r+")":n,s)}function write_text(e,t){if("s"!=t){set_page();var n,r,s,o,i,a,c,l,u,f,d=get_lwidth(),p=gene.curfont.size,h=p*cfmt.lineskipfac,m=p*cfmt.parskipfac;switch(t){default:switch(r=gene.curfont,t){case"c":i=d/2;break;case"r":i=d-r.pad;break;default:i=r.pad}for(o=0;;){if((s=e.indexOf("\n",o))==o){for(vskip(m),blk_flush(),use_font(gene.curfont);"\n"==e[s+1];)vskip(h),s++;if(s==e.length)break}else if(f=s<0?e.slice(o):e.slice(o,s),vskip(strwh(f)[1]*cfmt.lineskipfac+2*r.pad),xy_str(i,r.pad,f,t),s<0)break;o=s+1}vskip(m),blk_flush();break;case"f":case"j":for(o=0;;){for(a=(a=(s=e.indexOf("\n\n",o))<0?e.slice(o):e.slice(o,s)).split(/\s+/),c=l=n=0,o=0;o<a.length;o++)(c+=(u=strwh(a[o]+"&#x00a0;"))[0])>=d&&(vskip(n*cfmt.lineskipfac),xy_str(0,0,a.slice(l,o).join(" "),t,d),l=o,c=u[0],n=0),u[1]>n&&(n=u[1]);if(0!=c&&(vskip(n*cfmt.lineskipfac),xy_str(0,0,a.slice(l).join(" "))),vskip(m),blk_flush(),s<0)break;for(;"\n"==e[s+2];)vskip(h),s++;if(s==e.length)break;use_font(gene.curfont),o=s+2}}}}function put_words(e){var t,n,r,s,o,i,a,c,l,u,f,d=0,p=1;function h(e,t){var n=0,r=0;if("$"==e[0]&&e[1]>="0"&&e[1]<="9"&&(gene.curfont="0"==e[1]?gene.deffont:get_font("u"+e[1]),e=e.slice(2)),e[n]>="0"&&e[n]<="9"||"."==e[n+1]){for(;n<e.length&&" "!=e[++n]&&":"!=e[n-1]&&"."!=e[n-1];);for(r=n;" "==e[n];)n++}0!=r&&xy_str(t,0,e.slice(0,r),"r"),n<e.length&&xy_str(t+5,0,e.slice(n),"l")}for(set_font("words"),vskip(cfmt.wordsspace),svg_flush(),s=(e=e.split("\n")).length,n=0;n<s;n++)if(t=e[n])t.length>d&&(d=t.length,l=n);else{for(;n+1<s&&!e[n+1];)n++;p++}if(o=get_lwidth()/2,i=strwh(e[l])[0],l=u=0,i<o){for(r=p>>1,n=0;n<s;n++)if(!(t=e[n])){for(--r<=0&&(l=n);n+1<s&&!e[n+1];)n++;if(r<=0){u=n+1;break}}p>>=1}for(c=u?(a=(o-i)/2+10)+o:o-i/2+10,f=!0,n=0;n<l||u<s;n++,u++)vskip(cfmt.lineskipfac*gene.curfont.size),n<l&&((t=e[n])?h(t,a):use_font(gene.curfont)),u<s&&((t=e[u])?h(t,c):0==--p&&(n<l?p++:u<s-1&&(c=o-i/2+10,svg_flush()))),e[n+1]||e[u+1]?f=!0:f&&(svg_flush(),f=!1)}function put_history(){var e,t,n,r,s,o,i,a,c,l=cfmt.infoname.split("\n"),u=l.length;for(e=0;e<u;e++)if(n=l[e][0],!(cfmt.writefields.indexOf(n)<0)&&(r=info[n])){for(s||(s=!0,set_font("history"),vskip(cfmt.textspace),o=gene.curfont.size*cfmt.lineskipfac),'"'==(c=l[e].slice(2))[0]&&(c=c.slice(1,-1)),vskip(o),xy_str(0,0,c,null,null,a=strwh(c)),xy_str(i=a[0],0,(r=r.split("\n"))[0]),t=1;t<r.length;t++)vskip(o),xy_str(i,0,r[t]);vskip(.3*o),use_font(gene.curfont)}}var info_font_init={A:"info",C:"composer",O:"composer",P:"parts",Q:"tempo",R:"info",T:"title",X:"title"};function write_headform(e){for(var t,n,r,s,o,i,a,c,l={},u=Object.create(info_font_init),f={A:cfmt.infospace,C:cfmt.composerspace,O:cfmt.composerspace,R:cfmt.infospace},d={},p="",h=cfmt.titleformat,m=0,y=0;;){for(;" "==h[y];)y++;if(!(t=h[y++]))break;if(t<"A"||t>"Z")switch(t){case"+":s="+",t=h[y++];break;case",":p+="\n";default:continue;case"<":s="l",t=h[y++];break;case">":s="r",t=h[y++]}else switch(h[y]){case"-":s="l",y++;break;case"1":s="r",y++;break;case"0":y++;default:s="c"}if(l[t])d[t]++;else{if(!info[t])continue;l[t]=info[t].split("\n"),d[t]=1}p+=s+t}p+="\n";var g,A={l:cfmt.titlespace,c:cfmt.titlespace,r:cfmt.titlespace},_={l:0,c:.5*e,r:e},v={};for(h=p,y=0;;){for(v.l=v.c=v.r=i=0,m=y;"\n"!=(s=h[m++]);)t=h[m++],"+"==s||v[s]||(g=l[t])&&((r=u[t])||(r="history"),a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),i<a&&(i=a),v[s]=a);for(A.l+=i-v.l,A.c+=i-v.c,A.r+=i-v.r;"\n"!=(s=h[y++]);)if(l[t=h[y++]].length){if(g=l[t].shift(),"+"==h[y]&&(d[t]--,y++,l[t=h[y++]].length&&(g?g+=" "+l[t].shift():g=" "+l[t].shift())),(r=u[t])||(r="history"),a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),set_font(n),o=_[s],i=A[s]+a,"Q"==t?(self.set_width(glovar.tempo),glovar.tempo.invis||("l"!=s&&(tempo_build(glovar.tempo),c=glovar.tempo.tempo_wh[0],"c"==s&&(c*=.5),o-=c),writempo(glovar.tempo,o,-i))):g&&("T"==t&&(g=trim_title(g,"s"==u.T[0])),xy_str(o,-i,g,s)),"T"==t&&(r=u.T="subtitle",f.T=cfmt.subtitlespace),d[t]<=1)for("T"==t&&(a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),set_font(n));l[t].length>0;)xy_str(o,-(i+=a),g=l[t].shift(),s);d[t]--,A[s]=i}if(A.c>A.l&&(A.l=A.c),A.r>A.l&&(A.l=A.r),y>=h.length)break;A.c=A.r=A.l}vskip(A.l)}function write_heading(){var e,t,n,r,s,o,i,a,c=get_lwidth();if(vskip(cfmt.topspace),cfmt.titleformat)return write_headform(c),void vskip(cfmt.musicspace);if(info.T&&cfmt.writefields.indexOf("T")>=0)for(e=0;;){if((t=info.T.indexOf("\n",e))<0){write_title(info.T.substring(e),0!=e);break}write_title(info.T.slice(e,t),0!=e),e=t+1}if(i=a=0,parse.ckey.k_bagpipe&&!cfmt.infoline&&cfmt.writefields.indexOf("R")>=0&&(o=info.R),o&&(set_font("composer"),xy_str(0,-cfmt.composerspace,o),i=cfmt.composerspace),n=info.A,cfmt.writefields.indexOf("C")>=0&&(r=info.C),cfmt.writefields.indexOf("O")>=0&&(s=info.O),r||s||cfmt.infoline){var l,u;if(set_font("composer"),vskip(cfmt.composerspace),cfmt.aligncomposer<0?(l=0,u=" "):0==cfmt.aligncomposer?(l=.5*c,u="c"):(l=c,u="r"),a=i,r||s){for(cfmt.aligncomposer>=0&&i!=a&&vskip(i-a),e=0;;){if(vskip(gene.curfont.size),(t=r?r.indexOf("\n",e):-1)<0){put_inf2r(l,0,r?r.substring(e):null,s,u);break}xy_str(l,0,r.slice(e,t),u),i+=gene.curfont.size,e=t+1}a>i&&vskip(a-i)}((o=o?null:info.R)||n)&&cfmt.infoline&&(set_font("info"),vskip(gene.curfont.size+cfmt.infospace),put_inf2r(c,0,o,n,"r"),i+=gene.curfont.size+cfmt.infospace)}else a=cfmt.composerspace;info.P&&cfmt.writefields.indexOf("P")>=0&&(set_font("parts"),(i=cfmt.partsspace+gene.curfont.size-i)>0&&(a+=i),a>.01&&vskip(a),xy_str(0,0,info.P),a=0),vskip(a+cfmt.musicspace)}var output="",style="\n.stroke{stroke:currentColor;fill:none}\n.bW{stroke:currentColor;fill:none;stroke-width:1}\n.bthW{stroke:currentColor;fill:none;stroke-width:3}\n.slW{stroke:currentColor;fill:none;stroke-width:.7}\n.slthW{stroke:currentColor;fill:none;stroke-width:1.5}\n.sW{stroke:currentColor;fill:none;stroke-width:.7}\n.box{outline:1px solid black;outline-offset:1px}",font_style="",posx=cfmt.leftmargin/cfmt.scale,posy=0,img={width:cfmt.pagewidth,lm:cfmt.leftmargin,rm:cfmt.rightmargin},defined_glyph={},defs="",fulldefs="",stv_g={scale:1,dy:0,st:-1,v:-1,g:0},blkdiv=0,tgls={"mtr ":{x:0,y:0,c:" "},brace:{x:0,y:0,c:""},lphr:{x:0,y:23,c:""},mphr:{x:0,y:23,c:""},sphr:{x:0,y:26,c:""},short:{x:0,y:32,c:""},tick:{x:0,y:29,c:""},rdots:{x:-1,y:0,c:""},dsgn:{x:-4,y:-4,c:""},dcap:{x:-4,y:-4,c:""},sgno:{x:-6,y:0,c:""},coda:{x:-12,y:-6,c:""},tclef:{x:-8,y:0,c:""},cclef:{x:-8,y:0,c:""},bclef:{x:-8,y:0,c:""},pclef:{x:-6,y:0,c:""},spclef:{x:-6,y:0,c:""},stclef:{x:-8,y:0,c:""},scclef:{x:-8,y:0,c:""},sbclef:{x:-7,y:0,c:""},oct:{x:0,y:2,c:""},oct2:{x:0,y:2,c:""},mtr0:{x:0,y:0,c:""},mtr1:{x:0,y:0,c:""},mtr2:{x:0,y:0,c:""},mtr3:{x:0,y:0,c:""},mtr4:{x:0,y:0,c:""},mtr5:{x:0,y:0,c:""},mtr6:{x:0,y:0,c:""},mtr7:{x:0,y:0,c:""},mtr8:{x:0,y:0,c:""},mtr9:{x:0,y:0,c:""},mtrC:{x:0,y:0,c:""},"mtr+":{x:0,y:0,c:""},"mtr(":{x:0,y:0,c:""},"mtr)":{x:0,y:0,c:""},HDD:{x:-7,y:0,c:""},breve:{x:-7,y:0,c:""},HD:{x:-5.2,y:0,c:""},Hd:{x:-3.8,y:0,c:""},hd:{x:-3.7,y:0,c:""},ghd:{x:2,y:0,c:"",sc:.66},pshhd:{x:-3.7,y:0,c:""},pfthd:{x:-3.7,y:0,c:""},x:{x:-3.7,y:0,c:""},"circle-x":{x:-3.7,y:0,c:""},srep:{x:-5,y:0,c:""},"dot+":{x:-5,y:0,sc:.7,c:""},diamond:{x:-4,y:0,c:""},triangle:{x:-4,y:0,c:""},dot:{x:-1,y:0,c:""},flu1:{x:-.3,y:0,c:""},fld1:{x:-.3,y:0,c:""},flu2:{x:-.3,y:0,c:""},fld2:{x:-.3,y:0,c:""},flu3:{x:-.3,y:3.5,c:""},fld3:{x:-.3,y:-4,c:""},flu4:{x:-.3,y:8,c:""},fld4:{x:-.3,y:-9,c:""},flu5:{x:-.3,y:12.5,c:""},fld5:{x:-.3,y:-14,c:""},"acc-1":{x:-1,y:0,c:""},"cacc-1":{x:-18,y:0,c:""},"sacc-1":{x:-1,y:0,sc:.7,c:""},acc3:{x:-1,y:0,c:""},cacc3:{x:-18,y:0,c:""},sacc3:{x:-1,y:0,sc:.7,c:""},acc1:{x:-2,y:0,c:""},cacc1:{x:-18,y:0,c:""},sacc1:{x:-2,y:0,sc:.7,c:""},acc2:{x:-3,y:0,c:""},"acc-2":{x:-3,y:0,c:""},"acc-1_2":{x:-2,y:0,c:""},"acc-3_2":{x:-3,y:0,c:""},acc1_2:{x:-1,y:0,c:""},acc3_2:{x:-3,y:0,c:""},accent:{x:-3,y:2.5,c:""},stc:{x:-1,y:-2,c:""},emb:{x:-4,y:-2,c:""},wedge:{x:-1,y:0,c:""},marcato:{x:-3,y:-2,c:""},hld:{x:-7,y:-2,c:""},brth:{x:0,y:0,c:""},caes:{x:0,y:8,c:""},r00:{x:-1.5,y:0,c:""},r0:{x:-1.5,y:0,c:""},r1:{x:-3.5,y:-6,c:""},r2:{x:-3.2,y:0,c:""},r4:{x:-3,y:0,c:""},r8:{x:-3,y:0,c:""},r16:{x:-4,y:0,c:""},r32:{x:-4,y:0,c:""},r64:{x:-4,y:0,c:""},r128:{x:-4,y:0,c:""},mrep:{x:-6,y:0,c:""},mrep2:{x:-9,y:0,c:""},p:{x:-4,y:-6,c:""},f:{x:-2.5,y:-6,c:""},pppp:{x:-15,y:-6,c:""},ppp:{x:-11,y:-6,c:""},pp:{x:-8,y:-6,c:""},mp:{x:-8.5,y:-6,c:""},mf:{x:-8,y:-6,c:""},ff:{x:-6,y:-6,c:""},fff:{x:-9,y:-6,c:""},ffff:{x:-12,y:-6,c:""},sfz:{x:-9,y:-6,c:""},trl:{x:-4,y:-2,c:""},turn:{x:-5,y:3,c:""},turnx:{x:-5,y:3,c:""},umrd:{x:-7,y:2,c:""},lmrd:{x:-7,y:2,c:""},dplus:{x:-4,y:0,c:""},sld:{x:-8,y:12,c:""},grm:{x:-2,y:0,c:""},dnb:{x:-4,y:0,c:""},upb:{x:-3,y:0,c:""},opend:{x:-2,y:0,c:""},roll:{x:0,y:2,c:""},thumb:{x:0,y:0,c:""},snap:{x:-2,y:0,c:""},ped:{x:-10,y:0,c:""},pedoff:{x:-5,y:0,c:""},mtro:{x:0,y:0,c:""},mtrc:{x:0,y:0,c:""},"mtr.":{x:0,y:0,c:""},"mtr|":{x:0,y:0,c:""},longa:{x:-4.7,y:0,c:""},custos:{x:-4,y:3,c:""},ltr:{x:2,y:6,c:""}},glyphs={};function m_gl(e){return e.replace(/[Cco]\||[co]\.|./g,(function(e){var t=tgls["mtr"+e];return t?t.c:0}))}function def_use(e){var t,n,r;if(!defined_glyph[e])if(defined_glyph[e]=!0,r=glyphs[e]){for(n=0;!((t=r.indexOf('xlink:href="#',n))<0);)t+=13,n=r.indexOf('"',t),def_use(r.slice(t,n));defs+="\n"+r}else error(1,null,"Unknown glyph: '$1'",e)}function defs_add(e){var t,n,r,s,o,i=0;for(e=e.replace(/<!--.*?-->/g,"");!((o=e.indexOf("<",i))<0||(t=e.indexOf('id="',o))<0||(t+=4,(n=e.indexOf('"',t))<0)||(r=e.slice(t,n),(i=e.indexOf(">",n))<0));){if("/"==e[i-1])i++;else{if((t=e.indexOf(" ",o))<0)break;if(s=e.slice(o+1,t),(i=e.indexOf("</"+s+">",i))<0)break;i+=3+s.length}"<filter"==e.substr(o,7)?fulldefs+=e.slice(o,i)+"\n":glyphs[r]=e.slice(o,i)}}function set_g(){stv_g.started&&(stv_g.started=!1,glout(),output+="</g>\n"),(1!=stv_g.scale||stv_g.color)&&(glout(),output+="<g ",1!=stv_g.scale&&(stv_g.st<0?output+=voice_tb[stv_g.v].scale_str:stv_g.v<0?output+=staff_tb[stv_g.st].scale_str:output+='transform="translate(0,'+(posy-stv_g.dy).toFixed(1)+") scale("+stv_g.scale.toFixed(2)+')"'),stv_g.color&&(1!=stv_g.scale&&(output+=" "),output+='color="'+stv_g.color+'"'),output+=">\n",stv_g.started=!0)}function set_color(e){if(e!=stv_g.color){var t=stv_g.color;return stv_g.color=e,set_g(),t}}function set_sscale(e){var t,n;e!=stv_g.st&&1!=stv_g.scale&&(stv_g.scale=0),t=e>=0?staff_tb[e].staffscale:1,n=e>=0&&1!=t?staff_tb[e].y:posy,t==stv_g.scale&&n==stv_g.dy||(stv_g.scale=t,stv_g.dy=n,stv_g.st=e,stv_g.v=-1,set_g())}function set_scale(e){var t,n=e.p_v.scale;1!=n?(t=posy,1!=staff_tb[e.st].staffscale&&(n*=staff_tb[e.st].staffscale,t=staff_tb[e.st].y),n==stv_g.scale&&stv_g.dy==posy||(stv_g.scale=n,stv_g.dy=t,stv_g.st=1==staff_tb[e.st].staffscale?-1:e.st,stv_g.v=e.v,set_g())):set_sscale(e.st)}function set_dscale(e,t){output&&(stv_g.started&&(stv_g.started=!1,glout(),output+="</g>\n"),stv_g.st<0?staff_tb[0].output+=output:1==stv_g.scale?staff_tb[stv_g.st].output+=output:staff_tb[stv_g.st].sc_out+=output,output=""),stv_g.scale=e<0||t?1:staff_tb[e].staffscale,stv_g.st=e,stv_g.dy=0}function delayed_update(){var e;for(e=0;e<=nstaff;e++)staff_tb[e].sc_out&&(output+="<g "+staff_tb[e].scale_str+">\n"+staff_tb[e].sc_out+"</g>\n",staff_tb[e].sc_out=""),staff_tb[e].output&&(output+='<g transform="translate(0,'+(-staff_tb[e].y).toFixed(1)+')">\n'+staff_tb[e].output+"</g>\n",staff_tb[e].output="")}function anno_out(e,t,n){if(null!=e.istart){var r=e.type,s=e.ymx-e.ymn+4,o=e.wl||2,i=e.wr||2;e.grace&&(r=C.GRACE),n(t||abc2svg.sym_name[r],e.istart,e.iend,e.x-o-2,staff_tb[e.st].y+e.ymn+s-2,o+i+4,s,e)}}function a_start(e,t){anno_out(e,t,user.anno_start)}function a_stop(e,t){anno_out(e,t,user.anno_stop)}function empty_function(){}var anno_start=empty_function,anno_stop=empty_function;function anno_put(){for(var e;e=anno_a.shift();){switch(e.type){case C.CLEF:case C.METER:case C.KEY:case C.REST:if(e.type!=C.REST||e.rep_nb){set_sscale(e.st);break}case C.GRACE:case C.NOTE:case C.MREST:set_scale(e)}anno_stop(e)}}function out_XYAB(e,t,n,r,s){t=sx(t),n=sy(n),output+=e.replace(/X|Y|A|B|F|G/g,(function(e){switch(e){case"X":return t.toFixed(1);case"Y":return n.toFixed(1);case"A":return r;case"B":return s;case"F":return r.toFixed(1);default:return s.toFixed(1)}}))}function g_open(e,t,n,r,s){glout(),out_XYAB('<g transform="translate(X,Y',e,t),n&&(output+=") rotate("+n.toFixed(2)),r&&(output+=s?") scale("+r.toFixed(2)+", "+s.toFixed(2):") scale("+r.toFixed(2)),output+=')">\n',stv_g.g++}function g_close(){glout(),stv_g.g--,output+="</g>\n"}function sx(e){return stv_g.g?e:(e+posx)/stv_g.scale}function sy(e){return stv_g.g?-e:1==stv_g.scale?posy-e:stv_g.v>=0?(stv_g.dy-e)/voice_tb[stv_g.v].scale:stv_g.dy-e}function out_sxsy(e,t,n){e=sx(e),n=sy(n),output+=e.toFixed(1)+t+n.toFixed(1)}function xypath(e,t,n){out_XYAB(n?'<path d="mX Y':'<path class="stroke" d="mX Y',e,t)}function draw_all_hl(){var e,t;function n(e,n){var r,s,o,i,a,c,l=e.length;if(l)for(o=0;o<l;o++)if((s=e[o])&&s.length){for(i=sx(s[0][0]),output+='<path class="stroke" stroke-width="1" d="M'+i.toFixed(1)+" "+sy(t.y+n*o).toFixed(1),a=0;r=s.shift();)c=sx(r[0]),output+="m"+(c-i+r[1]-a).toFixed(2)+" 0h"+(-r[1]+r[2]).toFixed(2),i=c,a=r[2];output+='"/>\n'}}for(e=0;e<=nstaff;e++)(t=staff_tb[e]).hlu&&(set_sscale(e),n(t.hlu,6),n(t.hld,-6))}Abc.prototype.out_svg=function(e){output+=e},Abc.prototype.sx=sx,Abc.prototype.sy=sy,Abc.prototype.sh=function(e){return stv_g.st<0?e/stv_g.scale:e},Abc.prototype.ax=function(e){return e+posx},Abc.prototype.ay=function(e){return stv_g.st<0?posy-e:posy+(stv_g.dy-e)*stv_g.scale-stv_g.dy},Abc.prototype.ah=function(e){return stv_g.st<0?e:e*stv_g.scale},Abc.prototype.out_sxsy=out_sxsy,Abc.prototype.xypath=xypath;var gla=[[],[],"",[],[],[]];function glout(){var e,t=[];if(gla[0].length){for(;null!=(e=gla[0].shift());)t.push(e.toFixed(1));for(output+='<text x="'+t.join(","),t=[];null!=(e=gla[1].shift());)t.push(e.toFixed(1));output+='"\ny="'+t.join(","),output+='"\n>'+gla[2]+"</text>\n",gla[2]=""}if(gla[3].length){for(output+='<path class="sW" d="';null!=(e=gla[3].shift());)output+="M"+e.toFixed(1)+" "+gla[3].shift().toFixed(1)+"v"+gla[3].shift().toFixed(1);output+='"/>\n'}}function xygl(e,t,n){if(glyphs[n])def_use(n),out_XYAB('<use x="X" y="Y" xlink:href="#A"/>\n',e,t,n);else{var r=tgls[n];r?(e+=r.x*stv_g.scale,t-=r.y,r.sc?out_XYAB('<text transform="translate(X,Y) scale(A)">B</text>\n',e,t,r.sc,r.c):(gla[0].push(sx(e)),gla[1].push(sy(t)),gla[2]+=r.c)):error(1,null,"no definition of $1",n)}}function out_acciac(e,t,n,r,s){s?(e-=1,t+=4):(e-=5,t-=4),out_XYAB('<path class="stroke" d="mX YlF G"/>\n',e,t,n,-r)}function out_brace(e,t,n){t=posy-t,n/=24,output+='<text transform="translate('+(e+=posx-6).toFixed(1)+","+t.toFixed(1)+") scale(2.5,"+n.toFixed(2)+')">'+tgls.brace.c+"</text>\n"}function out_bracket(e,t,n){t=posy-t-3,n+=2,output+='<path d="m'+(e+=posx-5).toFixed(1)+" "+t.toFixed(1)+"\n c10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\n v"+n.toFixed(1)+'\n c5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5"/>\n'}function out_hyph(e,t,n){var r,s=25+3*(n/20|0);out_XYAB('<path class="stroke" stroke-width="1.2"\n stroke-dasharray="5,A"\n d="mX YhB"/>\n',e+=(n-s*(r=n>15?(n-15)/s|0:0)-5)/2,t+6,Math.round((s-5)/stv_g.scale),s*r+5)}function out_stem(e,t,n,r,s,o){var i=r?GSTEM_XOFF:3.5,a=-n;if(n<0&&(i=-i),e+=i*stv_g.scale,stv_g.v>=0&&(a/=voice_tb[stv_g.v].scale),gla[3].push(sx(e)),gla[3].push(sy(t)),gla[3].push(a),s){if(t+=n,n>0)if(o)if(output+='<path d="',r)for(;--s>=0;)out_XYAB("MX Yl3 1.5 0 2 -3 -1.5z\n",e,t),t-=3;else for(;--s>=0;)out_XYAB("MX Yl7 3.2 0 3.2 -7 -3.2z\n",e,t),t-=5.4;else{if(!r)return void xygl(e,t,"flu"+s);if(output+='<path d="',1==s)out_XYAB("MX Yc0.6 3.4 5.6 3.8 3 10\n 1.2 -4.4 -1.4 -7 -3 -7\n",e,t);else for(;--s>=0;)out_XYAB("MX Yc1 3.2 5.6 2.8 3.2 8\n 1.4 -4.8 -2.4 -5.4 -3.2 -5.2\n",e,t),t-=3.5}else if(o){if(output+='<path d="',!r)for(;--s>=0;)out_XYAB("MX Yl7 -3.2 0 -3.2 -7 3.2z\n",e,t),t+=5.4}else{if(!r)return void xygl(e,t,"fld"+s);if(output+='<path d="',1==s)out_XYAB("MX Yc0.6 -3.4 5.6 -3.8 3 -10\n 1.2 4.4 -1.4 7 -3 7\n",e,t);else for(;--s>=0;)out_XYAB("MX Yc1 -3.2 5.6 -2.8 3.2 -8\n 1.4 4.8 -2.4 5.4 -3.2 5.2\n",e,t),t+=3.5}output+='"/>\n'}}function out_trem(e,t,n){for(out_XYAB('<path d="mX Y\n\t',e-4.5,t);output+="l9 -3v3l-9 3z",!(--n<=0);)output+="m0 5.4";output+='"/>\n'}function out_tubr(e,t,n,r,s){var o=s?-3:3;t+=o,n/=stv_g.scale,output+='<path class="stroke" d="m',out_sxsy(e," ",t),output+="v"+o.toFixed(1)+"l"+n.toFixed(1)+" "+(-r).toFixed(1)+"v"+(-o).toFixed(1)+'"/>\n'}function out_tubrn(e,t,n,r,s,o){var i,a=10*o.length,c=s?-3:3;set_font("tuplet"),xy_str(e+n/2,t+r/2-.5*gene.curfont.size+2,o,"c"),n/=stv_g.scale,s||(t+=6),output+='<path class="stroke" d="m',out_sxsy(e," ",t),i=n-a+1,r>0?a+=r/8:a-=r/8,output+="v"+c.toFixed(1)+"m"+n.toFixed(1)+" "+(-r).toFixed(1)+"v"+(-c).toFixed(1)+'"/>\n<path class="stroke" stroke-dasharray="'+(i/2).toFixed(1)+" "+a.toFixed(1)+'" d="m',out_sxsy(e," ",t-c),output+="l"+n.toFixed(1)+" "+(-r).toFixed(1)+'"/>\n'}function out_wln(e,t,n){out_XYAB('<path class="stroke" stroke-width="0.8" d="mX YhF"/>\n',e,t+3,n)}var deco_str_style={crdc:{dx:0,dy:5,style:"font:italic 14px text,serif"},dacs:{dx:0,dy:3,style:"font:16px text,serif",anchor:' text-anchor="middle"'},pf:{dx:0,dy:5,style:"font:italic bold 16px text,serif"},"@":{dx:0,dy:5,style:"font:12px text,sans-serif"}};function out_deco_str(e,t,n,r){if("fng"!=n){var s=deco_str_style[n];s?(e+=s.dx,t+=s.dy,s.def||(style+="\n."+n+" {"+s.style+"}",s.def=!0),out_XYAB('<text x="X" y="Y" class="A"B>',e,t,n,s.anchor||""),set_font("annotation"),out_str(r),output+="</text>\n"):xygl(e,t,n)}else out_XYAB('<text x="X" y="Y" style="font-size:14px" text-anchor="middle">A</text>\n',e,t,m_gl(r))}function out_arp(e,t,n){for(g_open(e,t,270),e=0,n=Math.ceil(n/6);--n>=0;)xygl(e,6,"ltr"),e+=6;g_close()}function out_cresc(e,t,n,r){out_XYAB('<path class="stroke"\n d="mX YlF ',e+=n*stv_g.scale,t+5,n=-n),r.nost?output+="-2.2m0 -3.6l"+(-n).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-n).toFixed(1)+' -4"/>\n'}function out_dim(e,t,n,r){out_XYAB('<path class="stroke"\n d="mX YlF ',e,t+5,n),r.noen?output+="-2.2m0 -3.6l"+(-n).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-n).toFixed(1)+' -4"/>\n'}function out_ltr(e,t,n){for(t+=4,n=Math.ceil(n/6);--n>=0;)xygl(e,t,"ltr"),e+=6}function out_8va(e,t,n,r){n<18&&(n=18,e-=4),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">8<tspan dy="-4" style="font-size:10px">va</tspan></text>\n',e-8,t),e+=12,n-=12),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t+=6,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+n,t)}function out_8vb(e,t,n,r){n<18&&(n=18,e-=4),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">8<tspan dy=".5" style="font-size:10px">vb</tspan></text>\n',e-8,t),e+=10,n-=10),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+n,t)}function out_15ma(e,t,n,r){n<25&&(n=25,e-=6),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">15<tspan dy="-4" style="font-size:10px">ma</tspan></text>\n',e-10,t),e+=20,n-=20),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t+=6,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+n,t)}function out_15mb(e,t,n,r){n<24&&(n=24,e-=5),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">15<tspan dy=".5" style="font-size:10px">mb</tspan></text>\n',e-10,t),e+=18,n-=18),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+n,t)}Abc.prototype.out_lped=function(e,t,n,r){t+=4,r.nost||xygl(e,t,"ped"),r.noen||xygl(e+n+6,t,"pedoff")};var deco_val_tb={arp:out_arp,cresc:out_cresc,dim:out_dim,ltr:out_ltr,lped:function(e,t,n,r){self.out_lped(e,t,n,r)},"8va":out_8va,"8vb":out_8vb,"15ma":out_15ma,"15mb":out_15mb};function out_deco_val(e,t,n,r,s){deco_val_tb[n]?deco_val_tb[n](e,t,r,s):error(1,null,"No function for decoration '$1'",n)}function out_glisq(e,t,n){var r=n.start,s=r.x,o=r.y+staff_tb[r.st].y,i=Math.atan2(o-t,e-s),a=i/Math.PI*180,c=(e-s)/Math.cos(i);for(g_open(s,o,a),(c=(c-(s=r.s.dots?13+r.s.xmx:8)-6)/6|0)<1&&(c=1);--c>=0;)xygl(s,0,"ltr"),s+=6;g_close()}function out_gliss(e,t,n){var r=n.start,s=r.x,o=r.y+staff_tb[r.st].y,i=-Math.atan2(t-o,e-s),a=i/Math.PI*180,c=(e-s)/Math.cos(i);g_open(s,o,a),c-=(s=r.s.dots?13+r.s.xmx:8)+8,xypath(s,0),output+="h"+c.toFixed(1)+'" stroke-width="1"/>\n',g_close()}var deco_l_tb={glisq:out_glisq,gliss:out_gliss},par_sy,cur_sy,voice_tb,curvoice,staves_found,vover,tsfirst;function out_deco_long(e,t,n){var r=n.dd.glyph;deco_l_tb[r]?deco_l_tb[r](e,t,n):error(1,null,"No function for decoration '$1'",r)}function tempo_note(e,t){var n,r=identify_note(e,t);switch(r[0]){case C.OVAL:n="";break;case C.EMPTY:n="";break;default:switch(r[2]){case 2:n="";break;case 1:n="";break;default:n=""}}return r[1]&&(n+='<tspan dx=".1em"></tspan>'),n}function tempo_build(e){var t,n,r,s=0,o=[];if(!e.tempo_str){if(cfmt.musicfont.used||get_font("music"),set_font("tempo"),e.tempo_str1&&(o.push(e.tempo_str1),s+=strwh(e.tempo_str1)[0]),e.tempo_notes){for(r=' dy="-1"',t=0;t<e.tempo_notes.length;t++)n=tempo_note(e,e.tempo_notes[t]),o.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px"'+r+">"+n+"</tspan>"),s+=(n.length>1?2:1)*gene.curfont.swfac,r="";o.push('<tspan dy="1">=</tspan>'),s+=cwidf("="),e.tempo_ca&&(o.push(e.tempo_ca),s+=strwh(e.tempo_ca)[0],e.tempo_ca.length+1),e.tempo?(o.push(e.tempo),s+=strwh(e.tempo.toString())[0]):(n=tempo_note(e,e.new_beat),o.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px" dy="-1">'+n+"</tspan>"),s+=(n.length>1?2:1)*gene.curfont.swfac,r="y")}e.tempo_str2&&(r?o.push('<tspan\n\tdy="1">'+e.tempo_str2+"</tspan>"):o.push(e.tempo_str2),s+=strwh(e.tempo_str2)[0]),e.tempo_str=o.join(" "),s+=cwidf(" ")*(o.length-1),e.tempo_wh=[s,13]}}function writempo(e,t,n){var r;set_font("tempo"),gene.curfont.box&&(gene.curfont.box=!1,r=gene.curfont.size+4),output+='<text class="'+font_class(gene.curfont)+'" x="',out_sxsy(t,'" y="',n+.2*gene.curfont.size),output+='">'+e.tempo_str+"</text>\n",r&&(gene.curfont.box=!0,output+='<rect class="stroke" x="',out_sxsy(t-2,'" y="',n+r-1),output+='" width="'+(e.tempo_wh[0]+2).toFixed(1)+'" height="'+r.toFixed(1)+'"/>\n'),e.invis=!0}function vskip(e){posy+=e}function svg_flush(){if(!multicol&&output&&user.img_out&&0!=posy){var e,t,n='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n xmlns:xlink="http://www.w3.org/1999/xlink"\n fill="currentColor" stroke-width=".7"',r="";if(glout(),n+=' class="'+font_class(t=get_font("music"))+" tune"+tunes.length+'"\n',posy*=cfmt.scale,user.imagesize?n+=user.imagesize+' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'">\n':n+=' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'" width="'+img.width.toFixed(0)+'px" height="'+posy.toFixed(0)+'px">\n',n+=fulldefs,(style||font_style)&&(n+="<style>"+font_style,(cfmt.fgcolor||cfmt.bgcolor)&&(n+="\n.f"+t.fid+(cfmt.fullsvg||"")+"{"+(cfmt.fgcolor?"color:"+cfmt.fgcolor+";":"")+(cfmt.bgcolor?"background-color:"+cfmt.bgcolor:"")+"}"),n+=style+"\n</style>\n"),defs&&(n+="<defs>"+defs+"\n</defs>\n"),1!=cfmt.scale&&(n+='<g class="g" transform="scale('+cfmt.scale.toFixed(2)+')">\n',r="</g>\n"),psvg&&psvg.ps_flush(!0),blkdiv>0&&(user.img_out(1==blkdiv?'<div class="nobrk">':'<div class="nobrk newpage">'),blkdiv=-1),user.img_out(n+output+r+"</svg>"),output="",font_style="",cfmt.fullsvg)for(defined_glyph={},e=0;e<font_tb.length;e++)font_tb[e].used=!1;else style="",fulldefs="";defs="",posy=0}}function blk_flush(){svg_flush(),blkdiv<0&&(!parse.state||cfmt.splittune)&&(user.img_out("</div>"),blkdiv=0)}function voice_filter(){var e;function t(e,t){var n,r=new RegExp(t);if(r.test(curvoice.id)||r.test(curvoice.nm))for(n=0;n<e.length;n++)self.do_pscom(e[n])}if(parse.voice_opts)for(e in parse.voice_opts)parse.voice_opts.hasOwnProperty(e)&&t(parse.voice_opts[e],e);if(parse.tune_v_opts)for(e in parse.tune_v_opts)parse.tune_v_opts.hasOwnProperty(e)&&t(parse.tune_v_opts[e],e)}function sym_link(e){var t=curvoice.time;e.fname||set_ref(e),curvoice.ignore||(e.prev=curvoice.last_sym,curvoice.last_sym?curvoice.last_sym.next=e:curvoice.sym=e),curvoice.last_sym=e,e.v=curvoice.v,e.p_v=curvoice,e.st=curvoice.cst,e.time=t,e.dur&&!e.grace&&(curvoice.time+=e.dur),parse.ufmt=!0,e.fmt=cfmt,e.pos=curvoice.pos,curvoice.second&&(e.second=!0),curvoice.floating&&(e.floating=!0),curvoice.eoln&&(e.soln=!0,curvoice.eoln=!1)}function sym_add(e,t){var n,r={type:t,dur:0},s=curvoice;return curvoice=e,sym_link(r),curvoice=s,(n=r.prev)||(n=r.next),n&&(r.fname=n.fname,r.istart=n.istart,r.iend=n.iend),r}Abc.prototype.blk_flush=blk_flush;var w_tb=new Uint8Array([5,1,8,6,0,2,3,9,9,0,9,4,0,7,0,0,0,0]);function sort_all(){var e,t,n,r,s,o,i,a,c=voice_tb.length,l=[],u=[],f=cur_sy,d=f.top_voice,p=voice_tb[d],h={type:C.STAVES,dur:0,v:d,p_v:p,time:0,st:0,sy:f,next:p.sym,seqst:!0};if(p.sym){for(h.fmt=o=p.sym.fmt,d=0;d<c;d++)e=voice_tb[d].sym,l[d]=e,f.voices[d]&&(u[f.voices[d].range]=d);for(p.sym=tsfirst=e=h,e.next?e.next.prev=e:p.last_sym=e,(e=glovar.tempo)&&(e.v=d=p.v,e.p_v=p,e.st=0,e.time=0,e.prev=h,e.next=h.next,e.next?e.next.prev=e:p.last_sym=e,e.prev.next=e,e.fmt=o,glovar.tempo=null,l[d]=e);;){if(a)for(f=a,a=null,u=[],d=0;d<c;d++)f.voices[d]&&(u[f.voices[d].range]=d);for(r=t=1e7,s=0;null!=(d=u[s++]);)!(e=l[d])||e.time>t||(n=w_tb[e.type],e.time<t?(t=e.time,r=n):n<r&&(r=n));if(r>127)break;for(s=0;null!=(d=u[s++]);)if((e=l[d])&&e.time==t&&w_tb[e.type]==r){if(e.type==C.STAVES)a=e.sy;else if(e.type==C.SM){e.next.prev=e.prev,e.prev?e.prev.next=e.next:e.p_v.sym=e.next,l[d]=e.next;continue}i&&(i=0,e.seqst=!0),e.ts_prev=h,h.ts_next=e,h=e,l[d]=e.next}i=r}}}function voice_adj(e){var t,n,r,s,o;function i(e){var t,n,r,s,o,i,a=e.dur,c=1;for(t=e;t&&(!t.beam_end&&t.next);t=t.next)c++;if(c<=1)delete e.feathered_beam;else{if(n=t,s=a/2,i=a/(c-1),r=e.time,e.feathered_beam>0)for(t=e,o=c-1;t!=n;t=t.next,o--)a=(i*o|0)+s,t.dur=a,t.time=r,r+=a;else for(t=e,o=0;t!=n;t=t.next,o++)a=(i*o|0)+s,t.dur=a,t.time=r,r+=a;t.dur=t.time+t.dur-r,t.time=r}}for(curvoice&&curvoice.clone&&(parse.istart=parse.eol,do_cloning()),s=0;s<voice_tb.length;s++){if(t=voice_tb[s],!e)for(delete t.eoln;o=t.sls.shift();){for(r=(n=o.note.s).next;r&&(!r.bar_type||":"!=r.bar_type[0]);r=r.next);r?(n.sls||(n.sls=[]),n.sls.push({ty:o.ty,note:{s:r}})):(n.sls||(n.sls=[]),n.sls.push({ty:o.ty,note:{s:r},loc:"o"}))}for(n=t.sym;n&&!(n.time>=staves_found);n=n.next);for(;n;n=n.next)if((w_tb[n.type]||n.type==C.STAVES)&&n.type!=C.SPACE&&n.type!=C.GRACE||n.prev&&!(n.time>n.prev.time+n.prev.dur)||(r={type:C.SM,v:n.v,p_v:n.p_v,time:n.time,dur:0,next:n,prev:n.prev,fmt:n.fmt},n.prev?n.prev.next=r:voice_tb[n.v].sym=r,n.prev=r),n.type!==C.GRACE)n.feathered_beam&&i(n);else{if(!cfmt.graceword)continue;for(r=n.next;r;r=r.next){switch(r.type){case C.SPACE:continue;case C.NOTE:if(!r.a_ly)break;n.a_ly=r.a_ly,r.a_ly=null}break}}}}function new_syst(e){var t,n,r,s,o={voices:[],staves:[],top_voice:0};if(e)cur_sy=par_sy=o;else{for(n=0;n<voice_tb.length;n++)par_sy.voices[n]&&(t=par_sy.voices[n].st,r=par_sy.staves[t],s=voice_tb[n],r.staffnonote=s.staffnonote,s.staffscale&&(r.staffscale=s.staffscale));for(t=0;t<par_sy.staves.length;t++)o.staves[t]=clone(par_sy.staves[t]),o.staves[t].flags=0;par_sy.next=o,par_sy=o}}function not2abc(e,t){var n,r="";for(t&&3!=t&&("object"!=typeof t?r=["__","_","","^","^^"][t+2]:((n=t[0])>0?r+="^":(r+="_",n=-n),r+=n+"/"+t[1])),r+=ntb[(e+75)%7],n=e;n>=23;n-=7)r+="'";for(n=e;n<16;n+=7)r+=",";return r}function get_map(e){if(e){var t,n,r,s,o,i,a="",c=e.split(/\s+/);if(c.length<3)syntax(1,not_enough_p);else{if("*"==(i=c[1])[0]||0==i.indexOf("all"))i="all";else{if(0!=i.indexOf("octave,")&&0!=i.indexOf("key,")||(a=i[0],0==(i=(i=i.split(",")[1]).replace(/[,']+/,"").toUpperCase()).indexOf("key,")&&(i=i.replace(/[=^_]+/,""))),(o=new scanBuf).buffer=i,!(n=parse_acc_pit(o)))return void syntax(1,"Bad note in %%map");i=a+not2abc(n.pit,n.acc)}if((r=maps[c[0]])||(maps[c[0]]=r={}),(s=r[i])||(r[i]=s=[]),c.shift(),c.shift(),c.length){if(t=0,(c=info_split(c.join(" ")))[0].indexOf("=")<0){if("*"!=c[0][0]&&((o=new scanBuf).buffer=c[0],s[1]=parse_acc_pit(o)),!c[1])return;t++,c[1].indexOf("=")<0&&(s[0]=c[1].split(","),t++)}for(;t<c.length;t++)switch(c[t]){case"heads=":if(!c[++t]){syntax(1,not_enough_p);break}s[0]=c[t].split(",");break;case"print=":case"play=":if(!c[++t]){syntax(1,not_enough_p);break}(o=new scanBuf).buffer=c[t],n=parse_acc_pit(o),"r"==c[t-1][1]?s[1]=n:s[3]=n;break;case"color=":if(!c[++t]){syntax(1,not_enough_p);break}s[2]=c[t]}}}}}function set_transp(){var e,t,n;if(!curvoice.ckey.k_bagpipe&&!curvoice.ckey.k_drum){if(cfmt.transp&&curvoice.shift&&syntax(0,"Mix of old and new transposition syntaxes"),null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(t=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(n=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==t){if(null==n)return}else curvoice.vtransp=t;if(is_voice_sig())curvoice.okey.fmt=cfmt,curvoice.key=e=clone(curvoice.okey);else for(e=curvoice.last_sym;e.type!=C.KEY;)if(!(e=e.prev)){e=curvoice.key;break}null!=t&&(e.k_transp=t),null!=n&&(e.k_sndtran=n),curvoice.ckey=clone(e),curvoice.key.k_none&&(e.k_sf=0)}}function note_transp(e,t,n){var r,s,o,i=n.pit,a=n.acc;if("object"!=typeof a||(s=a[1],a=a[0],2==s)){if(!a&&t.k_a_acc&&(a=t.k_map[(i+19)%7]),o=abc2svg.pab40(i,a)+t.k_transp,n.pit=abc2svg.b40p(o),a||t.k_a_acc||t.k_none){if(r=abc2svg.b40a(o),a)t.k_a_acc&&t.k_map[(n.pit+19)%7]==r&&(r=0),r||(r=3);else if(t.k_none){if(acc_same_pitch(e,n.pit))return}else{if(!t.k_a_acc)return;if(acc_same_pitch(e,n.pit))return;t.k_map[(n.pit+19)%7]&&(r=3)}if(s&&r!=a)switch(Number(a)){case-3:switch(r){case-2:r=-1;break;case 3:r=-3,n.pit++;break;case 2:r=-1}break;case-1:switch(r){case-2:r=-3;break;case 3:r=1}break;case 1:switch(r){case-1:r=-3;break;case 3:r=-1;break;case 2:r=3}break;case 3:switch(r){case-1:r=1;break;case 1:r=1,n.pit++}}n.acc=s?[r,s]:r}}else error(1,e,"Microtone transposition not coded")}function pit_adj(){for(var e,t,n,r,s,o=voice_tb.length;--o>=0;)if(null!=(t=voice_tb[o]).vtransp)for(t.key.k_transp?(key_transp(r=t.key),r.k_old_sf=r.k_sf):r=null,n=t.sym;n;){if(!r)for(;n&&(n.type!=C.KEY||!n.k_transp);n=n.next);for(;n;n=n.next){switch(n.type){case C.GRACE:for(s=n.extra;s;s=s.next)for(e=0;e<=s.nhd;e++)note_transp(s,r,s.notes[e]);continue;case C.NOTE:case C.REST:for(e=0;e<=n.nhd;e++)note_transp(n,r,n.notes[e]);n.a_gch&&gch_transp(n,r);continue;case C.KEY:if(r&&(n.k_sf=r.k_sf),key_transp(n),!n.k_transp)break;r=n;default:continue}break}r=null}}function set_ctrl(){var e,t,n;for(t in parse.ctrl){for(n=parse.ctrl[t],e=tsfirst;e.next&&e.next.time<t;)e=e.next;for(;e&&e.time<t;)e=e.ts_next;if(e){for(;e.time==t&&e.ts_next&&!e.dur;)e=e.ts_next;n.part&&(e.part=n.part),n.tempo&&(lkvsym(n.tempo,e),lktsym(n.tempo,e))}else;}}function get_transp(e){if("0"==e[0])return 0;if("123456789-+".indexOf(e[0])>=0){var t=parseInt(e);return isNaN(t)||t<-36||t>36?void syntax(1,errs.bad_transp):40*(((t+=36)/12|0)-3)+("b"==e.slice(-1)?abc2svg.ifb40:abc2svg.isb40)[t%12]}}function generate(){var e;a_dcn.length&&(syntax(1,"Decoration without symbol"),a_dcn=[]),parse.tp&&(syntax(1,"No end of tuplet"),(e=parse.tps)&&delete e.tp,delete parse.tp),vover&&(syntax(1,"No end of voice overlay"),get_vover(vover.bar?"|":")")),voice_adj(),sort_all(),tsfirst&&(user.anno_start&&(anno_start=a_start),user.anno_stop&&(anno_stop=a_stop),self.set_bar_num(),pit_adj(),info.P&&(tsfirst.parts=info.P),parse.ctrl&&set_ctrl(),user.get_abcmodel&&user.get_abcmodel(tsfirst,voice_tb,abc2svg.sym_name,info),user.img_out&&self.output_music()),set_page(),info.W&&put_words(info.W),put_history(),parse.state=0,blk_flush(),tsfirst&&(tunes.push([tsfirst,voice_tb,info,cfmt]),tsfirst=null)}function key_transp(e){if(!e.k_a_acc&&!e.k_none){var t,n=(e.k_b40+200+e.k_transp)%40;(t=abc2svg.b40k[n]-n)&&(e.k_transp>0?e.k_transp+=t:e.k_transp-=t,n+=t),e.k_b40=n;var r=abc2svg.b40sf[n];e.k_old_sf=e.k_sf,e.k_sf=r,e.k_map=abc2svg.keys[r+7]}}function acc_same_pitch(e,t){var n,r,s=e.time;for(e=e.prev;e;e=e.prev)switch(e.type){case C.BAR:if(e.time<s)return;for(;;){if(!(e=e.prev))return;if(e.type==C.NOTE){if(e.time+e.dur==s)break;return}if(e.time<s)return}for(n=0;n<=e.nhd;n++)if(e.notes[n].pit==t&&e.notes[n].tie_ty)return null==(r=e.notes[n].acc)||3==r;return;case C.NOTE:for(n=0;n<=e.nhd;n++)if(e.notes[n].pit==t)return null==(r=e.notes[n].acc)||3==r}}function get_staves(e,t){var n,r,s,o,i,a,c,l,u,f=voice_tb.length,d=0;if(!t||(c=parse_staves(t))){for(a=0;a<f;a++)(r=voice_tb[a]).time>d&&(d=r.time);if(d){for(f&&voice_adj(!0),a=0;a<par_sy.voices.length;a++)if(par_sy.voices[a]){curvoice=voice_tb[a];break}if(curvoice.time=d,sym_link(n={type:C.STAVES,dur:0}),par_sy.nstaff=nstaff,!t){for(n.sy=clone(par_sy,1),par_sy.next=n.sy,par_sy=n.sy,staves_found=d,a=0;a<f;a++)voice_tb[a].time=d;return void(curvoice=voice_tb[par_sy.top_voice])}new_syst(),n.sy=par_sy}else par_sy.staves=[],par_sy.voices=[];for(staves_found=d,a=0;a<f;a++)delete(r=voice_tb[a]).second,delete r.ignore,delete r.floating;for(u=0,o=0;o<c.length;o++)for((r=new_voice(c[o][0])).time=d,a=r.v,c[o][0]=r;par_sy.voices[a]={range:u++},r=r.voice_down;)a=r.v;if(par_sy.top_voice=c[0][0].v,"t"==e[1])for(o=0;o<c.length;o++)(i=c[o][1])&(OPEN_BRACE|OPEN_BRACE2)&&(i&(OPEN_BRACE|CLOSE_BRACE))!=(OPEN_BRACE|CLOSE_BRACE)&&(i&(OPEN_BRACE2|CLOSE_BRACE2))!=(OPEN_BRACE2|CLOSE_BRACE2)&&0==c[o+1][1]&&(i&OPEN_PARENTH||c[o+2][1]&OPEN_PARENTH||(c[o+2][1]&(CLOSE_BRACE|CLOSE_BRACE2)?c[o+1][1]|=FL_VOICE:0==c[o+2][1]&&c[o+3][1]&(CLOSE_BRACE|CLOSE_BRACE2)&&(c[o][1]|=OPEN_PARENTH,c[o+1][1]|=CLOSE_PARENTH,c[o+2][1]|=OPEN_PARENTH,c[o+3][1]|=CLOSE_PARENTH)));for(l=-1,o=0;o<c.length;o++)if(((i=c[o][1])&(OPEN_PARENTH|CLOSE_PARENTH))==(OPEN_PARENTH|CLOSE_PARENTH)&&(i&=~(OPEN_PARENTH|CLOSE_PARENTH),c[o][1]=i),r=c[o][0],i&FL_VOICE?(r.floating=!0,r.second=!0):(l++,par_sy.staves[l]||(par_sy.staves[l]={stafflines:r.stafflines||"|||||",staffscale:1}),par_sy.staves[l].flags=0),a=r.v,r.st=r.cst=par_sy.voices[a].st=l,par_sy.staves[l].flags|=i,i&OPEN_PARENTH){for(s=r;o<c.length-1&&(a=(r=c[++o][0]).v,c[o][1]&MASTER_VOICE?(s.second=!0,s=r):r.second=!0,r.st=r.cst=par_sy.voices[a].st=l,!(c[o][1]&CLOSE_PARENTH)););par_sy.staves[l].flags|=c[o][1]}if(l<0&&(l=0),par_sy.nstaff=nstaff=l,"c"==e[1])for(l=0;l<nstaff;l++)par_sy.staves[l].flags^=STOP_BAR;for(f=voice_tb.length,l=0,a=0;a<f;a++){if(r=voice_tb[a],par_sy.voices[a]?l=r.st:r.st=l,!d)for(n=r.sym;n;n=n.next)n.st=l;if(par_sy.voices[a]){for(s=r.voice_down;s;)o=s.v,s.st=s.cst=par_sy.voices[o].st=l,s=s.voice_down;par_sy.voices[a].second=r.second,!((l=r.st)>0)||r.norepbra||par_sy.staves[l-1].flags&STOP_BAR||(r.norepbra=!0)}}!d&&f&&voice_adj(!0),curvoice=parse.state>=2?voice_tb[par_sy.top_voice]:null}}function clone_voice(e){var t,n;for(t=0;t<voice_tb.length;t++)if((n=voice_tb[t]).id==e)return n;return(n=clone(curvoice)).v=voice_tb.length,n.id=e,n.sym=n.last_sym=null,n.key=clone(curvoice.key),n.sls=[],delete n.nm,delete n.snm,delete n.new_name,delete n.lyric_restart,delete n.lyric_cont,delete n.sym_restart,delete n.sym_cont,delete n.have_ly,delete n.tie_s,voice_tb.push(n),n}function get_vover(e){var t,n,r,s,o,i,a;if("|"==e||")"==e){if(!curvoice.last_note)return void syntax(1,errs.nonote_vo);if(curvoice.last_note.beam_end=!0,!vover)return void syntax(1,"Erroneous end of voice overlay");if(curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time)),curvoice.acc=[],t=vover.p_voice,(r=curvoice.last_sym).type==C.SPACE&&t.last_sym.type!=C.SPACE){for(r.p_v=t,r.v=r.p_v.v;r.prev.type==C.SPACE;)(r=r.prev).p_v=t,r.v=r.p_v.v;(a=r.prev).next=null,r.prev=t.last_sym,r.prev.next=r,t.last_sym=curvoice.last_sym,curvoice.last_sym=a}return curvoice=t,void(vover=null)}if("("==e)return vover?void syntax(1,"Voice overlay already started"):void(vover={p_voice:curvoice,time:curvoice.time});if(curvoice.last_note){if(curvoice.last_note.beam_end=!0,!(t=curvoice.voice_down)){for(t=clone_voice(curvoice.id+"o"),curvoice.voice_down=t,t.time=0,t.second=!0,i=t.v,par_sy.voices[i]={st:curvoice.st,second:!0},n=par_sy.voices[curvoice.v].range,o=0;o<par_sy.voices.length;o++)par_sy.voices[o]&&par_sy.voices[o].range>n&&par_sy.voices[o].range++;par_sy.voices[i].range=n+1}if(t.ulen=curvoice.ulen,t.dur_fact=curvoice.dur_fact,t.acc=[],vover)curvoice!=vover.p_voice&&curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time));else{for(s=t.time,r=curvoice.last_sym;!(r.type==C.BAR||r.time<=s);r=r.prev);vover={bar:r&&r.bar_type?r.bar_type:"|",p_voice:curvoice,time:r.time}}t.time=vover.time,curvoice=t}else syntax(1,errs.nonote_vo)}function is_voice_sig(){var e;if(!curvoice.last_sym)return!0;if(curvoice.time)return!1;for(e=curvoice.last_sym;e;e=e.prev)if(w_tb[e.type])return!1;return!0}function get_clef(e){if(!curvoice.time&&is_voice_sig())return curvoice.clef=e,void(e.fmt=cfmt);sym_link(e),e.clef_small=!0;var t=e.prev;t&&t.type==C.BAR&&":"!=t.bar_type[0]&&(e.next=t,e.prev=t.prev,e.prev&&(e.prev.next=e),t.prev=e,t.next=null,curvoice.last_sym=t,e.soln&&(delete e.soln,curvoice.eoln=!0))}function get_key(e){var t,n,r,s,o=new_key(e),i=o[0];if(o=o[1],1==parse.state){for(null!=i.k_sf||i.k_a_acc||(i.k_sf=0,i.k_none=!0,i.k_map=abc2svg.keys[7]),t=0;t<voice_tb.length;t++)(n=voice_tb[t]).key=clone(i),n.okey=clone(i),n.ckey=clone(i);parse.ckey=i,glovar.ulen||(glovar.ulen=C.BLEN/8),o.length&&(memo_kv_parm("*",o),o=""),goto_tune(),parse.state=3}if(set_kv_parm(o),curvoice.ckey.k_bagpipe||curvoice.ckey.k_drum||null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(r=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(s=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==i.k_sf){if(!i.k_a_acc&&null==r){if(null==s)return;i.invis=!0}i.k_sf=curvoice.okey.k_sf}curvoice.okey=clone(i),null!=r&&(curvoice.vtransp=r,i.k_transp=r),null!=s&&(i.k_sndtran=s),i.k_old_sf=curvoice.ckey.k_sf,i.k_a_acc&&i.k_a_acc.length||i.k_sf||i.k_old_sf||(i.invis=!0),i.k_b40||(i.k_b40=curvoice.ckey.k_b40),curvoice.ckey=i,is_voice_sig()?(i.fmt=cfmt,curvoice.key=clone(i),i.k_none&&(curvoice.key.k_sf=0)):sym_link(i)}function new_voice(e){var t,n,r=voice_tb[0],s=voice_tb.length;if(1==s&&r.default&&(delete r.default,!r.time))return r.id=e,delete r.init,cfmt.transp&&parse.state>=2&&(n=curvoice,curvoice=r,set_transp(),curvoice=n),r;for(t=0;t<s;t++)if((r=voice_tb[t]).id==e)return r;return r={v:t,id:e,time:0,new:!0,pos:{},scale:1,ulen:glovar.ulen,dur_fact:1,key:clone(parse.ckey),ckey:clone(parse.ckey),okey:clone(parse.ckey),meter:clone(glovar.meter),wmeasure:glovar.meter.wmeasure,staffnonote:1,clef:{type:C.CLEF,clef_auto:!0,clef_type:"a",time:0},acc:[],sls:[],hy_st:0},voice_tb.push(r),r}function init_tune(){nstaff=-1,voice_tb=[],curvoice=null,new_syst(!0),staves_found=-1,gene={},a_de=[],cross={}}function do_cloning(){var e,t=curvoice.clone,n=t.vs,r=t.a,s=t.bol,o=parse.istart,i=parse,a=parse.file;for(delete curvoice.clone,"["==a[o-1]&&o--,include++,e=0;e<n.length;e++)(parse=Object.create(i)).line=Object.create(i.line),get_voice(n[e],r),tosvg(parse.fname,a,s,o);include--,parse=i}function get_voice(e){var t,n,r=info_split(e),s=r.shift();if(s)if(curvoice&&curvoice.clone&&do_cloning(),n=s.indexOf(",")>0?s.split(","):[s],parse.state<2)for(;s=n.shift();)r.length&&memo_kv_parm(s,r),"*"!=s&&1==parse.state&&(curvoice=new_voice(s));else if("*"!=s){if(curvoice=new_voice(n[0]),n.length>1&&(n.shift(),curvoice.clone={vs:n,a:r,bol:parse.iend},"]"!=parse.file[curvoice.clone.bol-1]&&curvoice.clone.bol++),set_kv_parm(r),t=curvoice.v,curvoice.new){if(delete curvoice.new,staves_found<0)curvoice.st=curvoice.cst=++nstaff,par_sy.nstaff=nstaff,par_sy.voices[t]={st:nstaff,range:t},par_sy.staves[nstaff]={stafflines:curvoice.stafflines||"|||||",staffscale:1};else if(!par_sy.voices[t])return void(curvoice.ignore=1);set_transp()}!curvoice.filtered&&par_sy.voices[t]&&(parse.voice_opts||parse.tune_v_opts)&&(curvoice.filtered=!0,voice_filter())}else syntax(1,"Cannot have V:* in tune body")}function goto_tune(){var e,t;for(set_page(),write_heading(),glovar.new_nbar?(gene.nbar=glovar.new_nbar,glovar.new_nbar=0):gene.nbar=1,voice_tb.length?curvoice=voice_tb[staves_found<0?0:par_sy.top_voice]:(get_voice("1"),curvoice.clef.istart=curvoice.key.istart,curvoice.clef.iend=curvoice.key.iend,curvoice.default=!0),e=0;e<voice_tb.length;e++)(t=voice_tb[e]).ulen=glovar.ulen,t.ckey.k_bagpipe&&!t.pos.stm&&(t.pos=clone(t.pos),t.pos.stm&=-8,t.pos.stm|=C.SL_BELOW);if(staves_found<0)for(e=voice_tb.length,par_sy.nstaff=nstaff=e-1;--e>=0;)delete(t=voice_tb[e]).new,t.st=t.cst=e,par_sy.voices[e]={st:e,range:e},par_sy.staves[e]={stafflines:t.stafflines||"|||||",staffscale:1}}function get_sym(e,t){var n,r,s,o,i;if(!curvoice.ignore){if(t){if(!(n=curvoice.sym_cont))return void syntax(1,"+: symbol line without music")}else if(curvoice.sym_restart&&(curvoice.sym_start=curvoice.sym_restart,curvoice.sym_restart=null),(n=curvoice.sym_start)||(n=curvoice.sym),!n)return void syntax(1,"s: without music");for(s=0;;){for(;" "==e[s]||"\t"==e[s];)s++;if(!(r=e[s]))break;switch(r){case"|":for(;n&&n.type!=C.BAR;)n=n.next;if(!n)return void syntax(1,"Not enough measure bars for symbol line");n=n.next,s++;continue;case"!":case'"':if(o=++s,(s=e.indexOf(r,o))<0){syntax(1,"!"==r?"No end of decoration":"No end of chord symbol/annotation"),s=e.length;continue}i=e.slice(o-1,s+1);break;case"*":break;default:if((i=r.charCodeAt(0))<128&&(i=char_tb[i]).length>1&&("!"==i[0]||'"'==i[0])){r=i[0];break}syntax(1,errs.bad_char,r)}for(;n&&n.type!=C.NOTE;)n=n.next;if(!n)return void syntax(1,"Too many elements in symbol line");switch(r){default:break;case"!":a_dcn.push(i.slice(1,-1)),deco_cnv(n,n.prev);break;case'"':parse_gchord(i),a_gch&&csan_add(n)}n=n.next,s++}curvoice.sym_cont=n}}function get_lyrics(e,t){var n,r,s,o,i,a,c,l,u,f;if(!curvoice.ignore){if((7&curvoice.pos.voc)!=C.SL_HIDDEN&&(curvoice.have_ly=!0),t){if(!(n=curvoice.lyric_cont))return void syntax(1,"+: lyric without music");c=get_font("vocal"),gene.deffont!=c&&(gene.curfont==gene.deffont&&(gene.curfont=c),gene.deffont=c)}else if(set_font("vocal"),curvoice.lyric_restart?(curvoice.lyric_start=n=curvoice.lyric_restart,curvoice.lyric_restart=null,curvoice.lyric_line=0):(curvoice.lyric_line++,n=curvoice.lyric_start),n||(n=curvoice.sym),!n)return void syntax(1,"w: without music");for(s=e,o=0,f=gene.curfont;;){for(;" "==s[o]||"\t"==s[o];)o++;if(!s[o])break;switch(l=0,i=parse.istart+o+2,s[o]){case"|":for(;n&&n.type!=C.BAR;)n=n.next;if(!n)return void syntax(1,"Not enough measure bars for lyric line");n=n.next,o++;continue;case"-":case"_":r=s[o],l=2;break;case"*":r="";break;default:for(r="";s[o];){switch(s[o]){case"_":case"*":case"|":o--;case" ":case"\t":break;case"~":r+="&#x00a0;",o++;continue;case"-":l=1;break;case"\\":if(!s[++o])continue;r+=s[o++];continue;case"$":r+=s[o++],"0"==(u=s[o])?gene.curfont=gene.deffont:u>="1"&&u<="9"&&(gene.curfont=get_font("u"+u));default:r+=s[o++];continue}break}}for(;n&&n.type!=C.NOTE;)n=n.next;if(!n)return void syntax(1,"Too many words in lyric line");r&&(7&n.pos.voc)!=C.SL_HIDDEN&&(a={t:r,font:f,istart:i,iend:i+r.length},l&&(a.ln=l),n.a_ly||(n.a_ly=[]),n.a_ly[curvoice.lyric_line]=a,f=gene.curfont),n=n.next,o++}curvoice.lyric_cont=n}}function ly_set(e){var t,n,r,s,o,i,a,c,l,u,f=e,d=0,p=0,h=0,m=0,y=e.a_ly,g=0;for(o=e.ts_next;o;o=o.ts_next){if(o.shrink&&(m+=o.shrink,h++),o.bar_type){m+=3;break}if(o.a_ly){for(t=o.a_ly.length;--t>=0&&(!(r=o.a_ly[t])||2==r.ln););if(t>=0)break}}for(t=0;t<y.length;t++)(r=y[t])&&(gene.curfont=r.font,r.t=i=str2svg(r.t),2!=r.ln?(c=cwid(" ")*r.font.swfac,a=i.wh[0]+1.5*c,e.type==C.GRACE?u=e.wl:i[0]>="0"&&i[0]<="9"&&i.length>2||":"==i[1]||"("==i[0]||")"==i[0]?("("==i[0]?l=c:(n=i.indexOf("&#x00a0;"),set_font(r.font),l=n>0?strwh(i.slice(0,n))[0]:.2*a),(u=.4*(a-=l))>14&&(u=14),u+=l,i[0]>="0"&&i[0]<="9"&&u>g&&(g=u)):(u=.4*a)>14&&(u=14),r.shift=u,u>p&&(p=u),(a-=u)>d&&(d=a)):r.shift=0);for(;!f.seqst;)f=f.ts_prev;if(f.ts_prev&&f.ts_prev.bar_type&&(p-=4),f.wl<p&&(f.shrink+=p-f.wl,f.wl=p),(m-=6)<d)for(m=(d-m)/h,s=e.ts_next;s.shrink&&(s.shrink+=m,f.wr+=m,f=s),s!=o;)s=s.ts_next;if(g>0)for(t=0;t<y.length;t++)(r=y[t])&&r.t[0]>="0"&&r.t[0]<="9"&&(r.shift=g)}function draw_lyric_line(e,t,n){var r,s,o,i,a,c,l,u,f,d;for(e.hy_st&1<<t&&(l=!0,e.hy_st&=~(1<<t)),i=e.sym;i.type==C.CLEF||i.type==C.KEY||i.type==C.METER;i=i.next);for(s=i.prev?i.prev.x:tsfirst.x,f=0;i;i=i.next)if(c=i.a_ly?i.a_ly[t]:null)c.font!=gene.curfont&&(gene.curfont=c.font),o=(r=c.t).wh[0],d=c.shift,l&&(2==c.ln&&"_"==r?r="-":2!=c.ln&&(out_hyph(s,n,i.x-d-s),l=!1,s=i.x+i.wr)),!u||2==c.ln&&"_"==r||(out_wln(s+3,n,f-s+3),u=!1,s=i.x+i.wr),2!=c.ln?(f=i.x-d,c.ln&&(l=!0),(user.anno_start||user.anno_stop)&&(a={st:i.st,istart:c.istart,iend:c.iend,x:f,y:n,ymn:n,ymx:n+gene.curfont.size,wl:0,wr:o},anno_start(a,"lyrics")),xy_str(f,n,r),anno_stop(a,"lyrics"),s=f+o):(0==f&&s>i.x-18&&(s=i.x-18),"-"==r?l=!0:u=!0,f=i.x-d);else switch(i.type){case C.REST:case C.MREST:u&&(out_wln(s+3,n,f-s),u=!1,s=i.x+i.wr)}for(l&&(l=!1,(f=realwidth-10)<s+10&&(f=s+10),out_hyph(s,n,f-s),e.s_next&&e.s_next.fmt.hyphencont&&(e.hy_st|=1<<t)),e.s_next;i;i=i.next)if(i.type==C.NOTE){if(!i.a_ly)break;(c=i.a_ly[t])&&c.ln&&"_"==c.t&&(u=!0,(f=realwidth-15)<s+12&&(f=s+12));break}u&&(out_wln(s+3,n,f-s+3),u=!1)}function draw_lyrics(e,t,n,r,s){var o,i,a=staff_tb[e.st].staffscale;if(set_font("vocal"),s>0){for(r>-tsfirst.fmt.vocalspace&&(r=-tsfirst.fmt.vocalspace),r*=a,o=0;o<t;o++)draw_lyric_line(e,o,r-=1.1*n[o]);return(r-n[o-1]/6)/a}for(r<(i=staff_tb[e.st].topbar+tsfirst.fmt.vocalspace)&&(r=i),r*=a,o=t;--o>=0;)draw_lyric_line(e,o,r),r+=1.1*n[o];return r/a}function draw_all_lyrics(){var e,t,n,r,s,o,i,a,c,l,u=new Array(nstaff+1),f=voice_tb.length,d=new Array(f),p=new Array(f),h=new Array(f),m=new Array(f),y=0,g=0,A=-1;for(n=0;n<f;n++)if((e=voice_tb[n]).sym){if(e.st!=A&&(y=0,g=0,A=e.st),r=0,e.have_ly){for(d[n]||(d[n]=[]),t=e.sym;t;t=t.next)if(c=t.a_ly){for(o=t.x,a=10,s=0;s<c.length;s++)if(l=c[s]){o-=l.shift,a=l.t.wh[0];break}for(y<(i=y_get(e.st,1,o,a))&&(y=i),g>(i=y_get(e.st,0,o,a))&&(g=i);r<c.length;)d[n][r++]=0;for(s=0;s<c.length;s++)(l=c[s])&&(!d[n][s]||l.t.wh[1]>d[n][s])&&(d[n][s]=l.t.wh[1])}}else y<(i=y_get(e.st,1,0,realwidth))&&(y=i),g>(i=y_get(e.st,0,0,realwidth))&&(g=i);u[A]||(u[A]={}),u[A].top=y,u[A].bot=g,p[n]=r,0!=r&&(e.pos.voc?h[n]=(7&e.pos.voc)==C.SL_ABOVE:voice_tb[n+1]&&voice_tb[n+1].st==A&&voice_tb[n+1].have_ly?h[n]=!0:h[n]=!1,h[n]?u[A].a=!0:u[A].b=!0)}for(s=0,n=0;n<f;n++)(e=voice_tb[n]).sym&&e.have_ly&&(h[n]?m[s++]=n:(set_dscale(A=e.st,!0),p[n]>0&&(u[A].bot=draw_lyrics(e,p[n],d[n],u[A].bot,1))));for(;--s>=0;)n=m[s],set_dscale(A=(e=voice_tb[n]).st,!0),u[A].top=draw_lyrics(e,p[n],d[n],u[A].top,-1);for(n=0;n<f;n++)if((e=voice_tb[n]).sym){if(u[A=e.st].a)for(y=u[A].top+2,t=e.sym.next;t;t=t.next)t.a_ly&&y_set(A,1,t.x-2,10,y);if(u[A].b)if(g=u[A].bot-2,p[e.v]>0)for(t=e.sym.next;t;t=t.next)t.a_ly&&y_set(A,0,t.x-2,10,g);else y_set(A,0,0,realwidth,g)}}function parse_gchord(e){var t,n,r,s,o,i,a,c,l,u=get_font("annotation"),f=u.size,d=parse.line;function p(){for(var e="";;){if(t=n[i++],"1234567890.-".indexOf(t)<0)return parseFloat(e);e+=t}}if(c=parse.bol+d.index,e.length>1)n=e.slice(1,-1),l=c+1;else{for(i=++d.index;;){if((a=d.buffer.indexOf('"',i))<0)return void syntax(1,"No end of chord symbol/annotation");if("\\"!=d.buffer[a-1])break;i=a+1}n=cnv_escape(d.buffer.slice(d.index,a)),d.index=a,l=parse.bol+d.index+1}for(u.pad&&(f+=u.pad),i=0,e="g";t=n[i];){switch(r={text:"",istart:c,iend:l,font:u},t){case"@":e=t,i++,s=p(),","!=t?(syntax(1,"',' lacking in annotation '@x,y'"),o=0):(o=p()," "!=t&&i--),r.x=s,o-=.3*f,r.y=o;break;case"^":r.pos=C.SL_ABOVE;case"_":"_"==t&&(r.pos=C.SL_BELOW);case"<":case">":i++,e=t;break;default:switch(e){case"g":r.font=get_font("gchord"),r.pos=curvoice.pos.gch||C.SL_ABOVE;break;case"^":r.pos=C.SL_ABOVE;break;case"_":r.pos=C.SL_BELOW;break;case"@":r.x=s,o-=f,r.y=o}}for(r.type=e;t=n[i];){switch(t){case"\\":if(!(t=n[++i])||"n"==t)break;r.text+="\\";default:r.text+=t,i++;continue;case"&":for(;;){switch(r.text+=t,t=n[++i]){default:continue;case";":case void 0:case"\\":}break}if(";"==t){i++,r.text+=t;continue}case";":}i++;break}r.otext=r.text,a_gch||(a_gch=[]),a_gch.push(r)}}Abc.prototype.set_bar_num=function(){var e,t,n,r,s,o,i,a=gene.nbar,c=0,l=0,u=voice_tb[cur_sy.top_voice].meter.wmeasure;for(e=tsfirst;;e=e.ts_next){if(!e)return;switch(e.type){case C.METER:u=e.wmeasure;case C.CLEF:case C.KEY:case C.STBRK:continue;case C.BAR:e.bar_num&&(a=e.bar_num)}break}for(t=e.ts_next;t;t=t.ts_next)if(t.type==C.BAR&&t.time){t.time<u&&(c=(e=t).time);break}for(;e;e=e.ts_next)switch(e.type){case C.METER:if(e.time==c)break;1!=u&&(a+=(e.time-c)/u),c=e.time,u=e.wmeasure;break;case C.BAR:if(e.invis)break;if(e.time!=n&&(i=0),n=e.time,i&(s=e.text?1:2))break;if(i|=s,e.bar_num){a=e.bar_num,l=c=n;continue}if(1==u){if(e.bar_dotted)continue;e.text&&(cfmt.contbarnb||("1"==e.text[0]?r=a:a=r)),e.bar_num=++a;continue}s=(o=a+(n-c)/u)-(0|o),cfmt.checkbars&&(s&&!e.bar_dotted&&e.next||n>l+u&&e.prev.type!=C.MREST)&&error(0,e,"Bad measure duration"),n>l+u&&(s=0,c=n,a=o|=0),e.text?"1"==e.text[0]?(r=cfmt.contbarnb?c+s*u:n,s||(e.bar_num=o)):(cfmt.contbarnb?c=r:c+=n-r,(o=a+(n-c)/u)==(0|o)&&(e.bar_num=o)):(s&&(o-=s),e.bar_num=o),s||(l=n)}},Abc.prototype.do_pscom=function(e){var t,n,r,s,o,i,a,c;if(s=e.match(/[^\s]+/)){if(s=s[0],curvoice&&curvoice.ignore)switch(s){case"staves":case"score":break;default:return}if(" lock"==(o=e.replace(s,"").trim()).slice(-5))fmt_lock[s]=!0,o=o.slice(0,-5).trim();else if(fmt_lock[s])return;switch(s){case"clef":return void(parse.state>=2&&(r=new_clef(o))&&get_clef(r));case"deco":return void deco_add(o);case"linebreak":return void set_linebreak(o);case"map":return void get_map(o);case"maxsysstaffsep":case"sysstaffsep":if(3==parse.state)return n=get_unit(o),isNaN(n)?void syntax(1,errs.bad_val,"%%"+s):void(par_sy.voices[curvoice.v]["m"==s[0]?"maxsep":"sep"]=n);break;case"multicol":if(parse.state>=2){curvoice=voice_tb[0],r=new_block("mc_"+o);break}switch(o){case"start":multicol={maxy:0,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"new":if(!multicol){syntax(1,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=0;break;case"end":if(!multicol){syntax(1,"%%multicol end without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;default:syntax(1,"Unknown keyword '$1' in %%multicol",o)}return;case"ottava":if(3!=parse.state)return;return i=parseInt(o),isNaN(i)||i<-2||i>2?void syntax(1,errs.bad_val,"%%ottava"):(glovar.ottava=!0,void parse.ottava.push(i));case"repbra":return void(curvoice&&(curvoice.norepbra=!get_bool(o)));case"repeat":if(3!=parse.state)return;if(!curvoice.last_sym)return void syntax(1,"%%repeat cannot start a tune");if(o.length){if(c=o.split(/\s+/),i=parseInt(c[0]),a=parseInt(c[1]),isNaN(i)||i<1||curvoice.last_sym.type==C.BAR&&i>2)return void syntax(1,"Incorrect 1st value in %%repeat");if(isNaN(a))a=1;else if(a<1)return void syntax(1,"Incorrect 2nd value in %%repeat")}else i=1,a=1;return parse.repeat_n=curvoice.last_sym.type==C.BAR?i:-i,void(parse.repeat_k=a);case"sep":var l,u,f,d;return set_page(),d=img.width-img.lm-img.rm,t=l=u=0,o&&(t=get_unit((f=o.split(/\s+/))[0]),f[1]&&(l=get_unit(f[1]),f[2]&&(u=get_unit(f[2]))),isNaN(t)||isNaN(l)||isNaN(u))?void syntax(1,errs.bad_val,"%%sep"):(t<1&&(t=14),l<1&&(l=t),u<1&&(u=90),parse.state>=2?((r=new_block(s)).x=(d-u)/2/cfmt.scale,r.l=u/cfmt.scale,r.sk1=t,void(r.sk2=l)):(vskip(t),output+='<path class="stroke"\n\td="M',out_sxsy((d-u)/2/cfmt.scale," ",0),output+="h"+(u/cfmt.scale).toFixed(1)+'"/>\n',vskip(l),void blk_flush()));case"setbarnb":if(n=parseInt(o),isNaN(n)||n<1){syntax(1,"Bad %%setbarnb value");break}return void(glovar.new_nbar=n);case"staff":if(3!=parse.state)return;return n=parseInt(o),isNaN(n)?void syntax(1,"Bad %%staff value '$1'",o):(p="+"==o[0]||"-"==o[0]?curvoice.cst+n:n-1)<0||p>nstaff?void syntax(1,"Bad %%staff number $1 (cur $2, max $3)",p,curvoice.cst,nstaff):(delete curvoice.floating,void(curvoice.cst=p));var p;case"staffbreak":if(3!=parse.state)return;if(r={type:C.STBRK,dur:0},"f"==o.slice(-1)&&(r.stbrk_forced=!0,o=o.replace(/\sf$/,"")),o){if(n=get_unit(o),isNaN(n))return void syntax(1,errs.bad_val,"%%staffbreak");r.xmx=n}else r.xmx=14;return void sym_link(r);case"stafflines":case"staffscale":case"staffnonote":return void set_v_param(s,o);case"staves":case"score":if(!parse.state)return;return parse.scores&&parse.scores.length>0&&(o=(s=(e=parse.scores.shift()).match(/([^\s]+)\s*(.*)/))[2],s=s[1]),void get_staves(s,o);case"center":case"text":return a="c"==s[0]?"c":cfmt.textoption,set_font("text"),parse.state>=2?((r=new_block("text")).text=o,r.opt=a,void(r.font=cfmt.textfont)):void write_text(o,a);case"transpose":if(cfmt.sound)return;if(null==(n=get_transp(o))&&null==(n=get_interval(o)))return;switch(parse.state){case 0:cfmt.transp=0;case 1:return void(cfmt.transp=(cfmt.transp||0)+n)}for(r=curvoice.last_sym;r;r=r.prev){switch(r.type){case C.NOTE:(r=clone(curvoice.okey)).k_old_sf=curvoice.ckey.k_sf,sym_link(r);break;case C.KEY:break;default:continue}break}return curvoice.transp=n,void set_transp();case"tune":return;case"user":return void set_user(o);case"voicecolor":return void(curvoice&&(curvoice.color=o));case"vskip":return n=get_unit(o),isNaN(n)?void syntax(1,errs.bad_val,"%%vskip"):n<0?void syntax(1,"%%vskip cannot be negative"):parse.state>=2?void((r=new_block(s)).sk=n):void vskip(n);case"newpage":case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"printmargin":case"scale":case"staffwidth":if(parse.state>=2)return void((r=new_block(s)).param=o);if("newpage"==s)return blk_flush(),void(user.page_format&&(blkdiv=2))}self.set_format(s,o)}},Abc.prototype.do_begin_end=function(e,t,n){var r,s,o,i;switch(e){case"js":js_inject(n);break;case"ml":if(cfmt.pageheight){syntax(1,"Cannot have %%beginml with %%pageheight");break}parse.state>=2?(i=new_block(e)).text=n:(blk_flush(),user.img_out&&user.img_out(n));break;case"svg":for(s=0;!((r=n.indexOf("<style",s))<0);){if(r=n.indexOf(">",r),(s=n.indexOf("</style>",r))<0){syntax(1,"No </style> in %%beginsvg sequence");break}style+=n.slice(r+1,s).replace(/\s+$/,"")}for(s=0;!((r=n.indexOf("<defs>\n",s))<0);){if((s=n.indexOf("</defs>",r))<0){syntax(1,"No </defs> in %%beginsvg sequence");break}defs_add(n.slice(r+6,s))}break;case"text":if((o=get_textopt(t))||(o=cfmt.textoption),set_font("text"),n.indexOf("\\")>=0&&(n=cnv_escape(n)),parse.state>1){(i=new_block(e)).text=n,i.opt=o,i.font=cfmt.textfont;break}write_text(n,o)}};var note_names="CDEFGAB",acc_name=["bb","b","","#","##"],hook_init;function gch_tr1(e,t){var n,r,s,o,i,a,c=e.split("/");for(n=0;n<c.length;n++)if(!((r=(e=c[n]).search(/[A-G]/))<0)){for(i=r+1,o=0;"#"==e[i]||"♯"==e[i];)o++,i++;for(;"b"==e[i]||"♭"==e[i];)o--,i++;s=note_names.indexOf(e[r])+16,a=(abc2svg.pab40(s,o)+t+200)%40,a=abc2svg.b40k[a],c[n]=e.slice(0,r)+note_names[abc2svg.b40_p[a]]+acc_name[abc2svg.b40_a[a]+2]+e.slice(i)}return c.join("/")}function gch_transp(e,t){for(var n,r=e.a_gch.length;--r>=0;)"g"==(n=e.a_gch[r]).type&&(n.text=gch_tr1(n.text,t.k_transp))}function csan_add(e){var t;if(e.type==C.BAR)for(t=0;t<a_gch.length;t++)"g"==a_gch[t].type&&(syntax(1,"There cannot be chord symbols on measure bars"),a_gch.splice(t));e.a_gch?e.a_gch=e.a_gch.concat(a_gch):e.a_gch=a_gch,a_gch=null}function draw_all_chsy(){var e,t,n,r,s,o,i=0,a=new Array(nstaff+1);function c(e){var n,r,s,o,i,c;for(s=t;s;s=s.ts_next)if((n=s.a_gch)&&(n=n[r=n.length-e-1])){if(n.pos==C.SL_ABOVE)o=s.x+n.x,(c=n.text.wh[0])&&o+c>realwidth&&(o=realwidth-c),i=y_get(s.st,1,o,c),"g"==n.type&&i<a[s.st].yup&&(i=a[s.st].yup);else{if(n.pos==C.SL_BELOW||n.pos==C.SL_HIDDEN)continue;o=s.x+n.x,i=n.y}self.draw_gchord(r,s,o,i)}}function l(e){for(var n,r,s,o,i=t;i;i=i.ts_next)(n=i.a_gch)&&(n=n[e])&&n.pos==C.SL_BELOW&&(r=i.x+n.x,(o=n.text.wh[0])&&r+o>realwidth&&(r=realwidth-o),s=y_get(i.st,0,r,o),"g"==n.type&&s>a[i.st].ydn&&(s=a[i.st].ydn),self.draw_gchord(e,i,r,s))}for(r=0;r<=nstaff;r++)a[r]={ydn:staff_tb[r].botbar-3,yup:staff_tb[r].topbar+4};for(e=tsfirst;e;e=e.ts_next)if(n=e.a_gch)for(t||(t=e),(r=n.length)>i&&(i=r);--r>=0;)if("g"==n[r].type){o=(n=n[r]).text.wh[0],n.pos==C.SL_ABOVE?(s=y_get(e.st,!0,e.x,o))>a[e.st].yup&&(a[e.st].yup=s):n.pos==C.SL_BELOW&&(s=y_get(e.st,!1,e.x,o))<a[e.st].ydn&&(a[e.st].ydn=s);break}if(t)for(set_dscale(-1),r=0;r<i;r++)c(r),l(r)}function set_hooks(){var e=abc2svg.modules.hooks,t=abc2svg.modules.g_hooks;function n(e){for(var t=0;t<e.length;t++)e[t](self)}hook_init?e.length&&(n(e),t.push.apply(t,e),abc2svg.modules.hooks=[]):(e.length&&(t.push.apply(t,e),abc2svg.modules.hooks=[]),n(t),hook_init=!0)}Abc.prototype.gch_build=function(e){var t,n,r,s,o=0,i=0;for(s=0;s<e.a_gch.length;s++){if("g"==(t=e.a_gch[s]).type)t.text=t.text.replace(/##|#|=|bb|b/g,(function(e){switch(e){case"##":return"&#x1d12a;";case"#":return"♯";case"=":return"♮";case"b":return"♭"}return"&#x1d12b;"}));else if("@"==t.type&&!user.anno_start&&!user.anno_stop){set_font(t.font),t.text=str2svg(t.text),t.text.wh=[0,0];continue}switch(set_font(t.font),t.text=str2svg(t.text),(n=t.text.wh)[1]+=2*t.font.pad,t.type){case"@":break;case"^":case"_":default:(r=.4*n[0])>8&&(r=8),t.x=-r;break;case"<":t.x=-(n[0]+6),o-=n[1],t.y=o+n[1]/2;break;case">":t.x=6,i-=n[1],t.y=i+n[1]/2}}for(o/=2,i/=2,s=0;s<e.a_gch.length;s++)switch((t=e.a_gch[s]).type){case"<":t.y-=o;break;case">":t.y-=i}},Abc.prototype.draw_gchord=function(e,t,n,r){if(!t.invis||!t.play){var s,o=t.a_gch[e],i=o.text.wh[1],a=o.font.pad,c=o.text.wh[0]+2*a,l=0;switch(o.font.figb&&(i*=2.4,l=1.3*o.font.size),o.type){case"_":r-=i+a,y_set(t.st,0,n,c,r-a);break;case"^":r=y_get(t.st,1,n,c),r+=a,y_set(t.st,1,n,c,r+i+a);break;case"<":case">":"<"==o.type?(t.notes[0].acc&&(n-=t.notes[0].shac),n-=a):(t.xmx&&(n+=t.xmx),t.dots&&(n+=1.5+3.5*t.dots),n+=a),(r+=(t.type==C.NOTE?3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18):12)-i/2)>24&&y_set(t.st,1,n,c,r+i+a),r<0&&y_set(t.st,0,n,c,r-a);break;default:r>=0?(r+=a,y_set(t.st,1,n,c,r+i+a)):(r-=i+a,y_set(t.st,0,n,c,r-a));break;case"@":(r+=(t.type==C.NOTE?3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18):12)+.2*i)>0?(s=r+.8*i)>staff_tb[t.st].ann_top&&(staff_tb[t.st].ann_top=s):(s=r)<staff_tb[t.st].ann_bot&&(staff_tb[t.st].ann_bot=s)}use_font(o.font),set_font(o.font),set_dscale(t.st),user.anno_start&&user.anno_start("annot",o.istart,o.iend,n-2,r+i+2,c+4,i+4,t),xy_str(n,r+l,o.text),user.anno_stop&&user.anno_stop("annot",o.istart,o.iend,n-2,r+i+2,c+4,i+4,t)}},init_tune(),Abc.prototype.a_de=function(){return a_de},Abc.prototype.add_style=function(e){style+=e},Abc.prototype.cfmt=function(){return cfmt},Abc.prototype.clone=clone,Abc.prototype.deco_put=function(e,t){a_dcn.push(e),deco_cnv(t)},Abc.prototype.defs_add=defs_add,Abc.prototype.dh_put=function(e,t,n){a_dcn.push(e),dh_cnv(t,n)},Abc.prototype.draw_meter=draw_meter,Abc.prototype.draw_note=draw_note,Abc.prototype.errs=errs,Abc.prototype.font_class=font_class,Abc.prototype.gch_tr1=gch_tr1,Abc.prototype.get_bool=get_bool,Abc.prototype.get_cur_sy=function(){return cur_sy},Abc.prototype.get_curvoice=function(){return curvoice},Abc.prototype.get_delta_tb=function(){return delta_tb},Abc.prototype.get_decos=function(){return decos},Abc.prototype.get_font=get_font,Abc.prototype.get_font_style=function(){return font_style},Abc.prototype.get_glyphs=function(){return glyphs},Abc.prototype.get_img=function(){return img},Abc.prototype.get_maps=function(){return maps},Abc.prototype.get_multi=function(){return multicol},Abc.prototype.get_newpage=function(){if(block.newpage)return block.newpage=!1,!0},Abc.prototype.get_posy=function(){return posy},Abc.prototype.get_staff_tb=function(){return staff_tb},Abc.prototype.get_top_v=function(){return par_sy.top_voice},Abc.prototype.get_tsfirst=function(){return tsfirst},Abc.prototype.get_unit=get_unit,Abc.prototype.get_voice_tb=function(){return voice_tb},Abc.prototype.glout=glout,Abc.prototype.info=function(){return info},Abc.prototype.new_block=new_block,Abc.prototype.out_arp=out_arp,Abc.prototype.out_deco_str=out_deco_str,Abc.prototype.out_deco_val=out_deco_val,Abc.prototype.out_ltr=out_ltr,Abc.prototype.param_set_font=param_set_font,Abc.prototype.parse=parse,Abc.prototype.psdeco=empty_function,Abc.prototype.psxygl=empty_function,Abc.prototype.set_cur_sy=function(e){cur_sy=e},Abc.prototype.set_dscale=set_dscale,Abc.prototype.set_font=set_font,Abc.prototype.set_a_gch=function(e,t){a_gch=t,csan_add(e)},Abc.prototype.set_hl=set_hl,Abc.prototype.set_pagef=function(){blkdiv=1},Abc.prototype.set_realwidth=function(e){realwidth=e},Abc.prototype.set_scale=set_scale,Abc.prototype.set_sscale=set_sscale,Abc.prototype.set_tsfirst=function(e){tsfirst=e},Abc.prototype.set_v_param=set_v_param,Abc.prototype.strwh=strwh,Abc.prototype.stv_g=function(){return stv_g},Abc.prototype.svg_flush=svg_flush,Abc.prototype.syntax=syntax,Abc.prototype.tunes=tunes,Abc.prototype.unlksym=unlksym,Abc.prototype.use_font=use_font,Abc.prototype.vskip=vskip,Abc.prototype.xy_str=xy_str,Abc.prototype.xygl=xygl};var Abc=abc2svg.Abc;__webpack_unused_export__=abc2svg,exports.y=Abc,abc2svg.loadjs||(abc2svg.loadjs=function(e,t,n){n&&n(e)}),abc2svg.modules={ambitus:{},begingrid:{fn:"grid3"},beginps:{fn:"psvg"},break:{},capo:{},chordnames:{},clip:{},clairnote:{fn:"clair"},voicecombine:{fn:"combine"},diagram:{fn:"diag"},equalbars:{},gamelan:{},grid:{},grid2:{},jazzchord:{},jianpu:{},mdnn:{},MIDI:{},nns:{},pageheight:{fn:"page"},pedline:{},percmap:{fn:"perc"},roman:{},soloffs:{},sth:{},strtab:{},temperament:{fn:"temper"},nreq:0,hooks:[],g_hooks:[],load:function(e,t,n){function r(){0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()}var s,o,i,a=this.nreq,c=e.match(/(^|\n)(%%|I:).+?\b/g);if(!c)return!0;for(this.cbf=t||function(){},this.errmsg=n||("object"==typeof user&&user.errmsg?user.errmsg:"function"==typeof abc2svg.printErr?abc2svg.printErr:"function"==typeof alert?function(e){alert(e)}:"object"==typeof console?console.log:function(){}),o=0;o<c.length;o++)i=c[o].replace(/\n?(%%|I:)/,""),(s=abc2svg.modules[i])&&!s.loaded&&(s.loaded=!0,s.fn&&(i=s.fn),this.nreq++,abc2svg.loadjs(i+"-1.js",r,(function(){abc2svg.modules.errmsg("Error loading the module "+i),r()})));return this.nreq==a}},abc2svg.version="1.22.1",abc2svg.vdate="2022-09-13"},486:function(e,t,n){var r;e=n.nmd(e),function(){var s,o="Expected a function",i="__lodash_hash_undefined__",a="__lodash_placeholder__",c=16,l=32,u=64,f=128,d=256,p=1/0,h=9007199254740991,m=NaN,y=4294967295,g=[["ary",f],["bind",1],["bindKey",2],["curry",8],["curryRight",c],["flip",512],["partial",l],["partialRight",u],["rearg",d]],A="[object Arguments]",_="[object Array]",v="[object Boolean]",b="[object Date]",x="[object Error]",w="[object Function]",E="[object GeneratorFunction]",k="[object Map]",C="[object Number]",$="[object Object]",B="[object Promise]",M="[object RegExp]",N="[object Set]",I="[object String]",T="[object Symbol]",S="[object WeakMap]",O="[object ArrayBuffer]",F="[object DataView]",R="[object Float32Array]",D="[object Float64Array]",U="[object Int8Array]",L="[object Int16Array]",Q="[object Int32Array]",j="[object Uint8Array]",P="[object Uint8ClampedArray]",Y="[object Uint16Array]",z="[object Uint32Array]",V=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,G=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,J=/[&<>"']/g,W=RegExp(q.source),K=RegExp(J.source),X=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,se=/[\\^$.*+?()[\]{}|]/g,oe=RegExp(se.source),ie=/^\s+/,ae=/\s/,ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,ue=/,? & /,fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,me=/\w*$/,ye=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,Ae=/^\[object .+?Constructor\]$/,_e=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xe=/($^)/,we=/['\n\r\u2028\u2029\\]/g,Ee="\\ud800-\\udfff",ke="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ce="\\u2700-\\u27bf",$e="a-z\\xdf-\\xf6\\xf8-\\xff",Be="A-Z\\xc0-\\xd6\\xd8-\\xde",Me="\\ufe0e\\ufe0f",Ne="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ie="['’]",Te="["+Ee+"]",Se="["+Ne+"]",Oe="["+ke+"]",Fe="\\d+",Re="["+Ce+"]",De="["+$e+"]",Ue="[^"+Ee+Ne+Fe+Ce+$e+Be+"]",Le="\\ud83c[\\udffb-\\udfff]",Qe="[^"+Ee+"]",je="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ye="["+Be+"]",ze="\\u200d",Ve="(?:"+De+"|"+Ue+")",He="(?:"+Ye+"|"+Ue+")",Ge="(?:['’](?:d|ll|m|re|s|t|ve))?",qe="(?:['’](?:D|LL|M|RE|S|T|VE))?",Je="(?:"+Oe+"|"+Le+")"+"?",We="["+Me+"]?",Ke=We+Je+("(?:"+ze+"(?:"+[Qe,je,Pe].join("|")+")"+We+Je+")*"),Xe="(?:"+[Re,je,Pe].join("|")+")"+Ke,Ze="(?:"+[Qe+Oe+"?",Oe,je,Pe,Te].join("|")+")",et=RegExp(Ie,"g"),tt=RegExp(Oe,"g"),nt=RegExp(Le+"(?="+Le+")|"+Ze+Ke,"g"),rt=RegExp([Ye+"?"+De+"+"+Ge+"(?="+[Se,Ye,"$"].join("|")+")",He+"+"+qe+"(?="+[Se,Ye+Ve,"$"].join("|")+")",Ye+"?"+Ve+"+"+Ge,Ye+"+"+qe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fe,Xe].join("|"),"g"),st=RegExp("["+ze+Ee+ke+Me+"]"),ot=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,it=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,ct={};ct[R]=ct[D]=ct[U]=ct[L]=ct[Q]=ct[j]=ct[P]=ct[Y]=ct[z]=!0,ct[A]=ct[_]=ct[O]=ct[v]=ct[F]=ct[b]=ct[x]=ct[w]=ct[k]=ct[C]=ct[$]=ct[M]=ct[N]=ct[I]=ct[S]=!1;var lt={};lt[A]=lt[_]=lt[O]=lt[F]=lt[v]=lt[b]=lt[R]=lt[D]=lt[U]=lt[L]=lt[Q]=lt[k]=lt[C]=lt[$]=lt[M]=lt[N]=lt[I]=lt[T]=lt[j]=lt[P]=lt[Y]=lt[z]=!0,lt[x]=lt[w]=lt[S]=!1;var ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ft=parseFloat,dt=parseInt,pt="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ht="object"==typeof self&&self&&self.Object===Object&&self,mt=pt||ht||Function("return this")(),yt=t&&!t.nodeType&&t,gt=yt&&e&&!e.nodeType&&e,At=gt&&gt.exports===yt,_t=At&&pt.process,vt=function(){try{var e=gt&&gt.require&&gt.require("util").types;return e||_t&&_t.binding&&_t.binding("util")}catch(e){}}(),bt=vt&&vt.isArrayBuffer,xt=vt&&vt.isDate,wt=vt&&vt.isMap,Et=vt&&vt.isRegExp,kt=vt&&vt.isSet,Ct=vt&&vt.isTypedArray;function $t(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Bt(e,t,n,r){for(var s=-1,o=null==e?0:e.length;++s<o;){var i=e[s];t(r,i,n(i),e)}return r}function Mt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Nt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function It(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Tt(e,t){for(var n=-1,r=null==e?0:e.length,s=0,o=[];++n<r;){var i=e[n];t(i,n,e)&&(o[s++]=i)}return o}function St(e,t){return!!(null==e?0:e.length)&&Yt(e,t,0)>-1}function Ot(e,t,n){for(var r=-1,s=null==e?0:e.length;++r<s;)if(n(t,e[r]))return!0;return!1}function Ft(e,t){for(var n=-1,r=null==e?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}function Rt(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function Dt(e,t,n,r){var s=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++s]);++s<o;)n=t(n,e[s],s,e);return n}function Ut(e,t,n,r){var s=null==e?0:e.length;for(r&&s&&(n=e[--s]);s--;)n=t(n,e[s],s,e);return n}function Lt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Qt=Gt("length");function jt(e,t,n){var r;return n(e,(function(e,n,s){if(t(e,n,s))return r=n,!1})),r}function Pt(e,t,n,r){for(var s=e.length,o=n+(r?1:-1);r?o--:++o<s;)if(t(e[o],o,e))return o;return-1}function Yt(e,t,n){return t==t?function(e,t,n){var r=n-1,s=e.length;for(;++r<s;)if(e[r]===t)return r;return-1}(e,t,n):Pt(e,Vt,n)}function zt(e,t,n,r){for(var s=n-1,o=e.length;++s<o;)if(r(e[s],t))return s;return-1}function Vt(e){return e!=e}function Ht(e,t){var n=null==e?0:e.length;return n?Wt(e,t)/n:m}function Gt(e){return function(t){return null==t?s:t[e]}}function qt(e){return function(t){return null==e?s:e[t]}}function Jt(e,t,n,r,s){return s(e,(function(e,s,o){n=r?(r=!1,e):t(n,e,s,o)})),n}function Wt(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);i!==s&&(n=n===s?i:n+i)}return n}function Kt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Xt(e){return e?e.slice(0,yn(e)+1).replace(ie,""):e}function Zt(e){return function(t){return e(t)}}function en(e,t){return Ft(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&Yt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&Yt(t,e[n],0)>-1;);return n}var sn=qt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),on=qt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(e){return"\\"+ut[e]}function cn(e){return st.test(e)}function ln(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function un(e,t){return function(n){return e(t(n))}}function fn(e,t){for(var n=-1,r=e.length,s=0,o=[];++n<r;){var i=e[n];i!==t&&i!==a||(e[n]=a,o[s++]=n)}return o}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function pn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function hn(e){return cn(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):Qt(e)}function mn(e){return cn(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function yn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var gn=qt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var An=function e(t){var n,r=(t=null==t?mt:An.defaults(mt.Object(),t,An.pick(mt,it))).Array,ae=t.Date,Ee=t.Error,ke=t.Function,Ce=t.Math,$e=t.Object,Be=t.RegExp,Me=t.String,Ne=t.TypeError,Ie=r.prototype,Te=ke.prototype,Se=$e.prototype,Oe=t["__core-js_shared__"],Fe=Te.toString,Re=Se.hasOwnProperty,De=0,Ue=(n=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Le=Se.toString,Qe=Fe.call($e),je=mt._,Pe=Be("^"+Fe.call(Re).replace(se,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ye=At?t.Buffer:s,ze=t.Symbol,Ve=t.Uint8Array,He=Ye?Ye.allocUnsafe:s,Ge=un($e.getPrototypeOf,$e),qe=$e.create,Je=Se.propertyIsEnumerable,We=Ie.splice,Ke=ze?ze.isConcatSpreadable:s,Xe=ze?ze.iterator:s,Ze=ze?ze.toStringTag:s,nt=function(){try{var e=po($e,"defineProperty");return e({},"",{}),e}catch(e){}}(),st=t.clearTimeout!==mt.clearTimeout&&t.clearTimeout,ut=ae&&ae.now!==mt.Date.now&&ae.now,pt=t.setTimeout!==mt.setTimeout&&t.setTimeout,ht=Ce.ceil,yt=Ce.floor,gt=$e.getOwnPropertySymbols,_t=Ye?Ye.isBuffer:s,vt=t.isFinite,Qt=Ie.join,qt=un($e.keys,$e),_n=Ce.max,vn=Ce.min,bn=ae.now,xn=t.parseInt,wn=Ce.random,En=Ie.reverse,kn=po(t,"DataView"),Cn=po(t,"Map"),$n=po(t,"Promise"),Bn=po(t,"Set"),Mn=po(t,"WeakMap"),Nn=po($e,"create"),In=Mn&&new Mn,Tn={},Sn=Lo(kn),On=Lo(Cn),Fn=Lo($n),Rn=Lo(Bn),Dn=Lo(Mn),Un=ze?ze.prototype:s,Ln=Un?Un.valueOf:s,Qn=Un?Un.toString:s;function jn(e){if(na(e)&&!Vi(e)&&!(e instanceof Vn)){if(e instanceof zn)return e;if(Re.call(e,"__wrapped__"))return Qo(e)}return new zn(e)}var Pn=function(){function e(){}return function(t){if(!ta(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Yn(){}function zn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function Vn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=y,this.__views__=[]}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Jn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new qn;++t<n;)this.add(e[t])}function Wn(e){var t=this.__data__=new Gn(e);this.size=t.size}function Kn(e,t){var n=Vi(e),r=!n&&zi(e),s=!n&&!r&&Ji(e),o=!n&&!r&&!s&&ua(e),i=n||r||s||o,a=i?Kt(e.length,Me):[],c=a.length;for(var l in e)!t&&!Re.call(e,l)||i&&("length"==l||s&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||vo(l,c))||a.push(l);return a}function Xn(e){var t=e.length;return t?e[Jr(0,t-1)]:s}function Zn(e,t){return Ro(Ns(e),cr(t,0,e.length))}function er(e){return Ro(Ns(e))}function tr(e,t,n){(n!==s&&!ji(e[t],n)||n===s&&!(t in e))&&ir(e,t,n)}function nr(e,t,n){var r=e[t];Re.call(e,t)&&ji(r,n)&&(n!==s||t in e)||ir(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(ji(e[n][0],t))return n;return-1}function sr(e,t,n,r){return pr(e,(function(e,s,o){t(r,e,n(e),o)})),r}function or(e,t){return e&&Is(t,Ta(t),e)}function ir(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var n=-1,o=t.length,i=r(o),a=null==e;++n<o;)i[n]=a?s:$a(e,t[n]);return i}function cr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function lr(e,t,n,r,o,i){var a,c=1&t,l=2&t,u=4&t;if(n&&(a=o?n(e,r,o,i):n(e)),a!==s)return a;if(!ta(e))return e;var f=Vi(e);if(f){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Re.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Ns(e,a)}else{var d=yo(e),p=d==w||d==E;if(Ji(e))return Es(e,c);if(d==$||d==A||p&&!o){if(a=l||p?{}:Ao(e),!c)return l?function(e,t){return Is(e,mo(e),t)}(e,function(e,t){return e&&Is(t,Sa(t),e)}(a,e)):function(e,t){return Is(e,ho(e),t)}(e,or(a,e))}else{if(!lt[d])return o?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case O:return ks(e);case v:case b:return new r(+e);case F:return function(e,t){var n=t?ks(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case R:case D:case U:case L:case Q:case j:case P:case Y:case z:return Cs(e,n);case k:return new r;case C:case I:return new r(e);case M:return function(e){var t=new e.constructor(e.source,me.exec(e));return t.lastIndex=e.lastIndex,t}(e);case N:return new r;case T:return s=e,Ln?$e(Ln.call(s)):{}}var s}(e,d,c)}}i||(i=new Wn);var h=i.get(e);if(h)return h;i.set(e,a),aa(e)?e.forEach((function(r){a.add(lr(r,t,n,r,e,i))})):ra(e)&&e.forEach((function(r,s){a.set(s,lr(r,t,n,s,e,i))}));var m=f?s:(u?l?oo:so:l?Sa:Ta)(e);return Mt(m||e,(function(r,s){m&&(r=e[s=r]),nr(a,s,lr(r,t,n,s,e,i))})),a}function ur(e,t,n){var r=n.length;if(null==e)return!r;for(e=$e(e);r--;){var o=n[r],i=t[o],a=e[o];if(a===s&&!(o in e)||!i(a))return!1}return!0}function fr(e,t,n){if("function"!=typeof e)throw new Ne(o);return To((function(){e.apply(s,n)}),t)}function dr(e,t,n,r){var s=-1,o=St,i=!0,a=e.length,c=[],l=t.length;if(!a)return c;n&&(t=Ft(t,Zt(n))),r?(o=Ot,i=!1):t.length>=200&&(o=tn,i=!1,t=new Jn(t));e:for(;++s<a;){var u=e[s],f=null==n?u:n(u);if(u=r||0!==u?u:0,i&&f==f){for(var d=l;d--;)if(t[d]===f)continue e;c.push(u)}else o(t,f,r)||c.push(u)}return c}jn.templateSettings={escape:X,evaluate:Z,interpolate:ee,variable:"",imports:{_:jn}},jn.prototype=Yn.prototype,jn.prototype.constructor=jn,zn.prototype=Pn(Yn.prototype),zn.prototype.constructor=zn,Vn.prototype=Pn(Yn.prototype),Vn.prototype.constructor=Vn,Hn.prototype.clear=function(){this.__data__=Nn?Nn(null):{},this.size=0},Hn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hn.prototype.get=function(e){var t=this.__data__;if(Nn){var n=t[e];return n===i?s:n}return Re.call(t,e)?t[e]:s},Hn.prototype.has=function(e){var t=this.__data__;return Nn?t[e]!==s:Re.call(t,e)},Hn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Nn&&t===s?i:t,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():We.call(t,n,1),--this.size,!0)},Gn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?s:t[n][1]},Gn.prototype.has=function(e){return rr(this.__data__,e)>-1},Gn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(Cn||Gn),string:new Hn}},qn.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},qn.prototype.get=function(e){return uo(this,e).get(e)},qn.prototype.has=function(e){return uo(this,e).has(e)},qn.prototype.set=function(e,t){var n=uo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Jn.prototype.add=Jn.prototype.push=function(e){return this.__data__.set(e,i),this},Jn.prototype.has=function(e){return this.__data__.has(e)},Wn.prototype.clear=function(){this.__data__=new Gn,this.size=0},Wn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Wn.prototype.get=function(e){return this.__data__.get(e)},Wn.prototype.has=function(e){return this.__data__.has(e)},Wn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!Cn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(e,t),this.size=n.size,this};var pr=Os(br),hr=Os(xr,!0);function mr(e,t){var n=!0;return pr(e,(function(e,r,s){return n=!!t(e,r,s)})),n}function yr(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(c===s?a==a&&!la(a):n(a,c)))var c=a,l=i}return l}function gr(e,t){var n=[];return pr(e,(function(e,r,s){t(e,r,s)&&n.push(e)})),n}function Ar(e,t,n,r,s){var o=-1,i=e.length;for(n||(n=_o),s||(s=[]);++o<i;){var a=e[o];t>0&&n(a)?t>1?Ar(a,t-1,n,r,s):Rt(s,a):r||(s[s.length]=a)}return s}var _r=Fs(),vr=Fs(!0);function br(e,t){return e&&_r(e,t,Ta)}function xr(e,t){return e&&vr(e,t,Ta)}function wr(e,t){return Tt(t,(function(t){return Xi(e[t])}))}function Er(e,t){for(var n=0,r=(t=vs(t,e)).length;null!=e&&n<r;)e=e[Uo(t[n++])];return n&&n==r?e:s}function kr(e,t,n){var r=t(e);return Vi(e)?r:Rt(r,n(e))}function Cr(e){return null==e?e===s?"[object Undefined]":"[object Null]":Ze&&Ze in $e(e)?function(e){var t=Re.call(e,Ze),n=e[Ze];try{e[Ze]=s;var r=!0}catch(e){}var o=Le.call(e);r&&(t?e[Ze]=n:delete e[Ze]);return o}(e):function(e){return Le.call(e)}(e)}function $r(e,t){return e>t}function Br(e,t){return null!=e&&Re.call(e,t)}function Mr(e,t){return null!=e&&t in $e(e)}function Nr(e,t,n){for(var o=n?Ot:St,i=e[0].length,a=e.length,c=a,l=r(a),u=1/0,f=[];c--;){var d=e[c];c&&t&&(d=Ft(d,Zt(t))),u=vn(d.length,u),l[c]=!n&&(t||i>=120&&d.length>=120)?new Jn(c&&d):s}d=e[0];var p=-1,h=l[0];e:for(;++p<i&&f.length<u;){var m=d[p],y=t?t(m):m;if(m=n||0!==m?m:0,!(h?tn(h,y):o(f,y,n))){for(c=a;--c;){var g=l[c];if(!(g?tn(g,y):o(e[c],y,n)))continue e}h&&h.push(y),f.push(m)}}return f}function Ir(e,t,n){var r=null==(e=Mo(e,t=vs(t,e)))?e:e[Uo(Ko(t))];return null==r?s:$t(r,e,n)}function Tr(e){return na(e)&&Cr(e)==A}function Sr(e,t,n,r,o){return e===t||(null==e||null==t||!na(e)&&!na(t)?e!=e&&t!=t:function(e,t,n,r,o,i){var a=Vi(e),c=Vi(t),l=a?_:yo(e),u=c?_:yo(t),f=(l=l==A?$:l)==$,d=(u=u==A?$:u)==$,p=l==u;if(p&&Ji(e)){if(!Ji(t))return!1;a=!0,f=!1}if(p&&!f)return i||(i=new Wn),a||ua(e)?no(e,t,n,r,o,i):function(e,t,n,r,s,o,i){switch(n){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!o(new Ve(e),new Ve(t)));case v:case b:case C:return ji(+e,+t);case x:return e.name==t.name&&e.message==t.message;case M:case I:return e==t+"";case k:var a=ln;case N:var c=1&r;if(a||(a=dn),e.size!=t.size&&!c)return!1;var l=i.get(e);if(l)return l==t;r|=2,i.set(e,t);var u=no(a(e),a(t),r,s,o,i);return i.delete(e),u;case T:if(Ln)return Ln.call(e)==Ln.call(t)}return!1}(e,t,l,n,r,o,i);if(!(1&n)){var h=f&&Re.call(e,"__wrapped__"),m=d&&Re.call(t,"__wrapped__");if(h||m){var y=h?e.value():e,g=m?t.value():t;return i||(i=new Wn),o(y,g,n,r,i)}}if(!p)return!1;return i||(i=new Wn),function(e,t,n,r,o,i){var a=1&n,c=so(e),l=c.length,u=so(t),f=u.length;if(l!=f&&!a)return!1;var d=l;for(;d--;){var p=c[d];if(!(a?p in t:Re.call(t,p)))return!1}var h=i.get(e),m=i.get(t);if(h&&m)return h==t&&m==e;var y=!0;i.set(e,t),i.set(t,e);var g=a;for(;++d<l;){var A=e[p=c[d]],_=t[p];if(r)var v=a?r(_,A,p,t,e,i):r(A,_,p,e,t,i);if(!(v===s?A===_||o(A,_,n,r,i):v)){y=!1;break}g||(g="constructor"==p)}if(y&&!g){var b=e.constructor,x=t.constructor;b==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(y=!1)}return i.delete(e),i.delete(t),y}(e,t,n,r,o,i)}(e,t,n,r,Sr,o))}function Or(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=$e(e);o--;){var c=n[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<i;){var l=(c=n[o])[0],u=e[l],f=c[1];if(a&&c[2]){if(u===s&&!(l in e))return!1}else{var d=new Wn;if(r)var p=r(u,f,l,e,t,d);if(!(p===s?Sr(f,u,3,r,d):p))return!1}}return!0}function Fr(e){return!(!ta(e)||(t=e,Ue&&Ue in t))&&(Xi(e)?Pe:Ae).test(Lo(e));var t}function Rr(e){return"function"==typeof e?e:null==e?sc:"object"==typeof e?Vi(e)?Pr(e[0],e[1]):jr(e):pc(e)}function Dr(e){if(!ko(e))return qt(e);var t=[];for(var n in $e(e))Re.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ur(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var n in $e(e))t.push(n);return t}(e);var t=ko(e),n=[];for(var r in e)("constructor"!=r||!t&&Re.call(e,r))&&n.push(r);return n}function Lr(e,t){return e<t}function Qr(e,t){var n=-1,s=Gi(e)?r(e.length):[];return pr(e,(function(e,r,o){s[++n]=t(e,r,o)})),s}function jr(e){var t=fo(e);return 1==t.length&&t[0][2]?$o(t[0][0],t[0][1]):function(n){return n===e||Or(n,e,t)}}function Pr(e,t){return xo(e)&&Co(t)?$o(Uo(e),t):function(n){var r=$a(n,e);return r===s&&r===t?Ba(n,e):Sr(t,r,3)}}function Yr(e,t,n,r,o){e!==t&&_r(t,(function(i,a){if(o||(o=new Wn),ta(i))!function(e,t,n,r,o,i,a){var c=No(e,n),l=No(t,n),u=a.get(l);if(u)return void tr(e,n,u);var f=i?i(c,l,n+"",e,t,a):s,d=f===s;if(d){var p=Vi(l),h=!p&&Ji(l),m=!p&&!h&&ua(l);f=l,p||h||m?Vi(c)?f=c:qi(c)?f=Ns(c):h?(d=!1,f=Es(l,!0)):m?(d=!1,f=Cs(l,!0)):f=[]:oa(l)||zi(l)?(f=c,zi(c)?f=Aa(c):ta(c)&&!Xi(c)||(f=Ao(l))):d=!1}d&&(a.set(l,f),o(f,l,r,i,a),a.delete(l));tr(e,n,f)}(e,t,a,n,Yr,r,o);else{var c=r?r(No(e,a),i,a+"",e,t,o):s;c===s&&(c=i),tr(e,a,c)}}),Sa)}function zr(e,t){var n=e.length;if(n)return vo(t+=t<0?n:0,n)?e[t]:s}function Vr(e,t,n){t=t.length?Ft(t,(function(e){return Vi(e)?function(t){return Er(t,1===e.length?e[0]:e)}:e})):[sc];var r=-1;t=Ft(t,Zt(lo()));var s=Qr(e,(function(e,n,s){var o=Ft(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(s,(function(e,t){return function(e,t,n){var r=-1,s=e.criteria,o=t.criteria,i=s.length,a=n.length;for(;++r<i;){var c=$s(s[r],o[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Hr(e,t,n){for(var r=-1,s=t.length,o={};++r<s;){var i=t[r],a=Er(e,i);n(a,i)&&es(o,vs(i,e),a)}return o}function Gr(e,t,n,r){var s=r?zt:Yt,o=-1,i=t.length,a=e;for(e===t&&(t=Ns(t)),n&&(a=Ft(e,Zt(n)));++o<i;)for(var c=0,l=t[o],u=n?n(l):l;(c=s(a,u,c,r))>-1;)a!==e&&We.call(a,c,1),We.call(e,c,1);return e}function qr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var s=t[n];if(n==r||s!==o){var o=s;vo(s)?We.call(e,s,1):ds(e,s)}}return e}function Jr(e,t){return e+yt(wn()*(t-e+1))}function Wr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=yt(t/2))&&(e+=e)}while(t);return n}function Kr(e,t){return So(Bo(e,t,sc),e+"")}function Xr(e){return Xn(ja(e))}function Zr(e,t){var n=ja(e);return Ro(n,cr(t,0,n.length))}function es(e,t,n,r){if(!ta(e))return e;for(var o=-1,i=(t=vs(t,e)).length,a=i-1,c=e;null!=c&&++o<i;){var l=Uo(t[o]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=a){var f=c[l];(u=r?r(f,l,c):s)===s&&(u=ta(f)?f:vo(t[o+1])?[]:{})}nr(c,l,u),c=c[l]}return e}var ts=In?function(e,t){return In.set(e,t),e}:sc,ns=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:tc(t),writable:!0})}:sc;function rs(e){return Ro(ja(e))}function ss(e,t,n){var s=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=r(o);++s<o;)i[s]=e[s+t];return i}function os(e,t){var n;return pr(e,(function(e,r,s){return!(n=t(e,r,s))})),!!n}function is(e,t,n){var r=0,s=null==e?r:e.length;if("number"==typeof t&&t==t&&s<=2147483647){for(;r<s;){var o=r+s>>>1,i=e[o];null!==i&&!la(i)&&(n?i<=t:i<t)?r=o+1:s=o}return s}return as(e,t,sc,n)}function as(e,t,n,r){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var a=(t=n(t))!=t,c=null===t,l=la(t),u=t===s;o<i;){var f=yt((o+i)/2),d=n(e[f]),p=d!==s,h=null===d,m=d==d,y=la(d);if(a)var g=r||m;else g=u?m&&(r||p):c?m&&p&&(r||!h):l?m&&p&&!h&&(r||!y):!h&&!y&&(r?d<=t:d<t);g?o=f+1:i=f}return vn(i,4294967294)}function cs(e,t){for(var n=-1,r=e.length,s=0,o=[];++n<r;){var i=e[n],a=t?t(i):i;if(!n||!ji(a,c)){var c=a;o[s++]=0===i?0:i}}return o}function ls(e){return"number"==typeof e?e:la(e)?m:+e}function us(e){if("string"==typeof e)return e;if(Vi(e))return Ft(e,us)+"";if(la(e))return Qn?Qn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function fs(e,t,n){var r=-1,s=St,o=e.length,i=!0,a=[],c=a;if(n)i=!1,s=Ot;else if(o>=200){var l=t?null:Ws(e);if(l)return dn(l);i=!1,s=tn,c=new Jn}else c=t?[]:a;e:for(;++r<o;){var u=e[r],f=t?t(u):u;if(u=n||0!==u?u:0,i&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;t&&c.push(f),a.push(u)}else s(c,f,n)||(c!==a&&c.push(f),a.push(u))}return a}function ds(e,t){return null==(e=Mo(e,t=vs(t,e)))||delete e[Uo(Ko(t))]}function ps(e,t,n,r){return es(e,t,n(Er(e,t)),r)}function hs(e,t,n,r){for(var s=e.length,o=r?s:-1;(r?o--:++o<s)&&t(e[o],o,e););return n?ss(e,r?0:o,r?o+1:s):ss(e,r?o+1:0,r?s:o)}function ms(e,t){var n=e;return n instanceof Vn&&(n=n.value()),Dt(t,(function(e,t){return t.func.apply(t.thisArg,Rt([e],t.args))}),n)}function ys(e,t,n){var s=e.length;if(s<2)return s?fs(e[0]):[];for(var o=-1,i=r(s);++o<s;)for(var a=e[o],c=-1;++c<s;)c!=o&&(i[o]=dr(i[o]||a,e[c],t,n));return fs(Ar(i,1),t,n)}function gs(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var c=r<i?t[r]:s;n(a,e[r],c)}return a}function As(e){return qi(e)?e:[]}function _s(e){return"function"==typeof e?e:sc}function vs(e,t){return Vi(e)?e:xo(e,t)?[e]:Do(_a(e))}var bs=Kr;function xs(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:ss(e,t,n)}var ws=st||function(e){return mt.clearTimeout(e)};function Es(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function ks(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function Cs(e,t){var n=t?ks(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function $s(e,t){if(e!==t){var n=e!==s,r=null===e,o=e==e,i=la(e),a=t!==s,c=null===t,l=t==t,u=la(t);if(!c&&!u&&!i&&e>t||i&&a&&l&&!c&&!u||r&&a&&l||!n&&l||!o)return 1;if(!r&&!i&&!u&&e<t||u&&n&&o&&!r&&!i||c&&n&&o||!a&&o||!l)return-1}return 0}function Bs(e,t,n,s){for(var o=-1,i=e.length,a=n.length,c=-1,l=t.length,u=_n(i-a,0),f=r(l+u),d=!s;++c<l;)f[c]=t[c];for(;++o<a;)(d||o<i)&&(f[n[o]]=e[o]);for(;u--;)f[c++]=e[o++];return f}function Ms(e,t,n,s){for(var o=-1,i=e.length,a=-1,c=n.length,l=-1,u=t.length,f=_n(i-c,0),d=r(f+u),p=!s;++o<f;)d[o]=e[o];for(var h=o;++l<u;)d[h+l]=t[l];for(;++a<c;)(p||o<i)&&(d[h+n[a]]=e[o++]);return d}function Ns(e,t){var n=-1,s=e.length;for(t||(t=r(s));++n<s;)t[n]=e[n];return t}function Is(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var c=t[i],l=r?r(n[c],e[c],c,n,e):s;l===s&&(l=e[c]),o?ir(n,c,l):nr(n,c,l)}return n}function Ts(e,t){return function(n,r){var s=Vi(n)?Bt:sr,o=t?t():{};return s(n,e,lo(r,2),o)}}function Ss(e){return Kr((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:s,a=o>2?n[2]:s;for(i=e.length>3&&"function"==typeof i?(o--,i):s,a&&bo(n[0],n[1],a)&&(i=o<3?s:i,o=1),t=$e(t);++r<o;){var c=n[r];c&&e(t,c,r,i)}return t}))}function Os(e,t){return function(n,r){if(null==n)return n;if(!Gi(n))return e(n,r);for(var s=n.length,o=t?s:-1,i=$e(n);(t?o--:++o<s)&&!1!==r(i[o],o,i););return n}}function Fs(e){return function(t,n,r){for(var s=-1,o=$e(t),i=r(t),a=i.length;a--;){var c=i[e?a:++s];if(!1===n(o[c],c,o))break}return t}}function Rs(e){return function(t){var n=cn(t=_a(t))?mn(t):s,r=n?n[0]:t.charAt(0),o=n?xs(n,1).join(""):t.slice(1);return r[e]()+o}}function Ds(e){return function(t){return Dt(Xa(za(t).replace(et,"")),e,"")}}function Us(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Pn(e.prototype),r=e.apply(n,t);return ta(r)?r:n}}function Ls(e){return function(t,n,r){var o=$e(t);if(!Gi(t)){var i=lo(n,3);t=Ta(t),n=function(e){return i(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:s}}function Qs(e){return ro((function(t){var n=t.length,r=n,i=zn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Ne(o);if(i&&!c&&"wrapper"==ao(a))var c=new zn([],!0)}for(r=c?r:n;++r<n;){var l=ao(a=t[r]),u="wrapper"==l?io(a):s;c=u&&wo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[ao(u[0])].apply(c,u[3]):1==a.length&&wo(a)?c[l]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Vi(r))return c.plant(r).value();for(var s=0,o=n?t[s].apply(this,e):r;++s<n;)o=t[s].call(this,o);return o}}))}function js(e,t,n,o,i,a,c,l,u,d){var p=t&f,h=1&t,m=2&t,y=24&t,g=512&t,A=m?s:Us(e);return function f(){for(var _=arguments.length,v=r(_),b=_;b--;)v[b]=arguments[b];if(y)var x=co(f),w=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(v,x);if(o&&(v=Bs(v,o,i,y)),a&&(v=Ms(v,a,c,y)),_-=w,y&&_<d){var E=fn(v,x);return qs(e,t,js,f.placeholder,n,v,E,l,u,d-_)}var k=h?n:this,C=m?k[e]:e;return _=v.length,l?v=function(e,t){var n=e.length,r=vn(t.length,n),o=Ns(e);for(;r--;){var i=t[r];e[r]=vo(i,n)?o[i]:s}return e}(v,l):g&&_>1&&v.reverse(),p&&u<_&&(v.length=u),this&&this!==mt&&this instanceof f&&(C=A||Us(C)),C.apply(k,v)}}function Ps(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,s,o){t(r,n(e),s,o)})),r}(n,e,t(r),{})}}function Ys(e,t){return function(n,r){var o;if(n===s&&r===s)return t;if(n!==s&&(o=n),r!==s){if(o===s)return r;"string"==typeof n||"string"==typeof r?(n=us(n),r=us(r)):(n=ls(n),r=ls(r)),o=e(n,r)}return o}}function zs(e){return ro((function(t){return t=Ft(t,Zt(lo())),Kr((function(n){var r=this;return e(t,(function(e){return $t(e,r,n)}))}))}))}function Vs(e,t){var n=(t=t===s?" ":us(t)).length;if(n<2)return n?Wr(t,e):t;var r=Wr(t,ht(e/hn(t)));return cn(t)?xs(mn(r),0,e).join(""):r.slice(0,e)}function Hs(e){return function(t,n,o){return o&&"number"!=typeof o&&bo(t,n,o)&&(n=o=s),t=ha(t),n===s?(n=t,t=0):n=ha(n),function(e,t,n,s){for(var o=-1,i=_n(ht((t-e)/(n||1)),0),a=r(i);i--;)a[s?i:++o]=e,e+=n;return a}(t,n,o=o===s?t<n?1:-1:ha(o),e)}}function Gs(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ga(t),n=ga(n)),e(t,n)}}function qs(e,t,n,r,o,i,a,c,f,d){var p=8&t;t|=p?l:u,4&(t&=~(p?u:l))||(t&=-4);var h=[e,t,o,p?i:s,p?a:s,p?s:i,p?s:a,c,f,d],m=n.apply(s,h);return wo(e)&&Io(m,h),m.placeholder=r,Oo(m,e,t)}function Js(e){var t=Ce[e];return function(e,n){if(e=ga(e),(n=null==n?0:vn(ma(n),292))&&vt(e)){var r=(_a(e)+"e").split("e");return+((r=(_a(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Ws=Bn&&1/dn(new Bn([,-0]))[1]==p?function(e){return new Bn(e)}:lc;function Ks(e){return function(t){var n=yo(t);return n==k?ln(t):n==N?pn(t):function(e,t){return Ft(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xs(e,t,n,i,p,h,m,y){var g=2&t;if(!g&&"function"!=typeof e)throw new Ne(o);var A=i?i.length:0;if(A||(t&=-97,i=p=s),m=m===s?m:_n(ma(m),0),y=y===s?y:ma(y),A-=p?p.length:0,t&u){var _=i,v=p;i=p=s}var b=g?s:io(e),x=[e,t,n,i,p,_,v,h,m,y];if(b&&function(e,t){var n=e[1],r=t[1],s=n|r,o=s<131,i=r==f&&8==n||r==f&&n==d&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!i)return e;1&r&&(e[2]=t[2],s|=1&n?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?Bs(l,c,t[4]):c,e[4]=l?fn(e[3],a):t[4]}(c=t[5])&&(l=e[5],e[5]=l?Ms(l,c,t[6]):c,e[6]=l?fn(e[5],a):t[6]);(c=t[7])&&(e[7]=c);r&f&&(e[8]=null==e[8]?t[8]:vn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=s}(x,b),e=x[0],t=x[1],n=x[2],i=x[3],p=x[4],!(y=x[9]=x[9]===s?g?0:e.length:_n(x[9]-A,0))&&24&t&&(t&=-25),t&&1!=t)w=8==t||t==c?function(e,t,n){var o=Us(e);return function i(){for(var a=arguments.length,c=r(a),l=a,u=co(i);l--;)c[l]=arguments[l];var f=a<3&&c[0]!==u&&c[a-1]!==u?[]:fn(c,u);return(a-=f.length)<n?qs(e,t,js,i.placeholder,s,c,f,s,s,n-a):$t(this&&this!==mt&&this instanceof i?o:e,this,c)}}(e,t,y):t!=l&&33!=t||p.length?js.apply(s,x):function(e,t,n,s){var o=1&t,i=Us(e);return function t(){for(var a=-1,c=arguments.length,l=-1,u=s.length,f=r(u+c),d=this&&this!==mt&&this instanceof t?i:e;++l<u;)f[l]=s[l];for(;c--;)f[l++]=arguments[++a];return $t(d,o?n:this,f)}}(e,t,n,i);else var w=function(e,t,n){var r=1&t,s=Us(e);return function t(){return(this&&this!==mt&&this instanceof t?s:e).apply(r?n:this,arguments)}}(e,t,n);return Oo((b?ts:Io)(w,x),e,t)}function Zs(e,t,n,r){return e===s||ji(e,Se[n])&&!Re.call(r,n)?t:e}function eo(e,t,n,r,o,i){return ta(e)&&ta(t)&&(i.set(t,e),Yr(e,t,s,eo,i),i.delete(t)),e}function to(e){return oa(e)?s:e}function no(e,t,n,r,o,i){var a=1&n,c=e.length,l=t.length;if(c!=l&&!(a&&l>c))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var d=-1,p=!0,h=2&n?new Jn:s;for(i.set(e,t),i.set(t,e);++d<c;){var m=e[d],y=t[d];if(r)var g=a?r(y,m,d,t,e,i):r(m,y,d,e,t,i);if(g!==s){if(g)continue;p=!1;break}if(h){if(!Lt(t,(function(e,t){if(!tn(h,t)&&(m===e||o(m,e,n,r,i)))return h.push(t)}))){p=!1;break}}else if(m!==y&&!o(m,y,n,r,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function ro(e){return So(Bo(e,s,Ho),e+"")}function so(e){return kr(e,Ta,ho)}function oo(e){return kr(e,Sa,mo)}var io=In?function(e){return In.get(e)}:lc;function ao(e){for(var t=e.name+"",n=Tn[t],r=Re.call(Tn,t)?n.length:0;r--;){var s=n[r],o=s.func;if(null==o||o==e)return s.name}return t}function co(e){return(Re.call(jn,"placeholder")?jn:e).placeholder}function lo(){var e=jn.iteratee||oc;return e=e===oc?Rr:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n,r,s=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?s["string"==typeof t?"string":"hash"]:s.map}function fo(e){for(var t=Ta(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,Co(s)]}return t}function po(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return Fr(n)?n:s}var ho=gt?function(e){return null==e?[]:(e=$e(e),Tt(gt(e),(function(t){return Je.call(e,t)})))}:yc,mo=gt?function(e){for(var t=[];e;)Rt(t,ho(e)),e=Ge(e);return t}:yc,yo=Cr;function go(e,t,n){for(var r=-1,s=(t=vs(t,e)).length,o=!1;++r<s;){var i=Uo(t[r]);if(!(o=null!=e&&n(e,i)))break;e=e[i]}return o||++r!=s?o:!!(s=null==e?0:e.length)&&ea(s)&&vo(i,s)&&(Vi(e)||zi(e))}function Ao(e){return"function"!=typeof e.constructor||ko(e)?{}:Pn(Ge(e))}function _o(e){return Vi(e)||zi(e)||!!(Ke&&e&&e[Ke])}function vo(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function bo(e,t,n){if(!ta(n))return!1;var r=typeof t;return!!("number"==r?Gi(n)&&vo(t,n.length):"string"==r&&t in n)&&ji(n[t],e)}function xo(e,t){if(Vi(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!la(e))||(ne.test(e)||!te.test(e)||null!=t&&e in $e(t))}function wo(e){var t=ao(e),n=jn[t];if("function"!=typeof n||!(t in Vn.prototype))return!1;if(e===n)return!0;var r=io(n);return!!r&&e===r[0]}(kn&&yo(new kn(new ArrayBuffer(1)))!=F||Cn&&yo(new Cn)!=k||$n&&yo($n.resolve())!=B||Bn&&yo(new Bn)!=N||Mn&&yo(new Mn)!=S)&&(yo=function(e){var t=Cr(e),n=t==$?e.constructor:s,r=n?Lo(n):"";if(r)switch(r){case Sn:return F;case On:return k;case Fn:return B;case Rn:return N;case Dn:return S}return t});var Eo=Oe?Xi:gc;function ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Se)}function Co(e){return e==e&&!ta(e)}function $o(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==s||e in $e(n)))}}function Bo(e,t,n){return t=_n(t===s?e.length-1:t,0),function(){for(var s=arguments,o=-1,i=_n(s.length-t,0),a=r(i);++o<i;)a[o]=s[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=s[o];return c[t]=n(a),$t(e,this,c)}}function Mo(e,t){return t.length<2?e:Er(e,ss(t,0,-1))}function No(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Io=Fo(ts),To=pt||function(e,t){return mt.setTimeout(e,t)},So=Fo(ns);function Oo(e,t,n){var r=t+"";return So(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ce,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Mt(g,(function(n){var r="_."+n[0];t&n[1]&&!St(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(le);return t?t[1].split(ue):[]}(r),n)))}function Fo(e){var t=0,n=0;return function(){var r=bn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(s,arguments)}}function Ro(e,t){var n=-1,r=e.length,o=r-1;for(t=t===s?r:t;++n<t;){var i=Jr(n,o),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}var Do=function(e){var t=Fi(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,s){t.push(r?s.replace(pe,"$1"):n||e)})),t}));function Uo(e){if("string"==typeof e||la(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Lo(e){if(null!=e){try{return Fe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Qo(e){if(e instanceof Vn)return e.clone();var t=new zn(e.__wrapped__,e.__chain__);return t.__actions__=Ns(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var jo=Kr((function(e,t){return qi(e)?dr(e,Ar(t,1,qi,!0)):[]})),Po=Kr((function(e,t){var n=Ko(t);return qi(n)&&(n=s),qi(e)?dr(e,Ar(t,1,qi,!0),lo(n,2)):[]})),Yo=Kr((function(e,t){var n=Ko(t);return qi(n)&&(n=s),qi(e)?dr(e,Ar(t,1,qi,!0),s,n):[]}));function zo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=null==n?0:ma(n);return s<0&&(s=_n(r+s,0)),Pt(e,lo(t,3),s)}function Vo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==s&&(o=ma(n),o=n<0?_n(r+o,0):vn(o,r-1)),Pt(e,lo(t,3),o,!0)}function Ho(e){return(null==e?0:e.length)?Ar(e,1):[]}function Go(e){return e&&e.length?e[0]:s}var qo=Kr((function(e){var t=Ft(e,As);return t.length&&t[0]===e[0]?Nr(t):[]})),Jo=Kr((function(e){var t=Ko(e),n=Ft(e,As);return t===Ko(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Nr(n,lo(t,2)):[]})),Wo=Kr((function(e){var t=Ko(e),n=Ft(e,As);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?Nr(n,s,t):[]}));function Ko(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Xo=Kr(Zo);function Zo(e,t){return e&&e.length&&t&&t.length?Gr(e,t):e}var ei=ro((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return qr(e,Ft(t,(function(e){return vo(e,n)?+e:e})).sort($s)),r}));function ti(e){return null==e?e:En.call(e)}var ni=Kr((function(e){return fs(Ar(e,1,qi,!0))})),ri=Kr((function(e){var t=Ko(e);return qi(t)&&(t=s),fs(Ar(e,1,qi,!0),lo(t,2))})),si=Kr((function(e){var t=Ko(e);return t="function"==typeof t?t:s,fs(Ar(e,1,qi,!0),s,t)}));function oi(e){if(!e||!e.length)return[];var t=0;return e=Tt(e,(function(e){if(qi(e))return t=_n(e.length,t),!0})),Kt(t,(function(t){return Ft(e,Gt(t))}))}function ii(e,t){if(!e||!e.length)return[];var n=oi(e);return null==t?n:Ft(n,(function(e){return $t(t,s,e)}))}var ai=Kr((function(e,t){return qi(e)?dr(e,t):[]})),ci=Kr((function(e){return ys(Tt(e,qi))})),li=Kr((function(e){var t=Ko(e);return qi(t)&&(t=s),ys(Tt(e,qi),lo(t,2))})),ui=Kr((function(e){var t=Ko(e);return t="function"==typeof t?t:s,ys(Tt(e,qi),s,t)})),fi=Kr(oi);var di=Kr((function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,ii(e,n)}));function pi(e){var t=jn(e);return t.__chain__=!0,t}function hi(e,t){return t(e)}var mi=ro((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Vn&&vo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:hi,args:[o],thisArg:s}),new zn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(s),e}))):this.thru(o)}));var yi=Ts((function(e,t,n){Re.call(e,n)?++e[n]:ir(e,n,1)}));var gi=Ls(zo),Ai=Ls(Vo);function _i(e,t){return(Vi(e)?Mt:pr)(e,lo(t,3))}function vi(e,t){return(Vi(e)?Nt:hr)(e,lo(t,3))}var bi=Ts((function(e,t,n){Re.call(e,n)?e[n].push(t):ir(e,n,[t])}));var xi=Kr((function(e,t,n){var s=-1,o="function"==typeof t,i=Gi(e)?r(e.length):[];return pr(e,(function(e){i[++s]=o?$t(t,e,n):Ir(e,t,n)})),i})),wi=Ts((function(e,t,n){ir(e,n,t)}));function Ei(e,t){return(Vi(e)?Ft:Qr)(e,lo(t,3))}var ki=Ts((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Ci=Kr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&bo(e,t[0],t[1])?t=[]:n>2&&bo(t[0],t[1],t[2])&&(t=[t[0]]),Vr(e,Ar(t,1),[])})),$i=ut||function(){return mt.Date.now()};function Bi(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Xs(e,f,s,s,s,s,t)}function Mi(e,t){var n;if("function"!=typeof t)throw new Ne(o);return e=ma(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var Ni=Kr((function(e,t,n){var r=1;if(n.length){var s=fn(n,co(Ni));r|=l}return Xs(e,r,t,n,s)})),Ii=Kr((function(e,t,n){var r=3;if(n.length){var s=fn(n,co(Ii));r|=l}return Xs(t,r,e,n,s)}));function Ti(e,t,n){var r,i,a,c,l,u,f=0,d=!1,p=!1,h=!0;if("function"!=typeof e)throw new Ne(o);function m(t){var n=r,o=i;return r=i=s,f=t,c=e.apply(o,n)}function y(e){var n=e-u;return u===s||n>=t||n<0||p&&e-f>=a}function g(){var e=$i();if(y(e))return A(e);l=To(g,function(e){var n=t-(e-u);return p?vn(n,a-(e-f)):n}(e))}function A(e){return l=s,h&&r?m(e):(r=i=s,c)}function _(){var e=$i(),n=y(e);if(r=arguments,i=this,u=e,n){if(l===s)return function(e){return f=e,l=To(g,t),d?m(e):c}(u);if(p)return ws(l),l=To(g,t),m(u)}return l===s&&(l=To(g,t)),c}return t=ga(t)||0,ta(n)&&(d=!!n.leading,a=(p="maxWait"in n)?_n(ga(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),_.cancel=function(){l!==s&&ws(l),f=0,r=u=i=l=s},_.flush=function(){return l===s?c:A($i())},_}var Si=Kr((function(e,t){return fr(e,1,t)})),Oi=Kr((function(e,t,n){return fr(e,ga(t)||0,n)}));function Fi(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ne(o);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],o=n.cache;if(o.has(s))return o.get(s);var i=e.apply(this,r);return n.cache=o.set(s,i)||o,i};return n.cache=new(Fi.Cache||qn),n}function Ri(e){if("function"!=typeof e)throw new Ne(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Fi.Cache=qn;var Di=bs((function(e,t){var n=(t=1==t.length&&Vi(t[0])?Ft(t[0],Zt(lo())):Ft(Ar(t,1),Zt(lo()))).length;return Kr((function(r){for(var s=-1,o=vn(r.length,n);++s<o;)r[s]=t[s].call(this,r[s]);return $t(e,this,r)}))})),Ui=Kr((function(e,t){var n=fn(t,co(Ui));return Xs(e,l,s,t,n)})),Li=Kr((function(e,t){var n=fn(t,co(Li));return Xs(e,u,s,t,n)})),Qi=ro((function(e,t){return Xs(e,d,s,s,s,t)}));function ji(e,t){return e===t||e!=e&&t!=t}var Pi=Gs($r),Yi=Gs((function(e,t){return e>=t})),zi=Tr(function(){return arguments}())?Tr:function(e){return na(e)&&Re.call(e,"callee")&&!Je.call(e,"callee")},Vi=r.isArray,Hi=bt?Zt(bt):function(e){return na(e)&&Cr(e)==O};function Gi(e){return null!=e&&ea(e.length)&&!Xi(e)}function qi(e){return na(e)&&Gi(e)}var Ji=_t||gc,Wi=xt?Zt(xt):function(e){return na(e)&&Cr(e)==b};function Ki(e){if(!na(e))return!1;var t=Cr(e);return t==x||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!oa(e)}function Xi(e){if(!ta(e))return!1;var t=Cr(e);return t==w||t==E||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Zi(e){return"number"==typeof e&&e==ma(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function na(e){return null!=e&&"object"==typeof e}var ra=wt?Zt(wt):function(e){return na(e)&&yo(e)==k};function sa(e){return"number"==typeof e||na(e)&&Cr(e)==C}function oa(e){if(!na(e)||Cr(e)!=$)return!1;var t=Ge(e);if(null===t)return!0;var n=Re.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Fe.call(n)==Qe}var ia=Et?Zt(Et):function(e){return na(e)&&Cr(e)==M};var aa=kt?Zt(kt):function(e){return na(e)&&yo(e)==N};function ca(e){return"string"==typeof e||!Vi(e)&&na(e)&&Cr(e)==I}function la(e){return"symbol"==typeof e||na(e)&&Cr(e)==T}var ua=Ct?Zt(Ct):function(e){return na(e)&&ea(e.length)&&!!ct[Cr(e)]};var fa=Gs(Lr),da=Gs((function(e,t){return e<=t}));function pa(e){if(!e)return[];if(Gi(e))return ca(e)?mn(e):Ns(e);if(Xe&&e[Xe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=yo(e);return(t==k?ln:t==N?dn:ja)(e)}function ha(e){return e?(e=ga(e))===p||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ma(e){var t=ha(e),n=t%1;return t==t?n?t-n:t:0}function ya(e){return e?cr(ma(e),0,y):0}function ga(e){if("number"==typeof e)return e;if(la(e))return m;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=ge.test(e);return n||_e.test(e)?dt(e.slice(2),n?2:8):ye.test(e)?m:+e}function Aa(e){return Is(e,Sa(e))}function _a(e){return null==e?"":us(e)}var va=Ss((function(e,t){if(ko(t)||Gi(t))Is(t,Ta(t),e);else for(var n in t)Re.call(t,n)&&nr(e,n,t[n])})),ba=Ss((function(e,t){Is(t,Sa(t),e)})),xa=Ss((function(e,t,n,r){Is(t,Sa(t),e,r)})),wa=Ss((function(e,t,n,r){Is(t,Ta(t),e,r)})),Ea=ro(ar);var ka=Kr((function(e,t){e=$e(e);var n=-1,r=t.length,o=r>2?t[2]:s;for(o&&bo(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=Sa(i),c=-1,l=a.length;++c<l;){var u=a[c],f=e[u];(f===s||ji(f,Se[u])&&!Re.call(e,u))&&(e[u]=i[u])}return e})),Ca=Kr((function(e){return e.push(s,eo),$t(Fa,s,e)}));function $a(e,t,n){var r=null==e?s:Er(e,t);return r===s?n:r}function Ba(e,t){return null!=e&&go(e,t,Mr)}var Ma=Ps((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Le.call(t)),e[t]=n}),tc(sc)),Na=Ps((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Le.call(t)),Re.call(e,t)?e[t].push(n):e[t]=[n]}),lo),Ia=Kr(Ir);function Ta(e){return Gi(e)?Kn(e):Dr(e)}function Sa(e){return Gi(e)?Kn(e,!0):Ur(e)}var Oa=Ss((function(e,t,n){Yr(e,t,n)})),Fa=Ss((function(e,t,n,r){Yr(e,t,n,r)})),Ra=ro((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ft(t,(function(t){return t=vs(t,e),r||(r=t.length>1),t})),Is(e,oo(e),n),r&&(n=lr(n,7,to));for(var s=t.length;s--;)ds(n,t[s]);return n}));var Da=ro((function(e,t){return null==e?{}:function(e,t){return Hr(e,t,(function(t,n){return Ba(e,n)}))}(e,t)}));function Ua(e,t){if(null==e)return{};var n=Ft(oo(e),(function(e){return[e]}));return t=lo(t),Hr(e,n,(function(e,n){return t(e,n[0])}))}var La=Ks(Ta),Qa=Ks(Sa);function ja(e){return null==e?[]:en(e,Ta(e))}var Pa=Ds((function(e,t,n){return t=t.toLowerCase(),e+(n?Ya(t):t)}));function Ya(e){return Ka(_a(e).toLowerCase())}function za(e){return(e=_a(e))&&e.replace(be,sn).replace(tt,"")}var Va=Ds((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ha=Ds((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ga=Rs("toLowerCase");var qa=Ds((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Ja=Ds((function(e,t,n){return e+(n?" ":"")+Ka(t)}));var Wa=Ds((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Rs("toUpperCase");function Xa(e,t,n){return e=_a(e),(t=n?s:t)===s?function(e){return ot.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(fe)||[]}(e):e.match(t)||[]}var Za=Kr((function(e,t){try{return $t(e,s,t)}catch(e){return Ki(e)?e:new Ee(e)}})),ec=ro((function(e,t){return Mt(t,(function(t){t=Uo(t),ir(e,t,Ni(e[t],e))})),e}));function tc(e){return function(){return e}}var nc=Qs(),rc=Qs(!0);function sc(e){return e}function oc(e){return Rr("function"==typeof e?e:lr(e,1))}var ic=Kr((function(e,t){return function(n){return Ir(n,e,t)}})),ac=Kr((function(e,t){return function(n){return Ir(e,n,t)}}));function cc(e,t,n){var r=Ta(t),s=wr(t,r);null!=n||ta(t)&&(s.length||!r.length)||(n=t,t=e,e=this,s=wr(t,Ta(t)));var o=!(ta(n)&&"chain"in n&&!n.chain),i=Xi(e);return Mt(s,(function(n){var r=t[n];e[n]=r,i&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ns(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Rt([this.value()],arguments))})})),e}function lc(){}var uc=zs(Ft),fc=zs(It),dc=zs(Lt);function pc(e){return xo(e)?Gt(Uo(e)):function(e){return function(t){return Er(t,e)}}(e)}var hc=Hs(),mc=Hs(!0);function yc(){return[]}function gc(){return!1}var Ac=Ys((function(e,t){return e+t}),0),_c=Js("ceil"),vc=Ys((function(e,t){return e/t}),1),bc=Js("floor");var xc,wc=Ys((function(e,t){return e*t}),1),Ec=Js("round"),kc=Ys((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new Ne(o);return e=ma(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=Bi,jn.assign=va,jn.assignIn=ba,jn.assignInWith=xa,jn.assignWith=wa,jn.at=Ea,jn.before=Mi,jn.bind=Ni,jn.bindAll=ec,jn.bindKey=Ii,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Vi(e)?e:[e]},jn.chain=pi,jn.chunk=function(e,t,n){t=(n?bo(e,t,n):t===s)?1:_n(ma(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,a=0,c=r(ht(o/t));i<o;)c[a++]=ss(e,i,i+=t);return c},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,s=[];++t<n;){var o=e[t];o&&(s[r++]=o)}return s},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],s=e;s--;)t[s-1]=arguments[s];return Rt(Vi(n)?Ns(n):[n],Ar(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=lo();return e=t?Ft(e,(function(e){if("function"!=typeof e[1])throw new Ne(o);return[n(e[0]),e[1]]})):[],Kr((function(n){for(var r=-1;++r<t;){var s=e[r];if($t(s[0],this,n))return $t(s[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=Ta(e);return function(n){return ur(n,e,t)}}(lr(e,1))},jn.constant=tc,jn.countBy=yi,jn.create=function(e,t){var n=Pn(e);return null==t?n:or(n,t)},jn.curry=function e(t,n,r){var o=Xs(t,8,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},jn.curryRight=function e(t,n,r){var o=Xs(t,c,s,s,s,s,s,n=r?s:n);return o.placeholder=e.placeholder,o},jn.debounce=Ti,jn.defaults=ka,jn.defaultsDeep=Ca,jn.defer=Si,jn.delay=Oi,jn.difference=jo,jn.differenceBy=Po,jn.differenceWith=Yo,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,(t=n||t===s?1:ma(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,0,(t=r-(t=n||t===s?1:ma(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?hs(e,lo(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?hs(e,lo(t,3),!0):[]},jn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&bo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=ma(n))<0&&(n=-n>o?0:o+n),(r=r===s||r>o?o:ma(r))<0&&(r+=o),r=n>r?0:ya(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(Vi(e)?Tt:gr)(e,lo(t,3))},jn.flatMap=function(e,t){return Ar(Ei(e,t),1)},jn.flatMapDeep=function(e,t){return Ar(Ei(e,t),p)},jn.flatMapDepth=function(e,t,n){return n=n===s?1:ma(n),Ar(Ei(e,t),n)},jn.flatten=Ho,jn.flattenDeep=function(e){return(null==e?0:e.length)?Ar(e,p):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?Ar(e,t=t===s?1:ma(t)):[]},jn.flip=function(e){return Xs(e,512)},jn.flow=nc,jn.flowRight=rc,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var s=e[t];r[s[0]]=s[1]}return r},jn.functions=function(e){return null==e?[]:wr(e,Ta(e))},jn.functionsIn=function(e){return null==e?[]:wr(e,Sa(e))},jn.groupBy=bi,jn.initial=function(e){return(null==e?0:e.length)?ss(e,0,-1):[]},jn.intersection=qo,jn.intersectionBy=Jo,jn.intersectionWith=Wo,jn.invert=Ma,jn.invertBy=Na,jn.invokeMap=xi,jn.iteratee=oc,jn.keyBy=wi,jn.keys=Ta,jn.keysIn=Sa,jn.map=Ei,jn.mapKeys=function(e,t){var n={};return t=lo(t,3),br(e,(function(e,r,s){ir(n,t(e,r,s),e)})),n},jn.mapValues=function(e,t){var n={};return t=lo(t,3),br(e,(function(e,r,s){ir(n,r,t(e,r,s))})),n},jn.matches=function(e){return jr(lr(e,1))},jn.matchesProperty=function(e,t){return Pr(e,lr(t,1))},jn.memoize=Fi,jn.merge=Oa,jn.mergeWith=Fa,jn.method=ic,jn.methodOf=ac,jn.mixin=cc,jn.negate=Ri,jn.nthArg=function(e){return e=ma(e),Kr((function(t){return zr(t,e)}))},jn.omit=Ra,jn.omitBy=function(e,t){return Ua(e,Ri(lo(t)))},jn.once=function(e){return Mi(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(Vi(t)||(t=null==t?[]:[t]),Vi(n=r?s:n)||(n=null==n?[]:[n]),Vr(e,t,n))},jn.over=uc,jn.overArgs=Di,jn.overEvery=fc,jn.overSome=dc,jn.partial=Ui,jn.partialRight=Li,jn.partition=ki,jn.pick=Da,jn.pickBy=Ua,jn.property=pc,jn.propertyOf=function(e){return function(t){return null==e?s:Er(e,t)}},jn.pull=Xo,jn.pullAll=Zo,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,lo(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,s,n):e},jn.pullAt=ei,jn.range=hc,jn.rangeRight=mc,jn.rearg=Qi,jn.reject=function(e,t){return(Vi(e)?Tt:gr)(e,Ri(lo(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,s=[],o=e.length;for(t=lo(t,3);++r<o;){var i=e[r];t(i,r,e)&&(n.push(i),s.push(r))}return qr(e,s),n},jn.rest=function(e,t){if("function"!=typeof e)throw new Ne(o);return Kr(e,t=t===s?t:ma(t))},jn.reverse=ti,jn.sampleSize=function(e,t,n){return t=(n?bo(e,t,n):t===s)?1:ma(t),(Vi(e)?Zn:Zr)(e,t)},jn.set=function(e,t,n){return null==e?e:es(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:es(e,t,n,r)},jn.shuffle=function(e){return(Vi(e)?er:rs)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&bo(e,t,n)?(t=0,n=r):(t=null==t?0:ma(t),n=n===s?r:ma(n)),ss(e,t,n)):[]},jn.sortBy=Ci,jn.sortedUniq=function(e){return e&&e.length?cs(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?cs(e,lo(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&bo(e,t,n)&&(t=n=s),(n=n===s?y:n>>>0)?(e=_a(e))&&("string"==typeof t||null!=t&&!ia(t))&&!(t=us(t))&&cn(e)?xs(mn(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new Ne(o);return t=null==t?0:_n(ma(t),0),Kr((function(n){var r=n[t],s=xs(n,0,t);return r&&Rt(s,r),$t(e,this,s)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?ss(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?ss(e,0,(t=n||t===s?1:ma(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,(t=r-(t=n||t===s?1:ma(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?hs(e,lo(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?hs(e,lo(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new Ne(o);return ta(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),Ti(e,t,{leading:r,maxWait:t,trailing:s})},jn.thru=hi,jn.toArray=pa,jn.toPairs=La,jn.toPairsIn=Qa,jn.toPath=function(e){return Vi(e)?Ft(e,Uo):la(e)?[e]:Ns(Do(_a(e)))},jn.toPlainObject=Aa,jn.transform=function(e,t,n){var r=Vi(e),s=r||Ji(e)||ua(e);if(t=lo(t,4),null==n){var o=e&&e.constructor;n=s?r?new o:[]:ta(e)&&Xi(o)?Pn(Ge(e)):{}}return(s?Mt:br)(e,(function(e,r,s){return t(n,e,r,s)})),n},jn.unary=function(e){return Bi(e,1)},jn.union=ni,jn.unionBy=ri,jn.unionWith=si,jn.uniq=function(e){return e&&e.length?fs(e):[]},jn.uniqBy=function(e,t){return e&&e.length?fs(e,lo(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?fs(e,s,t):[]},jn.unset=function(e,t){return null==e||ds(e,t)},jn.unzip=oi,jn.unzipWith=ii,jn.update=function(e,t,n){return null==e?e:ps(e,t,_s(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ps(e,t,_s(n),r)},jn.values=ja,jn.valuesIn=function(e){return null==e?[]:en(e,Sa(e))},jn.without=ai,jn.words=Xa,jn.wrap=function(e,t){return Ui(_s(t),e)},jn.xor=ci,jn.xorBy=li,jn.xorWith=ui,jn.zip=fi,jn.zipObject=function(e,t){return gs(e||[],t||[],nr)},jn.zipObjectDeep=function(e,t){return gs(e||[],t||[],es)},jn.zipWith=di,jn.entries=La,jn.entriesIn=Qa,jn.extend=ba,jn.extendWith=xa,cc(jn,jn),jn.add=Ac,jn.attempt=Za,jn.camelCase=Pa,jn.capitalize=Ya,jn.ceil=_c,jn.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=ga(n))==n?n:0),t!==s&&(t=(t=ga(t))==t?t:0),cr(ga(e),t,n)},jn.clone=function(e){return lr(e,4)},jn.cloneDeep=function(e){return lr(e,5)},jn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:s)},jn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:s)},jn.conformsTo=function(e,t){return null==t||ur(e,t,Ta(t))},jn.deburr=za,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=vc,jn.endsWith=function(e,t,n){e=_a(e),t=us(t);var r=e.length,o=n=n===s?r:cr(ma(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},jn.eq=ji,jn.escape=function(e){return(e=_a(e))&&K.test(e)?e.replace(J,on):e},jn.escapeRegExp=function(e){return(e=_a(e))&&oe.test(e)?e.replace(se,"\\$&"):e},jn.every=function(e,t,n){var r=Vi(e)?It:mr;return n&&bo(e,t,n)&&(t=s),r(e,lo(t,3))},jn.find=gi,jn.findIndex=zo,jn.findKey=function(e,t){return jt(e,lo(t,3),br)},jn.findLast=Ai,jn.findLastIndex=Vo,jn.findLastKey=function(e,t){return jt(e,lo(t,3),xr)},jn.floor=bc,jn.forEach=_i,jn.forEachRight=vi,jn.forIn=function(e,t){return null==e?e:_r(e,lo(t,3),Sa)},jn.forInRight=function(e,t){return null==e?e:vr(e,lo(t,3),Sa)},jn.forOwn=function(e,t){return e&&br(e,lo(t,3))},jn.forOwnRight=function(e,t){return e&&xr(e,lo(t,3))},jn.get=$a,jn.gt=Pi,jn.gte=Yi,jn.has=function(e,t){return null!=e&&go(e,t,Br)},jn.hasIn=Ba,jn.head=Go,jn.identity=sc,jn.includes=function(e,t,n,r){e=Gi(e)?e:ja(e),n=n&&!r?ma(n):0;var s=e.length;return n<0&&(n=_n(s+n,0)),ca(e)?n<=s&&e.indexOf(t,n)>-1:!!s&&Yt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=null==n?0:ma(n);return s<0&&(s=_n(r+s,0)),Yt(e,t,s)},jn.inRange=function(e,t,n){return t=ha(t),n===s?(n=t,t=0):n=ha(n),function(e,t,n){return e>=vn(t,n)&&e<_n(t,n)}(e=ga(e),t,n)},jn.invoke=Ia,jn.isArguments=zi,jn.isArray=Vi,jn.isArrayBuffer=Hi,jn.isArrayLike=Gi,jn.isArrayLikeObject=qi,jn.isBoolean=function(e){return!0===e||!1===e||na(e)&&Cr(e)==v},jn.isBuffer=Ji,jn.isDate=Wi,jn.isElement=function(e){return na(e)&&1===e.nodeType&&!oa(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Gi(e)&&(Vi(e)||"string"==typeof e||"function"==typeof e.splice||Ji(e)||ua(e)||zi(e)))return!e.length;var t=yo(e);if(t==k||t==N)return!e.size;if(ko(e))return!Dr(e).length;for(var n in e)if(Re.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return Sr(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?Sr(e,t,s,n):!!r},jn.isError=Ki,jn.isFinite=function(e){return"number"==typeof e&&vt(e)},jn.isFunction=Xi,jn.isInteger=Zi,jn.isLength=ea,jn.isMap=ra,jn.isMatch=function(e,t){return e===t||Or(e,t,fo(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,Or(e,t,fo(t),n)},jn.isNaN=function(e){return sa(e)&&e!=+e},jn.isNative=function(e){if(Eo(e))throw new Ee("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Fr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=sa,jn.isObject=ta,jn.isObjectLike=na,jn.isPlainObject=oa,jn.isRegExp=ia,jn.isSafeInteger=function(e){return Zi(e)&&e>=-9007199254740991&&e<=h},jn.isSet=aa,jn.isString=ca,jn.isSymbol=la,jn.isTypedArray=ua,jn.isUndefined=function(e){return e===s},jn.isWeakMap=function(e){return na(e)&&yo(e)==S},jn.isWeakSet=function(e){return na(e)&&"[object WeakSet]"==Cr(e)},jn.join=function(e,t){return null==e?"":Qt.call(e,t)},jn.kebabCase=Va,jn.last=Ko,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==s&&(o=(o=ma(n))<0?_n(r+o,0):vn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Pt(e,Vt,o,!0)},jn.lowerCase=Ha,jn.lowerFirst=Ga,jn.lt=fa,jn.lte=da,jn.max=function(e){return e&&e.length?yr(e,sc,$r):s},jn.maxBy=function(e,t){return e&&e.length?yr(e,lo(t,2),$r):s},jn.mean=function(e){return Ht(e,sc)},jn.meanBy=function(e,t){return Ht(e,lo(t,2))},jn.min=function(e){return e&&e.length?yr(e,sc,Lr):s},jn.minBy=function(e,t){return e&&e.length?yr(e,lo(t,2),Lr):s},jn.stubArray=yc,jn.stubFalse=gc,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=wc,jn.nth=function(e,t){return e&&e.length?zr(e,ma(t)):s},jn.noConflict=function(){return mt._===this&&(mt._=je),this},jn.noop=lc,jn.now=$i,jn.pad=function(e,t,n){e=_a(e);var r=(t=ma(t))?hn(e):0;if(!t||r>=t)return e;var s=(t-r)/2;return Vs(yt(s),n)+e+Vs(ht(s),n)},jn.padEnd=function(e,t,n){e=_a(e);var r=(t=ma(t))?hn(e):0;return t&&r<t?e+Vs(t-r,n):e},jn.padStart=function(e,t,n){e=_a(e);var r=(t=ma(t))?hn(e):0;return t&&r<t?Vs(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),xn(_a(e).replace(ie,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&bo(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=ha(e),t===s?(t=e,e=0):t=ha(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=wn();return vn(e+o*(t-e+ft("1e-"+((o+"").length-1))),t)}return Jr(e,t)},jn.reduce=function(e,t,n){var r=Vi(e)?Dt:Jt,s=arguments.length<3;return r(e,lo(t,4),n,s,pr)},jn.reduceRight=function(e,t,n){var r=Vi(e)?Ut:Jt,s=arguments.length<3;return r(e,lo(t,4),n,s,hr)},jn.repeat=function(e,t,n){return t=(n?bo(e,t,n):t===s)?1:ma(t),Wr(_a(e),t)},jn.replace=function(){var e=arguments,t=_a(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,o=(t=vs(t,e)).length;for(o||(o=1,e=s);++r<o;){var i=null==e?s:e[Uo(t[r])];i===s&&(r=o,i=n),e=Xi(i)?i.call(e):i}return e},jn.round=Ec,jn.runInContext=e,jn.sample=function(e){return(Vi(e)?Xn:Xr)(e)},jn.size=function(e){if(null==e)return 0;if(Gi(e))return ca(e)?hn(e):e.length;var t=yo(e);return t==k||t==N?e.size:Dr(e).length},jn.snakeCase=qa,jn.some=function(e,t,n){var r=Vi(e)?Lt:os;return n&&bo(e,t,n)&&(t=s),r(e,lo(t,3))},jn.sortedIndex=function(e,t){return is(e,t)},jn.sortedIndexBy=function(e,t,n){return as(e,t,lo(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=is(e,t);if(r<n&&ji(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return is(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return as(e,t,lo(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=is(e,t,!0)-1;if(ji(e[n],t))return n}return-1},jn.startCase=Ja,jn.startsWith=function(e,t,n){return e=_a(e),n=null==n?0:cr(ma(n),0,e.length),t=us(t),e.slice(n,n+t.length)==t},jn.subtract=kc,jn.sum=function(e){return e&&e.length?Wt(e,sc):0},jn.sumBy=function(e,t){return e&&e.length?Wt(e,lo(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&bo(e,t,n)&&(t=s),e=_a(e),t=xa({},t,r,Zs);var o,i,a=xa({},t.imports,r.imports,Zs),c=Ta(a),l=en(a,c),u=0,f=t.interpolate||xe,d="__p += '",p=Be((t.escape||xe).source+"|"+f.source+"|"+(f===ee?he:xe).source+"|"+(t.evaluate||xe).source+"|$","g"),h="//# sourceURL="+(Re.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(p,(function(t,n,r,s,a,c){return r||(r=s),d+=e.slice(u,c).replace(we,an),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(i=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),d+="';\n";var m=Re.call(t,"variable")&&t.variable;if(m){if(de.test(m))throw new Ee("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(i?d.replace(V,""):d).replace(H,"$1").replace(G,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var y=Za((function(){return ke(c,h+"return "+d).apply(s,l)}));if(y.source=d,Ki(y))throw y;return y},jn.times=function(e,t){if((e=ma(e))<1||e>h)return[];var n=y,r=vn(e,y);t=lo(t),e-=y;for(var s=Kt(r,t);++n<e;)t(n);return s},jn.toFinite=ha,jn.toInteger=ma,jn.toLength=ya,jn.toLower=function(e){return _a(e).toLowerCase()},jn.toNumber=ga,jn.toSafeInteger=function(e){return e?cr(ma(e),-9007199254740991,h):0===e?e:0},jn.toString=_a,jn.toUpper=function(e){return _a(e).toUpperCase()},jn.trim=function(e,t,n){if((e=_a(e))&&(n||t===s))return Xt(e);if(!e||!(t=us(t)))return e;var r=mn(e),o=mn(t);return xs(r,nn(r,o),rn(r,o)+1).join("")},jn.trimEnd=function(e,t,n){if((e=_a(e))&&(n||t===s))return e.slice(0,yn(e)+1);if(!e||!(t=us(t)))return e;var r=mn(e);return xs(r,0,rn(r,mn(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=_a(e))&&(n||t===s))return e.replace(ie,"");if(!e||!(t=us(t)))return e;var r=mn(e);return xs(r,nn(r,mn(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(ta(t)){var o="separator"in t?t.separator:o;n="length"in t?ma(t.length):n,r="omission"in t?us(t.omission):r}var i=(e=_a(e)).length;if(cn(e)){var a=mn(e);i=a.length}if(n>=i)return e;var c=n-hn(r);if(c<1)return r;var l=a?xs(a,0,c).join(""):e.slice(0,c);if(o===s)return l+r;if(a&&(c+=l.length-c),ia(o)){if(e.slice(c).search(o)){var u,f=l;for(o.global||(o=Be(o.source,_a(me.exec(o))+"g")),o.lastIndex=0;u=o.exec(f);)var d=u.index;l=l.slice(0,d===s?c:d)}}else if(e.indexOf(us(o),c)!=c){var p=l.lastIndexOf(o);p>-1&&(l=l.slice(0,p))}return l+r},jn.unescape=function(e){return(e=_a(e))&&W.test(e)?e.replace(q,gn):e},jn.uniqueId=function(e){var t=++De;return _a(e)+t},jn.upperCase=Wa,jn.upperFirst=Ka,jn.each=_i,jn.eachRight=vi,jn.first=Go,cc(jn,(xc={},br(jn,(function(e,t){Re.call(jn.prototype,t)||(xc[t]=e)})),xc),{chain:!1}),jn.VERSION="4.17.21",Mt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),Mt(["drop","take"],(function(e,t){Vn.prototype[e]=function(n){n=n===s?1:_n(ma(n),0);var r=this.__filtered__&&!t?new Vn(this):this.clone();return r.__filtered__?r.__takeCount__=vn(n,r.__takeCount__):r.__views__.push({size:vn(n,y),type:e+(r.__dir__<0?"Right":"")}),r},Vn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Mt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Vn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:lo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),Mt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Vn.prototype[e]=function(){return this[n](1).value()[0]}})),Mt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Vn.prototype[e]=function(){return this.__filtered__?new Vn(this):this[n](1)}})),Vn.prototype.compact=function(){return this.filter(sc)},Vn.prototype.find=function(e){return this.filter(e).head()},Vn.prototype.findLast=function(e){return this.reverse().find(e)},Vn.prototype.invokeMap=Kr((function(e,t){return"function"==typeof e?new Vn(this):this.map((function(n){return Ir(n,e,t)}))})),Vn.prototype.reject=function(e){return this.filter(Ri(lo(e)))},Vn.prototype.slice=function(e,t){e=ma(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Vn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=ma(t))<0?n.dropRight(-t):n.take(t-e)),n)},Vn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Vn.prototype.toArray=function(){return this.take(y)},br(Vn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=jn[r?"take"+("last"==t?"Right":""):t],i=r||/^find/.test(t);o&&(jn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof Vn,l=a[0],u=c||Vi(t),f=function(e){var t=o.apply(jn,Rt([e],a));return r&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var d=this.__chain__,p=!!this.__actions__.length,h=i&&!d,m=c&&!p;if(!i&&u){t=m?t:new Vn(this);var y=e.apply(t,a);return y.__actions__.push({func:hi,args:[f],thisArg:s}),new zn(y,d)}return h&&m?e.apply(this,a):(y=this.thru(f),h?r?y.value()[0]:y.value():y)})})),Mt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ie[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var s=this.value();return t.apply(Vi(s)?s:[],e)}return this[n]((function(n){return t.apply(Vi(n)?n:[],e)}))}})),br(Vn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";Re.call(Tn,r)||(Tn[r]=[]),Tn[r].push({name:t,func:n})}})),Tn[js(s,2).name]=[{name:"wrapper",func:s}],Vn.prototype.clone=function(){var e=new Vn(this.__wrapped__);return e.__actions__=Ns(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ns(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ns(this.__views__),e},Vn.prototype.reverse=function(){if(this.__filtered__){var e=new Vn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Vn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Vi(e),r=t<0,s=n?e.length:0,o=function(e,t,n){var r=-1,s=n.length;for(;++r<s;){var o=n[r],i=o.size;switch(o.type){case"drop":e+=i;break;case"dropRight":t-=i;break;case"take":t=vn(t,e+i);break;case"takeRight":e=_n(e,t-i)}}return{start:e,end:t}}(0,s,this.__views__),i=o.start,a=o.end,c=a-i,l=r?a:i-1,u=this.__iteratees__,f=u.length,d=0,p=vn(c,this.__takeCount__);if(!n||!r&&s==c&&p==c)return ms(e,this.__actions__);var h=[];e:for(;c--&&d<p;){for(var m=-1,y=e[l+=t];++m<f;){var g=u[m],A=g.iteratee,_=g.type,v=A(y);if(2==_)y=v;else if(!v){if(1==_)continue e;break e}}h[d++]=y}return h},jn.prototype.at=mi,jn.prototype.chain=function(){return pi(this)},jn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===s&&(this.__values__=pa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Yn;){var r=Qo(n);r.__index__=0,r.__values__=s,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Vn){var t=e;return this.__actions__.length&&(t=new Vn(this)),(t=t.reverse()).__actions__.push({func:hi,args:[ti],thisArg:s}),new zn(t,this.__chain__)}return this.thru(ti)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return ms(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Xe&&(jn.prototype[Xe]=function(){return this}),jn}();mt._=An,(r=function(){return An}.call(t,n,t,e))===s||(e.exports=r)}.call(this)},43:function(e,t,n){var r,s;!function(o,i){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function i(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}function a(t,n){for(var s=0;s<r.length;s++){var o=r[s];this[o]=s<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return i(e)||c.apply(this,arguments)}function u(e,n,s){var o,i=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=s||l,i.getLevel=function(){return o},i.setLevel=function(n,r){if("string"==typeof n&&void 0!==i.levels[n.toUpperCase()]&&(n=i.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&u(n),a.call(i,n,e),typeof console===t&&n<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){n=e,f()||i.setLevel(e,!1)},i.resetLevel=function(){i.setLevel(n,!1),d()},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var p=f();null==p&&(p=n),i.setLevel(p,!1)}var f=new u,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()},117:(e,t,n)=>{const r=n(17),s={id:"TB",desc:"Choose Treble or Bass clef",choices:[{id:"T",desc:"Treble"},{id:"B",desc:"Bass"}]},o={id:"SP",desc:"Show Keyboard",choices:[{id:"S",desc:"No"},{id:"P",desc:"Yes"}]};function i(e){let t="<ul>";for(let n of e)t+=`<li>${n} </li>`;return t+="</ul>",t}const a="Clap the Pulse",c="Sing Echoes",l="Describe the Change in Pitch or Rhythm",u="Answer Questions about a Piece",f="Clap the Pulse & State the Metre",d="Sing or Play from Memory",p="Sing from Score",h="Clap the Rhythm",m="Identify the Cadence",y="Identify the Chords",g="Identify the Modulation",A="Identify the Modulations",_="Last Note Higher or Lower than First?",v="Identify the Interval",b="Indicate when Hear Change in Pitch or Rhythm",x="Locate and Identify the Changes in Pitch and/or Rhythm",w="Time Signature, Dynamics, and Articulation",E="Describe Two (other) Characteristics",k="Start the player and listen to the {V1}.",C="Clap louder on the strong beats.",$="Review your response with the second player",B="Review your response with the score.",M="As soon as you can, join in clapping the pulse.",N=`${$} (which includes a metronome to indicate the pulse).`,I="Afterwards, state whether it is in {V1} time.",T="Say whether the music is in {V1} time.",S="You do not need to identify the time signature.",O=`${$} (which includes a metronome to indicate the pulse,\n  and a count-in to help identify the metre).`,F="After the count-in, you will hear {V1} bar phrases, each followed by a pause.",R=`${$}, and by studying the score.`,D=k.replace("{V1}","key-chord, starting note, and two bar count-in"),U=k.replace("{V1}","key-chord, tonic note, and two bar count-in"),L="During each pause, sing back the phrase you have just heard (keep in time).",Q="Choose whether you would like to sing from treble, or bass clef.",j="Listen to the key-chord, starting note, and tempo.",P="Take a few moments to study the score and, if you like, practise singing the {V1}.",Y="When you are ready, start the second player and after\n  the key-chord, starting note, and two bar count-in, sing the notes {V1}.",z="Check your response by using the additional players,\n  which will play the piece without and with the {V1} respectively.",V="You will then hear a {V1} followed by a pause.",H="The phrase will then be repeated with {V1}.",G="Review your response by listening again, and studying the\n  scores of the phrase, and altered phrase.",q="The {V1} question will be about {V2}.",J="Review your {V1} by listening again, and studying the score.",W="Listen to the key chord, starting note, two bar count-in, then the phrase (repeated after a pause) {V1} you need either to sing or play.",K=k.replace("{V1}","{V1} (played {V2})"),X="On the {V1} playing, join in clapping the pulse.",Z=N,ee=`${$} (which includes a metronome to indicate the pulse,\n  and a count-in to help identify the time signature).`,te=`${$} (which includes a count-in and metronome\n  to help identify the time signature).`,ne="Indicate (by raising your hand), as soon as you hear the change.",re="Say whether the time signature is {V1}.",se="Describe the {V1}.",oe="Say whether the playing was {V1}.",ie="Comment on {V1} characteristics of the piece (other than time signature, dynamics, or articulation).",ae="Check your response with the scores (first without, then with the change).",ce="Check your response with the score including the changes.",le="Study the score of the {V1}.",ue="Say where each change was located, and the type of the change (rhythm or pitch).",fe="This is to help you review your response.",de="Check your response with this player.",pe="View the score to check your response.",he=i([k.replace("{V1}","piece"),M,N,B]),me=i([k.replace("{V1}","piece"),M,C,I.replace("{V1}","two time, or three time"),S,O,B]),ye=i([k.replace("{V1}","piece"),M,C,I.replace("{V1}","two time, three time, or four time"),S,O,B]),ge=i(["If you intend to play rather than sing, check the key and starting note.",k.replace("{V1}","key chord, and starting note"),"You will then hear a count-in and a short phrase, repeated after a pause.","After hearing the phrase for the second time, either sing or play it back.",`${$}.`,B]),Ae=["If you intend to play rather than sing, check the key and starting note.",k.replace("{V1}","key chord, and starting note"),"You will then hear a count-in and a two-part phrase, repeated after a pause.","After hearing the phrase for the second time, either sing or play back the upper part.",`${$}.`,B],_e=i(Ae);Ae[3]="After hearing the phrase for the second time, either sing or play back the lower part.";const ve=i(Ae);Ae[2]="You will then hear a count-in and a three-part phrase, repeated after a pause.",Ae.push("Then proceed to part (ii) of the exercise.");const be=i(Ae),xe=i(["Listen to the piece (preceded by the key chord, and repeated).","Identify the cadence (perfect, imperfect, interrupted, or plagal).","Then proceed to part (iii)."]),we=i(["The chords in this part of the exercise are the same chords which formed the cadence in part (ii).","Listen to the key-chord, then the three chords from the cadence.","The chords are then repeated, each followed by a pause in which you should name the chord just played, and their positions."]),Ee=i([k.replace("{V1}","two bar count-in"),F.replace("{V1}","two two"),"During each pause, clap the rhythm of the phrase you have just heard, keeping in time.",R]),ke=i([D,F.replace("{V1}","three two"),L,R]),Ce=i([Q,"Take a few moments to look through the notes on the score.",k.replace("{V1}","key chord and starting note, then sing the notes from the score slowly."),"Check your response with the final player."]),$e=i([Q,j,P.replace("{V1}","melody"),Y.replace("{V1}","against with the accompaniment."),z.replace("{V1}","accompaniment")]),Be=i([Q,j,P.replace("{V1}","upper part"),Y.replace("{V1}","of the upper part against the lower part being played."),z.replace("{V1}","lower part")]),Me=i([Q,j,P.replace("{V1}","lower part"),Y.replace("{V1}","of the lower part against the upper part being played."),z.replace("{V1}","upper part")]),Ne=i([D,F.replace("{V1}","two one"),L,R]),Ie=i([U,V.replace("{V1}","two bar phrase"),H.replace("{V1}","one of the notes having a change in pitch"),"Say whether the change happened near the beginning, or the end, of the phrase.",G]),Te=i([U,V.replace("{V1}","two bar phrase"),H.replace("{V1}","a change in either pitch, or rhythm"),"Describe the change (whether pitch or ryhthm, and location).",G]),Se=i([U,V.replace("{V1}","phrase of up to four bars"),H.replace("{V1}","a change in either pitch, or rhythm"),"Describe the change (whether pitch or ryhthm, and location).",G]),Oe=[k.replace("{V1}","notes (taken from the piece in part (i))"),"After a pause the notes will be repeated.","Then, clap the rhythm of the notes.",T.replace("{V1}","two, three, or four"),S,R],Fe=i(Oe);Oe[3]=T.replace("{V1}","two, three, four, or 6/8");const Re=i(Oe),De=i(["Listen to the piece (preceded by the key chord, and repeated).","Say whether the cadence is perfect, or imperfect."]),Ue=i(["Listen to the piece (preceded by the key chord, and repeated).","Say whether the cadence is perfect, imperfect, or interrupted.","Then proceed to part (ii)."]),Le=i(["Listen to the two chords (preceded by the key chord).","The chords in this part of the exercise are the same chords which formed the cadence in part (i).","The chords will be in the root position only.","Identify the chords.","Then proceed to part (iii)."]),Qe=i(["Listen to the passage (preceded by the key chord, and played just once).","Say whether it modulated to the dominant, subdominant, or relative minor.",B]),je=i(["Listen to the passage (in a major key, preceded by the key chord).","Say whether it modulated to dominant, subdominant, or relative minor.",B,"Then proceed to part (ii)."]),Pe=i(["Listen to the passage (in a minor key, preceded by the key chord).","Say whether it modulated to dominant, subdominant, or relative major.",B]),Ye=i(["Read which feature of the piece you will be asked about.","This will be either dynamics or articulation.","Listen to the piece, then answer the question.",J.replace("{V1}","answer")]),ze=["Read which features of the piece you will be asked about.",q.replace("{V1}","first").replace("{V2}","dynamics"),q.replace("{V1}","second").replace("{V2}","articulation"),"Listen to the piece, then answer the questions.",J.replace("{V1}","answers")],Ve=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics or articulation"),ze[2]=q.replace("{V1}","second").replace("{V2}","tempo");const He=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, or tempo"),ze[2]=q.replace("{V1}","second").replace("{V2}","tonality");const Ge=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, tempo, or tonality"),ze[2]=q.replace("{V1}","second").replace("{V2}","character"),ze.pop(),ze.push("Review your answers by listening again."),ze.push("Then go to part (ii) of the exercise.");const qe=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, tempo, tonality, or character"),ze[2]=q.replace("{V1}","second").replace("{V2}","style/period");const Je=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","texture or structure"),ze[2]=q.replace("{V1}","second").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period");const We=i(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period"),ze[2]=q.replace("{V1}","second").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period");const Ke=i(ze),Xe=i(["Listen to the piece, then describe its features as well as you can.","Consider all of the features from earlier grades (texture, structure,    dynamics, articulation, tempo, tonality), and anything else you    think is relevant. Say as much as you can about the piece.",J.replace("{V1}","response")]),Ze=i([K.replace("{V1}","melody").replace("{V2}","three times"),X.replace("{V1}","third"),C,Z]),et=i([K.replace("{V1}","melody").replace("{V2}","twice"),X.replace("{V1}","second"),C,Z]),tt=i([K.replace("{V1}","piece").replace("{V2}","twice"),X.replace("{V1}","second"),C,Z]),nt=i([K.replace("{V1}","piece").replace("{V2}","twice"),X.replace("{V1}","second"),C,re.replace("{V1}","2/4, 3/4, 4/4, or 6/8"),ee]),rt=i([K.replace("{V1}","piece").replace("{V2}","twice"),re.replace("{V1}","2/4, 3/4, 4/4, or 6/8"),se.replace("{V1}","dynamics"),se.replace("{V1}","articulation"),te]),st=i([K.replace("{V1}","piece").replace("{V2}","once"),re.replace("{V1}","2/4, 3/4, 4/4, 6/8, or 5/8"),se.replace("{V1}","dynamics"),se.replace("{V1}","articulation"),te]),ot=i([k.replace("{V1}","melody"),oe.replace("{V1}","forte, or piano")]),it=i([k.replace("{V1}","melody"),oe.replace("{V1}","forte, or piano"),oe.replace("{V1}","legato, or staccato")]),at=i([k.replace("{V1}","melody"),"Say whether the melody started piano and ended forte, or vice-versa.",oe.replace("{V1}","legato, or staccato")]),ct=i([k.replace("{V1}","melody"),"Say whether the tonality is major, or minor."]),lt=i([K.replace("{V1}","piece").replace("{V2}","twice"),"Say whether the tonality is major, or minor.","Say whether the final cadence is perfect, or imperfect."]),ut=i([K.replace("{V1}","piece").replace("{V2}","twice"),"Say how the tonality changed.","Say whether the final cadence is perfect, plagal, imperfect, or interrupted."]),ft=i([K.replace("{V1}","piece").replace("{V2}","twice"),ie.replace("{V1}","two")]),dt=i([K.replace("{V1}","piece").replace("{V2}","twice"),ie.replace("{V1}","three")]),pt=i([k.replace("{V1}","melody"),oe.replace("{V1}","legato, or staccato")]),ht=i([k.replace("{V1}","first two bars of the melody for this exercise"),"Say whether the last note was higher, or lower, than the first.",pe]),mt=i([k.replace("{V1}","melody"),"Say whether the last note was higher, or lower, than the first.",pe]),yt=i([k.replace("{V1}","first two notes of the melody for this exercise"),"State the interval between them.","You only need to identify the interval by number (second, third, fourth, fifth, sixth).",pe]),gt=i([k.replace("{V1}","first two notes of the melody for this exercise"),"State the interval between them.","The interval will be a major/minor second, major/minor third, perfect fourth/fifth, major/minor sixth.",pe]),At=i([k.replace("{V1}","two consecutive notes from the melody for this exercise"),"State the interval between them.","The interval will be a major/minor second, major/minor third, perfect fourth/fifth, major/minor sixth, major/minor seventh, or an octave.",pe]),_t=i([k.replace("{V1}","key-chord, followed by the first four bars of the piece for this exercise"),"Say where the music modulated to (dominant, subdominant, or relative minor).",pe]),vt=i([k.replace("{V1}","key-chord, followed by the first four bars of the piece for this exercise"),"Say where the music modulated to (dominant, subdominant, or relative minor/major).",pe]),bt=i(["Check the question to see whether you will be asked to identify the highest, or the lowest, note.",k.replace("{V1}","first three notes of the melody for this exercise"),"Answer the question.","A score of the full melody for this exercise is also provided so you can    review your responses to the exercise as a whole."]),xt=i([k.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),ne,"You only need to indicate when the change occurs (there is no need to describe the change further).",ae]),wt=i([k.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),ne,"Say whether the change was in rhythm, or pitch.",ae]),Et=i([le.replace("{V1}","melody"),k.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),"Say in which bar the change occurred.","Say whether the change was in rhythm, or pitch.",ae]),kt=i([le.replace("{V1}","melody"),k.replace("{V1}","melody which, on being played for a second time, will have a change in rhythm and a change in pitch"),"Say in which bars the changes in rhythm and pitch occurred.",ae]),Ct=i([le.replace("{V1}","piece"),k.replace("{V1}","piece which, on being played for a second time, will have a change in rhythm and a change in pitch in the melody"),"Say in which bars the changes in rhythm and pitch occurred.",ae]),$t=i([le.replace("{V1}","piece"),k.replace("{V1}","piece, played twice, and having two changes\n    to the melody of rhythm, or pitch"),ue,ce]),Bt=i([le.replace("{V1}","piece"),k.replace("{V1}","piece, played twice, and having three changes\n    of rhythm, or pitch"),"Changes of pitch will be in the melody only.",ue,ce]),Mt=i([le.replace("{V1}","piece"),k.replace("{V1}","piece, played twice, and having three changes\n    of pitch or rhythm"),ue,ce]),Nt=[{id:"p2",info:i([de])},{id:"s1",info:i([pe])}],It=[{id:"P1",info:i(["Plays a short piece.",M])},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:i([pe])}],Tt=[{id:"P1",info:i(["Plays the piece.",M,C])},{id:"Q1"},{id:"a1"},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])},{id:"s1",info:i([pe])}],St=[{id:"P1",info:i(["Plays two phrases","Clap the rhythm in the pause after each phrase."])},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:i([pe])}],Ot=[{id:"P1",info:i(["Plays the notes, the rhythm of which you need to clap.","The notes are repeated.","After you have heard the notes for the second time, clap the rhythm of the notes.","Finally, answer the question below."])},{id:"Q1"},{id:"a1"},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:i([pe])},{id:"s2",info:i(["Full score to review the exercise as a whole."])}],Ft=[{id:"P1",info:i(["Plays two phrases.","Sing each phrase back in the following pause."])},{id:"p2",info:i([de,"Your response should correspond with the flute."])},{id:"s1",info:i([pe])}],Rt=[{id:"P1",info:i(["Plays three phrases.","Sing each back in the following pause."])},{id:"p2",info:i([de,"Your response should correspond with the flute."])},{id:"s1",info:i([pe])}],Dt=[{id:"P1",info:i(["Listen to the key chord, tonic note, and count-in.","These are followed by a two bar phrase ...","... and then the altered phrase."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i(["Score of the two bar phrase.",fe])},{id:"s2",info:i(["Score of the altered two bar phrase.",fe])}],Ut=[{id:"P1",info:i(["Listen to the key chord, tonic note, and count-in.","These are followed by a phrase (up to four bars) ...","... and then the altered phrase."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i(["Score of the phrase.",fe])},{id:"s2",info:i(["Score of the altered phrase.",fe])}],Lt=[{id:"P1",info:i(["Listen to the key chord, tonic note, and two bar count-in.","You will then hear a phrase (repeated after a pause).","Either sing or play back the phrase."])},{id:"K1:P"},...Nt],Qt=[{id:"P1",info:W.replace("{V1}","the upper part of which")},{id:"K1:P"},...Nt],jt=[{id:"P1",info:W.replace("{V1}","the lower part of which")},{id:"K1:P"},...Nt],Pt=[{id:"P1",info:W.replace("{V1}","the lower part of which")},{id:"K1:P"},...Nt],Yt=[{id:"S1:T",info:i(["Score of the notes for you to sing."])},{id:"S2:B",info:i(["Score of the notes for you to sing."])},{id:"P1:T",info:i(["Listen to the key-chord and starting note.","Then sing the notes from the above score slowly."])},{id:"P2:B",info:i(["Listen to the key-chord and starting note.","Then sing the notes from the above score slowly."])},{id:"p3:T",info:i([de])},{id:"p4:B",info:i([de])}],zt=[{id:"S1:T",info:i(["Score of the melody for you to sing."])},{id:"S2:B",info:i(["Score of the melody for you to sing."])},{id:"P1:T",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:i(["Play the accompaniment, against which you need to sing the melody."])},{id:"P4:B",info:i(["Play the accompaniment, against which you need to sing the melody."])},{id:"p5:T",info:i([de])},{id:"p6:B",info:i([de])},{id:"p7:T",info:i([de])},{id:"p8:B",info:i([de])}],Vt=[{id:"S1:T",info:i(["Score of the notes, the upper part for you to sing."])},{id:"S2:B",info:i(["Score of the notes, the upper part for you to sing."])},{id:"P1:T",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:i(["Play the lower part, against which you need to sing the upper part."])},{id:"P4:B",info:i(["Play the lower part, against which you need to sing the upper part."])},{id:"p5:T",info:i([de])},{id:"p6:B",info:i([de])},{id:"p7:T",info:i([de])},{id:"p8:B",info:i([de])}],Ht=[{id:"S1:T",info:i(["Score of the notes, the lower part for you to sing."])},{id:"S2:B",info:i(["Score of the notes, the lower part for you to sing."])},{id:"P1:T",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:i(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:i(["Play the upper part, against which you need to sing the lower part."])},{id:"P4:B",info:i(["Play the upper part, against which you need to sing the lower part."])},{id:"p5:T",info:i([de])},{id:"p6:B",info:i([de])},{id:"p7:T",info:i([de])},{id:"p8:B",info:i([de])}],Gt=[{id:"P1",info:i(["Listen to the key-chord and cadence (played twice)."])},{id:"Q1"},{id:"a1"}],qt=[...Gt,{id:"s1",info:i([pe])}],Jt=[{id:"P1",info:i(["Listen first to the key-chord, then the two chords from the cadence in part (i)."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],Wt=[{id:"P1",info:i(["Listen first to the key-chord, then the three chords from the cadence in part (ii).","The chords are then repeated with a pause after each, during which you should name the chord just played."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],Kt=[{id:"P1",info:i(["Listen first to the key-chord, then a piece which modulates."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],Xt=[{id:"IQ",info:i(["The feature of the piece you will be asked about."])},{id:"P1#Q1",info:i(["Plays the piece.","Listen, then answer the question below."])},{id:"q1"},{id:"a1"},{id:"s1",info:i([pe])}],Zt=[{id:"IQ",info:i(["Features of the piece you will be asked about."])},{id:"P1#Q1",info:i(["Plays the piece.","Listen, then answer the questions below."])},{id:"q1"},{id:"a1#Q2"},{id:"q2"},{id:"a2"}],en=[...Zt,{id:"s1",info:i([pe])}],tn=[{id:"P1#Q1",info:i(["Plays the piece.","Listen, then answer the question below."])},{id:"q1"},{id:"a1"},{id:"s1",info:i([pe])}],nn=[{id:"P1",info:i(["Plays the melody three times.","When you hear the melody for the third time, join in clapping the pulse.",C])},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],rn=[{id:"P1",info:i(["Plays the melody twice.","When you hear the melody for the second time, join in clapping the pulse.",C])},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],sn=[{id:"P1",info:i(["Plays the piece twice.","When you hear the piece for the second time, join in clapping the pulse.",C])},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],on=[{id:"P1",info:i(["Plays the piece twice.","When you hear the piece for the second time, join in clapping the pulse.",C,"Answer the question below (state the time signature)."])},{id:"Q1"},{id:"a1"},{id:"p2",info:i([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}];function an(e){return[{id:"P1",info:i([`Plays the piece ${e}.`,"After listening, answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"Q3"},{id:"a3"},{id:"p2",info:i([de,"A metronome is included to help you identify the time signature."])}]}const cn=an("twice"),ln=an("once"),un=[{id:"P1",info:i(["Plays the melody.","Listen, then answer the question."])},{id:"Q1"},{id:"a1"}],fn=[{id:"P1",info:i(["Plays the melody.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"}],dn=[{id:"P1",info:i(["Plays the piece twice.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"}],pn=[{id:"P1",info:i(["Plays the piece twice.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"}],hn=[{id:"P1",info:i(["Plays the first two bars of the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],mn=[{id:"P1",info:i(["Plays the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],yn=[{id:"P1",info:i(["Plays the first two notes of the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],gn=[{id:"P1",info:i(["Plays two consecutive notes from the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],An=[{id:"P1",info:i(["Plays the key-chord, then the first four bars of the piece.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])}],_n=[{id:"P1",info:i(["Plays the first three notes.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:i([pe])},{id:"s2",info:i(["Complete score of the music for this exercise.","View this to review your responses to the exercise as a whole."])}],vn=[{id:"s1",info:i(["Score of the melody <i>without</i> the change.",fe])},{id:"s2",info:i(["Score of the melody <i>with</i> the change.",fe])}],bn="Plays the melody, then repeats it with a change of <i>rhythm</i> or <i>pitch</i>.",xn=[{id:"P1",info:i([bn,"Indicate (by raising your hand), as soon as you hear the change."])},{id:"a1",info:i(["The bar of the change.",fe,"Did you indicate correctly?"])}].concat(vn),wn=[{id:"P1",info:i([bn,"Indicate (by raising your hand), as soon as you hear the change.","Then answer the question below (say whether the change was in <i>rhythm</i> or <i>pitch</i>)."])},{id:"a1",info:i(["The bar of the change.",fe,"Did you indicate correctly?"])},{id:"Q2"},{id:"a2"}].concat(vn),En=[{id:"S1",info:i(["Score of the melody.","Study this, then listen to the melody/variation below."])},{id:"P1",info:i(["Plays the melody first as written, then with a change in\n       either <i>rhythm</i> or <i>pitch</i>.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"s2",info:i(["Score of the melody <i>with</i> the change.",pe])}],kn=En.concat([{id:"s3",info:i(["Complete score of the piece for this exercise.","This is to help you review the exercise as a whole."])}]),Cn=[{id:"S1",info:i(["Score of the piece.","Study this, then listen to the piece/variation with the player below."])},{id:"P1",info:i(["Plays the piece first as written, then with a change of\n      <i>rhythm</i> and a change of <i>pitch</i> in the melody.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"s2",info:i(["Score of the piece <i>with</i> the changes.",pe])}];function $n(e,t){let n=["Plays the piece twice.",`The piece as played will have ${e} changes compared with the score.`,"The changes will be of rhythm and/or pitch.","Changes in pitch will occur only in the melody.","Listen, then answer the question below."];return"8"==t&&n.splice(3,1),[{id:"S1",info:i(["Score of the piece.","Study this, then listen to the variation with the player below."])},{id:"P1",info:i(n)},{id:"Q1"},{id:"a1"},{id:"s2",info:i(["Score of the piece <i>with</i> the changes.",pe])}]}const Bn=$n("two"),Mn=$n("three"),Nn=$n("three","8");var In={[r.ID_ABRSM]:{0:{A:{i:{title:a,instruction:he,layout:It}},B:{i:{title:"Clap Echoes",instruction:Ee,layout:St}},C:{i:{title:c,instruction:Ne,layout:Ft}},D:{i:{title:"Answer a Question about a Piece",instruction:Ye,qkeys:{1:["dynamics","articulation"]},layout:Xt}}},1:{A:{i:{title:f,instruction:me,qkeys:{1:["twothreetime"]},layout:Tt}},B:{i:{title:c,instruction:ke,layout:Rt}},C:{i:{title:"Locate the Change in Pitch",instruction:Ie,qkeys:{1:["beginorend"]},layout:Dt}},D:{i:{title:u,instruction:Ve,qkeys:{1:["dynamics"],2:["articulation"]},layout:en}}},2:{A:{i:{title:f,instruction:me,qkeys:{1:["twothreetime"]},layout:Tt}},B:{i:{title:c,instruction:ke,layout:Rt}},C:{i:{title:l,instruction:Te,qkeys:{1:["different"]},layout:Dt}},D:{i:{title:u,instruction:He,qkeys:{1:["dynamics","articulation"],2:["tempo"]},layout:en}}},3:{A:{i:{title:f,instruction:ye,qkeys:{1:["twothreefourtime"]},layout:Tt}},B:{i:{title:c,instruction:ke,layout:Rt}},C:{i:{title:l,instruction:Se,qkeys:{1:["different"]},layout:Ut}},D:{i:{title:u,instruction:Ge,qkeys:{1:["dynamics","articulation","tempo"],2:["tonality"]},layout:en}}},4:{A:{i:{title:d,instruction:ge,choices:[o],layout:Lt}},B:{i:{title:p,instruction:Ce,choices:[s],layout:Yt}},C:{i:{title:u,instruction:qe,qkeys:{1:["dynamics","articulation","tempo","tonality"],2:["character"]},layout:Zt},ii:{title:h,instruction:Fe,qkeys:{1:["twothreefourtime"]},layout:Ot}}},5:{A:{i:{title:d,instruction:ge,choices:[o],layout:Lt}},B:{i:{title:p,instruction:Ce,choices:[s],layout:Yt}},C:{i:{title:u,instruction:Je,qkeys:{1:["dynamics","articulation","tempo","tonality","character"],2:["style"]},layout:Zt},ii:{title:h,instruction:Fe,qkeys:{1:["twothreefourtime"]},layout:Ot}}},6:{A:{i:{title:d,instruction:_e,choices:[o],layout:Qt}},B:{i:{title:p,instruction:$e,choices:[s],layout:zt}},C:{i:{title:m,instruction:De,qkeys:{1:["cadence"]},layout:qt}},D:{i:{title:u,instruction:We,qkeys:{1:["texture","structure"],2:["texture","structure","dynamics","articulation","tempo","tonality","character","style"]},layout:en},ii:{title:h,instruction:Fe,qkeys:{1:["twothreefourtime"]},layout:Ot}}},7:{A:{i:{title:d,instruction:ve,choices:[o],layout:jt}},B:{i:{title:p,instruction:Be,choices:[s],layout:Vt}},C:{i:{title:m,instruction:Ue,qkeys:{1:["cadence"]},layout:Gt},ii:{title:y,instruction:Le,qkeys:{1:["chords"]},layout:Jt},iii:{title:g,instruction:Qe,qkeys:{1:["wheremodulate"]},layout:Kt}},D:{i:{title:u,instruction:Ke,qkeys:{1:["texture","structure","dynamics","articulation","tempo","tonality","character","style"],2:["texture","structure","dynamics","articulation","tempo","tonality","character","style"]},layout:en},ii:{title:h,instruction:Re,qkeys:{1:["twothreefour68time"]},layout:Ot}}},8:{A:{i:{title:d,instruction:be,choices:[o],layout:Pt},ii:{title:m,instruction:xe,qkeys:{1:["cadence"]},layout:Gt},iii:{title:y,instruction:we,qkeys:{1:["chords"]},layout:Wt}},B:{i:{title:p,instruction:Me,choices:[s],layout:Ht}},C:{i:{title:A+" (part 1)",instruction:je,qkeys:{1:["wheremodulate"]},layout:Kt},ii:{title:A+" (part 2)",instruction:Pe,qkeys:{1:["wheremodulate"]},layout:Kt}},D:{i:{title:"Describe the Features of a Piece",instruction:Xe,qkeys:{1:["describe"]},layout:tn}}}},[r.ID_TRINITY]:{0:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Forte or Piano?",instruction:ot,qkeys:{1:["fortepiano"]},layout:un},iii:{title:"Legato or Staccato?",instruction:pt,qkeys:{1:["legatostaccato"]},layout:un},iv:{title:"Identify the Highest or Lowest Note",instruction:bt,qkeys:{1:[["highest123","lowest123"]]},layout:_n}},1:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Forte or Piano? Legato or Staccato?",instruction:it,qkeys:{1:["fortepiano"],2:["legatostaccato"]},layout:fn},iii:{title:_,instruction:ht,qkeys:{1:["higherlastfirst"]},layout:hn},iv:{title:b,instruction:xt,qkeys:{1:["wherepitchrhythm"]},layout:xn}},2:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Dynamics & Articulation",instruction:at,qkeys:{1:["dynamics"],2:["legatostaccato"]},layout:fn},iii:{title:_,instruction:mt,qkeys:{1:["higherlastfirst"]},layout:mn},iv:{title:b,instruction:wt,qkeys:{1:["where"],2:["pitchrhythm"]},layout:wn}},3:{i:{title:a,instruction:et,layout:rn},ii:{title:"Major or Minor?",instruction:ct,qkeys:{1:["tonality"]},layout:un},iii:{title:v,instruction:yt,qkeys:{1:["interval"]},layout:yn},iv:{title:"Locate the Change in Pitch or Rhythm",instruction:Et,qkeys:{1:["whichbar"],2:["pitchrhythm"]},layout:En}},4:{i:{title:a,instruction:tt,layout:sn},ii:{title:"Major or Minor? Identify the Cadence.",instruction:lt,qkeys:{1:["tonality"],2:["cadence_pi"]},layout:dn},iii:{title:v,instruction:gt,qkeys:{1:["interval"]},layout:yn},iv:{title:"Locate the Changes in Pitch and Rhythm",instruction:kt,qkeys:{1:["whichbarrhythm"],2:["whichbarpitch"]},layout:kn}},5:{i:{title:"Clap the Pulse & State the Time Signature",instruction:nt,qkeys:{1:["timesig"]},layout:on},ii:{title:"Identify the Change in Tonality. Identify the Cadence.",instruction:ut,qkeys:{1:["tonalitychange"],2:["cadence_ppii"]},layout:dn},iii:{title:v,instruction:At,qkeys:{1:["interval"]},layout:gn},iv:{title:"Locate and Identify the Changes in Pitch and Rhythm",instruction:Ct,qkeys:{1:["whichbarrhythm"],2:["whichbarpitch"]},layout:Cn}},6:{i:{title:w,instruction:rt,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:cn},ii:{title:E,instruction:ft,qkeys:{1:["twootherchars"]},layout:pn},iii:{title:g,instruction:_t,qkeys:{1:["wheremodulate"]},layout:An},iv:{title:x,instruction:$t,qkeys:{1:["twochanges"]},layout:Bn}},7:{i:{title:w,instruction:rt,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:cn},ii:{title:E,instruction:ft,qkeys:{1:["twootherchars"]},layout:pn},iii:{title:g,instruction:vt,qkeys:{1:["wheremodulate"]},layout:An},iv:{title:x,instruction:Bt,qkeys:{1:["threechanges"]},layout:Mn}},8:{i:{title:w,instruction:st,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:ln},ii:{title:"Describe Three (other) Characteristics",instruction:dt,qkeys:{1:["threeotherchars"]},layout:pn},iii:{title:x,instruction:Mt,qkeys:{1:["threechanges"]},layout:Nn}}}};let Tn={SQA1:{title:"Theory Question",instruction:he,qkeys:{1:["custom"]},layout:[{id:"S1",info:"Score."},{id:"Q1"},{id:"a1"}]},T3:{title:"Theory Question",instruction:he,qkeys:{1:["custom"]},layout:[{id:"S1",info:"Score."},{id:"Q1"},{id:"a1#S2"},{id:"s2",info:"Score."}]},T2:{title:"Theory Lesson",instruction:he,layout:[{id:"P1",info:"Player."}]}};e.exports={byPath:In,byType:Tn}},17:e=>{const t="Section";function n(e){return`${e}`}function r(e,t,n="A, B, C, D"){return`Exercises for ${e} Grade ${t} are grouped by Section (${n}).<br/>Please choose a Section ...`}let s=[{id:"root",desc:"Home",icon:"home",cmpt:"MsgContent",msg:"Please choose a type of exercise ...",children:[{id:"T",desc:"Trinity",cmpt:"MsgContent",msg:"Please choose a Grade ...",children:[{id:"0",cmpt:"ExContent",module:!0,desc:"Initial",partDesc:"Question",partLabel:"num"},{id:"1",cmpt:"ExContent",module:!0,desc:n("1"),partDesc:"Question",partLabel:"num"},{id:"2",cmpt:"ExContent",module:!0,desc:n("2"),partDesc:"Question",partLabel:"num"},{id:"3",cmpt:"ExContent",module:!0,desc:n("3"),partDesc:"Question",partLabel:"num"},{id:"4",cmpt:"ExContent",module:!0,desc:n("4"),partDesc:"Question",partLabel:"num"},{id:"5",cmpt:"ExContent",module:!0,desc:n("5"),partDesc:"Question",partLabel:"num"}]},{id:"A",desc:"ABRSM",cmpt:"MsgContent",msg:"Please choose a Grade ...",children:[{id:"0",cmpt:"MsgContent",module:!0,allFree:!1,desc:"Initial",msg:r("ABRSM","Initial"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"1",cmpt:"MsgContent",module:!0,desc:n("1"),msg:r("ABRSM",1),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"2",cmpt:"MsgContent",module:!0,desc:n("2"),msg:r("ABRSM",2),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"3",cmpt:"MsgContent",module:!0,desc:n("3"),msg:r("ABRSM",3),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"4",cmpt:"MsgContent",module:!0,desc:n("4"),msg:r("ABRSM",4,"A,B,C"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent",partDesc:"Part"}]},{id:"5",cmpt:"MsgContent",module:!0,desc:n("5"),msg:r("ABRSM",5,"A,B,C"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent",partDesc:"Part"}]}]}]}];e.exports={ID_TRINITY:"T",ID_ABRSM:"A",exMenu:s}},446:(e,t,n)=>{e=n.nmd(e),function(t){"use strict";var n,r="function"==typeof(n=t.atob)?n:"function"==typeof Buffer?function(e){return new Buffer(e,"base64").toString("binary")}:"object"==typeof t.base64js?function(e){var n=t.base64js.b64ToByteArray(e);return Array.prototype.map.call(n,(function(e){return String.fromCharCode(e)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};t.atob=r,e&&e.exports&&(e.exports=r)}(window)},970:function(e,t,n){var r,s;!function(o,i){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function i(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}function a(t,n){for(var s=0;s<r.length;s++){var o=r[s];this[o]=s<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return i(e)||c.apply(this,arguments)}function u(e,n,s){var o,i=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=s||l,i.getLevel=function(){return o},i.setLevel=function(n,r){if("string"==typeof n&&void 0!==i.levels[n.toUpperCase()]&&(n=i.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&u(n),a.call(i,n,e),typeof console===t&&n<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){n=e,f()||i.setLevel(e,!1)},i.resetLevel=function(){i.setLevel(n,!1),d()},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var p=f();null==p&&(p=n),i.setLevel(p,!1)}var f=new u,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()},15:(e,t,n)=>{const r=n(970).getLogger("audiolib"),s=n(688).assert,o=n(60),i="CDEFGABcdefgab",a=[".","~","H","L","M","O","P","S","T","u","v"],c={NOTE:{groups:["NCR"]},CHORD:{groups:["NCR"]},REST:{groups:["NCR"]},PPP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},PP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},P:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},MP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},MF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},F:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},FF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},FFF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},START_CRESC:{groups:["DYNAMICS","START_CRESC_DECRESCS"]},END_CRESC:{groups:["DYNAMICS","END_CRESC_DECRESCS"]},START_DECRESC:{groups:["DYNAMICS","START_CRESC_DECRESCS"]},END_DECRESC:{groups:["DYNAMICS","END_CRESC_DECRESCS"]},PED:{groups:["DYNAMICS"],data:[o.Symbols.ControllerTypes.holdPedal,127]},PED_UP:{groups:["DYNAMICS"],data:[o.Symbols.ControllerTypes.holdPedal,0]}},l={};for(let e of Object.keys(c))for(let t of c[e].groups)l[t]=l[t]||[],l[t].push(e);const u={"!ppp!":"PPP","!pp!":"PP","!p!":"P","!mp!":"MP","!mf!":"MF","!f!":"F","!ff!":"FF","!fff!":"FFF","!<(!":"START_CRESC","!crescendo(!":"START_CRESC","!<)!":"END_CRESC","!crescendo)!":"END_CRESC","!>(!":"START_DECRESC","!diminuendo(!":"START_DECRESC","!>)!":"END_DECRESC","!diminuendo)!":"END_DECRESC","!ped!":"PED","!ped-up!":"PED_UP"},f=["!>!","!accent!","!emphasis!","!^!","!marcato!","!sfz!"],d={PPP:[30,20,10,1],PP:[45,35,20,1],P:[60,50,35,1],MP:[75,65,50,1],MF:[90,80,65,1],F:[105,95,80,1],FF:[120,110,95,1],FFF:[127,125,110,1]};let p={};function h(e,t){return Math.abs(e-t)<.001}function m(e){return e.replace(/".*?"/g,"")}function y(e){let t={},n=e.indexOf("/");if(n<0){let n=`No / in ${e}`;return r.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}let s="";for(let t=n+1;t<e.length;t++)"0123456789".indexOf(e[t])>-1&&(s+=e[t]);if(!s){let n=`No denominator in ${e}`;return r.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}t.denominator=Number(s);let o="";for(let t=n-1;t>-1;t--)"0123456789".indexOf(e[t])>-1&&(o=e[t]+o);if(!o){let n=`No numerator in ${e}`;return r.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}return t.numerator=Number(o),t}function g(e){let t={},n=e.indexOf("="),s=e.indexOf("/");if(n<0||s<0)return t;let o="";for(let t=n+1;t<e.length;t++)"0123456789".indexOf(e[t])>-1&&(o+=e[t]);o||r.error("audiolib.abc-utils.parseQ() Bad Q (bpm): "+e),t.bpm=Number(o);let i,a=e.substr(0,n),c=/\d*\/.\d*/g,l={numerator:0,denominator:1};for(;null!==(i=c.exec(a));){let e=y(i[0]);f=e,l={numerator:(u=l).numerator*f.denominator+f.numerator*u.denominator,denominator:u.denominator*f.denominator}}var u,f;return t.numerator=l.numerator,t.denominator=l.denominator,t}function A(e){if((e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),"none"==e.toLowerCase()||""==e)return{value:"none",numerator:0,denominator:0};"C"==e?e="4/4":"C|"==e&&(e="2/2");let t=y(e);return t.value=e,t}function _(e){return(e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),y(e)}function v(e){let t={};return(e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),t.value=e,t}function b(e){let t,n=e.split("beat ");if(n.length<2)r.error(`Bad MIDI beat: ${e}`),t=d.MF;else{t=[];let s=n[1].split(" ");for(let e of s)t.push(Number(e));t.length<4&&(r.error(`Bad MIDI beat: ${e}`),t=d.MF)}return t}function x(e){let t=(e=e.trim()).split("beatstring");return t.length<2?"":t[1].trim()}function w(e){let t=(e=e.trim()).split("channel");return t.length<2?(r.error(`Bad MIDI channel: ${e}`),1):Number(t[1].trim())}function E(e,t){let n,r,o=(e=e.trim()).split("program")[1].trim().split(" ");return o.length<2?(s(t,`Only one param for MIDI program, but current Channel not specified ${e}`),n=Number(t),r=Number(o[0])):(n=Number(o[0]),r=Number(o[1])),[n,r]}function k(e){s("string"==typeof e||e instanceof String,`${e} is not a string`);let t={};(e=e.trim().replace("[","").replace("]","")).startsWith("I:")&&(e=e.substr(2));let n=e.split(" ");if(1==n.length)t.type=(n[0]?n[0]:"TODObad_I").toUpperCase();else{let s=n[0].toUpperCase();"MIDI"==s?(t.type=s+n[1].toUpperCase(),"MIDIBEAT"==t.type?t.value=b(e):"MIDIBEATSTRING"==t.type?t.value=x(e):"MIDICHANNEL"==t.type?t.value=w(e):"MIDIPROGRAM"==t.type?t.value=E(e):"MIDICONTROL"==t.type&&(t.value=function(e){let t,n,s=(e=e.trim()).split("control")[1].trim().split(" ");return s.length<2?(r.error(`Bad MIDI control: '${e}'`),t=0,n=0):(t=Number(s[0]),n=Number(s[1])),[t,n]}(e))):(t.type=s,t.value=n.slice(1))}return t}function C(e){let t={};t.sLenMod=e;let n=0,r="";for(;n<t.sLenMod.length&&!isNaN(parseInt(t.sLenMod[n],10));)r+=t.sLenMod[n],n++;t.numerator=r?parseInt(r,10):1;let s=1;for(;n<t.sLenMod.length&&"/"==t.sLenMod[n];){let e="",r=n+1;for(;r<t.sLenMod.length&&!isNaN(parseInt(t.sLenMod[r],10));)e+=t.sLenMod[r],r++;n=r,s=e?s*parseInt(e,10):2*s}return t.denominator=s,t}function $(e){let t=!0;for(let n=0;n<e.length;n++)if("0123456789".indexOf(e[n])<0){t=!1;break}return t}function B(e,t){let n=t,r="";for(;t<e.length&&"0123456789".indexOf(e[t])>-1;)r+=e[t],t++;return{num:r?Number(r):NaN,len:t-n}}function M(e,t){let n={},o=t;s.ok("("==e[t],`Tuplet ${e} does not begin with (`);let i=B(e,++t);s.ok(!isNaN(i.num),`Tuplet ${e} does not have number after (`),n.p=i.num,t+=i.len;let a=!1;if(3==n.p?(n.q=2,n.r=3):2==n.p?(n.q=3,n.r=2):a=!0,":"==e[t]){if(t++,!isNaN(e[t])){let r=B(e,t);n.q=r.num,t+=r.len}if(":"==e[t]&&(t++,!isNaN(e[t]))){let r=B(e,t);n.r=r.num,t+=r.len}}return n.len=t-o,!a||n.q&&n.r||(r.error(`No default tuplet q/r values for ${n.p}`),n.q||r.error("No q specified"),n.r||r.error("No r specified"),r.error(JSON.stringify(n))),n}function N(e,t,n){let r;return"Z"==e.letter||"X"==e.letter?(s.ok(n,"Cannot evaluate X or Z without Metre."),r=e.postfix.lenMod.numerator*n.numerator*4/n.denominator):r=t.numerator/t.denominator*4*(e.postfix.lenMod.numerator/e.postfix.lenMod.denominator),r}function I(e,t,n){JSON.stringify(e);let r=e;if(t){let e=0;for(let s of t)if("M"==s.type){if(r=s.obj,e==n)break}else if(("BAR"==s.type||"END"==s.type)&&(e++,e>n))break}return s(r,"Could not find M"),s("none"!=r.value&&r.denominator>0,"Cannot work out quarter notes per bar if there is no metre."),r.numerator/r.denominator*4}function T(e,t,n,r){let s=0,o=n,i=r,a=0;for(let n of e)if(l.NCR.indexOf(n.type)>-1)a==t&&(s+=N(n,o,i));else if("L"==n.type)o=n.obj;else if("M"==n.type)i=n.obj;else if("BAR"==n.type&&(a++,a>t))break;return s}function S(e,t,n,r){let s;if(0==r.numerator||0==r.denominator)s=1;else{s=T(e,t,n,r)/I(r,e,r)}return s}function O(e,t,n){const r={"1/1":1/16,"1/2":1/8,"2/2":1/16,"3/2":1/24,"2/4":1/8,"3/4":1/12,"4/4":1/16,"5/4":.05,"3/8":1/6,"5/8":.1,"6/8":1/12,"9/8":1/18},o={"1/1":1,"1/2":1,"2/2":2,"3/2":3,"2/4":2,"3/4":3,"4/4":4,"5/4":5,"3/8":3,"5/8":5,"6/8":2,"9/8":3},i="L.=c",a=".=C",c={"1/1":`${i}4`,"1/2":`${i}2`,"2/2":`${i}2`,"3/2":`${i}2`,"2/4":`${i}`,"3/4":`${i}`,"4/4":`${i}`,"5/4":`${i}`,"3/8":`${i}/`,"5/8":`${i}/`,"6/8":`${i}3/`,"9/8":`${i}3/`},l={"1/1":`${a}4`,"1/2":`${a}2`,"2/2":`${a}2`,"3/2":`${a}2`,"2/4":`${a}`,"3/4":`${a}`,"4/4":`${a}`,"5/4":`${a}`,"3/8":`${a}/`,"5/8":`${a}/`,"6/8":`${a}3/`,"9/8":`${a}3/`},u={"1/1":`${i}4|`,"1/2":`${i}2|`,"2/2":`${i}2${a}2|`,"3/2":`${i}2${a}2${a}2|`,"2/4":`${i}${a}|`,"3/4":`${i}${a}${a}|`,"4/4":`${i}${a}${a}${a}|`,"3/8":`${i}/${a}/${a}/|`,"5/8":`${i}/${a}/${a}/${a}/${a}/|`,"6/8":`${i}3/${a}3/|`,"9/8":`${i}3/${a}3/${a}3/|`},f={"1/1":["=D4"],"1/2":["=D2"],"2/2":["=D2","=E2"],"3/2":["=D2","=E2","=F2"],"2/4":["=D","=E"],"3/4":["=D","=E","=F"],"4/4":["=D","=E","=F","=G"],"5/4":["=D","=E","=F","=G","=A"],"3/8":["=D/","=E/","=F/"],"5/8":["=D/","=E/","=F/","=G/","=A/"],"6/8":["=D3/","=E3/"],"9/8":["=D3/","=E3/","=F3/"]},d={"1/1":f["1/1"].join("")+"|","1/2":f["1/2"].join("")+"|","2/2":f["2/2"].join("")+"|","3/2":f["3/2"].join("")+"|","2/4":f["2/4"].join("")+"|","3/4":f["3/4"].join("")+"|","4/4":f["4/4"].join("")+"|","5/4":f["5/4"].join("")+"|","3/8":f["3/8"].join("")+"|","5/8":f["5/8"].join("")+"|","6/8":f["6/8"].join("")+"|","9/8":f["9/8"].join("")+"|"};let p=A(t);if(0==p.numerator)return["","","","",""];s.ok(l[p.value],`Could not look up Metro Note for M=${t}`),s.ok(c[p.value],`Could not look up Metro Note for M=${t}`),s.ok(u[p.value],`Could not look up Metro Full Bar for M=${t}`),s.ok(f[p.value],`Could not look up Count Notes for M=${t}`),s.ok(d[p.value],`Could not look up Count Full Bar for M=${t}`);let m=r[p.value];s.ok(m,`Could not look up delta for M=${p.value}`);let y=P(e);s(y>0,`Bar count is zero. || at end? ${e}`);let g,v=j({raw:e},null),b=_(n),x=S(v,0,b,p);s(!(x>1),`fracBarComplete ${x} > 1.`),g=y>1?S(v,y-1,b,p):0;let w="",E=0,k="",C=1-x;if(h(C,1))w="Z";else{for(;C>0&&!h(C,0);)C-=m,3==E?(k+="z",w="",E=0):(E++,w+="z//");w=k+w}let $="",B=0,M="";if(C=1-g,1==y);else if(h(C,1))$="Z";else{for(;C>0&&!h(C,0);)C-=m,3==B?(M+="z",$="",B=0):(B++,$+="z//");$+=M}let N="",I="",T=0,O="",F="";m=r[p.value];let R=0,D=1/r[p.value]/o[p.value];for(C=x;C>0&&!h(C,0);)N="z//"+N,T+=1,h(T,D)&&(R++,R==o[p.value]?(O=c[p.value]+O,F=f[p.value][0]+F):(O=l[p.value]+O,F=f[p.value][o[p.value]-R]+F),T=0,N="",I=""),T>0&&T%4==0&&(I+="z",N=""),C-=m;let U=`${I}${N}${O}|`,L=`${I}${N}${F}|`,Q="",Y="";if(1==y);else{let e=1;for(m=1/o[p.value],C=g;C>0&&!h(C,0);)1==e?(Q+=c[p.value],Y+=f[p.value][0]):(Q+=l[p.value],Y+=f[p.value][e-1]),e+=1,C-=m}let z="",V="";for(beatNum=1,m=1/o[p.value],C=1-x;C>0&&!h(C,0);)1==beatNum?(z+=c[p.value],V+=f[p.value][0]):(z+=l[p.value],V+=f[p.value][beatNum-1]),beatNum+=1,C-=m;p.value,p.value;let H=[w,$,U,Q,z,L,Y,V,u[p.value],d[p.value]];return H}function F(e,t,n){let r=e[0],s=e[1],o=`[L:${n}][Q:${t}]`,i="[L:1/4]";return i+="Z"==r&&"Z"==s?`Z|Z|${o}`:""==r?""==s?`Z|Z|${o}`:`${s}|Z|${o}`:""==s?`Z|${r}${o}`:s+"|Z|"+r+o,i}function R(e,t,n,r){s(i.indexOf(e)>-1,`Invalid note ${e}`);let o=e,a=4,c=0;o==o.toLowerCase()&&(o=o.toUpperCase(),a++);for(let e=0;e<t.length;e++){let n=t[e];s("',".indexOf(n)>-1),a+={"'":1,",":-1}[n]}if(n){for(let e=0;e<n.length;e++){let t=n[e];s("^=_".indexOf(t)>-1),"="==t?c=0:c+={"^":1,_:-1}[t]}Math.abs(c)>2&&(c=2*Math.sign(c))}else c=p[r]&&p[r][o]||0;return{name:o+a,semitones:c}}function D(e,t=1,n=0){s(2==e.length,`Bad absNote ${e}`);const r="CDEFGAB";n+=Math.floor(Math.abs(t)/7)*Math.sign(t),t%=7;let o=r.indexOf(e[0])+t;o<0?(n--,o+=7):o>6&&(n++,o-=7);let i=Number(e[1]);return r[o]+(i+n)}function U(e){let t=e[0];s("CDEFGAB".indexOf(t)>-1,`Invalid absNote ${e}`),s("0123456789".indexOf(e[1])>-1,`Invalid octave ${e}`);let n=Number(e[1]),r=t;n>4&&(r=t.toLowerCase());let o="";return n<4?o=",".repeat(4-n):n>5&&(o="'".repeat(n-5)),{abcLetter:r,octaveModifier:o}}function L(e,t,n){let r={raw:""},s="",o=t-1;for(;o>n&&"^_=".indexOf(e[o])>-1;)r.raw=e[o]+r.raw,s=e[o]+s,o--;s=s.slice(-2);s&&["__","_","=","^","^^"].indexOf(s)<0&&(s=s.charAt(s.length-1));let i=[],c=!1;const l=a;for(;o>n;){if(c){let t=o;for(;t>-1&&"!"!=e[t];)t--;if("!"!=e[t])break;{let n=e.slice(t,o+2);r.raw=n+r.raw,i.unshift(n),c=!1,o=t}}else if("!"==e[o])c=!0;else{if(l.indexOf(e[o])<0)break;r.raw=e[o]+r.raw,i.unshift(e[o])}o--}return r.sAcc=s,r.decArray=i,r}function Q(e,t,n){let r={raw:""};if(r.raw=e.slice(t,n),"["==e[t]){let r=-1;for(let s=t;s<n;s++)if("]"==e[s]){r=s;break}if(r<0)throw Error(`Could not find ] in ${e}`);t=r}let s=t,o="";for(let i=t+1;i<n;i++){let t=e[i];if("ABCDEFGabcdefgZzXx[!".indexOf(t)>-1)break;"-"==t?(r.tied=!0,s=i):"<"!=t&&">"!=t||(o+=t,s=i)}["<","<<","<<<",">",">>",">>>"].indexOf(o)>-1&&(r.brokenRhythm=o);let i=t+1,a="";for(;i<n&&"-><',".indexOf(e[i])>-1;){let t=e[i];if("ABCDEFGabcdefgZzXx[!".indexOf(t)>-1)break;"',".indexOf(e[i])>-1&&(a+=e[i],i>s&&(s=i)),i++}r.sOctMod=a;let c="";for(;i<n&&("-></".indexOf(e[i])>-1||!isNaN(parseInt(e[i],10)));)"-><".indexOf(e[i])>-1||(c+=e[i],i>s&&(s=i)),i++;return r.lenMod=C(c),r.raw=e.slice(t+1,s+1),r}function j(e,t){let n=m(e.raw),s=[{type:"START",idx:-1,endIdx:-1},{type:"END",idx:n.length,endIdx:n.length}],o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],i=o[e+1];for(let e=t.endIdx+1;e<i.idx;e++){if("{"==n[e]){let t=n.indexOf("}",e+1);if(t<0)r.error("Unterminated {");else{let r={type:"GRACE",idx:e,endIdx:t,str:n.slice(e,t+1)};s.splice(a,0,r),a++,e=t}}}a++}o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1];for(let e=t.endIdx+1;e<r.idx;e++){if("["==n[e]&&e<r.idx-1){let t=n[e+1];if("MLQKI".indexOf(t)>-1){let r=n.indexOf("]",e),o=n.slice(e,r+1);if(r>-1){let i,c=t;"M"==t?i=A(o):"L"==t?i=_(o):"Q"==t?i=g(o):"K"==t?i=v(o):(i=k(o),c=i.type),s.splice(a,0,{type:c,raw:n.slice(e,r+1),idx:e,endIdx:r,obj:i}),a++,e=r}}}}a++}o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1];for(let e=t.endIdx+1;e<r.idx;e++){let t=n[e],r=e<n.length-1?n[e+1]:"";if("("==t&&$(r)){let t=M(n,e),r=e+t.len-1,o={type:"TUPLET",raw:n.slice(e,r+1),idx:e,endIdx:r,obj:t};s.splice(a,0,o),a++,e=r}}a++}o=s.slice(),a=1;let c=l.DYNAMICS;for(let e=0;e<o.length-1;e++){let t=o[e],i=o[e+1];for(let e=t.endIdx+1;e<i.idx;e++){if("!"==n[e]){let t=n.indexOf("!",e+1);if(t<0)r.error("Unterminated !");else{let r=n.slice(e,t+1),o=u[r];if(c.indexOf(o)>-1){let n={type:o,idx:e,endIdx:t};s.splice(a,0,n),a++}e=t}}}a++}o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1],i=0;for(let e=t.endIdx+1;e<r.idx;e++){let t=n[e];if("("==t||")"==t){i="("==t?i++:i--;let n={type:"("==t?"SLUR":"END_SLUR",nestLevel:i,idx:e,endIdx:e};s.splice(a,0,n),a++}}a++}const f=["|","|]","||","[|","|:",":|","::","[|]"];o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1];for(let e=t.endIdx+1;e<r.idx;e++){let t=n[e],o="";if("|"==t){o=t;let s="";e<r.idx-1&&(s=n[e+1]),"]"!=s&&"|"!=s&&":"!=s||(o+=s)}else if("["==t){let s="";e<r.idx-1&&(s=n[e+1],"|"==s&&(o=t+s,s=n[e+2],"]"==s&&(o+=s)))}else if(":"==t){let s="";e<r.idx-1&&(s=n[e+1]),"|"!=s&&":"!=s||(o=t+s)}if(f.indexOf(o)>-1){let t={type:"BAR",idx:e,endIdx:e+o.length-1,sBar:o};s.splice(a,0,t),a++,e+=o.length-1}}a++}o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1];for(let e=t.endIdx+1;e<r.idx;e++){if("["==n[e]){let o=n.indexOf("]",e);if(o>-1){let c=n.slice(e,o+1),l=L(n,e,t.endIdx),u=Q(n,e,r.idx),f={type:"CHORD",raw:l.raw+c+u.raw,idx:e-l.raw.length,endIdx:e+c.length-1+u.raw.length,sChord:c,prefix:l,postfix:u};s.splice(a,0,f),f.notes=[];let d=0,p=!0;for(let e=0;e<c.length;e++)if(i.indexOf(c[e])>-1){let t=L(c,e,d),n=Q(c,e,c.length-1);f.notes.push({type:"CHORD_NOTE",raw:t.raw+c[e]+n.raw,letter:c[e],prefix:t,postfix:n}),p&&(f.postfix.lenMod=C(n.lenMod.sLenMod+f.postfix.lenMod.sLenMod),p=!1),d=e,e+=n.raw.length}a++,e+=c.length+-1+u.raw.length}}}a++}const d=["z","Z","x","X"];o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1],i=!1;for(let e=t.endIdx+1;e<r.idx;e++){let t=n[e];if(i="!"==t?!i:i,!i&&d.indexOf(t)>-1){let o=Q(n,e,r.idx);s.splice(a,0,{type:"REST",raw:t+o.raw,idx:e,endIdx:e+o.raw.length,letter:t,postfix:o}),a++,e+=o.raw.length}}a++}o=s.slice(),a=1;for(let e=0;e<o.length-1;e++){let t=o[e],r=o[e+1],c=!1;for(let e=t.endIdx+1;e<r.idx;e++){let o=n[e];if(c="!"==o?!c:c,!c&&i.indexOf(o)>-1){let i=L(n,e,t.endIdx),c=Q(n,e,r.idx);s.splice(a,0,{type:"NOTE",raw:i.raw+o+c.raw,idx:e-i.raw.length,endIdx:e+c.raw.length,letter:o,prefix:i,postfix:c}),a++,e+=c.raw.length}}a++}const p={">":[[3,2],[1,2]],">>":[[7,4],[1,4]],">>>":[[15,8],[1,8]],"<":[[1,2],[3,2]],"<<":[[1,4],[7,4]],"<<<":[[1,8],[15,8]]};for(let e=0;e<s.length;e++){let t=s[e];if(("NOTE"==t.type||"CHORD"==t.type)&&t.postfix.brokenRhythm){let n=t,r=p[n.postfix.brokenRhythm];n.postfix.lenMod.numerator*=r[0][0],n.postfix.lenMod.denominator*=r[0][1];let o=null;for(let t=e+1;t<s.length;t++)if("NOTE"==s[t].type||"CHORD"==s[t].type){o=s[t];break}o&&(o.postfix.lenMod.numerator*=r[1][0],o.postfix.lenMod.denominator*=r[1][1])}}e:for(let e=0;e<s.length;e++){let t=s[e];if("TUPLET"==t.type){let n=0;for(let r=e+1;r<s.length;r++){let e=s[r];if(!(l.NCR.indexOf(e.type)<0)&&(n++,e.postfix.lenMod.numerator*=t.obj.q,e.postfix.lenMod.denominator*=t.obj.p,n==t.obj.r))continue e}r.warn("Too few notes/chords/rests follow tuplet.")}}let h=0,y=null,b=null;for(let e=0;e<s.length;e++){let t=s[e];if("SLUR"==t.type)h++;else if("END_SLUR"==t.type){if(h--,y){y.inSlur=!1;for(let e=b+1;e<s.length;e++){let n=s[e];if("REST"==n.type)break;if("NOTE"==n.type||"CHORD"==t.type){y.lastInSlur=!0;break}}}}else h>0&&("NOTE"==t.type||"CHORD"==t.type)&&(t.inSlur=!0,y=t,b=e)}return s}function P(e,t=!1){let n=j({raw:e});return t?n.filter((e=>"BAR"==e.type&&"[|]"!=e.sBar)).length:n.filter((e=>"BAR"==e.type)).length}function Y(e,t){s("ABCDEFG".indexOf(e)>-1,`Bad note letter ${e}`),s(p[t],`Bad key ${t}`);let n=p[t][e]||0;return n++,e+{0:"b",1:"",2:"#"}[n]}function z(e){s("string"==typeof e||e instanceof String,"notes parameter should be a string");let t=j({id:"null",raw:e}),n=null;for(let e=0;e<t.length;e++){let r=t[e];if("NOTE"==r.type){n=r;break}}return n}function V(e,t,n=2){let r=0,o=0,i=0,a=j({id:"null",raw:e});for(let e=0;e<a.length;e++){let s=a[e],c=0;if("BAR"==s.type){if(r++,r>n-1)break}else if("NOTE"==s.type)c=J.getMidiKey(s.letter,s.postfix.sOctMod,s.prefix.sAcc,t),o+=c,i++;else if("CHORD"==s.type)for(let e=0;e<s.notes.length;e++){let n=s.notes[e];c=J.getMidiKey(n.letter,n.postfix.sOctMod,n.prefix.sAcc,t),o+=c,i++}}s(i>0,"Cannot work out average MidiKey value key if no notes.");let c=o/i;return c}p.C={},p.G=Object.assign({F:1},p.C),p.D=Object.assign({C:1},p.G),p.A=Object.assign({G:1},p.D),p.E=Object.assign({D:1},p.A),p.B=Object.assign({A:1},p.E),p["F#"]=Object.assign({E:1},p.B),p["C#"]=Object.assign({B:1},p["F#"]),p.F=Object.assign({B:-1},p.C),p.Bb=Object.assign({E:-1},p.F),p.Eb=Object.assign({A:-1},p.Bb),p.Ab=Object.assign({D:-1},p.Eb),p.Db=Object.assign({G:-1},p.Ab),p.Gb=Object.assign({C:-1},p.Db),p.Cb=Object.assign({F:-1},p.Gb),p.Am={},p.Dm=Object.assign({B:-1},p.Am),p.Gm=Object.assign({E:-1},p.Dm),p.Cm=Object.assign({A:-1},p.Gm),p.Fm=Object.assign({D:-1},p.Cm),p.Bbm=Object.assign({G:-1},p.Fm),p.Ebm=Object.assign({C:-1},p.Bbm),p.Abm=Object.assign({F:-1},p.Ebm),p.Em=Object.assign({F:1},p.Am),p.Bm=Object.assign({C:1},p.Em),p["F#m"]=Object.assign({G:1},p.Bm),p["C#m"]=Object.assign({D:1},p["F#m"]),p["G#m"]=Object.assign({A:1},p["C#m"]),p["D#m"]=Object.assign({E:1},p["G#m"]);const H={treble:{A:["A,","C","E","A"],B:["B,","D","F","B"],C:["C","E","G","c"],D:["D","F","A","d"],E:["E","G","B","e"],F:["F","A","c","f"],G:["G","B","d","g"]},bass:{A:["A,,","C,","E,","A,"],B:["B,,","D,","F,","B,"],C:["C,","E,","G,","C"],D:["D,","F,","A,","D"],E:["E,","G,","B,","E"],F:["F,","A,","C","F"],G:["G,","B,","D","G"]}},G={"A,,":[],"B,,":[],"C,":["C,,"],"D,":["D,,"],"E,":["E,,"],"F,":["F,,"],"G,":["G,,"],"A,":["A,,"],"B,":["B,,"],C:["C,"],D:["D,"],E:["E,"],F:["F,"],G:["G,"]};function q(e,t,n=""){let r=e[0];s("ABCDEFG".indexOf(r)>-1,`Bad key ${e}`),s(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let o=H[t][r];if(n){let s=o[0],i=s.substr(1),a=J.getMidiKey(s[0],i,"",e),c=o[o.length-1];i=c.substr(1);let l=J.getMidiKey(c[0],i,"",e),u=V(n,e,2);"treble"==t&&u<a?(t="bass",o=H.bass[r]):"bass"==t&&u>l&&(t="treble",o=H.treble[r])}return JSON.stringify(o),[o.slice(),t]}let J={__test__:{getTuplet:M,getNumFromStr:B,getAvgMidiKey:V},Defaults:{M:{numerator:0,denominator:0,value:"none"},Q:{numerator:1,denominator:4,bpm:120}},Tokens:u,TokenTypes:c,TokenTypeGroups:l,NOTE_LETTERS:i,DECORATION_SHORTHANDS:a,CONTROL:["!ped!","!ped-up!"],MIDI_BEATS:d,MIDI_BEATSTRING_DFLT:{none:"m","1/1":"f","2/2":"fm","2/4":"fm","3/4":"fpp","4/4":"fpmp","5/4":"f","3/8":"fpp","5/8":"f","6/8":"fppmpp","9/8":"fppmppmpp","12/8":"fppmppmppmpp"},getAbsNote:R,incAbsNote:D,getAbcNote:U,incAbcNote:function(e,t=1){s(e,"abc-utils.incAbcNote() called with empty input.");let n="",r=0;for(;r<e.length&&"^_=".indexOf(e[r])>-1;)n+=e[r],r++;let o=e[r],a=i.indexOf(o);s(a>-1,`Bad note ${o}`),r++;let c="";for(;r<e.length&&",'".indexOf(e[r])>-1;)c+=e[r],r++;let l=U(D(R(o,c,"","C").name,t));return n+l.abcLetter+l.octaveModifier},getMidiKey:function(e,t,n,r){let s=R(e,t,n,r);return o.getMidiKey(s.name,s.semitones)},getDegreesBetweenAbcNotes:function(e,t){function n(t){let n=t[0],r={C:0,D:1,E:2,F:3,G:4,A:5,B:6}[n.toUpperCase()];n==n.toUpperCase()||(r+=7);let s=1;for(;s<t.length;)"'"==t[s]?r+=7:","==e[s]&&(r-=7),s++;return r}return n(t)-n(e)},getArticulatedDuration:function(e){let t=!1,n=!1,r=!1;e.prefix.decArray.indexOf(".")>-1&&(t=!0),e.prefix.decArray.indexOf("!wedge!")>-1&&(r=!0),e.prefix.decArray.indexOf("!tenuto!")>-1&&(n=!0);let s=e.durationInTicks;return t||r?n||e.inSlur?Math.floor(.75*s):Math.floor(.5*s):e.lastInSlur?Math.floor(.7*s):n||e.inSlur?s-1:Math.floor(.95*s)},getPlayedAcc:function(e,t,n,r){let s=e.prefix.sAcc;if(e.prefix.sAcc)s=e.prefix.sAcc;else if(t.accidentals[e.noteName])s=t.accidentals[e.noteName];else if(n)n.postfix.tied&&n.playedAcc&&e.noteName==n.noteName&&(s=n.playedAcc);else if(r)for(let t of r.notes)(r.postfix.tied||t.postfix.tied)&&t.playedAcc&&e.noteName==t.noteName&&(s=t.playedAcc);return s},getVelocity:function(e,t,n,r){const s=1/1024;for(let e of r)if(f.indexOf(e)>-1){return Math.min(Math.floor(1.2*n[0]),127)}for(let r of t.f)if(Math.abs(e-r)<s)return n[0];for(let r of t.m)if(Math.abs(e-r)<s)return n[1];return n[2]},getStressedBeats:function(e){let t={f:[],m:[]};for(let n=0;n<e.length;n++)"f"==e[n]?t.f.push(n):"m"==e[n]&&t.m.push(n);return t},parseLenMod:C,removeAnnotations:m,parseFraction:y,parseQ:g,removeTextFromQ:function(e){let t=e.lastIndexOf('"');return t<0?e:e.slice(t+1).trim()},extractTextFromQ:function(e){let t=e.lastIndexOf('"');return t<0?"":e.slice(0,t+1).trim()},parseM:A,parseL:_,parseK:v,getKeyName:function(e){let t;return t="m"==e.slice(-1)?e.slice(0,-1)+" minor":e+" major",t},parseMIDIbeat:b,parseMIDIbeatstring:x,parseMidiChannel:w,parseMidiProgram:E,parseI:k,parseVoice:j,getNoteLengthInQuarterNotes:N,getQuarterNotesPerBar:I,getQuarterNotesInBar:T,getFracCompleteBar:S,getFirstLastComplements:O,repeatNotes:function(e,t,n,r,o=1){s(t,"Missing parameter Q"),s(n,"Missing parameter M"),s(r,"Missing parameter L");let i=F(O(e,n,r),t,r),a=e;for(let t=0;t<o;t++)a+=i+e;return a},appendNotes:function(e,t,n,r,o){s(r,"Missing parameter M"),s(o,"Missing parameter L");let i=e+F(O(e,r,o),n,o)+t;return i},getRhythm:function(e){let t=j({raw:e},null),n="";for(let e of t)if(["NOTE","CHORD"].indexOf(e.type)>-1){let t=`.=C${e.postfix.lenMod.sLenMod}`;t=`${t}${e.postfix.tied?"-":""}`,t=`${t}${e.postfix.brokenRhythm||""}`,n+=t}else["TUPLET"].indexOf(e.type)>-1||["REST","Q","M","L"].indexOf(e.type)>-1?n+=e.raw:["BAR"].indexOf(e.type)>-1&&(n+=e.sBar);return n="!ff![I:MIDI program 0 115]"+n,n},getQuarterNotesBetween:function(e,t,n,r,s){let o=0;for(let i=r;i<s+1;i++){let r=n[i];l.NCR.indexOf(r.type)>-1&&(o+=N(r,e,t))}return o},getEndDynChangeTokenIdx:function(e,t){for(let n=t;n<e.length;n++){let t=e[n];if(l.END_CRESC_DECRESCS.indexOf(t.type)>-1)return n}return e.length-1},getCrescMIDIbeat:function(e,t){s.ok(Array.isArray(e.startMIDIbeat)),s.ok(Array.isArray(e.endMIDIbeat)),s.ok(!Boolean(e.startCumQN>t)),s.ok(!Boolean(t-1/1024>e.endCumQN));let n=[...e.startMIDIbeat],r=(t-e.startCumQN)/(e.endCumQN-e.startCumQN);for(let t=0;t<3;t++)n[t]=n[t]+Math.trunc((e.endMIDIbeat[t]-e.startMIDIbeat[t])*r);for(let e=0;e<3;e++)s.ok(!(n[e]>127||n[e]<0),`getCrescMIDIbeat value out of range (0-127) ${JSON.stringify(n)}`);return n},getEndMIDIbeat:function(e,t,n,r){s.ok(Array.isArray(n)),s.ok(n.length>=3);let o=null,i=!1;for(let s=t;s<e.length;s++){let t=e[s];if(l.END_CRESC_DECRESCS.indexOf(t.type)>-1)i=!0;else{if("MIDIBEAT"==t.type){o=[...t.obj.value];break}if(l.DYNAMIC_LEVELS.indexOf(t.type)>-1){o=[...d[t.type]];break}if(i&&l.NCR.indexOf(t.type)>-1){let e=[...n];for(let t=0;t<3;t++)e[t]=Math.max(Math.min(e[t]+r,127),0);throw"CRESC/DECRESC DOES NOT HAVE DYNAMIC MARKER IMMEDIATELY AFTER (OR DURING)"}}}if(!o)throw"Probably you did not end a cresc/decresc";return o},countBars:P,countNCR:function(e){return j({raw:e}).filter((e=>l.NCR.indexOf(e.type)>-1)).length},getFirstNote:function(e,t){s("string"==typeof e||e instanceof String,"notes parameter should be a string");let n=z(e);s(n,"No first note"),s(""==n.prefix.sAcc,`First note should not have an accidental ${n.raw}`);let r=Y(n.letter.toUpperCase(),t);s(r,`Could not look up note name for ${n.letter} for key ${t}`);let o=n.postfix.sOctMod;return rv=[r,n.letter+o],rv},getFirstNoteToken:z,getNoteName:Y,octaveDown:function(e){s("string"==typeof e||e instanceof String,"notes parameter should be a string");let t="";for(let n=0;n<e.length;n++){let r=e[n];"CDEFGAB".indexOf(r.toUpperCase())>-1?r==r.toUpperCase()?t+=r+",":t+=r.toUpperCase():t+=r}return t},getKeyChordNoteArray:q,getSkcNotes:function(e,t,n=""){let r=t[0];s.ok("ABCDEFG".indexOf(r)>-1,`Bad key ${r}`);let o=q(t,e,n);JSON.stringify(o);let i=o[0];return JSON.stringify(i),i},getBassNotes:function(e){s(e,"Must supply lowestSkcNote");let t=G[e];s(t,`Could not look up BASS_NOTES from "${e}"`);let n=[];for(let e=0;e<t.length;e++)n.push(t[e]);return n},getKeyChord:function(e,t,n,r=""){let o=e[0];s("ABCDEFG".indexOf(o)>-1,`Bad key ${e}`),s(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let i=q(e,t,r)[0],a="[";return n&&(a+=G[i[0]].join("")),a+=i.join(""),a+="]",a},getKeyNote:function(e,t,n=""){let r=e[0];s.ok("ABCDEFG".indexOf(r)>-1,`Bad key ${e}`),s(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let o,i=H[t][r];if(n){let r=V(n,e),a=i[0],c=a.substr(1),l=J.getMidiKey(a[0],c,"",e),u=i[i.length-1];c=u.substr(1);let f=J.getMidiKey(u[0],c,"",e);o=Math.pow(l-r,2)>Math.pow(f-r,2)?u:a,s(o,`Could not find keyNote. key:${e} clef:${t} notes:${n}`)}else o=i[0];return o},preProcess:function(e,t,n=-1){s("string"==typeof e||e instanceof String,"abc parameter should be a string."),s("S"==t||"P"==t,`Bad parameter target ${t}`),s(Number.isInteger(n),`Param abcEditMode ${n} not an integer.`);let o=e;return o="P"==t?function(e){s("string"==typeof e||e instanceof String,"Param abc should be a string.");let t=e,n=/\[I\:ss\].*?\[I\:se\]/g;t=t.replace(n,""),n=/\[I\:ps\]/g,t=t.replace(n,""),n=/\[I\:pe\]/g,t=t.replace(n,"");let r=[/\[I:n:.*?\]/,/\[I:pos.*?\]/,/\[I:clef.*?\]/,/\[I:staff.*?\]/,/\[I:shiftunison.*?\]/,/\[I:tuplets.*?\]/,/\[I:ottava.*?\]/,/\[I:graceslurs.*?\]/,/\[I:end\]/];for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),"");n=/"_ppp"|"_pp"|"_p"|"_mp"|"_mf"|"_f"|"_ff"|"_fff"/g,t=t.replace(n,""),r=['"_D0"','"_D1"','"_D2"','"_D3"','"_D4"','"_D5"','"_D6"','"_D7"'],dest=["[I:MIDI beat 30 20 10 1]","[I:MIDI beat 45 35 20 1]","[I:MIDI beat 60 50 35 1]","[I:MIDI beat 75 65 50 1]","[I:MIDI beat 90 80 65 1]","[I:MIDI beat 105 95 80 1]","[I:MIDI beat 120 110 95 1]","[I:MIDI beat 127 125 110 1]"],s(r.length==dest.length);for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),dest[e]);r=['"_cs"','"_ce"','"_ds"','"_de"'],dest=["!<(!","!<)!","!>(!","!>)!"],s(r.length==dest.length);for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),dest[e]);return n=/\[I\:Q\:.*?\]/g,t=t.replace(n,""),n=/^\s*$/gm,t=t.replace(n,""),t}(o):function(e,t){s("string"==typeof e||e instanceof String,"abc parameter should be a string."),s(Number.isInteger(t),`Param abcEditMode ${t} not an integer.`);let n=e;if(t>-1)if(s([0,1,2,3].indexOf(t)>-1,`Param abcEdtMode ${t} should be 0-2.`),0==t);else if(1==t){let e=/\[I\:ps\]/g;n=n.replace(e,'"^'),e=/\[I\:pe\]/g,n=n.replace(e,'"         ')}else if(2==t){let e=/(\[I:ps\])(.*?)(\[I:pe\])/g;n=n.replace(e,(function(e,t,n,r){return"[I:ps "+"=".repeat(n.length)+" I:pe]"}))}else if(3==t){let e=/(\[I:ss\])(.*?)(\[I:se\])/g;n=n.replace(e,(function(e,t,n,r){return"[I:ss "+"=".repeat(n.length)+" I:se]"}))}else r.error(`audiolib.abc-utils.processPreRender() Bad abcEdtMode ${t}. Should be 0,1,2.`);else{let e=/\[I\:ps\].*?\[I\:pe\]/g;n=n.replace(e,""),e=/\[I\:ss\]/g,n=n.replace(e,""),e=/\[I\:se\]/g,n=n.replace(e,"");let t=['"_ppp"','"_pp"','"_p"','"_mp"','"_mf"','"_f"','"_ff"','"_fff"'],r=["!ppp!","!pp!","!p!","!mp!","!mf!","!f!","!ff!","!fff!"];s(t.length==r.length);for(let e=0;e<t.length;e++)n=n.replace(new RegExp(t[e],"g"),r[e]);e=/"_D0"|"_D1"|"_D2"|"_D3"|"_D4"|"_D5"|"_D6"|"_D7"/g,n=n.replace(e,""),e=/"_cs"|"_ce"|"_ds"|"_de"/g,n=n.replace(e,""),e=/\[Q\:[^\]]*\]/g,n=n.replace(e,""),e=/I\:Q/g,n=n.replace(e,"Q"),e=/\[I:MIDI.*?\]/,n=n.replace(e,"")}return n}(o,n),o}};e.exports=J},696:(e,t,n)=>{const r=n(970).getLogger("audiolib"),s=n(688).assert,o=n(15),i=n(60),a=i.Symbols;let c={abc2AbcObj:function(e){let t={header:{},voices:[]},n={},s={id:"DFLT",raw:""};n.DFLT=s,t.voices.push(s);let i=n.DFLT,a=e.split("\n"),c=!0;for(let e=0;e<a.length;e++){let s=a[e].trim();if(!s)break;if(s.startsWith("%")&&!s.startsWith("%%MIDI"))continue;let l=s.indexOf("%",2);if(l>-1&&(s=s.slice(0,l)),c)if(s.startsWith("X:"))t.header.X=s.substr(2).trim();else if(s.startsWith("%%MIDI")){let e=s.split(" ")[1];"beat"==e?t.header.MIDIbeat=o.parseMIDIbeat(s):"beatstring"==e?t.header.MIDIbeatstring=o.parseMIDIbeatstring(s):"channel"==e||"program"==e||"control"==e?i.raw+="[I:"+s.slice(2)+"]":r.info(`Unhandled abc MIDI directive ${s}`)}else if(s.startsWith("T:"))t.header.T=s.substr(2).trim();else if(s.startsWith("Q:"))t.header.Q=o.parseQ(s.split(":")[1]);else if(s.startsWith("M:"))t.header.M=o.parseM(s);else if(s.startsWith("L:"))t.header.L=o.parseL(s);else if(s.startsWith("V:")){let e=s.split(":")[1],r=e.indexOf(" ");r>-1&&(e=e.slice(0,r));let o={id:e,raw:""};n[e]=o,t.voices.push(o),i=o}else s.startsWith("K:")?(t.header.K=o.parseK(s),c=!1,i=n.DFLT):r.warn(`Unhandled line in header: ${s}`);else if(s.startsWith("V:")){let e=s.split(":")[1].split(" ")[0];if(i=n[e],!i){let r={id:e,raw:""};n[e]=r,t.voices.push(r),i=r}}else if(s.startsWith("L:"))i.raw+="["+s+"]";else if(s.startsWith("Q:"))i.raw+="["+s+"]";else if(s.startsWith("K:"))i.raw+="["+s+"]";else if(s.startsWith("M:"))i.raw+="["+s+"]";else if(s.startsWith("I:"))i.raw+="["+s+"]";else if(s.startsWith("%%MIDI")){let e=s.split(" ")[1];["beat","beatstring","channel","program","control"].indexOf(e)>-1?i.raw+=`[I:${s.slice(2)}]`:r.warn(`Unhandled MIDI command: ${s}`)}else for(let e=0;e<s.length;e++)if(e<s.length-4&&"["==s[e]&&"V"==s[e+1]&&":"==s[e+2]){let r=s.slice(e+3,s.indexOf("]",e+3));if(i=n[r],!i){let e={id:r,raw:""};n[r]=e,t.voices.push(e),i=e}e=s.indexOf("]",e+3)}else i.raw+=s[e]}if(c&&r.error("No K:"),t.header.M=t.header.M||o.Defaults.M,t.header.Q=t.header.Q||o.Defaults.Q,!t.header.L)if("none"==t.header.M.value)t.header.L={numerator:1,denominator:8};else{let e=t.header.M.numerator/t.header.M.denominator;t.header.L=e<.75?{numerator:1,denominator:16}:{numerator:1,denominator:8}}t.header.MIDIbeat=t.header.MIDIbeat||o.MIDI_BEATS.MF,t.header.MIDIbeatstring=t.header.MIDIbeatstring||o.MIDI_BEATSTRING_DFLT[t.header.M.value];for(let e=0;e<t.voices.length;e++){let n=t.voices[e];n.tokens=o.parseVoice(n)}return t},abcObj2MidiObj:function(e){let t={},n=[],r=480;for(let t=0;t<e.voices.length;t++){let n=e.voices[t],i=null,a=null,c=e.header.M,l=e.header.L,u=e.header.K,f=[],d={accidentals:{},cumQuarterNotes:0};if("none"!=c.value){let e=o.getQuarterNotesPerBar(c);d.cumQuarterNotes=(e-o.getQuarterNotesInBar(n.tokens,0,l,c))%e}f.push(d);let p=d.cumQuarterNotes,h=e.header.MIDIbeat,m=e.header.MIDIbeatstring,y=o.getStressedBeats(m),g=null;for(let e=0;e<n.tokens.length;e++){let t=n.tokens[e];if("BAR"==t.type)d={accidentals:{},cumQuarterNotes:0},f.push(d);else if("Q"==t.type)t.durationInTicks=0;else if("M"==t.type)c=t.obj,t.durationInTicks=0;else if("L"==t.type)l=t.obj,t.durationInTicks=0;else if("K"==t.type)u=t.obj,t.durationInTicks=0;else if("MIDIBEAT"==t.type)h=t.obj.value,t.durationInTicks=0;else if("MIDIBEATSTRING"==t.type)m=t.obj.value,y=o.getStressedBeats(m),t.durationInTicks=0;else if(o.TokenTypeGroups.DYNAMIC_LEVELS.indexOf(t.type)>-1)h=o.MIDI_BEATS[t.type],t.durationInTicks=0;else if(o.TokenTypeGroups.START_CRESC_DECRESCS.indexOf(t.type)>-1)if(t.durationInTicks=0,g)s.ok(!1,"Already in a cresc/decresc");else{g={startCumQN:p};let r=o.getEndDynChangeTokenIdx(n.tokens,e+1);g.endCumQN=p+o.getQuarterNotesBetween(l,c,n.tokens,e,r),g.startMIDIbeat=[...h];let s=15;"START_DECRESC"==t.type&&(s=-s),g.endMIDIbeat=o.getEndMIDIbeat(n.tokens,e+1,h,s)}else if(o.TokenTypeGroups.END_CRESC_DECRESCS.indexOf(t.type)>-1)t.durationInTicks=0,h=o.getCrescMIDIbeat(g,p),g=null;else if("REST"==t.type){let e=o.getNoteLengthInQuarterNotes(t,l,c);t.durationInTicks=e*r,d.cumQuarterNotes+=e,p+=e,a=null,i=null}else if("NOTE"==t.type){let e=t;if(e.noteName=o.getAbsNote(e.letter,e.postfix.sOctMod,"","C").name,e.prefix.sAcc&&(d.accidentals[e.noteName]=e.prefix.sAcc),e.playedAcc=o.getPlayedAcc(e,d,i,a),e.midiKeyNum=o.getMidiKey(e.letter,e.postfix.sOctMod,e.playedAcc,u.value),i)e.noteName==i.noteName&&e.playedAcc==i.playedAcc&&i.postfix.tied&&(i.holdToNext=!0,e.heldFromPrev=!0);else if(a)for(let t of a.notes)t.noteName==e.noteName&&t.playedAcc==e.playedAcc&&(a.postfix.tied||t.postfix.tied)&&(t.holdToNext=!0,e.heldFromPrev=!0);let n=o.getNoteLengthInQuarterNotes(t,l);e.durationInTicks=n*r;let s=d.cumQuarterNotes*c.denominator/4;if(g&&(h=o.getCrescMIDIbeat(g,p)),e.velocity=o.getVelocity(s,y,h,e.prefix.decArray),e.velocity>127||e.velocity<0)throw`Velocity out of range 0-127 ${e.velocity}`;d.cumQuarterNotes+=n,p+=n,a=null,i=e}else if("CHORD"==t.type){let e=o.getNoteLengthInQuarterNotes(t,l);t.durationInTicks=e*r;let n=d.cumQuarterNotes*c.denominator/4;if(g&&(h=o.getCrescMIDIbeat(g,p)),t.velocity=o.getVelocity(n,y,h,t.prefix.decArray),t.velocity>127||t.velocity<0)throw`Velocity out of range 0-127 ${t.velocity}`;d.cumQuarterNotes+=e,p+=e;for(let e=0;e<t.notes.length;e++){let n=t.notes[e];if(n.noteName=o.getAbsNote(n.letter,n.postfix.sOctMod,"","C").name,n.prefix.sAcc&&(d.accidentals[n.noteName]=n.prefix.sAcc),n.playedAcc=o.getPlayedAcc(n,d,i,a),n.midiKeyNum=o.getMidiKey(n.letter,n.postfix.sOctMod,n.playedAcc,u.value),i)n.noteName==i.noteName&&n.playedAcc==i.playedAcc&&i.postfix.tied&&(i.holdToNext=!0,n.heldFromPrev=!0);else if(a)for(let e of a.notes)e.noteName==n.noteName&&e.playedAcc==n.playedAcc&&(a.postfix.tied||e.postfix.tied)&&(e.holdToNext=!0,n.heldFromPrev=!0);let s=o.getNoteLengthInQuarterNotes(t,l);n.durationInTicks=s*r}a=t,i=null}}}for(let t=0;t<e.voices.length;t++){let r=e.voices[t],s={type:"MTrk",events:[]};s.voice=r,s.events.push({deltaTime:0,type:a.EventTypes.META,subtype:a.MetaTypes.text,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.text],data:"note track"}),e.header.Q&&0==t&&s.events.push({deltaTime:0,type:a.EventTypes.META,subtype:a.MetaTypes.tempo,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.tempo],data:Math.floor(60*e.header.Q.denominator*1e6/(4*e.header.Q.numerator*e.header.Q.bpm))}),!e.header.T||0!=t&&1!=t||s.events.push({deltaTime:0,type:a.EventTypes.META,subtype:a.MetaTypes.text,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.text],data:e.header.T}),n.push(s)}function c(e,t,n){let r=0,s=0;for(let o=0;o<n.length;o++){if(s+=n[o].deltaTime,s>t){let s=t-r;e.deltaTime=s,n[o].deltaTime-=s,n.splice(o,0,e);break}if(o==n.length-1){let r=t-s;e.deltaTime=r,n.push(e);break}r=s}}for(let e=0;e<n.length;e++){let t=n[e],r=0,s=0,l=i.Defaults.CHANNEL-1;for(let e=0;e<t.voice.tokens.length;e++){let i=t.voice.tokens[e];if("Q"==i.type){let e=Math.floor(60*i.obj.denominator*1e6/(4*i.obj.numerator*i.obj.bpm));c({type:a.EventTypes.META,subtype:a.MetaTypes.tempo,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.tempo],data:e},s,n[0].events)}else if("MIDICHANNEL"==i.type)l=i.obj.value-1;else if("MIDIPROGRAM"==i.type){let e=l;i.obj.value[0]&&(e=i.obj.value[0]-1),t.events.push({deltaTime:r,type:a.MidiTypes.program,type_desc:a.MidiCodes[a.MidiTypes.program],data:[e,i.obj.value[1]]}),r=0}else if("MIDICONTROL"==i.type)t.events.push({deltaTime:r,type:a.MidiTypes.control,type_desc:a.MidiCodes[a.MidiTypes.control],data:[l,i.obj.value[0],i.obj.value[1]]}),r=0;else if(["PED","PED_UP"].indexOf(i.type)>-1){let e=o.TokenTypes[i.type].data;t.events.push({deltaTime:r,type:a.MidiTypes.control,type_desc:a.MidiCodes[a.MidiTypes.control],data:[l,e[0],e[1]]}),r=0}else if("REST"==i.type)r+=i.durationInTicks;else if("NOTE"==i.type){let e;e=i.holdToNext?0:i.heldFromPrev?r+o.getArticulatedDuration(i):o.getArticulatedDuration(i),i.heldFromPrev||(t.events.push({deltaTime:r,type:a.MidiTypes.noteOn,type_desc:a.MidiCodes[a.MidiTypes.noteOn],data:[l,i.midiKeyNum,i.velocity]}),r=0),i.holdToNext||t.events.push({deltaTime:e,type:a.MidiTypes.noteOff,type_desc:a.MidiCodes[a.MidiTypes.noteOff],data:[l,i.midiKeyNum,0]}),i.holdToNext?r+=i.durationInTicks:r=i.heldFromPrev?i.durationInTicks-(e-r):i.durationInTicks-e}else if("CHORD"==i.type){for(let e=0;e<i.notes.length;e++){let n=i.notes[e];n.heldFromPrev||(t.events.push({deltaTime:r,type:a.MidiTypes.noteOn,type_desc:a.MidiCodes[a.MidiTypes.noteOn],data:[l,n.midiKeyNum,i.velocity]}),r=0)}let e;e=r+o.getArticulatedDuration(i),r+=i.durationInTicks;for(let n=0;n<i.notes.length;n++){let s=i.notes[n];s.holdToNext||(t.events.push({deltaTime:e,type:a.MidiTypes.noteOff,type_desc:a.MidiCodes[a.MidiTypes.noteOff],data:[l,s.midiKeyNum,0]}),r-=e,e=0)}}i.hasOwnProperty("durationInTicks")&&(s+=i.durationInTicks)}e>0&&t.events.push({deltaTime:r,type:a.EventTypes.META,subtype:a.MetaTypes.endOfTrack,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.endOfTrack],data:""})}return n[0].events.push({deltaTime:0,type:a.EventTypes.META,subtype:a.MetaTypes.endOfTrack,type_desc:a.EventCodes[a.EventTypes.META],subtype_desc:a.MetaCodes[a.MetaTypes.endOfTrack],data:""}),t.tracks=n,t.header={type:"MThd",len:6,format:1,tracks:t.tracks.length,ticksPerQuarterNote:480},i.dumpMidiObj(t),t},__test__:{}};e.exports=c},344:(e,t,n)=>{const r=n(970).getLogger("audiolib");let s="WARN";try{s="WARN"}catch(e){}r.setLevel(s),r.info("audiolib index.js");const o=n(974),i=n(60),a=n(696),c=n(15),l=n(688),u=n(223);let f={__test__:{utils:l},log:r,PlayerContext:o.PlayerContext,Player:o.Player,abc:a,abcUtils:c,midiUtils:i,utils:l,instr:u};e.exports=f},60:(e,t,n)=>{const r=n(970).getLogger("audiolib"),s=n(688).assert;let o;o="undefined"!=typeof TARGET&&"web"==TARGET?window.atob:n(446);const i={META:255,F0SYSEX:240,F7SYSEX:247},a={};Object.keys(i).reduce(((e,t)=>(e[i[t]]=t,e)),a);const c={seqNum:0,text:1,copyright:2,trackName:3,instrumentName:4,lyric:5,mark:6,cue:7,chPrefix:32,endOfTrack:47,tempo:81,SMTPE:84,timeSig:88,keySig:89,sequencerSpecific:127},l={};Object.keys(c).reduce(((e,t)=>(e[c[t]]=t,e)),l);const u={noteOff:128,noteOn:144,keyAftertouch:160,control:176,program:192,chAftertouch:208,bend:224},f={};Object.keys(u).reduce(((e,t)=>(e[u[t]]=t,e)),f);const d={volume:7,pan:160,holdPedal:64,allSoundOff:120,resetControllers:121,localControl:122,allNotesOff:123,omniModeOff:124,omniModeOn:125,monoModeOn:126,polyModeOn:127},p={};Object.keys(d).reduce(((e,t)=>(e[d[t]]=t,e)),p);function h(e){return("0"+e.toString(16)).slice(-2)}function m(e,t,n){let r="";for(let s=t;s<=n;s++)r+=h(e[s]);return parseInt(r,16)}function y(e,t,n){let r="";for(let s=t;s<=n;s++)r+=String.fromCharCode(e[s]);return r}function g(e,t){let n=255&e,r=e>>8&255;t.push(r),t.push(n)}function A(e,t){let n=v(e);for(let e=0;e<n.length;e++)t.push(n[e])}function _(e,t){for(let n=0;n<e.length;n++)t.push(e[n].charCodeAt(0))}function v(e){return arr=new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]),arr}function b(e){s(e<268435455,"too big");let t=[];return t.push(127&e),e>>7>0&&(t.unshift(e>>7&127|128),e>>14>0&&(t.unshift(e>>14&127|128),e>>21>0&&t.unshift(e>>21&127|128))),t}function x(e,t){let n=0,r=1,s=e[t];for(;128&s;)n<<=7,n|=127&s,s=e[t+r],r++;return n<<=7,n|=s,{val:n,len:r}}function w(e,t){let n=[];if(n=n.concat(b(e.deltaTime)),"MIDI"==e.type)if(e.subtype==S.MidiTypes.control)n.push(e.subtype|t),n.push(e.data[0]),n.push(e.data[1]);else if(e.subtype==S.MidiTypes.program)n.push(e.subtype|t),n.push(e.data);else{if(e.subtype!=S.MidiTypes.noteOff&&e.subtype!=S.MidiTypes.noteOn)throw`Unknown MIDI event ${e.subtype}`;n.push(e.subtype|t),n.push(e.data[0]),n.push(e.data[1])}else if("META"==e.type)if(e.subtype==S.MetaTypes.timeSig)n.push(255),n.push(e.subtype),n.push(4),n=n.concat(e.data);else if(e.subtype==S.MetaTypes.keySig)n.push(255),n.push(e.subtype),n.push(2),n.push(e.data[0]),n.push(e.data[1]);else if(e.subtype==S.MetaTypes.tempo){n.push(255),n.push(e.subtype),n.push(3);let t=numToBytes(e.data,3);s(e.data<16777215,`Tempo ${e.data} too large`),n=n.concat(t)}else{if(e.subtype!=S.MetaTypes.text&&e.subtype!=S.MetaTypes.copyright&&e.subtype!=S.MetaTypes.trackName&&e.subtype!=S.MetaTypes.endOfTrack)throw r.error(`Unknown Meta Event subtype ${e.subtype}`),`Unknown Meta Event subtype ${e.subtype}`;n.push(255),n.push(e.subtype),n=n.concat(b(e.data.length));for(let t=0;t<e.data.length;t++)n.push(e.data[t].charCodeAt(0))}return n}function E(e){let t="",n=e.header;t+="HEADER\n",t+=" ",n.pos&&(t+=` pos: ${n.pos}`),t+=` len:${n.len} format:${n.format} tracks:${n.tracks}\n`,n.ticksPerQuarterNote?t+=`  ticksPerQuarterNote:${n.ticksPerQuarterNote}\n`:(t+=`  smtpeTicksPerFrame: ${n.smtpeTicksPerFrame}`,t+=` smtpeFramesPerSec: ${n.smtpeFramesPerSec}\n`),t+="TRACKS\n";let r=e.tracks;for(let e=0;e<r.length;e++){let n=r[e];t+=` Track ${e}`,n.pos&&(t+=` pos: ${n.pos}`),n.len&&(t+=` len: ${n.len}`),t+="\n";let s=n.events;for(let e=0;e<s.length;e++){let n=s[e];t+=` ${String(n.deltaTime).padStart(5," ")} ${n.type_desc}`,n.subtype_desc&&(t+=` ${n.subtype_desc}`),n.len&&(t+=` ${n.len}`),t+=` data:${JSON.stringify(n.data,0,0)}\n`}}return t}function k(e){let t="",n=Math.floor(e.length/16)+1;for(let r=0;r<n;r++){r>0&&(t+="\r\n");let n=16*r,s=Math.min(16*(1+r)-1,e.length-1),o="",i="";for(j=n;j<=s;j++)o+=h(e[j])+" ",e[j]>20&&e[j]<127?i+=String.fromCharCode(e[j]):i+="?";t+=o+" | "+i}return t}let C={__test__:{byteToHex:h},Symbols:{EventTypes:i,EventCodes:a,MetaTypes:c,MetaCodes:l,MidiTypes:u,MidiCodes:f,ControllerTypes:d,ControllerCodes:p,ControllerValues:{OFF:0,ON:127},Instruments:{ACOUSTIC_GRAND:0},NoteEventDataIdx:{CHANNEL:0,KEY:1,VELOCITY:2}},Defaults:{CHANNEL:1,PROGRAM:0},getMidiKey:function(e,t){let n=24+12*(Number(e[1])-1)+{C:0,D:2,E:4,F:5,G:7,A:9,B:11}[e[0]]+t;return s(n>=21&&n<=108,`Note ${e} shifted by ${t} is out of range 21-108.`),n},getNote:function(e){let t=Math.floor(e/12)-1;return["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][e%12]+t},writeArray2File:function(e,t){let n=new Uint8Array(t);fs.writeFileSync(e,n)},midi2MidiObj:function(e){let t=function(e){-1!=e.indexOf("base64,")&&(e=e.split(",")[1]);let t=o(e),n=t.length,r=[];for(let e=0;e<n;e++)r.push(t.charCodeAt(e));return r}(e);k(t);let n=0,d=[],h=[];for(;n<t.length-3;)if(77==t[n]&&84==t[n+1]&&104==t[n+2]&&100==t[n+3]){d.length>0&&r.error("More than one header chunk.");let e=m(t,n+4,n+7);6==e||r.error(`MThd length should always be 6. It is ${e}.`);let s=m(t,n+8,n+9);0!==s&&1!==s&&2!==s&&r.error(`MThd format should be 0, 1, or 2. It is ${s}.`);let o={pos:n,len:e,format:s,tracks:m(t,n+10,n+11)},i=256*(g=t)[A=n+12]+g[A+1];32768&i?(o.smtpeTicksPerFrame=255&i,o.smtpeFramesPerSec=32512&i):o.ticksPerQuarterNote=i,d.push(o),n+=8+e}else if(77==t[n]&&84==t[n+1]&&114==t[n+2]&&107==t[n+3]){let e=m(t,n+4,n+7),o=[],d=n+8,g=0;for(;g<e;){let e=x(t,d+g);g+=e.len;let n=t[d+g],h={deltaTime:e.val};if(n==i.META){g++,h.type=i.META,h.type_desc=a[h.type];let e=t[d+g];h.subtype=e,h.subtype_desc=l[h.subtype],g++;let n,r=x(t,d+g);if(h.len=r.val,g+=r.len,h.subtype==c.seqNum){s(2==h.len,`Sequence Number has wrong length ${h.len}.`);let e=d+g;n=m(t,e,e+h.len-1)}else if([c.text,c.copyright,c.trackName,c.instrumentName,c.lyric,c.mark,c.cue].indexOf(h.subtype)>-1)n=y(t,d+g,d+g+r.val-1);else if(e==c.chPrefix){s(1==h.len,`MIDI Channel Prefix has wrong length ${h.len}.`);let e=d+g;n=m(t,e,e+h.len-1)}else if(h.subtype==c.endOfTrack)s(0==h.len,`End of Track has wrong length ${h.len}.`),n=0;else if(h.subtype==c.tempo)n=m(t,d+g,d+g+h.len-1);else if(h.subtype==c.SMTPE){s(5==h.len,`SMTPE Offset has wrong length ${h.len}.`);let e=d+g;n=Array.from(t.slice(e,e+h.len))}else if(h.subtype==c.timeSig||h.subtype==c.keySig){let e=d+g;n=Array.from(t.slice(e,e+h.len))}else if(h.subtype==c.sequencerSpecific){let e=d+g;n=Array.from(t.slice(e,e+h.len))}else s(!1,`Unhandled META ${e.toString(16)}.`);h.data=n,g+=r.val}else if(n==i.F0SYSEX||n==i.F7SYSEX){h.desc=a[n],g++;let e=x(t,d+g);h.len=e.val;let r=y(t,d+g,d+g+e.len);h.data=r,g+=e.len}else if(f[240&n]){h.type=240&n;let e=15&n;if(h.type_desc=f[h.type],h.type==u.noteOff||h.type==u.noteOn)h.len=3,h.data=[e,t[d+g+1],t[d+g+2]],g+=h.len;else if(h.type==u.keyAftertouch)h.len=3,h.data=[e,t[d+g+1],t[d+g+2]],g+=h.len;else if(h.type==u.program)h.len=2,h.data=[e,t[d+g+1]],g+=h.len;else if(h.type==u.chAftertouch)h.len=2,h.data=[e,t[d+g+1]],g+=h.len;else if(h.type==u.bend)h.len=3,h.data=[e,t[d+g+1],t[d+g+2]],g+=h.len;else if(h.type==u.control){let n=t[d+g+1];h.subtype=n,h.subtype_desc=p[n],h.len=3,h.data=[e,t[d+g+1],t[d+g+2]],g+=h.len}}else r.warn(`UNKNOWN EVENT_TYPE ${n.toString(16)}.`);o.push(h)}let A={pos:n,len:e,events:o};h.push(A),n+=8+e}else n++;var g,A;s(1==d.length,`A MIDI file should have 1 header chunk. Have ${d.length}.`),s(d[0].tracks==h.length,`Header tracks (${d[0].tracks}) does not match number of track chunks (${h.length}).`),s(h.length>0,"No track chunks present!"),s(0!=d[0].format||1==h.length,`Format 0 files should have only one track. Have ${h.length}`);let _={header:d[0],tracks:h};return E(_),_},midiObj2MidiArray:function(e){let t=[];_(e.header.type,t),A(e.header.length,t),g(e.header.format,t),g(e.header.tracks,t),g(e.header.ticksPerQuarterNote,t);let n=0;for(let r of e.tracks){let e=[];for(let t=0;t<r.events.length;t++){let s=w(r.events[t],n);e=e.concat(s)}let s=[];_(r.type,s),A(e.length,s),t=t.concat(s),t=t.concat(e),n++}return k(t),t},dumpMidiObj:E,dumpHex:k};e.exports=C},974:(e,t,n)=>{const r=n(970).getLogger("audiolib"),s=n(688).assert,o=n(60),i=n(696),a=n(223),c=o.Symbols,l=c.NoteEventDataIdx.CHANNEL,u=c.NoteEventDataIdx.KEY,f=c.NoteEventDataIdx.VELOCITY;function d(e,t){let n;if(e.ticksPerQuarterNote){s(t,"Must supply microsecondsPerQuarterNote"),n=t/e.ticksPerQuarterNote/1e6}else s(e.smtpeTicksPerFrame&&e.smtpeFramesPerSec),n=1/(e.smtpeTicksPerFrame*e.smtpeFramesPerSec);return n}"undefined"==typeof window&&(n.g.window={});let p=null,h=null;class m{constructor(e){e?this.audioCtx=e:(this.audioCtx=function(){if(!p){let e=window.AudioContext||window.webkitAudioContext;if(!e)return r.error("audiolib.midi.getDefaultAudioContext. AudioContext not available."),null;p=new e}return p}(),this.audioCtx||r.error("audiolib.midi.PlayerContext. No default AudioContext available."),this.audioCtx=p),this.masterGainNode=this.audioCtx.createGain(),this.masterGainNode.gain.value=1,this.masterGainNode.connect(this.audioCtx.destination),this.instr={}}async loadInstrument(e,t,n){let r=new a.Instrument(this.audioCtx,e);this.instr[e]=r;let s="./sf";s=t?`${s}/${t}`:s,s=n?`${s}/${n}-mp3.json`:`${s}/${e}-mp3.json`,await r.load(s),await r.decode(this.masterGainNode)}setVolume(e){let t=e/100*2;this.masterGainNode.gain.setValueAtTime(t,this.audioCtx.currentTime)}}function y(e,t,n){let r=e.data[l],s=e.data[u],o=null;for(let e=0;e<n.trackedNodes.length;e++){let i=n.trackedNodes[e];if(null==i.untrackAt&&i.channel==r&&i.key==s){i.untrackAt=t,o=i.node;break}}o&&e.instr.stop(t,[o.id])}e.exports={PlayerContext:m,Player:class{constructor(e,t,n){e?this.context=e:(h=h||new m,this.context=h),this.audioCtx=this.context.audioCtx,this.animationCallback=t,this.onEndCallback=n,this.status="STOPPED",this.schedulerState={trackedNodes:[],channelInfo:{}}}setContext(e){this.context=e}setAnimationCallback(e){this.animationCallback=e}loadMidiObj(e,t=!1){this.soundEvents=function(e,t){r.info("audiolib.midi.replay()",e);const n={0:"acoustic_grand_piano",6:"harpsichord",73:"flute",115:"woodblock"};let i=[],a=e.header.tracks;for(let t=0;t<a;t++){let n=e.tracks[t].events,r=0;for(let e=0;e<n.length;e++){let s=n[e];s.midiIndex=e,r+=s.deltaTime,s.cumDeltaTime=r;let o={tick:r,track:t,midiIndex:e,type:s.type,data:s.data};s.subtype&&(o.subtype=s.subtype),i.push(o)}}i.sort((function(e,t){return e.tick<t.tick?-1:e.tick>t.tick?1:e.track<t.track?-1:e.track>t.track?1:e.midiIndex<t.midiIndex?-1:e.midiIndex>t.midiIndex?1:0}));let u=[];for(let e=0;e<16;e++)u.push({program:o.Defaults.PROGRAM});let p=0,h=null,m=d(e.header,5e5);for(;p<i.length;){let o=i[p];if(0==p?(h=o,h.time=0):h=i[p-1],o.time=h.time+(o.tick-h.tick)*m,o.type==c.EventTypes.META)if(o.subtype==c.MetaTypes.tempo){s(e.header.ticksPerQuarterNote,"Have a Set Tempo META event, but division is in SMPTE format??");let t=o.data;m=d(e.header,t)}else r.info(`Unhandled event ${c.EventCodes[o.type]} ${c.MetaCodes[o.subtype]}`,o.data);else if(o.type==c.EventTypes.F0SYSEX||o.type==c.EventTypes.F7SYSEX)r.info(`Unhandled event ${c.EventCodes[o.type]}`);else{let e=u[o.data[l]];o.type==c.MidiTypes.noteOn?(o.data[f]>127?r.warn(`noteOn velocity too high ${o.data[f]}`,o):0==o.data[f]&&r.warn("noteOn with velocity 0",o),o.instr=t[n[e.program]]):o.type==c.MidiTypes.noteOff?o.instr=t[n[e.program]]:o.type==c.MidiTypes.program?e.program=o.data[1]:o.type==c.MidiTypes.control&&o.data[1]==c.ControllerTypes.holdPedal||r.warn(`Unhandled event MIDI ${c.MidiCodes[o.type]}`,o)}p++}return i}(e,this.context.instr),this.duration=0;for(let e=this.soundEvents.length-1;e>-1;e--){let n=this.soundEvents[e];if(t&&0!=n.track&&n.subtype==c.MetaTypes.endOfTrack){this.duration=n.time;break}if(n.subtype==c.MetaTypes.endOfTrack){this.duration=n.time;break}this.duration=n.time;break}s(this.duration,"Duration is zero."),this.seek(0)}loadAbc(e){let t=i.abc2AbcObj(e),n=i.abcObj2MidiObj(t);this.loadMidiObj(n)}loadMidiB64(e){let t=o.midi2MidiObj(e);this.loadMidiObj(t,!0)}get progressPct(){return 100*(this.audioCtx.currentTime+this.timeProgressed-this.timeLastStarted)/this.duration}schedule2(e,t){let n=this.soundEvents;s(n);let i=Math.max(e.timeLastEvent,this.timeProgressed)+t;for(;e.nextEventIdx<n.length&&e.timeLastEvent<i;){let t=n[e.nextEventIdx];if(t.type==c.MidiTypes.noteOn){let n=t.data[l];0==t.data[f]&&r.warn("noteOn with velocity 0");let s=t.time,i=this.timeLastStarted+(s-this.timeProgressed),c=t.data[u],d=t.data[f],p=t.instr.start(o.getNote(c),i,{gain:(a=d,a/127)});e.trackedNodes.push({channel:n,key:c,node:p})}else if(t.type==c.MidiTypes.noteOff){let n=t.data[l];if(e.channelInfo[n]&&e.channelInfo[n].holdPedal){let r=e.channelInfo[n];r.delayedNoteOffEvents=r.delayedNoteOffEvents||[],r.delayedNoteOffEvents.push(t)}else{let n=t.time;y(t,this.timeLastStarted+(n-this.timeProgressed),e)}}else if(t.type==c.MidiTypes.control)if(t.data[1]==c.ControllerTypes.holdPedal){let n=t.data[l];e.channelInfo[n]=e.channelInfo[n]||{};let s=e.channelInfo[n];if(t.data[2]==c.ControllerValues.ON)s.holdPedal=!0;else if(s.holdPedal){let n=t.time;for(let t=0;t<s.delayedNoteOffEvents.length;t++){y(s.delayedNoteOffEvents[t],this.timeLastStarted+(n-this.timeProgressed),e)}s.holdPedal=!1,s.delayedNoteOffEvents=[]}else r.warn("Pedal OFF, but pedal not currently ON",t)}else{let e=t.data[1];r.info(`Unhandled ControllerType ${e} ${c.ControllerCodes[e]}`,t)}else t.type==c.EventTypes.META?r.info(`Unhandled event (type ${t.type.toString(16)}) ${c.EventCodes[t.type]} ${c.MetaCodes[t.subtype]}`,t):r.info(`Unhandled event (type ${t.type.toString(16)}) ${c.MidiCodes[t.type]}`,t);e.timeLastEvent=t.time,e.nextEventIdx++}var a;let d=[];for(let t=0;t<e.trackedNodes.length;t++){let n=this.audioCtx.currentTime,r=e.trackedNodes[t];null==r.untrackAt||r.untrackAt>n?d.push(r):(r.channel,r.key,r.node.id,r.untrackAt)}return e.trackedNodes=d,r.debug("DONE Player.schedule2()"),e.nextEventIdx<n.length}start(){if("STOPPED"!=this.status)return;this.seek(100*this.timeProgressed/this.duration),this.status="STARTED",this.timeLastStarted=this.audioCtx.currentTime;let e=this,t=this.schedulerState;!function n(r){e.schedule2(t,3)&&(t.timeoutID=setTimeout((function(){n(3)}),1e3*r))}(2.5),this.progressIntervalID=setInterval((function(){let t=100*(e.audioCtx.currentTime+e.timeProgressed-e.timeLastStarted)/e.duration;e.animationCallback&&e.animationCallback(t),t<100||(clearInterval(e.progressIntervalID),e.stop("END"))}),100)}stop(e){if("STARTED"!=this.status)return;this.status="STOPPED","END"==e&&this.onEndCallback&&this.onEndCallback(),clearTimeout(this.schedulerState.timeoutID),clearInterval(this.progressIntervalID),this.timeProgressed+=this.audioCtx.currentTime-this.timeLastStarted;let t=this.schedulerState;for(let e=0;e<t.trackedNodes.length;e++){t.trackedNodes[e].node.stop()}this.schedulerState.trackedNodes=[],this.schedulerState.channelInfo={}}seek(e,t=!1){"STARTED"==this.status&&this.stop(),this.timeProgressed=e/100*this.duration;for(let e=this.soundEvents.length-1;e>-1;e--){let t=this.soundEvents[e];if(e<1)this.schedulerState.nextEventIdx=0,this.schedulerState.timeLastEvent=0;else if(t.time<this.timeProgressed){let t=Math.min(e+1,this.soundEvents.length-1);this.schedulerState.nextEventIdx=t,this.schedulerState.timeLastEvent=this.soundEvents[t-1].time;break}}t&&this.start()}}}},688:e=>{function t(e,t){if(!e){throw new Error(t?"Assertion failure: "+t:"Assertion failure")}}function n(e){const t=new Array(e.length);for(let n=0;n<e.length;n++){let r,s=e.charCodeAt(n);r=s<32||s>127?s:(s+15)%94+32,t[n]=String.fromCharCode(r)}return t.join("")}t.ok=t;let r={assert:t,cloneRot:function e(t){let r;if("string"==typeof t||t instanceof String)r=n(t);else if("number"==typeof t||t instanceof Number)r=t;else if(Array.isArray(t)){r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=e(t[n])}else{r={};for(const[s,o]of Object.entries(t))r[n(s)]=e(o)}return r}};e.exports=r},767:(e,t,n)=>{"use strict";n.r(t),n.d(t,{decode:()=>a,encode:()=>i});for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="undefined"==typeof Uint8Array?[]:new Uint8Array(256),o=0;o<64;o++)s[r.charCodeAt(o)]=o;var i=function(e){var t,n=new Uint8Array(e),s=n.length,o="";for(t=0;t<s;t+=3)o+=r[n[t]>>2],o+=r[(3&n[t])<<4|n[t+1]>>4],o+=r[(15&n[t+1])<<2|n[t+2]>>6],o+=r[63&n[t+2]];return s%3==2?o=o.substring(0,o.length-1)+"=":s%3==1&&(o=o.substring(0,o.length-2)+"=="),o},a=function(e){var t,n,r,o,i,a=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),f=new Uint8Array(u);for(t=0;t<c;t+=4)n=s[e.charCodeAt(t)],r=s[e.charCodeAt(t+1)],o=s[e.charCodeAt(t+2)],i=s[e.charCodeAt(t+3)],f[l++]=n<<2|r>>4,f[l++]=(15&r)<<4|o>>2,f[l++]=(3&o)<<6|63&i;return u}},713:function(e,t,n){var r,s;!function(o,i){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function i(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?o:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}function a(t,n){for(var s=0;s<r.length;s++){var o=r[s];this[o]=s<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return i(e)||c.apply(this,arguments)}function u(e,n,s){var o,i=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=s||l,i.getLevel=function(){return o},i.setLevel=function(n,r){if("string"==typeof n&&void 0!==i.levels[n.toUpperCase()]&&(n=i.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(o=n,!1!==r&&u(n),a.call(i,n,e),typeof console===t&&n<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){n=e,f()||i.setLevel(e,!1)},i.resetLevel=function(){i.setLevel(n,!1),d()},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var p=f();null==p&&(p=n),i.setLevel(p,!1)}var f=new u,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()},562:e=>{e.exports=function(e){var s=e.createGain(),o=s._voltage=function(e){var t=e.createBufferSource(),r=e.createBuffer(1,2,e.sampleRate);return r.getChannelData(0).set(n),t.buffer=r,t.loop=!0,t}(e),i=r(o),a=r(o),c=r(o);return s._startAmount=r(a),s._endAmount=r(c),s._multiplier=r(i),s._multiplier.connect(s),s._startAmount.connect(s),s._endAmount.connect(s),s.value=i.gain,s.startValue=a.gain,s.endValue=c.gain,s.startValue.value=0,s.endValue.value=0,Object.defineProperties(s,t),s};var t={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var o=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(o,this._decayFrom,s(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,o=this._startAmount.gain,i=this._endAmount.gain;r.cancelScheduledValues(e),o.cancelScheduledValues(e),i.cancelScheduledValues(e);var a=s(this.release);if(this.attack&&e<this._decayFrom){var c=function(e,t,n,r,s){var o=s-n,i=e+o/(r-n)*(t-e);i<=e&&(i=e);i>=t&&(i=t);return i}(0,1,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(c,e),o.linearRampToValueAtTime(1-c,e),o.setTargetAtTime(0,e,a)}i.setTargetAtTime(1,e,a),r.setTargetAtTime(0,e,a)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},n=new Float32Array([1,1]);function r(e){var t=e.context.createGain();return e.connect(t),t}function s(e){return Math.log(e+1)/Math.log(100)}},223:(e,t,n)=>{const r=n(713).getLogger("instr");let s="WARN";try{s="WARN"}catch(e){}r.setLevel(s),r.info("instr index.js");const o=n(767),i=n(338).ZP,a=(n(179).SamplePlayer,n(179).SP);let c={};function l(e,t=!0){const n={A:"G",B:"A",C:"B",D:"C",E:"D",F:"E",G:"F"},r={A:"B",B:"C",C:"D",D:"E",E:"F",F:"G",G:"A"},s={A:!0,B:!0,C:!1,D:!0,E:!0,F:!1,G:!0};let o=t?1:-1,i=t?"B":"C",a=e[0];if("b"==e[1]){let r=parseInt(e[2]);return(t?a:n[a])+r}{let c=parseInt(e[1]);if(a==i&&(c+=o,8<c||c<1))return"";let l=t?r:n;if(t){let e=l[a];return s[e]?e+"b"+c:e+c}return s[a]?a+"b"+c:l[a]+c}}let u={Instrument:class{constructor(e,t){this.ac=e,this.audioBuffers={},this.name=t}async load(e){let t=await i.get(e);c[this.name]=t.data}async decode(e){this.name;let t=this,n=0,s=0;for(const[e,i]of Object.entries(c[this.name])){let a;try{a=i.indexOf(",")}catch(e){throw r.error(e),r.error(`${this.name} ${JSON.stringify(i)}`),e}let c,l=i.slice(a+1);l.length;try{c=o.decode(l),n+=c.byteLength}catch(e){throw r.error(`${this.name} ${JSON.stringify(i)}`,i),"Instrument decode"}await this.ac.decodeAudioData(c,(function(n){t.audioBuffers[e]=n,t.name,n.length,s+=n.length}))}let i={};for(const[e,t]of Object.entries(this.audioBuffers)){let n=e.split("v"),r=n[0];i[r]=i[r]||{};let s=i[r],o=n[1];o?s[o]=t:s[8]=t}this.audioBuffersLayers=i,this.audioBufferCache={},this.sp=new a(this.ac,{}),e?this.sp.connect(e):this.sp.connect(this.ac.destination),this.name}start(e,t,n){this.name,JSON.stringify(n);let s,o=0,i=(n=n||{}).gain||.5,a=`${Math.floor(16*i)+1}`,c=`${e}${a}`;if(this.audioBufferCache[c]){let e=this.audioBufferCache[c];s=e.buffer,o=e.cents}else{let t=null;if(this.audioBuffersLayers[e])t=e;else{let n=e,r=0,s=e,i=0;for(;s||n;){if(n&&(n=l(n,!1),r+=100,this.audioBuffersLayers[n])){t=n,o=r;break}if(s&&(s=l(s),i-=100,s&&this.audioBuffersLayers[s])){t=s,o=i;break}}}if(!t)return void r.error("Note "+e+" not found, and no lower/higher note found either.");let n=this.audioBuffersLayers[t];s=n[function(e,t){let n=parseInt(e),r=-1,s=100;for(let e of t){let t=parseInt(e),o=Math.abs(t-n);o<s&&(r=t,s=o)}return r}(a,Object.keys(n))],this.audioBufferCache[c]={buffer:s,cents:o}}return n.cents=o,this.sp.startBuffer(s,t,n)}stop(e,t){this.name,this.sp.stopNodes(e,t)}},log:r};e.exports=u},179:(e,t,n)=>{const r=n(713).getLogger("instr"),s=n(562);function o(e){return"number"==typeof e}var i=["attack","decay","sustain","release"];e.exports={SP:class{constructor(e,t){this.connected=!1,this.nextId=0,this.tracked={},this.opts=Object.assign({},{gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0},t),this.context=e,this.out=e.createGain(),this.out.gain.value=1}track(e){e.id=this.nextId++,this.tracked[e.id]=e;let t=this;return e.source.onended=function(){let n=t.context.currentTime;e.source.disconnect(),e.env.disconnect(),e.disconnect(),delete t.tracked[e.id],e.id,t.tracked,t.emit("ended",n,e.id,e)},e.id}createNode(e,t){let n=this.context.createGain();var r;n.gain.value=0,n.connect(this.out),n.env=function(e,t,n){let r=s(e),a=t.adsr||n.adsr;return i.forEach((function(e,s){r[e]=a?a[s]:t[e]||n[e]})),r.value.value=o(t.gain)?t.gain:o(n.gain)?n.gain:1,r}(this.context,t,this.opts),n.env.connect(n.gain),n.source=this.context.createBufferSource(),n.source.buffer=e,n.source.connect(n),n.source.loop=t.loop||this.opts.loop,n.source.playbackRate.value=(r=t.cents||this.opts.cents)?Math.pow(2,r/1200):1,n.source.loopStart=t.loopStart||this.opts.loopStart,n.source.loopEnd=t.loopEnd||this.opts.loopEnd;let a=this;return n.stop=function(e){let t=e||a.context.currentTime;a.emit("stop",t,n);let r=n.env.stop(t);n.source.stop(r)},n}startBuffer(e,t,n){if(!this.connected)return void r.error("SamplePlayer not connected to any node.");let s=n||{};this.emit("start",t,s);let o=this.createNode(e,s);return this.track(o),o.env.start(t),o.source.start(t),this.emit("started",t,o.id,o),s.duration&&o.stop(t+s.duration),o}stopNodes(e,t){let n,r=this;return t.map((function(t){return n=r.tracked[t],n?(n.stop(e),n.id):null}))}stopAllNodes(e){this.stopNodes(e,Object.keys(this.tracked))}connect(e){return this.connected=!0,this.out.connect(e),this}emit(e,t,n,r){this.onevent&&this.onevent(e,t,n,r);var s=this["on"+e];s&&s(t,n,r)}}}},338:(e,t,n)=>{"use strict";function r(e,t){return function(){return e.apply(t,arguments)}}n.d(t,{ZP:()=>je});const{toString:s}=Object.prototype,{getPrototypeOf:o}=Object,i=(a=Object.create(null),e=>{const t=s.call(e);return a[t]||(a[t]=t.slice(8,-1).toLowerCase())});var a;const c=e=>(e=e.toLowerCase(),t=>i(t)===e),l=e=>t=>typeof t===e,{isArray:u}=Array,f=l("undefined");const d=c("ArrayBuffer");const p=l("string"),h=l("function"),m=l("number"),y=e=>null!==e&&"object"==typeof e,g=e=>{if("object"!==i(e))return!1;const t=o(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},A=c("Date"),_=c("File"),v=c("Blob"),b=c("FileList"),x=c("URLSearchParams");function w(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,s;if("object"!=typeof e&&(e=[e]),u(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let i;for(r=0;r<o;r++)i=s[r],t.call(null,e[i],i,e)}}function E(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,s=n.length;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,C=e=>!f(e)&&e!==k;const $=(B="undefined"!=typeof Uint8Array&&o(Uint8Array),e=>B&&e instanceof B);var B;const M=c("HTMLFormElement"),N=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),I=c("RegExp"),T=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};w(n,((n,s)=>{let o;!1!==(o=t(n,s,e))&&(r[s]=o||n)})),Object.defineProperties(e,r)},S="abcdefghijklmnopqrstuvwxyz",O="0123456789",F={DIGIT:O,ALPHA:S,ALPHA_DIGIT:S+S.toUpperCase()+O};const R=c("AsyncFunction"),D={isArray:u,isArrayBuffer:d,isBuffer:function(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&h(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||h(e.append)&&("formdata"===(t=i(e))||"object"===t&&h(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&d(e.buffer),t},isString:p,isNumber:m,isBoolean:e=>!0===e||!1===e,isObject:y,isPlainObject:g,isUndefined:f,isDate:A,isFile:_,isBlob:v,isRegExp:I,isFunction:h,isStream:e=>y(e)&&h(e.pipe),isURLSearchParams:x,isTypedArray:$,isFileList:b,forEach:w,merge:function e(){const{caseless:t}=C(this)&&this||{},n={},r=(r,s)=>{const o=t&&E(n,s)||s;g(n[o])&&g(r)?n[o]=e(n[o],r):g(r)?n[o]=e({},r):u(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&w(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:s}={})=>(w(t,((t,s)=>{n&&h(t)?e[s]=r(t,n):e[s]=t}),{allOwnKeys:s}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let s,i,a;const c={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)a=s[i],r&&!r(a,e,t)||c[a]||(t[a]=e[a],c[a]=!0);e=!1!==n&&o(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:i,kindOfTest:c,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(u(e))return e;let t=e.length;if(!m(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:M,hasOwnProperty:N,hasOwnProp:N,reduceDescriptors:T,freezeMethods:e=>{T(e,((t,n)=>{if(h(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];h(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return u(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:E,global:k,isContextDefined:C,ALPHABET:F,generateString:(e=16,t=F.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&h(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(y(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const s=u(e)?[]:{};return w(e,((e,t)=>{const o=n(e,r+1);!f(o)&&(s[t]=o)})),t[r]=void 0,s}}return e};return n(e,0)},isAsyncFn:R,isThenable:e=>e&&(y(e)||h(e))&&h(e.then)&&h(e.catch)};function U(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}D.inherits(U,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const L=U.prototype,Q={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Q[e]={value:e}})),Object.defineProperties(U,Q),Object.defineProperty(L,"isAxiosError",{value:!0}),U.from=(e,t,n,r,s,o)=>{const i=Object.create(L);return D.toFlatObject(e,i,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),U.call(i,e.message,t,n,r,s),i.cause=e,i.name=e.name,o&&Object.assign(i,o),i};const j=U;function P(e){return D.isPlainObject(e)||D.isArray(e)}function Y(e){return D.endsWith(e,"[]")?e.slice(0,-2):e}function z(e,t,n){return e?e.concat(t).map((function(e,t){return e=Y(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const V=D.toFlatObject(D,{},null,(function(e){return/^is[A-Z]/.test(e)}));const H=function(e,t,n){if(!D.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=D.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!D.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,o=n.dots,i=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&D.isSpecCompliantForm(t);if(!D.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(D.isDate(e))return e.toISOString();if(!a&&D.isBlob(e))throw new j("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(e)||D.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(D.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(D.isArray(e)&&function(e){return D.isArray(e)&&!e.some(P)}(e)||(D.isFileList(e)||D.endsWith(n,"[]"))&&(a=D.toArray(e)))return n=Y(n),a.forEach((function(e,r){!D.isUndefined(e)&&null!==e&&t.append(!0===i?z([n],r,o):null===i?n:n+"[]",c(e))})),!1;return!!P(e)||(t.append(z(s,n,o),c(e)),!1)}const u=[],f=Object.assign(V,{defaultVisitor:l,convertValue:c,isVisitable:P});if(!D.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!D.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),D.forEach(n,(function(n,o){!0===(!(D.isUndefined(n)||null===n)&&s.call(t,n,D.isString(o)?o.trim():o,r,f))&&e(n,r?r.concat(o):[o])})),u.pop()}}(e),t};function G(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function q(e,t){this._pairs=[],e&&H(e,this,t)}const J=q.prototype;J.append=function(e,t){this._pairs.push([e,t])},J.toString=function(e){const t=e?function(t){return e.call(this,t,G)}:G;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const W=q;function K(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function X(e,t,n){if(!t)return e;const r=n&&n.encode||K,s=n&&n.serialize;let o;if(o=s?s(t,n):D.isURLSearchParams(t)?t.toString():new W(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const Z=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){D.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},ee={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},te={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:W,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const ne=function(e){function t(e,n,r,s){let o=e[s++];const i=Number.isFinite(+o),a=s>=e.length;if(o=!o&&D.isArray(r)?r.length:o,a)return D.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!i;r[o]&&D.isObject(r[o])||(r[o]=[]);return t(e,n,r[o],s)&&D.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const s=n.length;let o;for(r=0;r<s;r++)o=n[r],t[o]=e[o];return t}(r[o])),!i}if(D.isFormData(e)&&D.isFunction(e.entries)){const n={};return D.forEachEntry(e,((e,r)=>{t(function(e){return D.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const re={transitional:ee,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=D.isObject(e);s&&D.isHTMLForm(e)&&(e=new FormData(e));if(D.isFormData(e))return r&&r?JSON.stringify(ne(e)):e;if(D.isArrayBuffer(e)||D.isBuffer(e)||D.isStream(e)||D.isFile(e)||D.isBlob(e))return e;if(D.isArrayBufferView(e))return e.buffer;if(D.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return H(e,new te.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return te.isNode&&D.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=D.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return H(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),function(e,t,n){if(D.isString(e))try{return(t||JSON.parse)(e),D.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||re.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&D.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw j.from(e,j.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:te.classes.FormData,Blob:te.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],(e=>{re.headers[e]={}}));const se=re,oe=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ie=Symbol("internals");function ae(e){return e&&String(e).trim().toLowerCase()}function ce(e){return!1===e||null==e?e:D.isArray(e)?e.map(ce):String(e)}function le(e,t,n,r,s){return D.isFunction(r)?r.call(this,t,n):(s&&(t=n),D.isString(t)?D.isString(r)?-1!==t.indexOf(r):D.isRegExp(r)?r.test(t):void 0:void 0)}class ue{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function s(e,t,n){const s=ae(t);if(!s)throw new Error("header name must be a non-empty string");const o=D.findKey(r,s);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=ce(e))}const o=(e,t)=>D.forEach(e,((e,n)=>s(e,n,t)));return D.isPlainObject(e)||e instanceof this.constructor?o(e,t):D.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?o((e=>{const t={};let n,r,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!n||t[n]&&oe[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&s(t,e,n),this}get(e,t){if(e=ae(e)){const n=D.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(D.isFunction(t))return t.call(this,e,n);if(D.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ae(e)){const n=D.findKey(this,e);return!(!n||void 0===this[n]||t&&!le(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function s(e){if(e=ae(e)){const s=D.findKey(n,e);!s||t&&!le(0,n[s],s,t)||(delete n[s],r=!0)}}return D.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const s=t[n];e&&!le(0,this[s],s,e,!0)||(delete this[s],r=!0)}return r}normalize(e){const t=this,n={};return D.forEach(this,((r,s)=>{const o=D.findKey(n,s);if(o)return t[o]=ce(r),void delete t[s];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();i!==s&&delete t[s],t[i]=ce(r),n[i]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return D.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&D.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[ie]=this[ie]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=ae(e);t[r]||(!function(e,t){const n=D.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,s){return this[r].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[r]=!0)}return D.isArray(e)?e.forEach(r):r(e),this}}ue.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),D.reduceDescriptors(ue.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),D.freezeMethods(ue);const fe=ue;function de(e,t){const n=this||se,r=t||n,s=fe.from(r.headers);let o=r.data;return D.forEach(e,(function(e){o=e.call(n,o,s.normalize(),t?t.status:void 0)})),s.normalize(),o}function pe(e){return!(!e||!e.__CANCEL__)}function he(e,t,n){j.call(this,null==e?"canceled":e,j.ERR_CANCELED,t,n),this.name="CanceledError"}D.inherits(he,j,{__CANCEL__:!0});const me=he;const ye=te.isStandardBrowserEnv?{write:function(e,t,n,r,s,o){const i=[];i.push(e+"="+encodeURIComponent(t)),D.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),D.isString(r)&&i.push("path="+r),D.isString(s)&&i.push("domain="+s),!0===o&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function ge(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Ae=te.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=D.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};const _e=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,o=0,i=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=r[i];s||(s=c),n[o]=a,r[o]=c;let u=i,f=0;for(;u!==o;)f+=n[u++],u%=e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),c-s<t)return;const d=l&&c-l;return d?Math.round(1e3*f/d):void 0}};function ve(e,t){let n=0;const r=_e(50,250);return s=>{const o=s.loaded,i=s.lengthComputable?s.total:void 0,a=o-n,c=r(a);n=o;const l={loaded:o,total:i,progress:i?o/i:void 0,bytes:a,rate:c||void 0,estimated:c&&i&&o<=i?(i-o)/c:void 0,event:s};l[t?"download":"upload"]=!0,e(l)}}const be={http:null,xhr:"undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const s=fe.from(e.headers).normalize(),o=e.responseType;let i,a;function c(){e.cancelToken&&e.cancelToken.unsubscribe(i),e.signal&&e.signal.removeEventListener("abort",i)}D.isFormData(r)&&(te.isStandardBrowserEnv||te.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?D.isString(a=s.getContentType())&&s.setContentType(a.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let l=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(t+":"+n))}const u=ge(e.baseURL,e.url);function f(){if(!l)return;const r=fe.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new j("Request failed with status code "+n.status,[j.ERR_BAD_REQUEST,j.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),c()}),(function(e){n(e),c()}),{data:o&&"text"!==o&&"json"!==o?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:r,config:e,request:l}),l=null}if(l.open(e.method.toUpperCase(),X(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=f:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(f)},l.onabort=function(){l&&(n(new j("Request aborted",j.ECONNABORTED,e,l)),l=null)},l.onerror=function(){n(new j("Network Error",j.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||ee;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new j(t,r.clarifyTimeoutError?j.ETIMEDOUT:j.ECONNABORTED,e,l)),l=null},te.isStandardBrowserEnv){const t=(e.withCredentials||Ae(u))&&e.xsrfCookieName&&ye.read(e.xsrfCookieName);t&&s.set(e.xsrfHeaderName,t)}void 0===r&&s.setContentType(null),"setRequestHeader"in l&&D.forEach(s.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),D.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),o&&"json"!==o&&(l.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",ve(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",ve(e.onUploadProgress)),(e.cancelToken||e.signal)&&(i=t=>{l&&(n(!t||t.type?new me(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(i),e.signal&&(e.signal.aborted?i():e.signal.addEventListener("abort",i)));const d=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);d&&-1===te.protocols.indexOf(d)?n(new j("Unsupported protocol "+d+":",j.ERR_BAD_REQUEST,e)):l.send(r||null)}))}};D.forEach(be,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const xe=e=>`- ${e}`,we=e=>D.isFunction(e)||null===e||!1===e,Ee=e=>{e=D.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let o=0;o<t;o++){let t;if(n=e[o],r=n,!we(n)&&(r=be[(t=String(n)).toLowerCase()],void 0===r))throw new j(`Unknown adapter '${t}'`);if(r)break;s[t||"#"+o]=r}if(!r){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(xe).join("\n"):" "+xe(e[0]):"as no adapter specified";throw new j("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function ke(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new me(null,e)}function Ce(e){ke(e),e.headers=fe.from(e.headers),e.data=de.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ee(e.adapter||se.adapter)(e).then((function(t){return ke(e),t.data=de.call(e,e.transformResponse,t),t.headers=fe.from(t.headers),t}),(function(t){return pe(t)||(ke(e),t&&t.response&&(t.response.data=de.call(e,e.transformResponse,t.response),t.response.headers=fe.from(t.response.headers))),Promise.reject(t)}))}const $e=e=>e instanceof fe?e.toJSON():e;function Be(e,t){t=t||{};const n={};function r(e,t,n){return D.isPlainObject(e)&&D.isPlainObject(t)?D.merge.call({caseless:n},e,t):D.isPlainObject(t)?D.merge({},t):D.isArray(t)?t.slice():t}function s(e,t,n){return D.isUndefined(t)?D.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function o(e,t){if(!D.isUndefined(t))return r(void 0,t)}function i(e,t){return D.isUndefined(t)?D.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,s,o){return o in t?r(n,s):o in e?r(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(e,t)=>s($e(e),$e(t),!0)};return D.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=c[r]||s,i=o(e[r],t[r],r);D.isUndefined(i)&&o!==a||(n[r]=i)})),n}const Me="1.5.1",Ne={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Ne[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Ie={};Ne.transitional=function(e,t,n){return(r,s,o)=>{if(!1===e)throw new j(function(e,t){return"[Axios v1.5.1] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")),j.ERR_DEPRECATED);return t&&!Ie[s]&&(Ie[s]=!0),!e||e(r,s,o)}};const Te={assertOptions:function(e,t,n){if("object"!=typeof e)throw new j("options must be an object",j.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const o=r[s],i=t[o];if(i){const t=e[o],n=void 0===t||i(t,o,e);if(!0!==n)throw new j("option "+o+" must be "+n,j.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new j("Unknown option "+o,j.ERR_BAD_OPTION)}},validators:Ne},Se=Te.validators;class Oe{constructor(e){this.defaults=e,this.interceptors={request:new Z,response:new Z}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Be(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:s}=t;void 0!==n&&Te.assertOptions(n,{silentJSONParsing:Se.transitional(Se.boolean),forcedJSONParsing:Se.transitional(Se.boolean),clarifyTimeoutError:Se.transitional(Se.boolean)},!1),null!=r&&(D.isFunction(r)?t.paramsSerializer={serialize:r}:Te.assertOptions(r,{encode:Se.function,serialize:Se.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&D.merge(s.common,s[t.method]);s&&D.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=fe.concat(o,s);const i=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,f=0;if(!a){const e=[Ce.bind(this),void 0];for(e.unshift.apply(e,i),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);f<u;)l=l.then(e[f++],e[f++]);return l}u=i.length;let d=t;for(f=0;f<u;){const e=i[f++],t=i[f++];try{d=e(d)}catch(e){t.call(this,e);break}}try{l=Ce.call(this,d)}catch(e){return Promise.reject(e)}for(f=0,u=c.length;f<u;)l=l.then(c[f++],c[f++]);return l}getUri(e){return X(ge((e=Be(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}D.forEach(["delete","get","head","options"],(function(e){Oe.prototype[e]=function(t,n){return this.request(Be(n||{},{method:e,url:t,data:(n||{}).data}))}})),D.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,s){return this.request(Be(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Oe.prototype[e]=t(),Oe.prototype[e+"Form"]=t(!0)}));const Fe=Oe;class Re{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,s){n.reason||(n.reason=new me(e,r,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new Re((function(t){e=t})),cancel:e}}}const De=Re;const Ue={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ue).forEach((([e,t])=>{Ue[t]=e}));const Le=Ue;const Qe=function e(t){const n=new Fe(t),s=r(Fe.prototype.request,n);return D.extend(s,Fe.prototype,n,{allOwnKeys:!0}),D.extend(s,n,null,{allOwnKeys:!0}),s.create=function(n){return e(Be(t,n))},s}(se);Qe.Axios=Fe,Qe.CanceledError=me,Qe.CancelToken=De,Qe.isCancel=pe,Qe.VERSION=Me,Qe.toFormData=H,Qe.AxiosError=j,Qe.Cancel=Qe.CanceledError,Qe.all=function(e){return Promise.all(e)},Qe.spread=function(e){return function(t){return e.apply(null,t)}},Qe.isAxiosError=function(e){return D.isObject(e)&&!0===e.isAxiosError},Qe.mergeConfig=Be,Qe.AxiosHeaders=fe,Qe.formToJSON=e=>ne(D.isHTMLForm(e)?new FormData(e):e),Qe.getAdapter=Ee,Qe.HttpStatusCode=Le,Qe.default=Qe;const je=Qe,{Axios:Pe,AxiosError:Ye,CanceledError:ze,isCancel:Ve,CancelToken:He,VERSION:Ge,all:qe,Cancel:Je,isAxiosError:We,spread:Ke,toFormData:Xe,AxiosHeaders:Ze,HttpStatusCode:et,formToJSON:tt,getAdapter:nt,mergeConfig:rt}=je}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};(()=>{"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function s(){return Object.create(null)}function o(e){e.forEach(r)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e){return 0===Object.keys(e).length}function l(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(l(t,n))}function f(e,t,n,r){if(e){const s=d(e,t,n,r);return e[0](s)}}function d(e,t,r,s){return e[1]&&s?n(r.ctx.slice(),e[1](s(t))):r.ctx}function p(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|s[r];return e}return t.dirty|s}return t.dirty}function h(e,t,n,r,s,o){if(s){const i=d(t,n,r,o);e.p(i,s)}}function m(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function y(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function g(e,t){const n={};t=new Set(t);for(const r in e)t.has(r)||"$"===r[0]||(n[r]=e[r]);return n}function A(e){const t={};for(const n in e)t[n]=!0;return t}function _(e){return null==e?"":e}function v(e,t,n){return e.set(n),t}const b="undefined"!=typeof window;let x=b?()=>window.performance.now():()=>Date.now(),w=b?e=>requestAnimationFrame(e):e;const E=new Set;function k(e){E.forEach((t=>{t.c(e)||(E.delete(t),t.f())})),0!==E.size&&w(k)}function C(e){let t;return 0===E.size&&w(k),{promise:new Promise((n=>{E.add(t={c:e,f:n})})),abort(){E.delete(t)}}}const $="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class B{constructor(e){this.options=e,this._listeners="WeakMap"in $?new WeakMap:void 0}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return null!==(e=this._observer)&&void 0!==e?e:this._observer=new ResizeObserver((e=>{var t;for(const n of e)B.entries.set(n.target,n),null===(t=this._listeners.get(n.target))||void 0===t||t(n)}))}}B.entries="WeakMap"in $?new WeakMap:void 0;let M=!1;function N(e,t){e.appendChild(t)}function I(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function T(e){const t=D("style");return S(I(e),t),t.sheet}function S(e,t){return N(e.head||e,t),t.sheet}function O(e,t,n){e.insertBefore(t,n||null)}function F(e){e.parentNode&&e.parentNode.removeChild(e)}function R(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function D(e){return document.createElement(e)}function U(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function Q(){return L(" ")}function j(){return L("")}function P(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function Y(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}const z=["width","height"];function V(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const r in t)null==t[r]?e.removeAttribute(r):"style"===r?e.style.cssText=t[r]:"__value"===r?e.value=e[r]=t[r]:n[r]&&n[r].set&&-1===z.indexOf(r)?e[r]=t[r]:Y(e,r,t[r])}function H(e,t){for(const n in t)Y(e,n,t[n])}function G(e,t){t=""+t,e.data!==t&&(e.data=t)}function q(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function J(e,t,n){e.classList[n?"add":"remove"](t)}function W(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,r,t),s}class K{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.is_svg?this.e=U(t.nodeName):this.e=D(11===t.nodeType?"TEMPLATE":t.nodeName),this.t="TEMPLATE"!==t.tagName?t:t.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)O(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(F)}}function X(e,t){return new e(t)}const Z=new Map;let ee,te=0;function ne(e,t,n,r,s,o,i,a=0){const c=16.666/r;let l="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*o(e);l+=100*e+`%{${i(r,1-r)}}\n`}const u=l+`100% {${i(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=I(e),{stylesheet:p,rules:h}=Z.get(d)||function(e,t){const n={stylesheet:T(t),rules:{}};return Z.set(e,n),n}(d,e);h[f]||(h[f]=!0,p.insertRule(`@keyframes ${f} ${u}`,p.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${f} ${r}ms linear ${s}ms 1 both`,te+=1,f}function re(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),s=n.length-r.length;s&&(e.style.animation=r.join(", "),te-=s,te||w((()=>{te||(Z.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&F(t)})),Z.clear())})))}function se(e){ee=e}function oe(){if(!ee)throw new Error("Function called outside component initialization");return ee}function ie(e){oe().$$.before_update.push(e)}function ae(e){oe().$$.on_mount.push(e)}function ce(e){oe().$$.after_update.push(e)}function le(e){oe().$$.on_destroy.push(e)}function ue(){const e=oe();return(t,n,{cancelable:r=!1}={})=>{const s=e.$$.callbacks[t];if(s){const o=W(t,n,{cancelable:r});return s.slice().forEach((t=>{t.call(e,o)})),!o.defaultPrevented}return!0}}function fe(e){return oe().$$.context.get(e)}function de(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const pe=[],he=[];let me=[];const ye=[],ge=Promise.resolve();let Ae=!1;function _e(){Ae||(Ae=!0,ge.then(Ee))}function ve(e){me.push(e)}const be=new Set;let xe,we=0;function Ee(){if(0!==we)return;const e=ee;do{try{for(;we<pe.length;){const e=pe[we];we++,se(e),ke(e.$$)}}catch(e){throw pe.length=0,we=0,e}for(se(null),pe.length=0,we=0;he.length;)he.pop()();for(let e=0;e<me.length;e+=1){const t=me[e];be.has(t)||(be.add(t),t())}me.length=0}while(pe.length);for(;ye.length;)ye.pop()();Ae=!1,be.clear(),se(e)}function ke(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ve)}}function Ce(){return xe||(xe=Promise.resolve(),xe.then((()=>{xe=null}))),xe}function $e(e,t,n){e.dispatchEvent(W(`${t?"intro":"outro"}${n}`))}const Be=new Set;let Me;function Ne(){Me={r:0,c:[],p:Me}}function Ie(){Me.r||o(Me.c),Me=Me.p}function Te(e,t){e&&e.i&&(Be.delete(e),e.i(t))}function Se(e,t,n,r){if(e&&e.o){if(Be.has(e))return;Be.add(e),Me.c.push((()=>{Be.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const Oe={duration:0};function Fe(n,r,s){const o={direction:"in"};let a,c,l=r(n,s,o),u=!1,f=0;function d(){a&&re(n,a)}function p(){const{delay:r=0,duration:s=300,easing:o=t,tick:i=e,css:p}=l||Oe;p&&(a=ne(n,0,1,s,r,o,p,f++)),i(0,1);const h=x()+r,m=h+s;c&&c.abort(),u=!0,ve((()=>$e(n,!0,"start"))),c=C((e=>{if(u){if(e>=m)return i(1,0),$e(n,!0,"end"),d(),u=!1;if(e>=h){const t=o((e-h)/s);i(t,1-t)}}return u}))}let h=!1;return{start(){h||(h=!0,re(n),i(l)?(l=l(o),Ce().then(p)):p())},invalidate(){h=!1},end(){u&&(d(),u=!1)}}}function Re(n,r,s){const a={direction:"out"};let c,l=r(n,s,a),u=!0;const f=Me;function d(){const{delay:r=0,duration:s=300,easing:i=t,tick:a=e,css:d}=l||Oe;d&&(c=ne(n,1,0,s,r,i,d));const p=x()+r,h=p+s;ve((()=>$e(n,!1,"start"))),C((e=>{if(u){if(e>=h)return a(0,1),$e(n,!1,"end"),--f.r||o(f.c),!1;if(e>=p){const t=i((e-p)/s);a(1-t,t)}}return u}))}return f.r+=1,i(l)?Ce().then((()=>{l=l(a),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),u&&(c&&re(n,c),u=!1)}}}function De(n,r,s,a){const c={direction:"both"};let l=r(n,s,c),u=a?0:1,f=null,d=null,p=null;function h(){p&&re(n,p)}function m(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function y(r){const{delay:s=0,duration:i=300,easing:a=t,tick:c=e,css:y}=l||Oe,g={start:x()+s,b:r};r||(g.group=Me,Me.r+=1),f||d?d=g:(y&&(h(),p=ne(n,u,r,i,s,a,y)),r&&c(0,1),f=m(g,i),ve((()=>$e(n,r,"start"))),C((e=>{if(d&&e>d.start&&(f=m(d,i),d=null,$e(n,f.b,"start"),y&&(h(),p=ne(n,u,f.b,f.duration,0,a,l.css))),f)if(e>=f.end)c(u=f.b,1-u),$e(n,f.b,"end"),d||(f.b?h():--f.group.r||o(f.group.c)),f=null;else if(e>=f.start){const t=e-f.start;u=f.a+f.d*a(t/f.duration),c(u,1-u)}return!(!f&&!d)})))}return{run(e){i(l)?Ce().then((()=>{l=l(c),y(e)})):y(e)},end(){h(),f=d=null}}}function Ue(e,t){Se(e,1,1,(()=>{t.delete(e.key)}))}function Le(e,t){const n={},r={},s={$$scope:1};let o=e.length;for(;o--;){const i=e[o],a=t[o];if(a){for(const e in i)e in a||(r[e]=1);for(const e in a)s[e]||(n[e]=a[e],s[e]=1);e[o]=a}else for(const e in i)s[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function Qe(e){return"object"==typeof e&&null!==e?e:{}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let je;function Pe(e){e&&e.c()}function Ye(e,t,n,s){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,n),s||ve((()=>{const t=e.$$.on_mount.map(r).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...t):o(t),e.$$.on_mount=[]})),c.forEach(ve)}function ze(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];me.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),me=t}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ve(t,n,r,i,a,c,l,u=[-1]){const f=ee;se(t);const d=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:s(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};l&&l(d.root);let p=!1;if(d.ctx=r?r(t,n.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),p&&function(e,t){-1===e.$$.dirty[0]&&(pe.push(e),_e(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),n.target){if(n.hydrate){M=!0;const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(F)}else d.fragment&&d.fragment.c();n.intro&&Te(t.$$.fragment),Ye(t,n.target,n.anchor,n.customElement),M=!1,Ee()}se(f)}"function"==typeof HTMLElement&&(je=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(r).filter(i);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){ze(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){this.$$set&&!c(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class He{$destroy(){ze(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){this.$$set&&!c(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Ge=__webpack_require__(43),qe=__webpack_require__.n(Ge),Je=__webpack_require__(344),We=__webpack_require__.n(Je);const Ke=[];function Xe(t,n=e){let r;const s=new Set;function o(e){if(a(t,e)&&(t=e,r)){const e=!Ke.length;for(const e of s)e[1](),Ke.push(e,t);if(e){for(let e=0;e<Ke.length;e+=2)Ke[e][0](Ke[e+1]);Ke.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(i,a=e){const c=[i,a];return s.add(c),1===s.size&&(r=n(o)||e),i(t),()=>{s.delete(c),0===s.size&&r&&(r(),r=null)}}}}function Ze(e){document.body.style.paddingRight=e>0?`${e}px`:null}function et(){const e=function(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}(),t=document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top")[0],n=t?parseInt(t.style.paddingRight||0,10):0;window&&document.body.clientWidth<window.innerWidth&&Ze(n+e)}function tt(e,t,n){return!0===n||""===n?e?"col":`col-${t}`:"auto"===n?e?"col-auto":`col-${t}-auto`:e?`col-${n}`:`col-${t}-${n}`}function nt(e){let t="";if("string"==typeof e||"number"==typeof e)t+=e;else if("object"==typeof e)if(Array.isArray(e))t=e.map(nt).filter(Boolean).join(" ");else for(let n in e)e[n]&&(t&&(t+=" "),t+=n);return t}function rt(...e){return e.map(nt).filter(Boolean).join(" ")}function st(e){if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);const r=Number.parseFloat(t),s=Number.parseFloat(n);return r||s?(t=t.split(",")[0],n=n.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(n))):0}function ot(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function it(e){e.style.display="block";return{duration:st(e),tick:t=>{0===t&&e.classList.add("show")}}}function at(e){e.classList.remove("show");return{duration:st(e),tick:t=>{0===t&&(e.style.display="none")}}}function ct(e,t){const n=t.horizontal?"width":"height";e.style[n]=`${e.getBoundingClientRect()[n]}px`,e.classList.add("collapsing"),e.classList.remove("collapse","show");return{duration:st(e),tick:t=>{t>0?e.style[n]="":0===t&&(e.classList.remove("collapsing"),e.classList.add("collapse"))}}}function lt(e,t){const n=t.horizontal,r=n?"width":"height";e.classList.add("collapsing"),e.classList.remove("collapse","show"),e.style[r]=0;return{duration:st(e),tick:t=>{t<1?n?e.style.width=`${e.scrollWidth}px`:e.style.height=`${e.scrollHeight}px`:(e.classList.remove("collapsing"),e.classList.add("collapse","show"),e.style[r]="")}}}function ut(e){e.style.display="block";return{duration:st(e),tick:t=>{t>0&&e.classList.add("show")}}}function ft(e){e.classList.remove("show");return{duration:st(e),tick:t=>{1===t&&(e.style.display="none")}}}const dt=["touchstart","click"];function pt(e){let t,r,s,a,c,l,u;const d=e[16].default,y=f(d,e,e[15],null);let g=[{style:r=e[2]?void 0:"overflow: hidden;"},e[9],{class:e[8]}],A={};for(let e=0;e<g.length;e+=1)A=n(A,g[e]);return{c(){t=D("div"),y&&y.c(),V(t,A)},m(n,r){O(n,t,r),y&&y.m(t,null),c=!0,l||(u=[P(t,"introstart",e[17]),P(t,"introend",e[18]),P(t,"outrostart",e[19]),P(t,"outroend",e[20]),P(t,"introstart",(function(){i(e[3])&&e[3].apply(this,arguments)})),P(t,"introend",(function(){i(e[4])&&e[4].apply(this,arguments)})),P(t,"outrostart",(function(){i(e[5])&&e[5].apply(this,arguments)})),P(t,"outroend",(function(){i(e[6])&&e[6].apply(this,arguments)}))],l=!0)},p(n,s){e=n,y&&y.p&&(!c||32768&s)&&h(y,d,e,e[15],c?p(d,e[15],s,null):m(e[15]),null),V(t,A=Le(g,[(!c||4&s&&r!==(r=e[2]?void 0:"overflow: hidden;"))&&{style:r},512&s&&e[9],(!c||256&s)&&{class:e[8]}]))},i(n){c||(Te(y,n),ve((()=>{c&&(a&&a.end(1),s=Fe(t,lt,{horizontal:e[1]}),s.start())})),c=!0)},o(n){Se(y,n),s&&s.invalidate(),n&&(a=Re(t,ct,{horizontal:e[1]})),c=!1},d(e){e&&F(t),y&&y.d(e),e&&a&&a.end(),l=!1,o(u)}}}function ht(e){let t,n,r,s;ve(e[21]);let o=e[0]&&pt(e);return{c(){o&&o.c(),t=j()},m(i,a){o&&o.m(i,a),O(i,t,a),n=!0,r||(s=P(window,"resize",e[21]),r=!0)},p(e,[n]){e[0]?o?(o.p(e,n),1&n&&Te(o,1)):(o=pt(e),o.c(),Te(o,1),o.m(t.parentNode,t)):o&&(Ne(),Se(o,1,1,(()=>{o=null})),Ie())},i(e){n||(Te(o),n=!0)},o(e){Se(o),n=!1},d(e){o&&o.d(e),e&&F(t),r=!1,s()}}}function mt(e,t,r){let s;const o=["isOpen","class","horizontal","navbar","onEntering","onEntered","onExiting","onExited","expand","toggler"];let i=g(t,o),{$$slots:a={},$$scope:c}=t;const l=ue();let{isOpen:u=!1}=t,{class:f=""}=t,{horizontal:d=!1}=t,{navbar:p=!1}=t,{onEntering:h=(()=>l("opening"))}=t,{onEntered:m=(()=>l("open"))}=t,{onExiting:A=(()=>l("closing"))}=t,{onExited:_=(()=>l("close"))}=t,{expand:v=!1}=t,{toggler:b=null}=t;ae((()=>((e,t)=>{let n;if("string"==typeof e&&"undefined"!=typeof window&&document&&document.createElement){let r=document.querySelectorAll(e);if(r.length||(r=document.querySelectorAll(`#${e}`)),!r.length)throw new Error(`The target '${e}' could not be identified in the dom, tip: check spelling`);dt.forEach((e=>{r.forEach((n=>{n.addEventListener(e,t)}))})),n=()=>{dt.forEach((e=>{r.forEach((n=>{n.removeEventListener(e,t)}))}))}}return()=>{"function"==typeof n&&(n(),n=void 0)}})(b,(e=>{r(0,u=!u),e.preventDefault()}))));let x=0,w=!1;const E={};function k(){l("update",u)}return E.xs=0,E.sm=576,E.md=768,E.lg=992,E.xl=1200,e.$$set=e=>{t=n(n({},t),y(e)),r(9,i=g(t,o)),"isOpen"in e&&r(0,u=e.isOpen),"class"in e&&r(10,f=e.class),"horizontal"in e&&r(1,d=e.horizontal),"navbar"in e&&r(2,p=e.navbar),"onEntering"in e&&r(3,h=e.onEntering),"onEntered"in e&&r(4,m=e.onEntered),"onExiting"in e&&r(5,A=e.onExiting),"onExited"in e&&r(6,_=e.onExited),"expand"in e&&r(11,v=e.expand),"toggler"in e&&r(12,b=e.toggler),"$$scope"in e&&r(15,c=e.$$scope)},e.$$.update=()=>{1030&e.$$.dirty&&r(8,s=rt(f,{"collapse-horizontal":d,"navbar-collapse":p})),26757&e.$$.dirty&&p&&v&&(x>=E[v]&&!u?(r(0,u=!0),r(13,w=!0),k()):x<E[v]&&w&&(r(0,u=!1),r(13,w=!1),k()))},[u,d,p,h,m,A,_,x,s,i,f,v,b,w,E,c,a,function(t){de.call(this,e,t)},function(t){de.call(this,e,t)},function(t){de.call(this,e,t)},function(t){de.call(this,e,t)},function(){r(7,x=window.innerWidth)}]}const yt=class extends He{constructor(e){super(),Ve(this,e,mt,ht,a,{isOpen:0,class:10,horizontal:1,navbar:2,onEntering:3,onEntered:4,onExiting:5,onExited:6,expand:11,toggler:12})}};function gt(e,{delay:n=0,duration:r=400,easing:s=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:s,css:e=>"opacity: "+e*o}}const At=e=>({}),_t=e=>({});function vt(e){let t,r,s,o,i,a,c,l=(e[3]||e[10].heading)&&bt(e),u=e[5]&&xt(e);const f=[Et,wt],d=[];function p(e,t){return e[1]?0:1}o=p(e),i=d[o]=f[o](e);let h=[e[9],{class:e[7]},{role:"alert"}],m={};for(let e=0;e<h.length;e+=1)m=n(m,h[e]);return{c(){t=D("div"),l&&l.c(),r=Q(),u&&u.c(),s=Q(),i.c(),V(t,m)},m(e,n){O(e,t,n),l&&l.m(t,null),N(t,r),u&&u.m(t,null),N(t,s),d[o].m(t,null),c=!0},p(n,a){(e=n)[3]||e[10].heading?l?(l.p(e,a),1032&a&&Te(l,1)):(l=bt(e),l.c(),Te(l,1),l.m(t,r)):l&&(Ne(),Se(l,1,1,(()=>{l=null})),Ie()),e[5]?u?u.p(e,a):(u=xt(e),u.c(),u.m(t,s)):u&&(u.d(1),u=null);let y=o;o=p(e),o===y?d[o].p(e,a):(Ne(),Se(d[y],1,1,(()=>{d[y]=null})),Ie(),i=d[o],i?i.p(e,a):(i=d[o]=f[o](e),i.c()),Te(i,1),i.m(t,null)),V(t,m=Le(h,[512&a&&e[9],(!c||128&a)&&{class:e[7]},{role:"alert"}]))},i(n){c||(Te(l),Te(i),ve((()=>{c&&(a||(a=De(t,gt,e[4],!0)),a.run(1))})),c=!0)},o(n){Se(l),Se(i),a||(a=De(t,gt,e[4],!1)),a.run(0),c=!1},d(e){e&&F(t),l&&l.d(),u&&u.d(),d[o].d(),e&&a&&a.end()}}}function bt(e){let t,n,r;const s=e[18].heading,o=f(s,e,e[17],_t);return{c(){t=D("h4"),n=L(e[3]),o&&o.c(),Y(t,"class","alert-heading")},m(e,s){O(e,t,s),N(t,n),o&&o.m(t,null),r=!0},p(e,t){(!r||8&t)&&G(n,e[3]),o&&o.p&&(!r||131072&t)&&h(o,s,e,e[17],r?p(s,e[17],t,At):m(e[17]),_t)},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(e){e&&F(t),o&&o.d(e)}}}function xt(e){let t,n,r;return{c(){t=D("button"),Y(t,"type","button"),Y(t,"class",e[6]),Y(t,"aria-label",e[2])},m(s,o){O(s,t,o),n||(r=P(t,"click",(function(){i(e[8])&&e[8].apply(this,arguments)})),n=!0)},p(n,r){e=n,64&r&&Y(t,"class",e[6]),4&r&&Y(t,"aria-label",e[2])},d(e){e&&F(t),n=!1,r()}}}function wt(e){let t;const n=e[18].default,r=f(n,e,e[17],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||131072&s)&&h(r,n,e,e[17],t?p(n,e[17],s,null):m(e[17]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function Et(t){let n;return{c(){n=L(t[1])},m(e,t){O(e,n,t)},p(e,t){2&t&&G(n,e[1])},i:e,o:e,d(e){e&&F(n)}}}function kt(e){let t,n,r=e[0]&&vt(e);return{c(){r&&r.c(),t=j()},m(e,s){r&&r.m(e,s),O(e,t,s),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&Te(r,1)):(r=vt(e),r.c(),Te(r,1),r.m(t.parentNode,t)):r&&(Ne(),Se(r,1,1,(()=>{r=null})),Ie())},i(e){n||(Te(r),n=!0)},o(e){Se(r),n=!1},d(e){r&&r.d(e),e&&F(t)}}}function Ct(e,t,r){let s,o,i,a;const c=["class","children","color","closeClassName","closeAriaLabel","dismissible","heading","isOpen","toggle","fade","transition"];let l=g(t,c),{$$slots:u={},$$scope:f}=t;const d=A(u);let{class:p=""}=t,{children:h}=t,{color:m="success"}=t,{closeClassName:_=""}=t,{closeAriaLabel:v="Close"}=t,{dismissible:b=!1}=t,{heading:x}=t,{isOpen:w=!0}=t,{toggle:E}=t,{fade:k=!0}=t,{transition:C={duration:k?400:0}}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(9,l=g(t,c)),"class"in e&&r(11,p=e.class),"children"in e&&r(1,h=e.children),"color"in e&&r(12,m=e.color),"closeClassName"in e&&r(13,_=e.closeClassName),"closeAriaLabel"in e&&r(2,v=e.closeAriaLabel),"dismissible"in e&&r(14,b=e.dismissible),"heading"in e&&r(3,x=e.heading),"isOpen"in e&&r(0,w=e.isOpen),"toggle"in e&&r(15,E=e.toggle),"fade"in e&&r(16,k=e.fade),"transition"in e&&r(4,C=e.transition),"$$scope"in e&&r(17,f=e.$$scope)},e.$$.update=()=>{49152&e.$$.dirty&&r(5,s=b||E),32768&e.$$.dirty&&r(8,o=E||(()=>r(0,w=!1))),6176&e.$$.dirty&&r(7,i=rt(p,"alert",`alert-${m}`,{"alert-dismissible":s})),8192&e.$$.dirty&&r(6,a=rt("btn-close",_))},[w,h,v,x,C,s,a,i,o,l,d,p,m,_,b,E,k,f,u]}const $t=class extends He{constructor(e){super(),Ve(this,e,Ct,kt,a,{class:11,children:1,color:12,closeClassName:13,closeAriaLabel:2,dismissible:14,heading:3,isOpen:0,toggle:15,fade:16,transition:4})}};function Bt(e){let t,r,s,o,i;const a=e[17].default,c=f(a,e,e[16],null),l=c||function(e){let t,n,r,s;const o=[It,Nt],i=[];function a(e,t){return e[1]?0:1}return t=a(e,-1),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,s){let c=t;t=a(e,s),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}(e);let u=[e[8],{class:e[6]},{disabled:e[2]},{value:e[4]},{"aria-label":r=e[7]||e[5]}],d={};for(let e=0;e<u.length;e+=1)d=n(d,u[e]);return{c(){t=D("button"),l&&l.c(),V(t,d)},m(n,r){O(n,t,r),l&&l.m(t,null),t.autofocus&&t.focus(),e[21](t),s=!0,o||(i=P(t,"click",e[19]),o=!0)},p(e,n){c?c.p&&(!s||65536&n)&&h(c,a,e,e[16],s?p(a,e[16],n,null):m(e[16]),null):l&&l.p&&(!s||65538&n)&&l.p(e,s?n:-1),V(t,d=Le(u,[256&n&&e[8],(!s||64&n)&&{class:e[6]},(!s||4&n)&&{disabled:e[2]},(!s||16&n)&&{value:e[4]},(!s||160&n&&r!==(r=e[7]||e[5]))&&{"aria-label":r}]))},i(e){s||(Te(l,e),s=!0)},o(e){Se(l,e),s=!1},d(n){n&&F(t),l&&l.d(n),e[21](null),o=!1,i()}}}function Mt(e){let t,r,s,o,i,a,c;const l=[St,Tt],u=[];function f(e,t){return e[1]?0:1}r=f(e),s=u[r]=l[r](e);let d=[e[8],{class:e[6]},{disabled:e[2]},{href:e[3]},{"aria-label":o=e[7]||e[5]}],p={};for(let e=0;e<d.length;e+=1)p=n(p,d[e]);return{c(){t=D("a"),s.c(),V(t,p)},m(n,s){O(n,t,s),u[r].m(t,null),e[20](t),i=!0,a||(c=P(t,"click",e[18]),a=!0)},p(e,n){let a=r;r=f(e),r===a?u[r].p(e,n):(Ne(),Se(u[a],1,1,(()=>{u[a]=null})),Ie(),s=u[r],s?s.p(e,n):(s=u[r]=l[r](e),s.c()),Te(s,1),s.m(t,null)),V(t,p=Le(d,[256&n&&e[8],(!i||64&n)&&{class:e[6]},(!i||4&n)&&{disabled:e[2]},(!i||8&n)&&{href:e[3]},(!i||160&n&&o!==(o=e[7]||e[5]))&&{"aria-label":o}]))},i(e){i||(Te(s),i=!0)},o(e){Se(s),i=!1},d(n){n&&F(t),u[r].d(),e[20](null),a=!1,c()}}}function Nt(e){let t;const n=e[17].default,r=f(n,e,e[16],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||65536&s)&&h(r,n,e,e[16],t?p(n,e[16],s,null):m(e[16]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function It(t){let n;return{c(){n=L(t[1])},m(e,t){O(e,n,t)},p(e,t){2&t&&G(n,e[1])},i:e,o:e,d(e){e&&F(n)}}}function Tt(e){let t;const n=e[17].default,r=f(n,e,e[16],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||65536&s)&&h(r,n,e,e[16],t?p(n,e[16],s,null):m(e[16]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function St(t){let n;return{c(){n=L(t[1])},m(e,t){O(e,n,t)},p(e,t){2&t&&G(n,e[1])},i:e,o:e,d(e){e&&F(n)}}}function Ot(e){let t,n,r,s;const o=[Mt,Bt],i=[];function a(e,t){return e[3]?0:1}return t=a(e),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,[s]){let c=t;t=a(e),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function Ft(e,t,r){let s,o,i;const a=["class","active","block","children","close","color","disabled","href","inner","outline","size","value"];let c=g(t,a),{$$slots:l={},$$scope:u}=t,{class:f=""}=t,{active:d=!1}=t,{block:p=!1}=t,{children:h}=t,{close:m=!1}=t,{color:A="secondary"}=t,{disabled:_=!1}=t,{href:v=""}=t,{inner:b}=t,{outline:x=!1}=t,{size:w=null}=t,{value:E=""}=t;return e.$$set=e=>{r(22,t=n(n({},t),y(e))),r(8,c=g(t,a)),"class"in e&&r(9,f=e.class),"active"in e&&r(10,d=e.active),"block"in e&&r(11,p=e.block),"children"in e&&r(1,h=e.children),"close"in e&&r(12,m=e.close),"color"in e&&r(13,A=e.color),"disabled"in e&&r(2,_=e.disabled),"href"in e&&r(3,v=e.href),"inner"in e&&r(0,b=e.inner),"outline"in e&&r(14,x=e.outline),"size"in e&&r(15,w=e.size),"value"in e&&r(4,E=e.value),"$$scope"in e&&r(16,u=e.$$scope)},e.$$.update=()=>{r(7,s=t["aria-label"]),65024&e.$$.dirty&&r(6,o=rt(f,m?"btn-close":"btn",m||`btn${x?"-outline":""}-${A}`,!!w&&`btn-${w}`,!!p&&"d-block w-100",{active:d})),4096&e.$$.dirty&&r(5,i=m?"Close":null)},t=y(t),[b,h,_,v,E,i,o,s,c,f,d,p,m,A,x,w,u,l,function(t){de.call(this,e,t)},function(t){de.call(this,e,t)},function(e){he[e?"unshift":"push"]((()=>{b=e,r(0,b)}))},function(e){he[e?"unshift":"push"]((()=>{b=e,r(0,b)}))}]}const Rt=class extends He{constructor(e){super(),Ve(this,e,Ft,Ot,a,{class:9,active:10,block:11,children:1,close:12,color:13,disabled:2,href:3,inner:0,outline:14,size:15,value:4})}};function Dt(e){let t,r;const s=e[6].default,o=f(s,e,e[5],null);let i=[e[1],{class:e[0]}],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(e,n){O(e,t,n),o&&o.m(t,null),r=!0},p(e,[n]){o&&o.p&&(!r||32&n)&&h(o,s,e,e[5],r?p(s,e[5],n,null):m(e[5]),null),V(t,a=Le(i,[2&n&&e[1],(!r||1&n)&&{class:e[0]}]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(e){e&&F(t),o&&o.d(e)}}}function Ut(e,t,r){let s;const o=["class","size","vertical"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t,{size:u=""}=t,{vertical:f=!1}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(1,i=g(t,o)),"class"in e&&r(2,l=e.class),"size"in e&&r(3,u=e.size),"vertical"in e&&r(4,f=e.vertical),"$$scope"in e&&r(5,c=e.$$scope)},e.$$.update=()=>{28&e.$$.dirty&&r(0,s=rt(l,!!u&&`btn-group-${u}`,f?"btn-group-vertical":"btn-group"))},[s,i,l,u,f,c,a]}const Lt=class extends He{constructor(e){super(),Ve(this,e,Ut,Dt,a,{class:2,size:3,vertical:4})}};function Qt(e){let t,r,s,o;const i=e[8].default,a=f(i,e,e[7],null);let c=[e[1],{class:e[0]}],l={};for(let e=0;e<c.length;e+=1)l=n(l,c[e]);return{c(){t=D("div"),a&&a.c(),V(t,l)},m(n,i){O(n,t,i),a&&a.m(t,null),r=!0,s||(o=P(t,"click",e[9]),s=!0)},p(e,[n]){a&&a.p&&(!r||128&n)&&h(a,i,e,e[7],r?p(i,e[7],n,null):m(e[7]),null),V(t,l=Le(c,[2&n&&e[1],(!r||1&n)&&{class:e[0]}]))},i(e){r||(Te(a,e),r=!0)},o(e){Se(a,e),r=!1},d(e){e&&F(t),a&&a.d(e),s=!1,o()}}}function jt(e,t,r){let s;const o=["class","body","color","inverse","outline"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t,{body:u=!1}=t,{color:f=""}=t,{inverse:d=!1}=t,{outline:p=!1}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(1,i=g(t,o)),"class"in e&&r(2,l=e.class),"body"in e&&r(3,u=e.body),"color"in e&&r(4,f=e.color),"inverse"in e&&r(5,d=e.inverse),"outline"in e&&r(6,p=e.outline),"$$scope"in e&&r(7,c=e.$$scope)},e.$$.update=()=>{124&e.$$.dirty&&r(0,s=rt(l,"card",!!d&&"text-white",!!u&&"card-body",!!f&&`${p?"border":"bg"}-${f}`))},[s,i,l,u,f,d,p,c,a,function(t){de.call(this,e,t)}]}const Pt=class extends He{constructor(e){super(),Ve(this,e,jt,Qt,a,{class:2,body:3,color:4,inverse:5,outline:6})}};function Yt(e){let t,r,s;const o=e[10].default,i=f(o,e,e[9],null);let a=[e[1],{class:r=e[0].join(" ")}],c={};for(let e=0;e<a.length;e+=1)c=n(c,a[e]);return{c(){t=D("div"),i&&i.c(),V(t,c)},m(e,n){O(e,t,n),i&&i.m(t,null),s=!0},p(e,[n]){i&&i.p&&(!s||512&n)&&h(i,o,e,e[9],s?p(o,e[9],n,null):m(e[9]),null),V(t,c=Le(a,[2&n&&e[1],{class:r}]))},i(e){s||(Te(i,e),s=!0)},o(e){Se(i,e),s=!1},d(e){e&&F(t),i&&i.d(e)}}}function zt(e,t,r){const s=["class","xs","sm","md","lg","xl","xxl"];let o=g(t,s),{$$slots:i={},$$scope:a}=t,{class:c=""}=t,{xs:l}=t,{sm:u}=t,{md:f}=t,{lg:d}=t,{xl:p}=t,{xxl:h}=t;const m=[],A={xs:l,sm:u,md:f,lg:d,xl:p,xxl:h};return Object.keys(A).forEach((e=>{const t=A[e];if(!t&&""!==t)return;const n="xs"===e;if(function(e){const t=typeof e;return null!=e&&("object"==t||"function"==t)}(t)){const r=n?"-":`-${e}-`,s=tt(n,e,t.size);(t.size||""===t.size)&&m.push(s),t.push&&m.push(`push${r}${t.push}`),t.pull&&m.push(`pull${r}${t.pull}`),t.offset&&m.push(`offset${r}${t.offset}`),t.order&&m.push(`order${r}${t.order}`)}else m.push(tt(n,e,t))})),m.length||m.push("col"),c&&m.push(c),e.$$set=e=>{t=n(n({},t),y(e)),r(1,o=g(t,s)),"class"in e&&r(2,c=e.class),"xs"in e&&r(3,l=e.xs),"sm"in e&&r(4,u=e.sm),"md"in e&&r(5,f=e.md),"lg"in e&&r(6,d=e.lg),"xl"in e&&r(7,p=e.xl),"xxl"in e&&r(8,h=e.xxl),"$$scope"in e&&r(9,a=e.$$scope)},[m,o,c,l,u,f,d,p,h,a,i]}const Vt=class extends He{constructor(e){super(),Ve(this,e,zt,Yt,a,{class:2,xs:3,sm:4,md:5,lg:6,xl:7,xxl:8})}};function Ht(e){let t,r;const s=e[10].default,o=f(s,e,e[9],null);let i=[e[1],{class:e[0]}],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(e,n){O(e,t,n),o&&o.m(t,null),r=!0},p(e,[n]){o&&o.p&&(!r||512&n)&&h(o,s,e,e[9],r?p(s,e[9],n,null):m(e[9]),null),V(t,a=Le(i,[2&n&&e[1],(!r||1&n)&&{class:e[0]}]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(e){e&&F(t),o&&o.d(e)}}}function Gt(e,t,r){let s;const o=["class","sm","md","lg","xl","xxl","fluid"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t,{sm:u}=t,{md:f}=t,{lg:d}=t,{xl:p}=t,{xxl:h}=t,{fluid:m=!1}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(1,i=g(t,o)),"class"in e&&r(2,l=e.class),"sm"in e&&r(3,u=e.sm),"md"in e&&r(4,f=e.md),"lg"in e&&r(5,d=e.lg),"xl"in e&&r(6,p=e.xl),"xxl"in e&&r(7,h=e.xxl),"fluid"in e&&r(8,m=e.fluid),"$$scope"in e&&r(9,c=e.$$scope)},e.$$.update=()=>{508&e.$$.dirty&&r(0,s=rt(l,{"container-sm":u,"container-md":f,"container-lg":d,"container-xl":p,"container-xxl":h,"container-fluid":m,container:!(u||f||d||p||h||m)}))},[s,i,l,u,f,d,p,h,m,c,a]}const qt=class extends He{constructor(e){super(),Ve(this,e,Gt,Ht,a,{class:2,sm:3,md:4,lg:5,xl:6,xxl:7,fluid:8})}};function Jt(e){let t,n;const r=e[1].default,s=f(r,e,e[0],null);return{c(){t=D("div"),s&&s.c()},m(e,r){O(e,t,r),s&&s.m(t,null),n=!0},p(e,[t]){s&&s.p&&(!n||1&t)&&h(s,r,e,e[0],n?p(r,e[0],t,null):m(e[0]),null)},i(e){n||(Te(s,e),n=!0)},o(e){Se(s,e),n=!1},d(e){e&&F(t),s&&s.d(e)}}}function Wt(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r]}const Kt=class extends He{constructor(e){super(),Ve(this,e,Wt,Jt,a,{})}};function Xt(e){let t,r,s,o,i,a,c=[{role:"presentation"},e[4],{class:e[3]}],l={};for(let e=0;e<c.length;e+=1)l=n(l,c[e]);return{c(){t=D("div"),V(t,l),J(t,"fade",e[1])},m(n,r){O(n,t,r),o=!0,i||(a=P(t,"click",e[6]),i=!0)},p(e,n){V(t,l=Le(c,[{role:"presentation"},16&n&&e[4],(!o||8&n)&&{class:e[3]}])),J(t,"fade",e[1])},i(e){o||(ve((()=>{o&&(s&&s.end(1),r=Fe(t,it,{}),r.start())})),o=!0)},o(e){r&&r.invalidate(),s=Re(t,at,{}),o=!1},d(e){e&&F(t),e&&s&&s.end(),i=!1,a()}}}function Zt(e){let t,n,r=e[0]&&e[2]&&Xt(e);return{c(){r&&r.c(),t=j()},m(e,s){r&&r.m(e,s),O(e,t,s),n=!0},p(e,[n]){e[0]&&e[2]?r?(r.p(e,n),5&n&&Te(r,1)):(r=Xt(e),r.c(),Te(r,1),r.m(t.parentNode,t)):r&&(Ne(),Se(r,1,1,(()=>{r=null})),Ie())},i(e){n||(Te(r),n=!0)},o(e){Se(r),n=!1},d(e){r&&r.d(e),e&&F(t)}}}function en(e,t,r){let s;const o=["class","isOpen","fade"];let i=g(t,o),{class:a=""}=t,{isOpen:c=!1}=t,{fade:l=!0}=t,u=!1;return ae((()=>{r(2,u=!0)})),e.$$set=e=>{t=n(n({},t),y(e)),r(4,i=g(t,o)),"class"in e&&r(5,a=e.class),"isOpen"in e&&r(0,c=e.isOpen),"fade"in e&&r(1,l=e.fade)},e.$$.update=()=>{32&e.$$.dirty&&r(3,s=rt(a,"modal-backdrop"))},[c,l,u,s,i,a,function(t){de.call(this,e,t)}]}const tn=class extends He{constructor(e){super(),Ve(this,e,en,Zt,a,{class:5,isOpen:0,fade:1})}};function nn(e){let t,r;const s=e[4].default,o=f(s,e,e[3],null);let i=[e[1],{class:e[0]}],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(e,n){O(e,t,n),o&&o.m(t,null),r=!0},p(e,[n]){o&&o.p&&(!r||8&n)&&h(o,s,e,e[3],r?p(s,e[3],n,null):m(e[3]),null),V(t,a=Le(i,[2&n&&e[1],(!r||1&n)&&{class:e[0]}]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(e){e&&F(t),o&&o.d(e)}}}function rn(e,t,r){let s;const o=["class"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(1,i=g(t,o)),"class"in e&&r(2,l=e.class),"$$scope"in e&&r(3,c=e.$$scope)},e.$$.update=()=>{4&e.$$.dirty&&r(0,s=rt(l,"modal-body"))},[s,i,l,c,a]}const sn=class extends He{constructor(e){super(),Ve(this,e,rn,nn,a,{class:2})}},on=e=>({}),an=e=>({});function cn(e){let t;const n=e[8].default,r=f(n,e,e[7],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||128&s)&&h(r,n,e,e[7],t?p(n,e[7],s,null):m(e[7]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function ln(t){let n;return{c(){n=L(t[2])},m(e,t){O(e,n,t)},p(e,t){4&t&&G(n,e[2])},i:e,o:e,d(e){e&&F(n)}}}function un(e){let t,n,r;return{c(){t=D("button"),Y(t,"type","button"),Y(t,"class","btn-close"),Y(t,"aria-label",e[1])},m(s,o){O(s,t,o),n||(r=P(t,"click",(function(){i(e[0])&&e[0].apply(this,arguments)})),n=!0)},p(n,r){e=n,2&r&&Y(t,"aria-label",e[1])},d(e){e&&F(t),n=!1,r()}}}function fn(e){let t,r,s,o,i,a;const c=[ln,cn],l=[];function u(e,t){return e[2]?0:1}s=u(e),o=l[s]=c[s](e);const d=e[8].close,y=f(d,e,e[7],an),g=y||function(e){let t,n="function"==typeof e[0]&&un(e);return{c(){n&&n.c(),t=j()},m(e,r){n&&n.m(e,r),O(e,t,r)},p(e,r){"function"==typeof e[0]?n?n.p(e,r):(n=un(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&F(t)}}}(e);let A=[e[5],{class:e[4]}],_={};for(let e=0;e<A.length;e+=1)_=n(_,A[e]);return{c(){t=D("div"),r=D("h5"),o.c(),i=Q(),g&&g.c(),Y(r,"class","modal-title"),Y(r,"id",e[3]),V(t,_)},m(e,n){O(e,t,n),N(t,r),l[s].m(r,null),N(t,i),g&&g.m(t,null),a=!0},p(e,[n]){let i=s;s=u(e),s===i?l[s].p(e,n):(Ne(),Se(l[i],1,1,(()=>{l[i]=null})),Ie(),o=l[s],o?o.p(e,n):(o=l[s]=c[s](e),o.c()),Te(o,1),o.m(r,null)),(!a||8&n)&&Y(r,"id",e[3]),y?y.p&&(!a||128&n)&&h(y,d,e,e[7],a?p(d,e[7],n,on):m(e[7]),an):g&&g.p&&(!a||3&n)&&g.p(e,a?n:-1),V(t,_=Le(A,[32&n&&e[5],(!a||16&n)&&{class:e[4]}]))},i(e){a||(Te(o),Te(g,e),a=!0)},o(e){Se(o),Se(g,e),a=!1},d(e){e&&F(t),l[s].d(),g&&g.d(e)}}}function dn(e,t,r){let s;const o=["class","toggle","closeAriaLabel","children","id"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t,{toggle:u}=t,{closeAriaLabel:f="Close"}=t,{children:d}=t,{id:p}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(5,i=g(t,o)),"class"in e&&r(6,l=e.class),"toggle"in e&&r(0,u=e.toggle),"closeAriaLabel"in e&&r(1,f=e.closeAriaLabel),"children"in e&&r(2,d=e.children),"id"in e&&r(3,p=e.id),"$$scope"in e&&r(7,c=e.$$scope)},e.$$.update=()=>{64&e.$$.dirty&&r(4,s=rt(l,"modal-header"))},[u,f,d,p,s,i,l,c,a]}const pn=class extends He{constructor(e){super(),Ve(this,e,dn,fn,a,{class:6,toggle:0,closeAriaLabel:1,children:2,id:3})}};function hn(e){let t,r;const s=e[3].default,o=f(s,e,e[2],null);let i=[e[1]],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(n,s){O(n,t,s),o&&o.m(t,null),e[4](t),r=!0},p(e,[n]){o&&o.p&&(!r||4&n)&&h(o,s,e,e[2],r?p(s,e[2],n,null):m(e[2]),null),V(t,a=Le(i,[2&n&&e[1]]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(n){n&&F(t),o&&o.d(n),e[4](null)}}}function mn(e,t,r){const s=[];let o,i,a=g(t,s),{$$slots:c={},$$scope:l}=t;return ae((()=>{i=document.createElement("div"),document.body.appendChild(i),i.appendChild(o)})),le((()=>{"undefined"!=typeof document&&document.body.removeChild(i)})),e.$$set=e=>{t=n(n({},t),y(e)),r(1,a=g(t,s)),"$$scope"in e&&r(2,l=e.$$scope)},[o,a,l,c,function(e){he[e?"unshift":"push"]((()=>{o=e,r(0,o)}))}]}const yn=class extends He{constructor(e){super(),Ve(this,e,mn,hn,a,{})}},gn=e=>({}),An=e=>({});function _n(e){let t,n,r;var s=e[13];function o(e){return{props:{$$slots:{default:[Cn]},$$scope:{ctx:e}}}}return s&&(t=X(s,o(e))),{c(){t&&Pe(t.$$.fragment),n=j()},m(e,s){t&&Ye(t,e,s),O(e,n,s),r=!0},p(e,r){const i={};if(2119615&r[0]|8&r[1]&&(i.$$scope={dirty:r,ctx:e}),8192&r[0]&&s!==(s=e[13])){if(t){Ne();const e=t;Se(e.$$.fragment,1,0,(()=>{ze(e,1)})),Ie()}s?(t=X(s,o(e)),Pe(t.$$.fragment),Te(t.$$.fragment,1),Ye(t,n.parentNode,n)):t=null}else s&&t.$set(i)},i(e){r||(t&&Te(t.$$.fragment,e),r=!0)},o(e){t&&Se(t.$$.fragment,e),r=!1},d(e){e&&F(n),t&&ze(t,e)}}}function vn(e){let t,n,r,s,i,a,c,l,u,d,y,g,A,_;const v=e[31].external,b=f(v,e,e[34],An);let x=e[3]&&bn(e);const w=[En,wn],E=[];function k(e,t){return e[2]?0:1}return a=k(e),c=E[a]=w[a](e),{c(){t=D("div"),b&&b.c(),n=Q(),r=D("div"),s=D("div"),x&&x.c(),i=Q(),c.c(),Y(s,"class",l=rt("modal-content",e[9])),Y(r,"class",e[14]),Y(r,"role","document"),Y(t,"aria-labelledby",e[5]),Y(t,"class",u=rt("modal",e[8],{fade:e[10],"position-static":e[0]})),Y(t,"role","dialog")},m(o,c){O(o,t,c),b&&b.m(t,null),N(t,n),N(t,r),N(r,s),x&&x.m(s,null),N(s,i),E[a].m(s,null),e[32](r),g=!0,A||(_=[P(t,"introstart",e[33]),P(t,"introend",e[17]),P(t,"outrostart",e[18]),P(t,"outroend",e[19]),P(t,"click",e[16]),P(t,"mousedown",e[20])],A=!0)},p(e,n){b&&b.p&&(!g||8&n[1])&&h(b,v,e,e[34],g?p(v,e[34],n,gn):m(e[34]),An),e[3]?x?(x.p(e,n),8&n[0]&&Te(x,1)):(x=bn(e),x.c(),Te(x,1),x.m(s,i)):x&&(Ne(),Se(x,1,1,(()=>{x=null})),Ie());let o=a;a=k(e),a===o?E[a].p(e,n):(Ne(),Se(E[o],1,1,(()=>{E[o]=null})),Ie(),c=E[a],c?c.p(e,n):(c=E[a]=w[a](e),c.c()),Te(c,1),c.m(s,null)),(!g||512&n[0]&&l!==(l=rt("modal-content",e[9])))&&Y(s,"class",l),(!g||16384&n[0])&&Y(r,"class",e[14]),(!g||32&n[0])&&Y(t,"aria-labelledby",e[5]),(!g||1281&n[0]&&u!==(u=rt("modal",e[8],{fade:e[10],"position-static":e[0]})))&&Y(t,"class",u)},i(e){g||(Te(b,e),Te(x),Te(c),ve((()=>{g&&(y&&y.end(1),d=Fe(t,ut,{}),d.start())})),g=!0)},o(e){Se(b,e),Se(x),Se(c),d&&d.invalidate(),y=Re(t,ft,{}),g=!1},d(n){n&&F(t),b&&b.d(n),x&&x.d(),E[a].d(),e[32](null),n&&y&&y.end(),A=!1,o(_)}}}function bn(e){let t,n;return t=new pn({props:{toggle:e[4],id:e[5],$$slots:{default:[xn]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};16&n[0]&&(r.toggle=e[4]),32&n[0]&&(r.id=e[5]),8&n[0]|8&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function xn(e){let t;return{c(){t=L(e[3])},m(e,n){O(e,t,n)},p(e,n){8&n[0]&&G(t,e[3])},d(e){e&&F(t)}}}function wn(e){let t;const n=e[31].default,r=f(n,e,e[34],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8&s[1])&&h(r,n,e,e[34],t?p(n,e[34],s,null):m(e[34]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function En(e){let t,n;return t=new sn({props:{$$slots:{default:[kn]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function kn(e){let t;const n=e[31].default,r=f(n,e,e[34],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8&s[1])&&h(r,n,e,e[34],t?p(n,e[34],s,null):m(e[34]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function Cn(e){let t,r,s=e[1]&&vn(e),o=[{class:e[7]},{tabindex:"-1"},e[21]],i={};for(let e=0;e<o.length;e+=1)i=n(i,o[e]);return{c(){t=D("div"),s&&s.c(),V(t,i)},m(e,n){O(e,t,n),s&&s.m(t,null),r=!0},p(e,n){e[1]?s?(s.p(e,n),2&n[0]&&Te(s,1)):(s=vn(e),s.c(),Te(s,1),s.m(t,null)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie()),V(t,i=Le(o,[(!r||128&n[0])&&{class:e[7]},{tabindex:"-1"},2097152&n[0]&&e[21]]))},i(e){r||(Te(s),r=!0)},o(e){Se(s),r=!1},d(e){e&&F(t),s&&s.d()}}}function $n(e){let t,n,r;var s=e[13];function o(e){return{props:{$$slots:{default:[Bn]},$$scope:{ctx:e}}}}return s&&(t=X(s,o(e))),{c(){t&&Pe(t.$$.fragment),n=j()},m(e,s){t&&Ye(t,e,s),O(e,n,s),r=!0},p(e,r){const i={};if(1026&r[0]|8&r[1]&&(i.$$scope={dirty:r,ctx:e}),8192&r[0]&&s!==(s=e[13])){if(t){Ne();const e=t;Se(e.$$.fragment,1,0,(()=>{ze(e,1)})),Ie()}s?(t=X(s,o(e)),Pe(t.$$.fragment),Te(t.$$.fragment,1),Ye(t,n.parentNode,n)):t=null}else s&&t.$set(i)},i(e){r||(t&&Te(t.$$.fragment,e),r=!0)},o(e){t&&Se(t.$$.fragment,e),r=!1},d(e){e&&F(n),t&&ze(t,e)}}}function Bn(e){let t,n;return t=new tn({props:{fade:e[10],isOpen:e[1]}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1024&n[0]&&(r.fade=e[10]),2&n[0]&&(r.isOpen=e[1]),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Mn(e){let t,n,r,s=e[11]&&_n(e),o=e[6]&&!e[0]&&$n(e);return{c(){s&&s.c(),t=Q(),o&&o.c(),n=j()},m(e,i){s&&s.m(e,i),O(e,t,i),o&&o.m(e,i),O(e,n,i),r=!0},p(e,r){e[11]?s?(s.p(e,r),2048&r[0]&&Te(s,1)):(s=_n(e),s.c(),Te(s,1),s.m(t.parentNode,t)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie()),e[6]&&!e[0]?o?(o.p(e,r),65&r[0]&&Te(o,1)):(o=$n(e),o.c(),Te(o,1),o.m(n.parentNode,n)):o&&(Ne(),Se(o,1,1,(()=>{o=null})),Ie())},i(e){r||(Te(s),Te(o),r=!0)},o(e){Se(s),Se(o),r=!1},d(e){s&&s.d(e),e&&F(t),o&&o.d(e),e&&F(n)}}}let Nn=0;const In="modal-dialog";function Tn(e,t,r){let s,o;const i=["class","static","isOpen","autoFocus","body","centered","container","fullscreen","header","scrollable","size","toggle","labelledBy","backdrop","wrapClassName","modalClassName","contentClassName","fade","unmountOnClose","returnFocusAfterClose"];let a=g(t,i),{$$slots:c={},$$scope:l}=t;const u=ue();let f,d,p,h,m,{class:A=""}=t,{static:_=!1}=t,{isOpen:v=!1}=t,{autoFocus:b=!0}=t,{body:x=!1}=t,{centered:w=!1}=t,{container:E}=t,{fullscreen:k=!1}=t,{header:C}=t,{scrollable:$=!1}=t,{size:B=""}=t,{toggle:M}=t,{labelledBy:N=(C?`modal-${ot()}`:void 0)}=t,{backdrop:I=!0}=t,{wrapClassName:T=""}=t,{modalClassName:S=""}=t,{contentClassName:O=""}=t,{fade:F=!0}=t,{unmountOnClose:R=!0}=t,{returnFocusAfterClose:D=!0}=t,U=!1,L=!1,Q=v,j=U;function P(){p&&p.parentNode&&"function"==typeof p.parentNode.focus&&p.parentNode.focus()}function Y(){try{f=document.activeElement}catch(e){f=null}_||(d=function(){const e=window?window.getComputedStyle(document.body,null):{};return parseInt(e&&e.getPropertyValue("padding-right")||0,10)}(),et(),0===Nn&&(document.body.className=rt(document.body.className,"modal-open")),++Nn),r(11,L=!0)}function z(){f&&("function"==typeof f.focus&&D&&f.focus(),f=null)}function V(){z()}function H(){Nn<=1&&document.body.classList.remove("modal-open"),z(),Nn=Math.max(0,Nn-1),Ze(d)}ae((()=>{v&&(Y(),U=!0),U&&b&&P()})),le((()=>{V(),U&&H()})),ce((()=>{v&&!Q&&(Y(),U=!0),b&&U&&!j&&P(),Q=v,j=U}));return e.$$set=e=>{t=n(n({},t),y(e)),r(21,a=g(t,i)),"class"in e&&r(22,A=e.class),"static"in e&&r(0,_=e.static),"isOpen"in e&&r(1,v=e.isOpen),"autoFocus"in e&&r(23,b=e.autoFocus),"body"in e&&r(2,x=e.body),"centered"in e&&r(24,w=e.centered),"container"in e&&r(25,E=e.container),"fullscreen"in e&&r(26,k=e.fullscreen),"header"in e&&r(3,C=e.header),"scrollable"in e&&r(27,$=e.scrollable),"size"in e&&r(28,B=e.size),"toggle"in e&&r(4,M=e.toggle),"labelledBy"in e&&r(5,N=e.labelledBy),"backdrop"in e&&r(6,I=e.backdrop),"wrapClassName"in e&&r(7,T=e.wrapClassName),"modalClassName"in e&&r(8,S=e.modalClassName),"contentClassName"in e&&r(9,O=e.contentClassName),"fade"in e&&r(10,F=e.fade),"unmountOnClose"in e&&r(29,R=e.unmountOnClose),"returnFocusAfterClose"in e&&r(30,D=e.returnFocusAfterClose),"$$scope"in e&&r(34,l=e.$$scope)},e.$$.update=()=>{490733568&e.$$.dirty[0]&&r(14,s=rt(In,A,{[`modal-${B}`]:B,"modal-fullscreen":!0===k,[`modal-fullscreen-${k}-down`]:k&&"string"==typeof k,[`${In}-centered`]:w,[`${In}-scrollable`]:$})),33554433&e.$$.dirty[0]&&r(13,o="inline"===E||_?Kt:yn)},[_,v,x,C,M,N,I,T,S,O,F,L,p,o,s,u,function(e){if(e.target===h){if(!v||!I)return;const t=p?p.parentNode:null;!0===I&&t&&e.target===t&&M&&(e.stopPropagation(),M(e))}},function(){u("open"),m=function(e,...t){return e.addEventListener(...t),()=>e.removeEventListener(...t)}(document,"keydown",(e=>{e.key&&"Escape"===e.key&&M&&!0===I&&(m&&m(),M(e))}))},function(){u("closing"),m&&m()},function(){u("close"),R&&V(),H(),L&&(U=!1),r(11,L=!1)},function(e){h=e.target},a,A,b,w,E,k,$,B,R,D,c,function(e){he[e?"unshift":"push"]((()=>{p=e,r(12,p)}))},()=>u("opening"),l]}const Sn=class extends He{constructor(e){super(),Ve(this,e,Tn,Mn,a,{class:22,static:0,isOpen:1,autoFocus:23,body:2,centered:24,container:25,fullscreen:26,header:3,scrollable:27,size:28,toggle:4,labelledBy:5,backdrop:6,wrapClassName:7,modalClassName:8,contentClassName:9,fade:10,unmountOnClose:29,returnFocusAfterClose:30},null,[-1,-1])}};function On(e){let t,r;const s=e[4].default,o=f(s,e,e[3],null);let i=[e[1],{class:e[0]}],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(e,n){O(e,t,n),o&&o.m(t,null),r=!0},p(e,[n]){o&&o.p&&(!r||8&n)&&h(o,s,e,e[3],r?p(s,e[3],n,null):m(e[3]),null),V(t,a=Le(i,[2&n&&e[1],(!r||1&n)&&{class:e[0]}]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(e){e&&F(t),o&&o.d(e)}}}function Fn(e,t,r){let s;const o=["class"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(1,i=g(t,o)),"class"in e&&r(2,l=e.class),"$$scope"in e&&r(3,c=e.$$scope)},e.$$.update=()=>{4&e.$$.dirty&&r(0,s=rt(l,"modal-footer"))},[s,i,l,c,a]}const Rn=class extends He{constructor(e){super(),Ve(this,e,Fn,On,a,{class:2})}};const{document:Dn}=$;function Un(e){let t,r,s,o;const i=[jn,Qn],a=[];function c(e,t){return e[1]?0:1}r=c(e),s=a[r]=i[r](e);let l=[e[7],{class:e[6]}],u={};for(let e=0;e<l.length;e+=1)u=n(u,l[e]);return{c(){t=D("div"),s.c(),V(t,u)},m(e,n){O(e,t,n),a[r].m(t,null),o=!0},p(e,n){let f=r;r=c(e),r===f?a[r].p(e,n):(Ne(),Se(a[f],1,1,(()=>{a[f]=null})),Ie(),s=a[r],s?s.p(e,n):(s=a[r]=i[r](e),s.c()),Te(s,1),s.m(t,null)),V(t,u=Le(l,[128&n&&e[7],(!o||64&n)&&{class:e[6]}]))},i(e){o||(Te(s),o=!0)},o(e){Se(s),o=!1},d(e){e&&F(t),a[r].d()}}}function Ln(e){let t,n,r,s;const o=[Yn,Pn],i=[];function a(e,t){return e[1]?0:1}return t=a(e),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,s){let c=t;t=a(e),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function Qn(e){let t,n;const r=e[14].default,s=f(r,e,e[13],null);return{c(){t=D("div"),s&&s.c(),Y(t,"class",e[5]),q(t,"width",e[4]+"%"),Y(t,"role","progressbar"),Y(t,"aria-valuenow",e[2]),Y(t,"aria-valuemin","0"),Y(t,"aria-valuemax",e[3])},m(e,r){O(e,t,r),s&&s.m(t,null),n=!0},p(e,o){s&&s.p&&(!n||8192&o)&&h(s,r,e,e[13],n?p(r,e[13],o,null):m(e[13]),null),(!n||32&o)&&Y(t,"class",e[5]),(!n||16&o)&&q(t,"width",e[4]+"%"),(!n||4&o)&&Y(t,"aria-valuenow",e[2]),(!n||8&o)&&Y(t,"aria-valuemax",e[3])},i(e){n||(Te(s,e),n=!0)},o(e){Se(s,e),n=!1},d(e){e&&F(t),s&&s.d(e)}}}function jn(e){let t;const n=e[14].default,r=f(n,e,e[13],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8192&s)&&h(r,n,e,e[13],t?p(n,e[13],s,null):m(e[13]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function Pn(e){let t,r,s;const o=e[14].default,i=f(o,e,e[13],null);let a=[e[7],{class:e[5]},{style:r="width: "+e[4]+"%"},{role:"progressbar"},{"aria-valuenow":e[2]},{"aria-valuemin":"0"},{"aria-valuemax":e[3]}],c={};for(let e=0;e<a.length;e+=1)c=n(c,a[e]);return{c(){t=D("div"),i&&i.c(),V(t,c)},m(e,n){O(e,t,n),i&&i.m(t,null),s=!0},p(e,n){i&&i.p&&(!s||8192&n)&&h(i,o,e,e[13],s?p(o,e[13],n,null):m(e[13]),null),V(t,c=Le(a,[128&n&&e[7],(!s||32&n)&&{class:e[5]},(!s||16&n&&r!==(r="width: "+e[4]+"%"))&&{style:r},{role:"progressbar"},(!s||4&n)&&{"aria-valuenow":e[2]},{"aria-valuemin":"0"},(!s||8&n)&&{"aria-valuemax":e[3]}]))},i(e){s||(Te(i,e),s=!0)},o(e){Se(i,e),s=!1},d(e){e&&F(t),i&&i.d(e)}}}function Yn(e){let t;const n=e[14].default,r=f(n,e,e[13],null);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8192&s)&&h(r,n,e,e[13],t?p(n,e[13],s,null):m(e[13]),null)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function zn(e){let t,n,r,s;const o=[Ln,Un],i=[];function a(e,t){return e[0]?0:1}return t=a(e),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,[s]){let c=t;t=a(e),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function Vn(e,t,r){let s,o,i;const a=["class","bar","multi","value","max","animated","striped","color","barClassName"];let c=g(t,a),{$$slots:l={},$$scope:u}=t,{class:f=""}=t,{bar:d=!1}=t,{multi:p=!1}=t,{value:h=0}=t,{max:m=100}=t,{animated:A=!1}=t,{striped:_=!1}=t,{color:v=""}=t,{barClassName:b=""}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(7,c=g(t,a)),"class"in e&&r(8,f=e.class),"bar"in e&&r(0,d=e.bar),"multi"in e&&r(1,p=e.multi),"value"in e&&r(2,h=e.value),"max"in e&&r(3,m=e.max),"animated"in e&&r(9,A=e.animated),"striped"in e&&r(10,_=e.striped),"color"in e&&r(11,v=e.color),"barClassName"in e&&r(12,b=e.barClassName),"$$scope"in e&&r(13,u=e.$$scope)},e.$$.update=()=>{256&e.$$.dirty&&r(6,s=rt(f,"progress")),7937&e.$$.dirty&&r(5,o=rt("progress-bar",d&&f||b,A?"progress-bar-animated":null,v?`text-bg-${v}`:null,_||A?"progress-bar-striped":null)),12&e.$$.dirty&&r(4,i=parseInt(h,10)/parseInt(m,10)*100)},[d,p,h,m,i,o,s,c,f,A,_,v,b,u,l]}const Hn=class extends He{constructor(e){super(),Ve(this,e,Vn,zn,a,{class:8,bar:0,multi:1,value:2,max:3,animated:9,striped:10,color:11,barClassName:12})}};function Gn(e){let t,r;const s=e[8].default,o=f(s,e,e[7],null);let i=[e[2],{class:e[1]}],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("div"),o&&o.c(),V(t,a)},m(n,s){O(n,t,s),o&&o.m(t,null),e[9](t),r=!0},p(e,[n]){o&&o.p&&(!r||128&n)&&h(o,s,e,e[7],r?p(s,e[7],n,null):m(e[7]),null),V(t,a=Le(i,[4&n&&e[2],(!r||2&n)&&{class:e[1]}]))},i(e){r||(Te(o,e),r=!0)},o(e){Se(o,e),r=!1},d(n){n&&F(t),o&&o.d(n),e[9](null)}}}function qn(e,t,r){let s;const o=["class","noGutters","form","cols","inner"];let i=g(t,o),{$$slots:a={},$$scope:c}=t,{class:l=""}=t,{noGutters:u=!1}=t,{form:f=!1}=t,{cols:d=0}=t,{inner:p}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(2,i=g(t,o)),"class"in e&&r(3,l=e.class),"noGutters"in e&&r(4,u=e.noGutters),"form"in e&&r(5,f=e.form),"cols"in e&&r(6,d=e.cols),"inner"in e&&r(0,p=e.inner),"$$scope"in e&&r(7,c=e.$$scope)},e.$$.update=()=>{120&e.$$.dirty&&r(1,s=rt(l,u?"gx-0":null,f?"form-row":"row",...function(e){const t=parseInt(e);if(isNaN(t)){if("object"==typeof e)return["xs","sm","md","lg","xl"].map((t=>{const n="xs"===t?"-":`-${t}-`,r=e[t];return"number"==typeof r&&r>0?`row-cols${n}${r}`:null})).filter((e=>!!e))}else if(t>0)return[`row-cols-${t}`];return[]}(d)))},[p,s,i,l,u,f,d,c,a,function(e){he[e?"unshift":"push"]((()=>{p=e,r(0,p)}))}]}const Jn=class extends He{constructor(e){super(),Ve(this,e,qn,Gn,a,{class:3,noGutters:4,form:5,cols:6,inner:0})}};const{document:Wn}=$;function Kn(t){let n;return{c(){n=U("g")},m(e,r){O(e,n,r),n.innerHTML=t[0]},p(e,[t]){1&t&&(n.innerHTML=e[0])},i:e,o:e,d(e){e&&F(n)}}}function Xn(e,t,n){let r=870711;let s="",{data:o}=t;function i(e){if(!e||!e.raw)return"";let t=e.raw;const n={};return t=t.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,((e,t)=>{const s=(r+=1,`fa-${r.toString(16)}`);return n[t]=s,` id="${s}"`})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,((e,t,r,s)=>{const o=t||s;return o&&n[o]?`#${n[o]}`:e})),t}return e.$$set=e=>{"data"in e&&n(1,o=e.data)},e.$$.update=()=>{2&e.$$.dirty&&n(0,s=i(o))},[s,o]}const Zn=class extends He{constructor(e){super(),Ve(this,e,Xn,Kn,a,{data:1})}};function er(e){let t,r,s,o;const i=e[12].default,a=f(i,e,e[11],null);let c=[{version:"1.1"},{class:r="fa-icon "+e[0]},{width:e[1]},{height:e[2]},{"aria-label":e[9]},{role:s=e[9]?"img":"presentation"},{viewBox:e[3]},{style:e[8]},e[10]],l={};for(let e=0;e<c.length;e+=1)l=n(l,c[e]);return{c(){t=U("svg"),a&&a.c(),H(t,l),J(t,"fa-spin",e[4]),J(t,"fa-pulse",e[6]),J(t,"fa-inverse",e[5]),J(t,"fa-flip-horizontal","horizontal"===e[7]),J(t,"fa-flip-vertical","vertical"===e[7]),J(t,"svelte-1mc5hvj",!0)},m(e,n){O(e,t,n),a&&a.m(t,null),o=!0},p(e,[n]){a&&a.p&&(!o||2048&n)&&h(a,i,e,e[11],o?p(i,e[11],n,null):m(e[11]),null),H(t,l=Le(c,[{version:"1.1"},(!o||1&n&&r!==(r="fa-icon "+e[0]))&&{class:r},(!o||2&n)&&{width:e[1]},(!o||4&n)&&{height:e[2]},(!o||512&n)&&{"aria-label":e[9]},(!o||512&n&&s!==(s=e[9]?"img":"presentation"))&&{role:s},(!o||8&n)&&{viewBox:e[3]},(!o||256&n)&&{style:e[8]},1024&n&&e[10]])),J(t,"fa-spin",e[4]),J(t,"fa-pulse",e[6]),J(t,"fa-inverse",e[5]),J(t,"fa-flip-horizontal","horizontal"===e[7]),J(t,"fa-flip-vertical","vertical"===e[7]),J(t,"svelte-1mc5hvj",!0)},i(e){o||(Te(a,e),o=!0)},o(e){Se(a,e),o=!1},d(e){e&&F(t),a&&a.d(e)}}}function tr(e,t,r){const s=["class","width","height","box","spin","inverse","pulse","flip","style","label"];let o=g(t,s),{$$slots:i={},$$scope:a}=t,{class:c=""}=t,{width:l}=t,{height:u}=t,{box:f="0 0 0 0"}=t,{spin:d=!1}=t,{inverse:p=!1}=t,{pulse:h=!1}=t,{flip:m="none"}=t,{style:A=""}=t,{label:_=""}=t;return e.$$set=e=>{t=n(n({},t),y(e)),r(10,o=g(t,s)),"class"in e&&r(0,c=e.class),"width"in e&&r(1,l=e.width),"height"in e&&r(2,u=e.height),"box"in e&&r(3,f=e.box),"spin"in e&&r(4,d=e.spin),"inverse"in e&&r(5,p=e.inverse),"pulse"in e&&r(6,h=e.pulse),"flip"in e&&r(7,m=e.flip),"style"in e&&r(8,A=e.style),"label"in e&&r(9,_=e.label),"$$scope"in e&&r(11,a=e.$$scope)},[c,l,u,f,d,p,h,m,A,_,o,a,i]}const nr=class extends He{constructor(e){super(),Ve(this,e,tr,er,a,{class:0,width:1,height:2,box:3,spin:4,inverse:5,pulse:6,flip:7,style:8,label:9})}};function rr(e,t,n){const r=e.slice();return r[24]=t[n],r}function sr(e,t,n){const r=e.slice();return r[27]=t[n],r}function or(e){let t,n,r,s,o=e[6].paths&&ir(e),i=e[6].polygons&&cr(e),a=e[6].raw&&ur(e);return{c(){o&&o.c(),t=Q(),i&&i.c(),n=Q(),a&&a.c(),r=j()},m(e,c){o&&o.m(e,c),O(e,t,c),i&&i.m(e,c),O(e,n,c),a&&a.m(e,c),O(e,r,c),s=!0},p(e,s){e[6].paths?o?o.p(e,s):(o=ir(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),e[6].polygons?i?i.p(e,s):(i=cr(e),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null),e[6].raw?a?(a.p(e,s),64&s&&Te(a,1)):(a=ur(e),a.c(),Te(a,1),a.m(r.parentNode,r)):a&&(Ne(),Se(a,1,1,(()=>{a=null})),Ie())},i(e){s||(Te(a),s=!0)},o(e){Se(a),s=!1},d(e){o&&o.d(e),e&&F(t),i&&i.d(e),e&&F(n),a&&a.d(e),e&&F(r)}}}function ir(e){let t,n=e[6].paths,r=[];for(let t=0;t<n.length;t+=1)r[t]=ar(sr(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=j()},m(e,n){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,n);O(e,t,n)},p(e,s){if(64&s){let o;for(n=e[6].paths,o=0;o<n.length;o+=1){const i=sr(e,n,o);r[o]?r[o].p(i,s):(r[o]=ar(i),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){R(r,e),e&&F(t)}}}function ar(e){let t,r=[e[27]],s={};for(let e=0;e<r.length;e+=1)s=n(s,r[e]);return{c(){t=U("path"),H(t,s)},m(e,n){O(e,t,n)},p(e,n){H(t,s=Le(r,[64&n&&e[27]]))},d(e){e&&F(t)}}}function cr(e){let t,n=e[6].polygons,r=[];for(let t=0;t<n.length;t+=1)r[t]=lr(rr(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=j()},m(e,n){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,n);O(e,t,n)},p(e,s){if(64&s){let o;for(n=e[6].polygons,o=0;o<n.length;o+=1){const i=rr(e,n,o);r[o]?r[o].p(i,s):(r[o]=lr(i),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){R(r,e),e&&F(t)}}}function lr(e){let t,r=[e[24]],s={};for(let e=0;e<r.length;e+=1)s=n(s,r[e]);return{c(){t=U("polygon"),H(t,s)},m(e,n){O(e,t,n)},p(e,n){H(t,s=Le(r,[64&n&&e[24]]))},d(e){e&&F(t)}}}function ur(e){let t,n,r;function s(t){e[16](t)}let o={};return void 0!==e[6]&&(o.data=e[6]),t=new Zn({props:o}),he.push((()=>function(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}(t,"data",s))),{c(){Pe(t.$$.fragment)},m(e,n){Ye(t,e,n),r=!0},p(e,r){const s={};var o;!n&&64&r&&(n=!0,s.data=e[6],o=()=>n=!1,ye.push(o)),t.$set(s)},i(e){r||(Te(t.$$.fragment,e),r=!0)},o(e){Se(t.$$.fragment,e),r=!1},d(e){ze(t,e)}}}function fr(e){let t;const n=e[15].default,r=f(n,e,e[17],null),s=r||function(e){let t,n,r=e[6]&&or(e);return{c(){r&&r.c(),t=j()},m(e,s){r&&r.m(e,s),O(e,t,s),n=!0},p(e,n){e[6]?r?(r.p(e,n),64&n&&Te(r,1)):(r=or(e),r.c(),Te(r,1),r.m(t.parentNode,t)):r&&(Ne(),Se(r,1,1,(()=>{r=null})),Ie())},i(e){n||(Te(r),n=!0)},o(e){Se(r),n=!1},d(e){r&&r.d(e),e&&F(t)}}}(e);return{c(){s&&s.c()},m(e,n){s&&s.m(e,n),t=!0},p(e,o){r?r.p&&(!t||131072&o)&&h(r,n,e,e[17],t?p(n,e[17],o,null):m(e[17]),null):s&&s.p&&(!t||64&o)&&s.p(e,t?o:-1)},i(e){t||(Te(s,e),t=!0)},o(e){Se(s,e),t=!1},d(e){s&&s.d(e)}}}function dr(e){let t,r;const s=[{label:e[5]},{width:e[7]},{height:e[8]},{box:e[10]},{style:e[9]},{spin:e[1]},{flip:e[4]},{inverse:e[2]},{pulse:e[3]},{class:e[0]},e[11]];let o={$$slots:{default:[fr]},$$scope:{ctx:e}};for(let e=0;e<s.length;e+=1)o=n(o,s[e]);return t=new nr({props:o}),{c(){Pe(t.$$.fragment)},m(e,n){Ye(t,e,n),r=!0},p(e,[n]){const r=4031&n?Le(s,[32&n&&{label:e[5]},128&n&&{width:e[7]},256&n&&{height:e[8]},1024&n&&{box:e[10]},512&n&&{style:e[9]},2&n&&{spin:e[1]},16&n&&{flip:e[4]},4&n&&{inverse:e[2]},8&n&&{pulse:e[3]},1&n&&{class:e[0]},2048&n&&Qe(e[11])]):{};131136&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(Te(t.$$.fragment,e),r=!0)},o(e){Se(t.$$.fragment,e),r=!1},d(e){ze(t,e)}}}function pr(e,t,r){const s=["class","data","scale","spin","inverse","pulse","flip","label","style"];let o,i,a,c=g(t,s),{$$slots:l={},$$scope:u}=t,{class:f=""}=t,{data:d}=t,{scale:p=1}=t,{spin:h=!1}=t,{inverse:m=!1}=t,{pulse:A=!1}=t,{flip:_}=t,{label:v=""}=t,{style:b=""}=t,x=10,w=10;function E(){let e=1;return void 0!==p&&(e=Number(p)),isNaN(e)||e<=0?1:1*e}function k(){return o?Math.max(o.width,o.height)/16:1}return e.$$set=e=>{t=n(n({},t),y(e)),r(11,c=g(t,s)),"class"in e&&r(0,f=e.class),"data"in e&&r(12,d=e.data),"scale"in e&&r(13,p=e.scale),"spin"in e&&r(1,h=e.spin),"inverse"in e&&r(2,m=e.inverse),"pulse"in e&&r(3,A=e.pulse),"flip"in e&&r(4,_=e.flip),"label"in e&&r(5,v=e.label),"style"in e&&r(14,b=e.style),"$$scope"in e&&r(17,u=e.$$scope)},e.$$.update=()=>{28672&e.$$.dirty&&(r(6,o=function(e){let t,n;if(e&&!("definition"in e)){if("iconName"in e&&"icon"in e){t=e.iconName;let r=[];const[s,o,,,i]=e.icon;r=Array.isArray(i)?i:[i],n={width:s,height:o,paths:r.map((e=>({d:e})))}}else t=Object.keys(e)[0],n=e[t];return n}}(d)),r(7,x=o?o.width/k()*E():0),r(8,w=o?o.height/k()*E():0),r(9,i=function(){let e="";null!==b&&(e+=b);let t=E();return 1===t?0===e.length?"":e:(""===e||e.endsWith(";")||(e+="; "),`${e}font-size: ${t}em`)}()),r(10,a=o?`0 0 ${o.width} ${o.height}`:`0 0 ${x} ${w}`))},[f,h,m,A,_,v,o,x,w,i,a,c,d,p,b,l,function(e){o=e,r(6,o),r(12,d),r(14,b),r(13,p)},u]}const hr=class extends He{constructor(e){super(),Ve(this,e,pr,dr,a,{class:0,data:12,scale:13,spin:1,inverse:2,pulse:3,flip:4,label:5,style:14})}},mr={spinner:{width:1792,height:1792,paths:[{d:"M526 1394q0 53-37.5 90.5t-90.5 37.5q-52 0-90-38t-38-90q0-53 37.5-90.5t90.5-37.5 90.5 37.5 37.5 90.5zM1024 1600q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM320 896q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM1522 1394q0 52-38 90t-90 38q-53 0-90.5-37.5t-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM558 398q0 66-47 113t-113 47-113-47-47-113 47-113 113-47 113 47 47 113zM1728 896q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM1088 192q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zM1618 398q0 93-66 158.5t-158 65.5q-93 0-158.5-65.5t-65.5-158.5q0-92 65.5-158t158.5-66q92 0 158 66t66 158z"}]}};function yr(e){let t,n,r,s,o,i,a;return o=new hr({props:{style:"display:flex;",data:mr,spin:!0}}),{c(){t=D("div"),r=Q(),s=D("div"),Pe(o.$$.fragment),Y(t,"class","rounded-3 Overlay BackgroundOverlay svelte-xsphhw"),Y(s,"class","Overlay IconOverlay svelte-xsphhw")},m(e,n){O(e,t,n),O(e,r,n),O(e,s,n),Ye(o,s,null),a=!0},p(t,[n]){e=t},i(e){a||(n&&n.end(1),Te(o.$$.fragment,e),i&&i.end(1),a=!0)},o(r){r&&(n=Re(t,gt,{duration:e[0]})),Se(o.$$.fragment,r),r&&(i=Re(s,gt,{duration:e[0]})),a=!1},d(e){e&&F(t),e&&n&&n.end(),e&&F(r),e&&F(s),ze(o),e&&i&&i.end()}}}function gr(e,t,n){qe().getLogger("atf");let{duration_out:r=800}=t;return e.$$set=e=>{"duration_out"in e&&n(0,r=e.duration_out)},[r]}const Ar=class extends He{constructor(e){super(),Ve(this,e,gr,yr,a,{duration_out:0})}},_r={home:{width:1664,height:1792,paths:[{d:"M1408 992v480q0 26-19 45t-45 19h-384v-384h-256v384h-384q-26 0-45-19t-19-45v-480q0-1 0.5-3t0.5-3l575-474 575 474q1 2 1 6zM1631 923l-62 74q-8 9-21 11h-3q-13 0-21-7l-692-577-692 577q-12 8-24 7-13-2-21-11l-62-74q-8-10-7-23.5t11-21.5l719-599q32-26 76-26t76 26l244 204v-195q0-14 9-23t23-9h192q14 0 23 9t9 23v408l219 182q10 8 11 21.5t-7 23.5z"}]}};function vr(e,t){return function(){return e.apply(t,arguments)}}const{toString:br}=Object.prototype,{getPrototypeOf:xr}=Object,wr=(Er=Object.create(null),e=>{const t=br.call(e);return Er[t]||(Er[t]=t.slice(8,-1).toLowerCase())});var Er;const kr=e=>(e=e.toLowerCase(),t=>wr(t)===e),Cr=e=>t=>typeof t===e,{isArray:$r}=Array,Br=Cr("undefined");const Mr=kr("ArrayBuffer");const Nr=Cr("string"),Ir=Cr("function"),Tr=Cr("number"),Sr=e=>null!==e&&"object"==typeof e,Or=e=>{if("object"!==wr(e))return!1;const t=xr(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},Fr=kr("Date"),Rr=kr("File"),Dr=kr("Blob"),Ur=kr("FileList"),Lr=kr("URLSearchParams");function Qr(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,s;if("object"!=typeof e&&(e=[e]),$r(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let i;for(r=0;r<o;r++)i=s[r],t.call(null,e[i],i,e)}}function jr(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,s=n.length;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const Pr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Yr=e=>!Br(e)&&e!==Pr;const zr=(Vr="undefined"!=typeof Uint8Array&&xr(Uint8Array),e=>Vr&&e instanceof Vr);var Vr;const Hr=kr("HTMLFormElement"),Gr=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),qr=kr("RegExp"),Jr=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Qr(n,((n,s)=>{let o;!1!==(o=t(n,s,e))&&(r[s]=o||n)})),Object.defineProperties(e,r)},Wr="abcdefghijklmnopqrstuvwxyz",Kr="0123456789",Xr={DIGIT:Kr,ALPHA:Wr,ALPHA_DIGIT:Wr+Wr.toUpperCase()+Kr};const Zr=kr("AsyncFunction"),es={isArray:$r,isArrayBuffer:Mr,isBuffer:function(e){return null!==e&&!Br(e)&&null!==e.constructor&&!Br(e.constructor)&&Ir(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Ir(e.append)&&("formdata"===(t=wr(e))||"object"===t&&Ir(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Mr(e.buffer),t},isString:Nr,isNumber:Tr,isBoolean:e=>!0===e||!1===e,isObject:Sr,isPlainObject:Or,isUndefined:Br,isDate:Fr,isFile:Rr,isBlob:Dr,isRegExp:qr,isFunction:Ir,isStream:e=>Sr(e)&&Ir(e.pipe),isURLSearchParams:Lr,isTypedArray:zr,isFileList:Ur,forEach:Qr,merge:function e(){const{caseless:t}=Yr(this)&&this||{},n={},r=(r,s)=>{const o=t&&jr(n,s)||s;Or(n[o])&&Or(r)?n[o]=e(n[o],r):Or(r)?n[o]=e({},r):$r(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&Qr(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(Qr(t,((t,r)=>{n&&Ir(t)?e[r]=vr(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let s,o,i;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)i=s[o],r&&!r(i,e,t)||a[i]||(t[i]=e[i],a[i]=!0);e=!1!==n&&xr(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:wr,kindOfTest:kr,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if($r(e))return e;let t=e.length;if(!Tr(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Hr,hasOwnProperty:Gr,hasOwnProp:Gr,reduceDescriptors:Jr,freezeMethods:e=>{Jr(e,((t,n)=>{if(Ir(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Ir(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return $r(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:jr,global:Pr,isContextDefined:Yr,ALPHABET:Xr,generateString:(e=16,t=Xr.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&Ir(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Sr(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const s=$r(e)?[]:{};return Qr(e,((e,t)=>{const o=n(e,r+1);!Br(o)&&(s[t]=o)})),t[r]=void 0,s}}return e};return n(e,0)},isAsyncFn:Zr,isThenable:e=>e&&(Sr(e)||Ir(e))&&Ir(e.then)&&Ir(e.catch)};function ts(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}es.inherits(ts,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:es.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ns=ts.prototype,rs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{rs[e]={value:e}})),Object.defineProperties(ts,rs),Object.defineProperty(ns,"isAxiosError",{value:!0}),ts.from=(e,t,n,r,s,o)=>{const i=Object.create(ns);return es.toFlatObject(e,i,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),ts.call(i,e.message,t,n,r,s),i.cause=e,i.name=e.name,o&&Object.assign(i,o),i};const ss=ts;function os(e){return es.isPlainObject(e)||es.isArray(e)}function is(e){return es.endsWith(e,"[]")?e.slice(0,-2):e}function as(e,t,n){return e?e.concat(t).map((function(e,t){return e=is(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const cs=es.toFlatObject(es,{},null,(function(e){return/^is[A-Z]/.test(e)}));const ls=function(e,t,n){if(!es.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=es.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!es.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,o=n.dots,i=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&es.isSpecCompliantForm(t);if(!es.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(es.isDate(e))return e.toISOString();if(!a&&es.isBlob(e))throw new ss("Blob is not supported. Use a Buffer instead.");return es.isArrayBuffer(e)||es.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(es.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(es.isArray(e)&&function(e){return es.isArray(e)&&!e.some(os)}(e)||(es.isFileList(e)||es.endsWith(n,"[]"))&&(a=es.toArray(e)))return n=is(n),a.forEach((function(e,r){!es.isUndefined(e)&&null!==e&&t.append(!0===i?as([n],r,o):null===i?n:n+"[]",c(e))})),!1;return!!os(e)||(t.append(as(s,n,o),c(e)),!1)}const u=[],f=Object.assign(cs,{defaultVisitor:l,convertValue:c,isVisitable:os});if(!es.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!es.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),es.forEach(n,(function(n,o){!0===(!(es.isUndefined(n)||null===n)&&s.call(t,n,es.isString(o)?o.trim():o,r,f))&&e(n,r?r.concat(o):[o])})),u.pop()}}(e),t};function us(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function fs(e,t){this._pairs=[],e&&ls(e,this,t)}const ds=fs.prototype;ds.append=function(e,t){this._pairs.push([e,t])},ds.toString=function(e){const t=e?function(t){return e.call(this,t,us)}:us;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const ps=fs;function hs(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ms(e,t,n){if(!t)return e;const r=n&&n.encode||hs,s=n&&n.serialize;let o;if(o=s?s(t,n):es.isURLSearchParams(t)?t.toString():new ps(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const ys=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){es.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},gs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},As={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ps,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const _s=function(e){function t(e,n,r,s){let o=e[s++];const i=Number.isFinite(+o),a=s>=e.length;if(o=!o&&es.isArray(r)?r.length:o,a)return es.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!i;r[o]&&es.isObject(r[o])||(r[o]=[]);return t(e,n,r[o],s)&&es.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const s=n.length;let o;for(r=0;r<s;r++)o=n[r],t[o]=e[o];return t}(r[o])),!i}if(es.isFormData(e)&&es.isFunction(e.entries)){const n={};return es.forEachEntry(e,((e,r)=>{t(function(e){return es.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const vs={transitional:gs,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=es.isObject(e);s&&es.isHTMLForm(e)&&(e=new FormData(e));if(es.isFormData(e))return r&&r?JSON.stringify(_s(e)):e;if(es.isArrayBuffer(e)||es.isBuffer(e)||es.isStream(e)||es.isFile(e)||es.isBlob(e))return e;if(es.isArrayBufferView(e))return e.buffer;if(es.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ls(e,new As.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return As.isNode&&es.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=es.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ls(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),function(e,t,n){if(es.isString(e))try{return(t||JSON.parse)(e),es.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||vs.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&es.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw ss.from(e,ss.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:As.classes.FormData,Blob:As.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};es.forEach(["delete","get","head","post","put","patch"],(e=>{vs.headers[e]={}}));const bs=vs,xs=es.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ws=Symbol("internals");function Es(e){return e&&String(e).trim().toLowerCase()}function ks(e){return!1===e||null==e?e:es.isArray(e)?e.map(ks):String(e)}function Cs(e,t,n,r,s){return es.isFunction(r)?r.call(this,t,n):(s&&(t=n),es.isString(t)?es.isString(r)?-1!==t.indexOf(r):es.isRegExp(r)?r.test(t):void 0:void 0)}class $s{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function s(e,t,n){const s=Es(t);if(!s)throw new Error("header name must be a non-empty string");const o=es.findKey(r,s);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=ks(e))}const o=(e,t)=>es.forEach(e,((e,n)=>s(e,n,t)));return es.isPlainObject(e)||e instanceof this.constructor?o(e,t):es.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?o((e=>{const t={};let n,r,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!n||t[n]&&xs[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&s(t,e,n),this}get(e,t){if(e=Es(e)){const n=es.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(es.isFunction(t))return t.call(this,e,n);if(es.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Es(e)){const n=es.findKey(this,e);return!(!n||void 0===this[n]||t&&!Cs(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function s(e){if(e=Es(e)){const s=es.findKey(n,e);!s||t&&!Cs(0,n[s],s,t)||(delete n[s],r=!0)}}return es.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const s=t[n];e&&!Cs(0,this[s],s,e,!0)||(delete this[s],r=!0)}return r}normalize(e){const t=this,n={};return es.forEach(this,((r,s)=>{const o=es.findKey(n,s);if(o)return t[o]=ks(r),void delete t[s];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();i!==s&&delete t[s],t[i]=ks(r),n[i]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return es.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&es.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[ws]=this[ws]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Es(e);t[r]||(!function(e,t){const n=es.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,s){return this[r].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[r]=!0)}return es.isArray(e)?e.forEach(r):r(e),this}}$s.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),es.reduceDescriptors($s.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),es.freezeMethods($s);const Bs=$s;function Ms(e,t){const n=this||bs,r=t||n,s=Bs.from(r.headers);let o=r.data;return es.forEach(e,(function(e){o=e.call(n,o,s.normalize(),t?t.status:void 0)})),s.normalize(),o}function Ns(e){return!(!e||!e.__CANCEL__)}function Is(e,t,n){ss.call(this,null==e?"canceled":e,ss.ERR_CANCELED,t,n),this.name="CanceledError"}es.inherits(Is,ss,{__CANCEL__:!0});const Ts=Is;const Ss=As.isStandardBrowserEnv?{write:function(e,t,n,r,s,o){const i=[];i.push(e+"="+encodeURIComponent(t)),es.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),es.isString(r)&&i.push("path="+r),es.isString(s)&&i.push("domain="+s),!0===o&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Os(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Fs=As.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=es.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};const Rs=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,o=0,i=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=r[i];s||(s=c),n[o]=a,r[o]=c;let u=i,f=0;for(;u!==o;)f+=n[u++],u%=e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),c-s<t)return;const d=l&&c-l;return d?Math.round(1e3*f/d):void 0}};function Ds(e,t){let n=0;const r=Rs(50,250);return s=>{const o=s.loaded,i=s.lengthComputable?s.total:void 0,a=o-n,c=r(a);n=o;const l={loaded:o,total:i,progress:i?o/i:void 0,bytes:a,rate:c||void 0,estimated:c&&i&&o<=i?(i-o)/c:void 0,event:s};l[t?"download":"upload"]=!0,e(l)}}const Us="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const s=Bs.from(e.headers).normalize(),o=e.responseType;let i,a;function c(){e.cancelToken&&e.cancelToken.unsubscribe(i),e.signal&&e.signal.removeEventListener("abort",i)}es.isFormData(r)&&(As.isStandardBrowserEnv||As.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?es.isString(a=s.getContentType())&&s.setContentType(a.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let l=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(t+":"+n))}const u=Os(e.baseURL,e.url);function f(){if(!l)return;const r=Bs.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new ss("Request failed with status code "+n.status,[ss.ERR_BAD_REQUEST,ss.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),c()}),(function(e){n(e),c()}),{data:o&&"text"!==o&&"json"!==o?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:r,config:e,request:l}),l=null}if(l.open(e.method.toUpperCase(),ms(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=f:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(f)},l.onabort=function(){l&&(n(new ss("Request aborted",ss.ECONNABORTED,e,l)),l=null)},l.onerror=function(){n(new ss("Network Error",ss.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||gs;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new ss(t,r.clarifyTimeoutError?ss.ETIMEDOUT:ss.ECONNABORTED,e,l)),l=null},As.isStandardBrowserEnv){const t=(e.withCredentials||Fs(u))&&e.xsrfCookieName&&Ss.read(e.xsrfCookieName);t&&s.set(e.xsrfHeaderName,t)}void 0===r&&s.setContentType(null),"setRequestHeader"in l&&es.forEach(s.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),es.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),o&&"json"!==o&&(l.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",Ds(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Ds(e.onUploadProgress)),(e.cancelToken||e.signal)&&(i=t=>{l&&(n(!t||t.type?new Ts(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(i),e.signal&&(e.signal.aborted?i():e.signal.addEventListener("abort",i)));const d=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);d&&-1===As.protocols.indexOf(d)?n(new ss("Unsupported protocol "+d+":",ss.ERR_BAD_REQUEST,e)):l.send(r||null)}))},Ls={http:null,xhr:Us};es.forEach(Ls,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const Qs=e=>`- ${e}`,js=e=>es.isFunction(e)||null===e||!1===e,Ps=e=>{e=es.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let o=0;o<t;o++){let t;if(n=e[o],r=n,!js(n)&&(r=Ls[(t=String(n)).toLowerCase()],void 0===r))throw new ss(`Unknown adapter '${t}'`);if(r)break;s[t||"#"+o]=r}if(!r){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(Qs).join("\n"):" "+Qs(e[0]):"as no adapter specified";throw new ss("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function Ys(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ts(null,e)}function zs(e){Ys(e),e.headers=Bs.from(e.headers),e.data=Ms.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ps(e.adapter||bs.adapter)(e).then((function(t){return Ys(e),t.data=Ms.call(e,e.transformResponse,t),t.headers=Bs.from(t.headers),t}),(function(t){return Ns(t)||(Ys(e),t&&t.response&&(t.response.data=Ms.call(e,e.transformResponse,t.response),t.response.headers=Bs.from(t.response.headers))),Promise.reject(t)}))}const Vs=e=>e instanceof Bs?e.toJSON():e;function Hs(e,t){t=t||{};const n={};function r(e,t,n){return es.isPlainObject(e)&&es.isPlainObject(t)?es.merge.call({caseless:n},e,t):es.isPlainObject(t)?es.merge({},t):es.isArray(t)?t.slice():t}function s(e,t,n){return es.isUndefined(t)?es.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function o(e,t){if(!es.isUndefined(t))return r(void 0,t)}function i(e,t){return es.isUndefined(t)?es.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,s,o){return o in t?r(n,s):o in e?r(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(e,t)=>s(Vs(e),Vs(t),!0)};return es.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=c[r]||s,i=o(e[r],t[r],r);es.isUndefined(i)&&o!==a||(n[r]=i)})),n}const Gs="1.5.1",qs={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{qs[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Js={};qs.transitional=function(e,t,n){return(r,s,o)=>{if(!1===e)throw new ss(function(e,t){return"[Axios v1.5.1] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")),ss.ERR_DEPRECATED);return t&&!Js[s]&&(Js[s]=!0),!e||e(r,s,o)}};const Ws={assertOptions:function(e,t,n){if("object"!=typeof e)throw new ss("options must be an object",ss.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const o=r[s],i=t[o];if(i){const t=e[o],n=void 0===t||i(t,o,e);if(!0!==n)throw new ss("option "+o+" must be "+n,ss.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ss("Unknown option "+o,ss.ERR_BAD_OPTION)}},validators:qs},Ks=Ws.validators;class Xs{constructor(e){this.defaults=e,this.interceptors={request:new ys,response:new ys}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Hs(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:s}=t;void 0!==n&&Ws.assertOptions(n,{silentJSONParsing:Ks.transitional(Ks.boolean),forcedJSONParsing:Ks.transitional(Ks.boolean),clarifyTimeoutError:Ks.transitional(Ks.boolean)},!1),null!=r&&(es.isFunction(r)?t.paramsSerializer={serialize:r}:Ws.assertOptions(r,{encode:Ks.function,serialize:Ks.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&es.merge(s.common,s[t.method]);s&&es.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=Bs.concat(o,s);const i=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,f=0;if(!a){const e=[zs.bind(this),void 0];for(e.unshift.apply(e,i),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);f<u;)l=l.then(e[f++],e[f++]);return l}u=i.length;let d=t;for(f=0;f<u;){const e=i[f++],t=i[f++];try{d=e(d)}catch(e){t.call(this,e);break}}try{l=zs.call(this,d)}catch(e){return Promise.reject(e)}for(f=0,u=c.length;f<u;)l=l.then(c[f++],c[f++]);return l}getUri(e){return ms(Os((e=Hs(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}es.forEach(["delete","get","head","options"],(function(e){Xs.prototype[e]=function(t,n){return this.request(Hs(n||{},{method:e,url:t,data:(n||{}).data}))}})),es.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,s){return this.request(Hs(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Xs.prototype[e]=t(),Xs.prototype[e+"Form"]=t(!0)}));const Zs=Xs;class eo{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,s){n.reason||(n.reason=new Ts(e,r,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new eo((function(t){e=t})),cancel:e}}}const to=eo;const no={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(no).forEach((([e,t])=>{no[t]=e}));const ro=no;const so=function e(t){const n=new Zs(t),r=vr(Zs.prototype.request,n);return es.extend(r,Zs.prototype,n,{allOwnKeys:!0}),es.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Hs(t,n))},r}(bs);so.Axios=Zs,so.CanceledError=Ts,so.CancelToken=to,so.isCancel=Ns,so.VERSION=Gs,so.toFormData=ls,so.AxiosError=ss,so.Cancel=so.CanceledError,so.all=function(e){return Promise.all(e)},so.spread=function(e){return function(t){return e.apply(null,t)}},so.isAxiosError=function(e){return es.isObject(e)&&!0===e.isAxiosError},so.mergeConfig=Hs,so.AxiosHeaders=Bs,so.formToJSON=e=>_s(es.isHTMLForm(e)?new FormData(e):e),so.getAdapter=Ps,so.HttpStatusCode=ro,so.default=so;const oo=so,io=qe().getLogger("atf");oo.defaults.withCredentials=!0;let ao=window.location,co=ao.origin,lo=co;["localhost","127.0.0.1"].indexOf(ao.hostname)>-1&&(lo=ao.protocol+"//"+ao.hostname+":3333");var uo=async function(e,t={},n="API"){let r=lo+e;"APP"==n&&(r=co+e),JSON.stringify(t);try{return{data:(await oo.get(r,t)).data}}catch(e){return io.error(e.message),{error:e.message}}},fo=async function(e,t){let n=lo+e;JSON.stringify(t);try{return{data:(await oo.post(n,t)).data}}catch(e){return io.error(e.message),{error:e.message}}},po=__webpack_require__(17),ho=__webpack_require__(117),mo=__webpack_require__.n(ho),yo=__webpack_require__(486),go=__webpack_require__.n(yo);class Ao extends Error{}class _o extends Ao{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class vo extends Ao{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class bo extends Ao{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class xo extends Ao{}class wo extends Ao{constructor(e){super(`Invalid unit ${e}`)}}class Eo extends Ao{}class ko extends Ao{constructor(){super("Zone is an abstract class")}}const Co="numeric",$o="short",Bo="long",Mo={year:Co,month:Co,day:Co},No={year:Co,month:$o,day:Co},Io={year:Co,month:$o,day:Co,weekday:$o},To={year:Co,month:Bo,day:Co},So={year:Co,month:Bo,day:Co,weekday:Bo},Oo={hour:Co,minute:Co},Fo={hour:Co,minute:Co,second:Co},Ro={hour:Co,minute:Co,second:Co,timeZoneName:$o},Do={hour:Co,minute:Co,second:Co,timeZoneName:Bo},Uo={hour:Co,minute:Co,hourCycle:"h23"},Lo={hour:Co,minute:Co,second:Co,hourCycle:"h23"},Qo={hour:Co,minute:Co,second:Co,hourCycle:"h23",timeZoneName:$o},jo={hour:Co,minute:Co,second:Co,hourCycle:"h23",timeZoneName:Bo},Po={year:Co,month:Co,day:Co,hour:Co,minute:Co},Yo={year:Co,month:Co,day:Co,hour:Co,minute:Co,second:Co},zo={year:Co,month:$o,day:Co,hour:Co,minute:Co},Vo={year:Co,month:$o,day:Co,hour:Co,minute:Co,second:Co},Ho={year:Co,month:$o,day:Co,weekday:$o,hour:Co,minute:Co},Go={year:Co,month:Bo,day:Co,hour:Co,minute:Co,timeZoneName:$o},qo={year:Co,month:Bo,day:Co,hour:Co,minute:Co,second:Co,timeZoneName:$o},Jo={year:Co,month:Bo,day:Co,weekday:Bo,hour:Co,minute:Co,timeZoneName:Bo},Wo={year:Co,month:Bo,day:Co,weekday:Bo,hour:Co,minute:Co,second:Co,timeZoneName:Bo};class Ko{get type(){throw new ko}get name(){throw new ko}get ianaName(){return this.name}get isUniversal(){throw new ko}offsetName(e,t){throw new ko}formatOffset(e,t){throw new ko}offset(e){throw new ko}equals(e){throw new ko}get isValid(){throw new ko}}let Xo=null;class Zo extends Ko{static get instance(){return null===Xo&&(Xo=new Zo),Xo}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return Vi(e,t,n)}formatOffset(e,t){return Ji(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return"system"===e.type}get isValid(){return!0}}let ei={};const ti={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let ni={};class ri extends Ko{static create(e){return ni[e]||(ni[e]=new ri(e)),ni[e]}static resetCache(){ni={},ei={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}}constructor(e){super(),this.zoneName=e,this.valid=ri.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return Vi(e,t,n,this.name)}formatOffset(e,t){return Ji(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const n=(r=this.name,ei[r]||(ei[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),ei[r]);var r;let[s,o,i,a,c,l,u]=n.formatToParts?function(e,t){const n=e.formatToParts(t),r=[];for(let e=0;e<n.length;e++){const{type:t,value:s}=n[e],o=ti[t];"era"===t?r[o]=s:$i(o)||(r[o]=parseInt(s,10))}return r}(n,t):function(e,t){const n=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,s,o,i,a,c,l,u]=r;return[i,s,o,a,c,l,u]}(n,t);"BC"===a&&(s=1-Math.abs(s));let f=+t;const d=f%1e3;return f-=d>=0?d:1e3+d,(Pi({year:s,month:o,day:i,hour:24===c?0:c,minute:l,second:u,millisecond:0})-f)/6e4}equals(e){return"iana"===e.type&&e.name===this.name}get isValid(){return this.valid}}let si={};let oi={};function ii(e,t={}){const n=JSON.stringify([e,t]);let r=oi[n];return r||(r=new Intl.DateTimeFormat(e,t),oi[n]=r),r}let ai={};let ci={};let li=null;function ui(e,t,n,r){const s=e.listingMode();return"error"===s?null:"en"===s?n(t):r(t)}class fi{constructor(e,t,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:r,floor:s,...o}=n;if(!t||Object.keys(o).length>0){const t={useGrouping:!1,...n};n.padTo>0&&(t.minimumIntegerDigits=n.padTo),this.inf=function(e,t={}){const n=JSON.stringify([e,t]);let r=ai[n];return r||(r=new Intl.NumberFormat(e,t),ai[n]=r),r}(e,t)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}return Oi(this.floor?Math.floor(e):Ui(e,3),this.padTo)}}class di{constructor(e,t,n){let r;if(this.opts=n,this.originalZone=void 0,this.opts.timeZone)this.dt=e;else if("fixed"===e.zone.type){const t=e.offset/60*-1,n=t>=0?`Etc/GMT+${t}`:`Etc/GMT${t}`;0!==e.offset&&ri.create(n).valid?(r=n,this.dt=e):(r="UTC",this.dt=0===e.offset?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else"system"===e.zone.type?this.dt=e:"iana"===e.zone.type?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||r,this.dtf=ii(t,s)}format(){return this.originalZone?this.formatToParts().map((({value:e})=>e)).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map((e=>{if("timeZoneName"===e.type){const t=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...e,value:t}}return e})):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class pi{constructor(e,t,n){this.opts={style:"long",...n},!t&&Ni()&&(this.rtf=function(e,t={}){const{base:n,...r}=t,s=JSON.stringify([e,r]);let o=ci[s];return o||(o=new Intl.RelativeTimeFormat(e,t),ci[s]=o),o}(e,n))}format(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,n="always",r=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===n&&o){const n="days"===e;switch(t){case 1:return n?"tomorrow":`next ${s[e][0]}`;case-1:return n?"yesterday":`last ${s[e][0]}`;case 0:return n?"today":`this ${s[e][0]}`}}const i=Object.is(t,-0)||t<0,a=Math.abs(t),c=1===a,l=s[e],u=r?c?l[1]:l[2]||l[1]:c?s[e][0]:e;return i?`${a} ${u} ago`:`in ${a} ${u}`}(t,e,this.opts.numeric,"long"!==this.opts.style)}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class hi{static fromOpts(e){return hi.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,n,r=!1){const s=e||Ci.defaultLocale,o=s||(r?"en-US":li||(li=(new Intl.DateTimeFormat).resolvedOptions().locale,li)),i=t||Ci.defaultNumberingSystem,a=n||Ci.defaultOutputCalendar;return new hi(o,i,a,s)}static resetCache(){li=null,oi={},ai={},ci={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:n}={}){return hi.create(e,t,n)}constructor(e,t,n,r){const[s,o,i]=function(e){const t=e.indexOf("-x-");-1!==t&&(e=e.substring(0,t));const n=e.indexOf("-u-");if(-1===n)return[e];{let t,r;try{t=ii(e).resolvedOptions(),r=e}catch(s){const o=e.substring(0,n);t=ii(o).resolvedOptions(),r=o}const{numberingSystem:s,calendar:o}=t;return[r,s,o]}}(e);this.locale=s,this.numberingSystem=t||o||null,this.outputCalendar=n||i||null,this.intl=function(e,t,n){return n||t?(e.includes("-u-")||(e+="-u"),n&&(e+=`-ca-${n}`),t&&(e+=`-nu-${t}`),e):e}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=function(e){return(!e.numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)}(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"}clone(e){return e&&0!==Object.getOwnPropertyNames(e).length?hi.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1):this}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return ui(this,e,ea,(()=>{const n=t?{month:e,day:"numeric"}:{month:e},r=t?"format":"standalone";return this.monthsCache[r][e]||(this.monthsCache[r][e]=function(e){const t=[];for(let n=1;n<=12;n++){const r=gl.utc(2009,n,1);t.push(e(r))}return t}((e=>this.extract(e,n,"month")))),this.monthsCache[r][e]}))}weekdays(e,t=!1){return ui(this,e,sa,(()=>{const n=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=t?"format":"standalone";return this.weekdaysCache[r][e]||(this.weekdaysCache[r][e]=function(e){const t=[];for(let n=1;n<=7;n++){const r=gl.utc(2016,11,13+n);t.push(e(r))}return t}((e=>this.extract(e,n,"weekday")))),this.weekdaysCache[r][e]}))}meridiems(){return ui(this,void 0,(()=>oa),(()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[gl.utc(2016,11,13,9),gl.utc(2016,11,13,19)].map((t=>this.extract(t,e,"dayperiod")))}return this.meridiemCache}))}eras(e){return ui(this,e,la,(()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[gl.utc(-40,1,1),gl.utc(2017,1,1)].map((e=>this.extract(e,t,"era")))),this.eraCache[e]}))}extract(e,t,n){const r=this.dtFormatter(e,t).formatToParts().find((e=>e.type.toLowerCase()===n));return r?r.value:null}numberFormatter(e={}){return new fi(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new di(e,this.intl,t)}relFormatter(e={}){return new pi(this.intl,this.isEnglish(),e)}listFormatter(e={}){return function(e,t={}){const n=JSON.stringify([e,t]);let r=si[n];return r||(r=new Intl.ListFormat(e,t),si[n]=r),r}(this.intl,e)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let mi=null;class yi extends Ko{static get utcInstance(){return null===mi&&(mi=new yi(0)),mi}static instance(e){return 0===e?yi.utcInstance:new yi(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new yi(Hi(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${Ji(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${Ji(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return Ji(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return"fixed"===e.type&&e.fixed===this.fixed}get isValid(){return!0}}class gi extends Ko{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ai(e,t){if($i(e)||null===e)return t;if(e instanceof Ko)return e;if("string"==typeof e){const n=e.toLowerCase();return"default"===n?t:"local"===n||"system"===n?Zo.instance:"utc"===n||"gmt"===n?yi.utcInstance:yi.parseSpecifier(n)||ri.create(e)}return Bi(e)?yi.instance(e):"object"==typeof e&&"offset"in e&&"function"==typeof e.offset?e:new gi(e)}let _i,vi=()=>Date.now(),bi="system",xi=null,wi=null,Ei=null,ki=60;class Ci{static get now(){return vi}static set now(e){vi=e}static set defaultZone(e){bi=e}static get defaultZone(){return Ai(bi,Zo.instance)}static get defaultLocale(){return xi}static set defaultLocale(e){xi=e}static get defaultNumberingSystem(){return wi}static set defaultNumberingSystem(e){wi=e}static get defaultOutputCalendar(){return Ei}static set defaultOutputCalendar(e){Ei=e}static get twoDigitCutoffYear(){return ki}static set twoDigitCutoffYear(e){ki=e%100}static get throwOnInvalid(){return _i}static set throwOnInvalid(e){_i=e}static resetCaches(){hi.resetCache(),ri.resetCache()}}function $i(e){return void 0===e}function Bi(e){return"number"==typeof e}function Mi(e){return"number"==typeof e&&e%1==0}function Ni(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function Ii(e,t,n){if(0!==e.length)return e.reduce(((e,r)=>{const s=[t(r),r];return e&&n(e[0],s[0])===e[0]?e:s}),null)[1]}function Ti(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Si(e,t,n){return Mi(e)&&e>=t&&e<=n}function Oi(e,t=2){let n;return n=e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0"),n}function Fi(e){return $i(e)||null===e||""===e?void 0:parseInt(e,10)}function Ri(e){return $i(e)||null===e||""===e?void 0:parseFloat(e)}function Di(e){if(!$i(e)&&null!==e&&""!==e){const t=1e3*parseFloat("0."+e);return Math.floor(t)}}function Ui(e,t,n=!1){const r=10**t;return(n?Math.trunc:Math.round)(e*r)/r}function Li(e){return e%4==0&&(e%100!=0||e%400==0)}function Qi(e){return Li(e)?366:365}function ji(e,t){const n=function(e,t){return e-t*Math.floor(e/t)}(t-1,12)+1;return 2===n?Li(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function Pi(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function Yi(e){const t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,n=e-1,r=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===t||3===r?53:52}function zi(e){return e>99?e:e>Ci.twoDigitCutoffYear?1900+e:2e3+e}function Vi(e,t,n,r=null){const s=new Date(e),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);const i={timeZoneName:t,...o},a=new Intl.DateTimeFormat(n,i).formatToParts(s).find((e=>"timezonename"===e.type.toLowerCase()));return a?a.value:null}function Hi(e,t){let n=parseInt(e,10);Number.isNaN(n)&&(n=0);const r=parseInt(t,10)||0;return 60*n+(n<0||Object.is(n,-0)?-r:r)}function Gi(e){const t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new Eo(`Invalid unit value ${e}`);return t}function qi(e,t){const n={};for(const r in e)if(Ti(e,r)){const s=e[r];if(null==s)continue;n[t(r)]=Gi(s)}return n}function Ji(e,t){const n=Math.trunc(Math.abs(e/60)),r=Math.trunc(Math.abs(e%60)),s=e>=0?"+":"-";switch(t){case"short":return`${s}${Oi(n,2)}:${Oi(r,2)}`;case"narrow":return`${s}${n}${r>0?`:${r}`:""}`;case"techie":return`${s}${Oi(n,2)}${Oi(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function Wi(e){return function(e,t){return t.reduce(((t,n)=>(t[n]=e[n],t)),{})}(e,["hour","minute","second","millisecond"])}const Ki=["January","February","March","April","May","June","July","August","September","October","November","December"],Xi=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Zi=["J","F","M","A","M","J","J","A","S","O","N","D"];function ea(e){switch(e){case"narrow":return[...Zi];case"short":return[...Xi];case"long":return[...Ki];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const ta=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],na=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],ra=["M","T","W","T","F","S","S"];function sa(e){switch(e){case"narrow":return[...ra];case"short":return[...na];case"long":return[...ta];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const oa=["AM","PM"],ia=["Before Christ","Anno Domini"],aa=["BC","AD"],ca=["B","A"];function la(e){switch(e){case"narrow":return[...ca];case"short":return[...aa];case"long":return[...ia];default:return null}}function ua(e,t){let n="";for(const r of e)r.literal?n+=r.val:n+=t(r.val);return n}const fa={D:Mo,DD:No,DDD:To,DDDD:So,t:Oo,tt:Fo,ttt:Ro,tttt:Do,T:Uo,TT:Lo,TTT:Qo,TTTT:jo,f:Po,ff:zo,fff:Go,ffff:Jo,F:Yo,FF:Vo,FFF:qo,FFFF:Wo};class da{static create(e,t={}){return new da(e,t)}static parseFormat(e){let t=null,n="",r=!1;const s=[];for(let o=0;o<e.length;o++){const i=e.charAt(o);"'"===i?(n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),t=null,n="",r=!r):r||i===t?n+=i:(n.length>0&&s.push({literal:/^\s+$/.test(n),val:n}),n=i,t=i)}return n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),s}static macroTokenToFormatOpts(e){return fa[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return Oi(e,t);const n={...this.opts};return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,t){const n="en"===this.loc.listingMode(),r=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,s=(t,n)=>this.loc.extract(e,t,n),o=t=>e.isOffsetFixed&&0===e.offset&&t.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,t.format):"",i=()=>n?function(e){return oa[e.hour<12?0:1]}(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),a=(t,r)=>n?function(e,t){return ea(t)[e.month-1]}(e,t):s(r?{month:t}:{month:t,day:"numeric"},"month"),c=(t,r)=>n?function(e,t){return sa(t)[e.weekday-1]}(e,t):s(r?{weekday:t}:{weekday:t,month:"long",day:"numeric"},"weekday"),l=t=>{const n=da.macroTokenToFormatOpts(t);return n?this.formatWithSystemDefault(e,n):t},u=t=>n?function(e,t){return la(t)[e.year<0?0:1]}(e,t):s({era:t},"era");return ua(da.parseFormat(t),(t=>{switch(t){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12==0?12:e.hour%12);case"hh":return this.num(e.hour%12==0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return i();case"d":return r?s({day:"numeric"},"day"):this.num(e.day);case"dd":return r?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":case"E":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return r?s({month:"numeric"},"month"):this.num(e.month);case"MM":return r?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return r?s({year:"numeric"},"year"):this.num(e.year);case"yy":return r?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return u("short");case"GG":return u("long");case"GGGGG":return u("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return l(t)}}))}formatDurationFromString(e,t){const n=e=>{switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=da.parseFormat(t),s=r.reduce(((e,{literal:t,val:n})=>t?e:e.concat(n)),[]);return ua(r,(e=>t=>{const r=n(t);return r?this.num(e.get(r),t.length):t})(e.shiftTo(...s.map(n).filter((e=>e)))))}}class pa{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const ha=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function ma(...e){const t=e.reduce(((e,t)=>e+t.source),"");return RegExp(`^${t}$`)}function ya(...e){return t=>e.reduce((([e,n,r],s)=>{const[o,i,a]=s(t,r);return[{...e,...o},i||n,a]}),[{},null,1]).slice(0,2)}function ga(e,...t){if(null==e)return[null,null];for(const[n,r]of t){const t=n.exec(e);if(t)return r(t)}return[null,null]}function Aa(...e){return(t,n)=>{const r={};let s;for(s=0;s<e.length;s++)r[e[s]]=Fi(t[n+s]);return[r,null,n+s]}}const _a=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,va=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,ba=RegExp(`${va.source}${`(?:${_a.source}?(?:\\[(${ha.source})\\])?)?`}`),xa=RegExp(`(?:T${ba.source})?`),wa=Aa("weekYear","weekNumber","weekDay"),Ea=Aa("year","ordinal"),ka=RegExp(`${va.source} ?(?:${_a.source}|(${ha.source}))?`),Ca=RegExp(`(?: ${ka.source})?`);function $a(e,t,n){const r=e[t];return $i(r)?n:Fi(r)}function Ba(e,t){return[{hours:$a(e,t,0),minutes:$a(e,t+1,0),seconds:$a(e,t+2,0),milliseconds:Di(e[t+3])},null,t+4]}function Ma(e,t){const n=!e[t]&&!e[t+1],r=Hi(e[t+1],e[t+2]);return[{},n?null:yi.instance(r),t+3]}function Na(e,t){return[{},e[t]?ri.create(e[t]):null,t+1]}const Ia=RegExp(`^T?${va.source}$`),Ta=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Sa(e){const[t,n,r,s,o,i,a,c,l]=e,u="-"===t[0],f=c&&"-"===c[0],d=(e,t=!1)=>void 0!==e&&(t||e&&u)?-e:e;return[{years:d(Ri(n)),months:d(Ri(r)),weeks:d(Ri(s)),days:d(Ri(o)),hours:d(Ri(i)),minutes:d(Ri(a)),seconds:d(Ri(c),"-0"===c),milliseconds:d(Di(l),f)}]}const Oa={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Fa(e,t,n,r,s,o,i){const a={year:2===t.length?zi(Fi(t)):Fi(t),month:Xi.indexOf(n)+1,day:Fi(r),hour:Fi(s),minute:Fi(o)};return i&&(a.second=Fi(i)),e&&(a.weekday=e.length>3?ta.indexOf(e)+1:na.indexOf(e)+1),a}const Ra=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Da(e){const[,t,n,r,s,o,i,a,c,l,u,f]=e,d=Fa(t,s,r,n,o,i,a);let p;return p=c?Oa[c]:l?0:Hi(u,f),[d,new yi(p)]}const Ua=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,La=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Qa=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ja(e){const[,t,n,r,s,o,i,a]=e;return[Fa(t,s,r,n,o,i,a),yi.utcInstance]}function Pa(e){const[,t,n,r,s,o,i,a]=e;return[Fa(t,a,n,r,s,o,i),yi.utcInstance]}const Ya=ma(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,xa),za=ma(/(\d{4})-?W(\d\d)(?:-?(\d))?/,xa),Va=ma(/(\d{4})-?(\d{3})/,xa),Ha=ma(ba),Ga=ya((function(e,t){return[{year:$a(e,t),month:$a(e,t+1,1),day:$a(e,t+2,1)},null,t+3]}),Ba,Ma,Na),qa=ya(wa,Ba,Ma,Na),Ja=ya(Ea,Ba,Ma,Na),Wa=ya(Ba,Ma,Na);const Ka=ya(Ba);const Xa=ma(/(\d{4})-(\d\d)-(\d\d)/,Ca),Za=ma(ka),ec=ya(Ba,Ma,Na);const tc="Invalid Duration",nc={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},rc={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...nc},sc=365.2425,oc=30.436875,ic={years:{quarters:4,months:12,weeks:52.1775,days:sc,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:oc,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...nc},ac=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],cc=ac.slice(0).reverse();function lc(e,t,n=!1){const r={values:n?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new dc(r)}function uc(e,t){let n=t.milliseconds??0;for(const r of cc.slice(1))t[r]&&(n+=t[r]*e[r].milliseconds);return n}function fc(e,t){const n=uc(e,t)<0?-1:1;ac.reduceRight(((r,s)=>{if($i(t[s]))return r;if(r){const o=t[r]*n,i=e[s][r],a=Math.floor(o/i);t[s]+=a*n,t[r]-=a*i*n}return s}),null),ac.reduce(((n,r)=>{if($i(t[r]))return n;if(n){const s=t[n]%1;t[n]-=s,t[r]+=s*e[n][r]}return r}),null)}class dc{constructor(e){const t="longterm"===e.conversionAccuracy||!1;let n=t?ic:rc;e.matrix&&(n=e.matrix),this.values=e.values,this.loc=e.loc||hi.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=n,this.isLuxonDuration=!0}static fromMillis(e,t){return dc.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(null==e||"object"!=typeof e)throw new Eo("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new dc({values:qi(e,dc.normalizeUnit),loc:hi.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(Bi(e))return dc.fromMillis(e);if(dc.isDuration(e))return e;if("object"==typeof e)return dc.fromObject(e);throw new Eo(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[n]=function(e){return ga(e,[Ta,Sa])}(e);return n?dc.fromObject(n,t):dc.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[n]=function(e){return ga(e,[Ia,Ka])}(e);return n?dc.fromObject(n,t):dc.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new Eo("need to specify a reason the Duration is invalid");const n=e instanceof pa?e:new pa(e,t);if(Ci.throwOnInvalid)throw new bo(n);return new dc({invalid:n})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new wo(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const n={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?da.create(this.loc,n).formatDurationFromString(this,e):tc}toHuman(e={}){if(!this.isValid)return tc;const t=ac.map((t=>{const n=this.values[t];return $i(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:t.slice(0,-1)}).format(n)})).filter((e=>e));return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=Ui(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1};return gl.fromMillis(t,{zone:"UTC"}).toISOTime(e)}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.isValid?uc(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=dc.fromDurationLike(e),n={};for(const e of ac)(Ti(t.values,e)||Ti(this.values,e))&&(n[e]=t.get(e)+this.get(e));return lc(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const t=dc.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const n of Object.keys(this.values))t[n]=Gi(e(this.values[n],n));return lc(this,{values:t},!0)}get(e){return this[dc.normalizeUnit(e)]}set(e){if(!this.isValid)return this;return lc(this,{values:{...this.values,...qi(e,dc.normalizeUnit)}})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:n,matrix:r}={}){return lc(this,{loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:r,conversionAccuracy:n})}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return fc(this.matrix,e),lc(this,{values:e},!0)}rescale(){if(!this.isValid)return this;return lc(this,{values:function(e){const t={};for(const[n,r]of Object.entries(e))0!==r&&(t[n]=r);return t}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...e){if(!this.isValid)return this;if(0===e.length)return this;e=e.map((e=>dc.normalizeUnit(e)));const t={},n={},r=this.toObject();let s;for(const o of ac)if(e.indexOf(o)>=0){s=o;let e=0;for(const t in n)e+=this.matrix[t][o]*n[t],n[t]=0;Bi(r[o])&&(e+=r[o]);const i=Math.trunc(e);t[o]=i,n[o]=(1e3*e-1e3*i)/1e3}else Bi(r[o])&&(n[o]=r[o]);for(const e in n)0!==n[e]&&(t[s]+=e===s?n[e]:n[e]/this.matrix[s][e]);return fc(this.matrix,t),lc(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=0===this.values[t]?0:-this.values[t];return lc(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(const r of ac)if(t=this.values[r],n=e.values[r],!(void 0===t||0===t?void 0===n||0===n:t===n))return!1;var t,n;return!0}}const pc="Invalid Interval";class hc{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new Eo("need to specify a reason the Interval is invalid");const n=e instanceof pa?e:new pa(e,t);if(Ci.throwOnInvalid)throw new vo(n);return new hc({invalid:n})}static fromDateTimes(e,t){const n=Al(e),r=Al(t),s=function(e,t){return e&&e.isValid?t&&t.isValid?t<e?hc.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null:hc.invalid("missing or invalid end"):hc.invalid("missing or invalid start")}(n,r);return null==s?new hc({start:n,end:r}):s}static after(e,t){const n=dc.fromDurationLike(t),r=Al(e);return hc.fromDateTimes(r,r.plus(n))}static before(e,t){const n=dc.fromDurationLike(t),r=Al(e);return hc.fromDateTimes(r.minus(n),r)}static fromISO(e,t){const[n,r]=(e||"").split("/",2);if(n&&r){let e,s,o,i;try{e=gl.fromISO(n,t),s=e.isValid}catch(r){s=!1}try{o=gl.fromISO(r,t),i=o.isValid}catch(r){i=!1}if(s&&i)return hc.fromDateTimes(e,o);if(s){const n=dc.fromISO(r,t);if(n.isValid)return hc.after(e,n)}else if(i){const e=dc.fromISO(n,t);if(e.isValid)return hc.before(o,e)}}return hc.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(t,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return!!this.isValid&&this.s>e}isBefore(e){return!!this.isValid&&this.e<=e}contains(e){return!!this.isValid&&(this.s<=e&&this.e>e)}set({start:e,end:t}={}){return this.isValid?hc.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Al).filter((e=>this.contains(e))).sort(),n=[];let{s:r}=this,s=0;for(;r<this.e;){const e=t[s]||this.e,o=+e>+this.e?this.e:e;n.push(hc.fromDateTimes(r,o)),r=o,s+=1}return n}splitBy(e){const t=dc.fromDurationLike(e);if(!this.isValid||!t.isValid||0===t.as("milliseconds"))return[];let n,{s:r}=this,s=1;const o=[];for(;r<this.e;){const e=this.start.plus(t.mapUnits((e=>e*s)));n=+e>+this.e?this.e:e,o.push(hc.fromDateTimes(r,n)),r=n,s+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return!!this.isValid&&+this.e==+e.s}abutsEnd(e){return!!this.isValid&&+e.e==+this.s}engulfs(e){return!!this.isValid&&(this.s<=e.s&&this.e>=e.e)}equals(e){return!(!this.isValid||!e.isValid)&&(this.s.equals(e.s)&&this.e.equals(e.e))}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return t>=n?null:hc.fromDateTimes(t,n)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return hc.fromDateTimes(t,n)}static merge(e){const[t,n]=e.sort(((e,t)=>e.s-t.s)).reduce((([e,t],n)=>t?t.overlaps(n)||t.abutsStart(n)?[e,t.union(n)]:[e.concat([t]),n]:[e,n]),[[],null]);return n&&t.push(n),t}static xor(e){let t=null,n=0;const r=[],s=e.map((e=>[{time:e.s,type:"s"},{time:e.e,type:"e"}])),o=Array.prototype.concat(...s).sort(((e,t)=>e.time-t.time));for(const e of o)n+="s"===e.type?1:-1,1===n?t=e.time:(t&&+t!=+e.time&&r.push(hc.fromDateTimes(t,e.time)),t=null);return hc.merge(r)}difference(...e){return hc.xor([this].concat(e)).map((e=>this.intersection(e))).filter((e=>e&&!e.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:pc}toLocaleString(e=Mo,t={}){return this.isValid?da.create(this.s.loc.clone(t),e).formatInterval(this):pc}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:pc}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:pc}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:pc}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:pc}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):dc.invalid(this.invalidReason)}mapEndpoints(e){return hc.fromDateTimes(e(this.s),e(this.e))}}class mc{static hasDST(e=Ci.defaultZone){const t=gl.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return ri.isValidZone(e)}static normalizeZone(e){return Ai(e,Ci.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||hi.create(t,n,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||hi.create(t,n,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null}={}){return(r||hi.create(t,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null}={}){return(r||hi.create(t,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return hi.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return hi.create(t,null,"gregory").eras(e)}static features(){return{relative:Ni()}}}function yc(e,t){const n=e=>e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(t)-n(e);return Math.floor(dc.fromMillis(r).as("days"))}function gc(e,t,n,r){let[s,o,i,a]=function(e,t,n){const r=[["years",(e,t)=>t.year-e.year],["quarters",(e,t)=>t.quarter-e.quarter+4*(t.year-e.year)],["months",(e,t)=>t.month-e.month+12*(t.year-e.year)],["weeks",(e,t)=>{const n=yc(e,t);return(n-n%7)/7}],["days",yc]],s={},o=e;let i,a;for(const[c,l]of r)n.indexOf(c)>=0&&(i=c,s[c]=l(e,t),a=o.plus(s),a>t?(s[c]--,(e=o.plus(s))>t&&(a=e,s[c]--,e=o.plus(s))):e=a);return[e,s,a,i]}(e,t,n);const c=t-s,l=n.filter((e=>["hours","minutes","seconds","milliseconds"].indexOf(e)>=0));0===l.length&&(i<t&&(i=s.plus({[a]:1})),i!==s&&(o[a]=(o[a]||0)+c/(i-s)));const u=dc.fromObject(o,r);return l.length>0?dc.fromMillis(c,r).shiftTo(...l).plus(u):u}const Ac={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},_c={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},vc=Ac.hanidec.replace(/[\[|\]]/g,"").split("");function bc({numberingSystem:e},t=""){return new RegExp(`${Ac[e||"latn"]}${t}`)}const xc="missing Intl.DateTimeFormat.formatToParts support";function wc(e,t=(e=>e)){return{regex:e,deser:([e])=>t(function(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);if(-1!==e[n].search(Ac.hanidec))t+=vc.indexOf(e[n]);else for(const e in _c){const[n,s]=_c[e];r>=n&&r<=s&&(t+=r-n)}}return parseInt(t,10)}return t}(e))}}const Ec=`[ ${String.fromCharCode(160)}]`,kc=new RegExp(Ec,"g");function Cc(e){return e.replace(/\./g,"\\.?").replace(kc,Ec)}function $c(e){return e.replace(/\./g,"").replace(kc," ").toLowerCase()}function Bc(e,t){return null===e?null:{regex:RegExp(e.map(Cc).join("|")),deser:([n])=>e.findIndex((e=>$c(n)===$c(e)))+t}}function Mc(e,t){return{regex:e,deser:([,e,t])=>Hi(e,t),groups:t}}function Nc(e){return{regex:e,deser:([e])=>e}}const Ic={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let Tc=null;function Sc(e,t){return Array.prototype.concat(...e.map((e=>function(e,t){if(e.literal)return e;const n=Fc(da.macroTokenToFormatOpts(e.val),t);return null==n||n.includes(void 0)?e:n}(e,t))))}function Oc(e,t,n){const r=Sc(da.parseFormat(n),e),s=r.map((t=>function(e,t){const n=bc(t),r=bc(t,"{2}"),s=bc(t,"{3}"),o=bc(t,"{4}"),i=bc(t,"{6}"),a=bc(t,"{1,2}"),c=bc(t,"{1,3}"),l=bc(t,"{1,6}"),u=bc(t,"{1,9}"),f=bc(t,"{2,4}"),d=bc(t,"{4,6}"),p=e=>{return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([e])=>e,literal:!0};var t},h=(h=>{if(e.literal)return p(h);switch(h.val){case"G":return Bc(t.eras("short"),0);case"GG":return Bc(t.eras("long"),0);case"y":return wc(l);case"yy":case"kk":return wc(f,zi);case"yyyy":case"kkkk":return wc(o);case"yyyyy":return wc(d);case"yyyyyy":return wc(i);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return wc(a);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return wc(r);case"MMM":return Bc(t.months("short",!0),1);case"MMMM":return Bc(t.months("long",!0),1);case"LLL":return Bc(t.months("short",!1),1);case"LLLL":return Bc(t.months("long",!1),1);case"o":case"S":return wc(c);case"ooo":case"SSS":return wc(s);case"u":return Nc(u);case"uu":return Nc(a);case"uuu":case"E":case"c":return wc(n);case"a":return Bc(t.meridiems(),0);case"EEE":return Bc(t.weekdays("short",!1),1);case"EEEE":return Bc(t.weekdays("long",!1),1);case"ccc":return Bc(t.weekdays("short",!0),1);case"cccc":return Bc(t.weekdays("long",!0),1);case"Z":case"ZZ":return Mc(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return Mc(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return Nc(/[a-z_+-/]{1,256}?/i);case" ":return Nc(/[^\S\n\r]/);default:return p(h)}})(e)||{invalidReason:xc};return h.token=e,h}(t,e))),o=s.find((e=>e.invalidReason));if(o)return{input:t,tokens:r,invalidReason:o.invalidReason};{const[e,n]=function(e){return[`^${e.map((e=>e.regex)).reduce(((e,t)=>`${e}(${t.source})`),"")}$`,e]}(s),o=RegExp(e,"i"),[i,a]=function(e,t,n){const r=e.match(t);if(r){const e={};let t=1;for(const s in n)if(Ti(n,s)){const o=n[s],i=o.groups?o.groups+1:1;!o.literal&&o.token&&(e[o.token.val[0]]=o.deser(r.slice(t,t+i))),t+=i}return[r,e]}return[r,{}]}(t,o,n),[c,l,u]=a?function(e){let t,n=null;return $i(e.z)||(n=ri.create(e.z)),$i(e.Z)||(n||(n=new yi(e.Z)),t=e.Z),$i(e.q)||(e.M=3*(e.q-1)+1),$i(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),$i(e.u)||(e.S=Di(e.u)),[Object.keys(e).reduce(((t,n)=>{const r=(e=>{switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(n);return r&&(t[r]=e[n]),t}),{}),n,t]}(a):[null,null,void 0];if(Ti(a,"a")&&Ti(a,"H"))throw new xo("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:r,regex:o,rawMatches:i,matches:a,result:c,zone:l,specificOffset:u}}}function Fc(e,t){if(!e)return null;const n=da.create(t,e).dtFormatter((Tc||(Tc=gl.fromMillis(1555555555555)),Tc)),r=n.formatToParts(),s=n.resolvedOptions();return r.map((t=>function(e,t,n){const{type:r,value:s}=e;if("literal"===r){const e=/^\s+$/.test(s);return{literal:!e,val:e?" ":s}}const o=t[r];let i=r;"hour"===r&&(i=null!=t.hour12?t.hour12?"hour12":"hour24":null!=t.hourCycle?"h11"===t.hourCycle||"h12"===t.hourCycle?"hour12":"hour24":n.hour12?"hour12":"hour24");let a=Ic[i];if("object"==typeof a&&(a=a[o]),a)return{literal:!1,val:a}}(t,e,s)))}const Rc=[0,31,59,90,120,151,181,212,243,273,304,334],Dc=[0,31,60,91,121,152,182,213,244,274,305,335];function Uc(e,t){return new pa("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function Lc(e,t,n){const r=new Date(Date.UTC(e,t-1,n));e<100&&e>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const s=r.getUTCDay();return 0===s?7:s}function Qc(e,t,n){return n+(Li(e)?Dc:Rc)[t-1]}function jc(e,t){const n=Li(e)?Dc:Rc,r=n.findIndex((e=>e<t));return{month:r+1,day:t-n[r]}}function Pc(e){const{year:t,month:n,day:r}=e,s=Qc(t,n,r),o=Lc(t,n,r);let i,a=Math.floor((s-o+10)/7);return a<1?(i=t-1,a=Yi(i)):a>Yi(t)?(i=t+1,a=1):i=t,{weekYear:i,weekNumber:a,weekday:o,...Wi(e)}}function Yc(e){const{weekYear:t,weekNumber:n,weekday:r}=e,s=Lc(t,1,4),o=Qi(t);let i,a=7*n+r-s-3;a<1?(i=t-1,a+=Qi(i)):a>o?(i=t+1,a-=Qi(t)):i=t;const{month:c,day:l}=jc(i,a);return{year:i,month:c,day:l,...Wi(e)}}function zc(e){const{year:t,month:n,day:r}=e;return{year:t,ordinal:Qc(t,n,r),...Wi(e)}}function Vc(e){const{year:t,ordinal:n}=e,{month:r,day:s}=jc(t,n);return{year:t,month:r,day:s,...Wi(e)}}function Hc(e){const t=Mi(e.year),n=Si(e.month,1,12),r=Si(e.day,1,ji(e.year,e.month));return t?n?!r&&Uc("day",e.day):Uc("month",e.month):Uc("year",e.year)}function Gc(e){const{hour:t,minute:n,second:r,millisecond:s}=e,o=Si(t,0,23)||24===t&&0===n&&0===r&&0===s,i=Si(n,0,59),a=Si(r,0,59),c=Si(s,0,999);return o?i?a?!c&&Uc("millisecond",s):Uc("second",r):Uc("minute",n):Uc("hour",t)}const qc="Invalid DateTime",Jc=864e13;function Wc(e){return new pa("unsupported zone",`the zone "${e.name}" is not supported`)}function Kc(e){return null===e.weekData&&(e.weekData=Pc(e.c)),e.weekData}function Xc(e,t){const n={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new gl({...n,...t,old:n})}function Zc(e,t,n){let r=e-60*t*1e3;const s=n.offset(r);if(t===s)return[r,t];r-=60*(s-t)*1e3;const o=n.offset(r);return s===o?[r,s]:[e-60*Math.min(s,o)*1e3,Math.max(s,o)]}function el(e,t){const n=new Date(e+=60*t*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function tl(e,t,n){return Zc(Pi(e),t,n)}function nl(e,t){const n=e.o,r=e.c.year+Math.trunc(t.years),s=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),o={...e.c,year:r,month:s,day:Math.min(e.c.day,ji(r,s))+Math.trunc(t.days)+7*Math.trunc(t.weeks)},i=dc.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=Pi(o);let[c,l]=Zc(a,n,e.zone);return 0!==i&&(c+=i,l=e.zone.offset(c)),{ts:c,o:l}}function rl(e,t,n,r,s,o){const{setZone:i,zone:a}=n;if(e&&0!==Object.keys(e).length||t){const r=t||a,s=gl.fromObject(e,{...n,zone:r,specificOffset:o});return i?s:s.setZone(a)}return gl.invalid(new pa("unparsable",`the input "${s}" can't be parsed as ${r}`))}function sl(e,t,n=!0){return e.isValid?da.create(hi.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(e,t):null}function ol(e,t){const n=e.c.year>9999||e.c.year<0;let r="";return n&&e.c.year>=0&&(r+="+"),r+=Oi(e.c.year,n?6:4),t?(r+="-",r+=Oi(e.c.month),r+="-",r+=Oi(e.c.day)):(r+=Oi(e.c.month),r+=Oi(e.c.day)),r}function il(e,t,n,r,s,o){let i=Oi(e.c.hour);return t?(i+=":",i+=Oi(e.c.minute),0===e.c.millisecond&&0===e.c.second&&n||(i+=":")):i+=Oi(e.c.minute),0===e.c.millisecond&&0===e.c.second&&n||(i+=Oi(e.c.second),0===e.c.millisecond&&r||(i+=".",i+=Oi(e.c.millisecond,3))),s&&(e.isOffsetFixed&&0===e.offset&&!o?i+="Z":e.o<0?(i+="-",i+=Oi(Math.trunc(-e.o/60)),i+=":",i+=Oi(Math.trunc(-e.o%60))):(i+="+",i+=Oi(Math.trunc(e.o/60)),i+=":",i+=Oi(Math.trunc(e.o%60)))),o&&(i+="["+e.zone.ianaName+"]"),i}const al={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},cl={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ll={ordinal:1,hour:0,minute:0,second:0,millisecond:0},ul=["year","month","day","hour","minute","second","millisecond"],fl=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],dl=["year","ordinal","hour","minute","second","millisecond"];function pl(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new wo(e);return t}function hl(e,t){const n=Ai(t.zone,Ci.defaultZone),r=hi.fromObject(t),s=Ci.now();let o,i;if($i(e.year))o=s;else{for(const t of ul)$i(e[t])&&(e[t]=al[t]);const t=Hc(e)||Gc(e);if(t)return gl.invalid(t);const r=n.offset(s);[o,i]=tl(e,r,n)}return new gl({ts:o,zone:n,loc:r,o:i})}function ml(e,t,n){const r=!!$i(n.round)||n.round,s=(e,s)=>{e=Ui(e,r||n.calendary?0:2,!0);return t.loc.clone(n).relFormatter(n).format(e,s)},o=r=>n.calendary?t.hasSame(e,r)?0:t.startOf(r).diff(e.startOf(r),r).get(r):t.diff(e,r).get(r);if(n.unit)return s(o(n.unit),n.unit);for(const e of n.units){const t=o(e);if(Math.abs(t)>=1)return s(t,e)}return s(e>t?-0:0,n.units[n.units.length-1])}function yl(e){let t,n={};return e.length>0&&"object"==typeof e[e.length-1]?(n=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[n,t]}class gl{constructor(e){const t=e.zone||Ci.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new pa("invalid input"):null)||(t.isValid?null:Wc(t));this.ts=$i(e.ts)?Ci.now():e.ts;let r=null,s=null;if(!n){if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[r,s]=[e.old.c,e.old.o];else{const e=t.offset(this.ts);r=el(this.ts,e),n=Number.isNaN(r.year)?new pa("invalid input"):null,r=n?null:r,s=n?null:e}}this._zone=t,this.loc=e.loc||hi.create(),this.invalid=n,this.weekData=null,this.c=r,this.o=s,this.isLuxonDateTime=!0}static now(){return new gl({})}static local(){const[e,t]=yl(arguments),[n,r,s,o,i,a,c]=t;return hl({year:n,month:r,day:s,hour:o,minute:i,second:a,millisecond:c},e)}static utc(){const[e,t]=yl(arguments),[n,r,s,o,i,a,c]=t;return e.zone=yi.utcInstance,hl({year:n,month:r,day:s,hour:o,minute:i,second:a,millisecond:c},e)}static fromJSDate(e,t={}){const n=(r=e,"[object Date]"===Object.prototype.toString.call(r)?e.valueOf():NaN);var r;if(Number.isNaN(n))return gl.invalid("invalid input");const s=Ai(t.zone,Ci.defaultZone);return s.isValid?new gl({ts:n,zone:s,loc:hi.fromObject(t)}):gl.invalid(Wc(s))}static fromMillis(e,t={}){if(Bi(e))return e<-Jc||e>Jc?gl.invalid("Timestamp out of range"):new gl({ts:e,zone:Ai(t.zone,Ci.defaultZone),loc:hi.fromObject(t)});throw new Eo(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(Bi(e))return new gl({ts:1e3*e,zone:Ai(t.zone,Ci.defaultZone),loc:hi.fromObject(t)});throw new Eo("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const n=Ai(t.zone,Ci.defaultZone);if(!n.isValid)return gl.invalid(Wc(n));const r=Ci.now(),s=$i(t.specificOffset)?n.offset(r):t.specificOffset,o=qi(e,pl),i=!$i(o.ordinal),a=!$i(o.year),c=!$i(o.month)||!$i(o.day),l=a||c,u=o.weekYear||o.weekNumber,f=hi.fromObject(t);if((l||i)&&u)throw new xo("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&i)throw new xo("Can't mix ordinal dates with month/day");const d=u||o.weekday&&!l;let p,h,m=el(r,s);d?(p=fl,h=cl,m=Pc(m)):i?(p=dl,h=ll,m=zc(m)):(p=ul,h=al);let y=!1;for(const e of p){$i(o[e])?o[e]=y?h[e]:m[e]:y=!0}const g=d?function(e){const t=Mi(e.weekYear),n=Si(e.weekNumber,1,Yi(e.weekYear)),r=Si(e.weekday,1,7);return t?n?!r&&Uc("weekday",e.weekday):Uc("week",e.week):Uc("weekYear",e.weekYear)}(o):i?function(e){const t=Mi(e.year),n=Si(e.ordinal,1,Qi(e.year));return t?!n&&Uc("ordinal",e.ordinal):Uc("year",e.year)}(o):Hc(o),A=g||Gc(o);if(A)return gl.invalid(A);const _=d?Yc(o):i?Vc(o):o,[v,b]=tl(_,s,n),x=new gl({ts:v,zone:n,o:b,loc:f});return o.weekday&&l&&e.weekday!==x.weekday?gl.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${x.toISO()}`):x}static fromISO(e,t={}){const[n,r]=function(e){return ga(e,[Ya,Ga],[za,qa],[Va,Ja],[Ha,Wa])}(e);return rl(n,r,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[n,r]=function(e){return ga(function(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[Ra,Da])}(e);return rl(n,r,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[n,r]=function(e){return ga(e,[Ua,ja],[La,ja],[Qa,Pa])}(e);return rl(n,r,t,"HTTP",t)}static fromFormat(e,t,n={}){if($i(e)||$i(t))throw new Eo("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:s=null}=n,o=hi.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),[i,a,c,l]=function(e,t,n){const{result:r,zone:s,specificOffset:o,invalidReason:i}=Oc(e,t,n);return[r,s,o,i]}(o,e,t);return l?gl.invalid(l):rl(i,a,n,`format ${t}`,e,c)}static fromString(e,t,n={}){return gl.fromFormat(e,t,n)}static fromSQL(e,t={}){const[n,r]=function(e){return ga(e,[Xa,Ga],[Za,ec])}(e);return rl(n,r,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new Eo("need to specify a reason the DateTime is invalid");const n=e instanceof pa?e:new pa(e,t);if(Ci.throwOnInvalid)throw new _o(n);return new gl({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const n=Fc(e,hi.fromObject(t));return n?n.map((e=>e?e.val:null)).join(""):null}static expandFormat(e,t={}){return Sc(da.parseFormat(e),hi.fromObject(t)).map((e=>e.val)).join("")}get(e){return this[e]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Kc(this).weekYear:NaN}get weekNumber(){return this.isValid?Kc(this).weekNumber:NaN}get weekday(){return this.isValid?Kc(this).weekday:NaN}get ordinal(){return this.isValid?zc(this.c).ordinal:NaN}get monthShort(){return this.isValid?mc.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?mc.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?mc.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?mc.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,n=Pi(this.c),r=this.zone.offset(n-e),s=this.zone.offset(n+e),o=this.zone.offset(n-r*t),i=this.zone.offset(n-s*t);if(o===i)return[this];const a=n-o*t,c=n-i*t,l=el(a,o),u=el(c,i);return l.hour===u.hour&&l.minute===u.minute&&l.second===u.second&&l.millisecond===u.millisecond?[Xc(this,{ts:a}),Xc(this,{ts:c})]:[this]}get isInLeapYear(){return Li(this.year)}get daysInMonth(){return ji(this.year,this.month)}get daysInYear(){return this.isValid?Qi(this.year):NaN}get weeksInWeekYear(){return this.isValid?Yi(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:n,calendar:r}=da.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:n,outputCalendar:r}}toUTC(e=0,t={}){return this.setZone(yi.instance(e),t)}toLocal(){return this.setZone(Ci.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:n=!1}={}){if((e=Ai(e,Ci.defaultZone)).equals(this.zone))return this;if(e.isValid){let r=this.ts;if(t||n){const t=e.offset(this.ts),n=this.toObject();[r]=tl(n,t,e)}return Xc(this,{ts:r,zone:e})}return gl.invalid(Wc(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:n}={}){return Xc(this,{loc:this.loc.clone({locale:e,numberingSystem:t,outputCalendar:n})})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=qi(e,pl),n=!$i(t.weekYear)||!$i(t.weekNumber)||!$i(t.weekday),r=!$i(t.ordinal),s=!$i(t.year),o=!$i(t.month)||!$i(t.day),i=s||o,a=t.weekYear||t.weekNumber;if((i||r)&&a)throw new xo("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&r)throw new xo("Can't mix ordinal dates with month/day");let c;n?c=Yc({...Pc(this.c),...t}):$i(t.ordinal)?(c={...this.toObject(),...t},$i(t.day)&&(c.day=Math.min(ji(c.year,c.month),c.day))):c=Vc({...zc(this.c),...t});const[l,u]=tl(c,this.o,this.zone);return Xc(this,{ts:l,o:u})}plus(e){if(!this.isValid)return this;return Xc(this,nl(this,dc.fromDurationLike(e)))}minus(e){if(!this.isValid)return this;return Xc(this,nl(this,dc.fromDurationLike(e).negate()))}startOf(e){if(!this.isValid)return this;const t={},n=dc.normalizeUnit(e);switch(n){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===n&&(t.weekday=1),"quarters"===n){const e=Math.ceil(this.month/3);t.month=3*(e-1)+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?da.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):qc}toLocaleString(e=Mo,t={}){return this.isValid?da.create(this.loc.clone(t),e).formatDateTime(this):qc}toLocaleParts(e={}){return this.isValid?da.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:n=!1,includeOffset:r=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o="extended"===e;let i=ol(this,o);return i+="T",i+=il(this,o,t,n,r,s),i}toISODate({format:e="extended"}={}){return this.isValid?ol(this,"extended"===e):null}toISOWeekDate(){return sl(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:n=!0,includePrefix:r=!1,extendedZone:s=!1,format:o="extended"}={}){if(!this.isValid)return null;return(r?"T":"")+il(this,"extended"===o,t,e,n,s)}toRFC2822(){return sl(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return sl(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?ol(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:n=!0}={}){let r="HH:mm:ss.SSS";return(t||e)&&(n&&(r+=" "),t?r+="z":e&&(r+="ZZ")),sl(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():qc}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",n={}){if(!this.isValid||!e.isValid)return dc.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=(a=t,Array.isArray(a)?a:[a]).map(dc.normalizeUnit),o=e.valueOf()>this.valueOf(),i=gc(o?this:e,o?e:this,s,r);var a;return o?i.negate():i}diffNow(e="milliseconds",t={}){return this.diff(gl.now(),e,t)}until(e){return this.isValid?hc.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const n=e.valueOf(),r=this.setZone(e.zone,{keepLocalTime:!0});return r.startOf(t)<=n&&n<=r.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||gl.fromObject({},{zone:this.zone}),n=e.padding?this<t?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(r=e.unit,s=void 0),ml(t,this.plus(n),{...e,numeric:"always",units:r,unit:s})}toRelativeCalendar(e={}){return this.isValid?ml(e.base||gl.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(gl.isDateTime))throw new Eo("min requires all arguments be DateTimes");return Ii(e,(e=>e.valueOf()),Math.min)}static max(...e){if(!e.every(gl.isDateTime))throw new Eo("max requires all arguments be DateTimes");return Ii(e,(e=>e.valueOf()),Math.max)}static fromFormatExplain(e,t,n={}){const{locale:r=null,numberingSystem:s=null}=n;return Oc(hi.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),e,t)}static fromStringExplain(e,t,n={}){return gl.fromFormatExplain(e,t,n)}static get DATE_SHORT(){return Mo}static get DATE_MED(){return No}static get DATE_MED_WITH_WEEKDAY(){return Io}static get DATE_FULL(){return To}static get DATE_HUGE(){return So}static get TIME_SIMPLE(){return Oo}static get TIME_WITH_SECONDS(){return Fo}static get TIME_WITH_SHORT_OFFSET(){return Ro}static get TIME_WITH_LONG_OFFSET(){return Do}static get TIME_24_SIMPLE(){return Uo}static get TIME_24_WITH_SECONDS(){return Lo}static get TIME_24_WITH_SHORT_OFFSET(){return Qo}static get TIME_24_WITH_LONG_OFFSET(){return jo}static get DATETIME_SHORT(){return Po}static get DATETIME_SHORT_WITH_SECONDS(){return Yo}static get DATETIME_MED(){return zo}static get DATETIME_MED_WITH_SECONDS(){return Vo}static get DATETIME_MED_WITH_WEEKDAY(){return Ho}static get DATETIME_FULL(){return Go}static get DATETIME_FULL_WITH_SECONDS(){return qo}static get DATETIME_HUGE(){return Jo}static get DATETIME_HUGE_WITH_SECONDS(){return Wo}}function Al(e){if(gl.isDateTime(e))return e;if(e&&e.valueOf&&Bi(e.valueOf()))return gl.fromJSDate(e);if(e&&"object"==typeof e)return gl.fromObject(e);throw new Eo(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const _l=qe().getLogger("atf");function vl(e,t){if(!e){throw new Error(t?"Assertion failure: "+t:"Assertion failure")}}function bl(){return Math.floor(1e5*Math.random())+""}function xl(e){_l.log("utils.getPathMenuItems()",e),vl(Array.isArray(e),`path parameter must be an Array: ${e}`);let t=[],n=[];for(let r of e){n.push(r);let e=wl(po.exMenu,n);t.push({id:e.id,desc:e.desc,module:Boolean(e.module),allFree:Boolean(e.allFree)})}return t}function wl(e,t){_l.log("utils.getMenuItemAtPath()",e,t),vl(Array.isArray(e),"menu parameter must be an Array: "+e),vl(Array.isArray(t),"path parameter must be an Array: "+t),vl(t.length>0,`path must be at least ['root']: ${t}`);let n=[...t],r=e.find((e=>e.id==n[0]));return r?1==n.length?r:wl(r.children,n.slice(1)):null}function El(e,t){_l.log("utils.getRandomKeyHist()",e,t);let n=Il(t),r=Object.keys(e);if(r.length<1)throw"Cannot select a key from an empty object";let s=go().difference(r,n);return s.length<1?null:s[Math.floor(Math.random()*s.length)]}function kl(e){let t=e[Math.floor(Math.random()*e.length)];return Array.isArray(t)&&(t=kl(t)),t}function Cl(e,t){for(let n of Object.keys(t))if(t[n]==e)return!0;return!1}function $l(e){let t={};for(let n of Object.keys(e)){let r=e[n],s=kl(r),o=0;for(;Cl(s,t);)if(s=kl(r),o++,o>100)throw"Could not get question";t[n]=s}return t}function Bl(e,t){_l.log("utils.getPartsObj()",e,t),vl(t.length>0,"path too short");var n=e;for(let e=1;e<t.length;e++)if(!(n=n[t[e]]))return"NO_DATA";return go().isEmpty(n)?"NO_DATA":(_l.log("getPartsObj ==> ",n),n)}function Ml(e,t,n){let r;if(_l.log(`utils.getExPartInfo(${JSON.stringify(e)}, '${t}', '${n}')`),n)r=mo().byType[n];else{let n=mo().byPath,s=e;for(let e=1;e<s.length;e++)n=n[s[e]];r=n[t]}return r}function Nl(){let e;_l.log("utils.getHistObj()");let t=localStorage.getItem("hist");try{e=JSON.parse(t),e||(e={},localStorage.setItem("hist","{}"))}catch(t){e={},localStorage.setItem("hist","{}")}return e}function Il(e){_l.log("utils.getHistArr()",e);let t=e.slice(1),n=Nl();return go().get(n,t)||[]}function Tl(e,t){_l.log("utils.setHistArr()",e,t);let n=e.slice(1),r=Nl();go().setWith(r,n,t,Object),localStorage.setItem("hist",JSON.stringify(r))}function Sl(e,t){_l.log("utils.resetHistArr()",e,t),vl(e.length>1,e);let n=Il(e);n=go().difference(n,t),Tl(e,n)}vl.ok=vl;const Ol={assert:vl,delay:function(e){return new Promise((t=>setTimeout(t,e)))},validatePath:function e(t,n){if(_l.log("utils.validatePath()",n),n.length>1){return wl(t,n)?[...n]:e(t,n.slice(0,-1))}return[...n]},hasFullAccess:function(e){let t=!1;if(e.loggedIn)if(e.fullAccessUntil&&gl.fromISO(e.fullAccessUntil).diff(gl.utc(),"minutes").minutes>0)t=!0;else if(e.subs.length>0){gl.fromISO(e.subs[e.subs.length-1].next_billing_time).diff(gl.utc(),"minutes").minutes>0&&(t=!0)}return t},getPathId:function(e){let t=xl(e),n="";for(let e=1;e<t.length;e++)n+=t[e].id;return n},getPathModuleId:function(e){_l.log("utils.getPathModuleId()",e);let t=xl(e),n="NONE",r="";for(let e=1;e<t.length;e++){let s=t[e];if(r+=t[e].id,s.module){n=r;break}}return n},isPathModuleAllFree:function(e){_l.log("utils.isPathModuleAllFree()",e);let t=xl(e),n=!1;for(let e=1;e<t.length;e++){if(t[e].allFree){n=!0;break}}return n},getMenuItemAtPath:wl,getPathMenuItems:xl,getNextExSpec:function(e,t,n){_l.log("utils.getNextExSpec()",e,t,n);let r=Bl(e,t);if("NO_DATA"==r)return _l.log("partsObj",r),null;let s=wl(po.exMenu,t),o={};for(const[e,t]of Object.entries(r))o[e]=Object.keys(t);let i=Object.keys(o),a={parts_ex_id:{}};if(s.order)for(let e=0;e<i.length;e++){let t=i[e];if(0==e){let e=0;if(n){let r=o[t].indexOf(n.parts_ex_id[t]);r>-1&&(e=++r%o[t].length)}a.parts_ex_id[t]=o[t][e]}else if(s.link&&s.link.hasOwnProperty(t)){let e=s.link[t],i=0;if(e){let n=a.parts_ex_id[e];n&&r[t][n]&&(i=n)}else{if(n){let e=o[t].indexOf(n.parts_ex_id[t]);e>-1&&(i=++e%o[t].length)}a.parts_ex_id[t]=o[t][i]}a.parts_ex_id[t]=i}else{let e=a.parts_ex_id[i[0]];o[t].indexOf(e)>-1&&(a.parts_ex_id[t]=e)}}else{let e=new Set;for(let n=0;n<i.length;n++){let c=i[n];if(go().isEmpty(r[c]))return null;if(0==n){let n=El(r[c],t);n||(a.end=!0,Sl(t,Object.keys(r[c])),n=El(r[c],t)),a.parts_ex_id[c]=n,e.add(n)}else if(s.link&&s.link.hasOwnProperty(c)){let n=s.link[c];if(n){let e=a.parts_ex_id[n];if(!e||!r[c][e])throw`Cannot link ${c} to ${n} for exercise ${e}`;a.parts_ex_id[c]=e}else{let n=El(r[c],t);n||(a.end=!0,Sl(t,Object.keys(r[c])),n=El(r[c],t)),a.parts_ex_id[c]=n,e.add(n)}}else{let e=a.parts_ex_id[i[0]];if(!(o[c].indexOf(e)>-1))throw`Part ${c} does not have ${e}\n              corresponding to ${i[0]}`;a.parts_ex_id[c]=e}}!function(e,t){_l.log("utils.updateHist()",e,t);let n=Il(e);n=n.concat(Array.from(t)),Tl(e,n)}(t,e)}a.parts_qkeys={};for(let e of Object.keys(a.parts_ex_id)){let n=a.parts_ex_id[e],s=Ml(t,e,r[e][n].xi);s.qkeys&&(a.parts_qkeys[e]=$l(s.qkeys))}a.parts_qa_idx={};for(let e of Object.keys(a.parts_qkeys)){let t=a.parts_qkeys[e],n=a.parts_ex_id[e];for(let s of Object.keys(t)){let o=r[e][n].questions[t[s]];a.parts_qa_idx[e]=a.parts_qa_idx[e]||{},a.parts_qa_idx[e][s]=Math.floor(Math.random()*o.length)}}return a},getExPartInfo:Ml,getPartsObj:Bl,getHelpTransitionStyle:function(e){let t="position:absolute;right:0;top:0;overflow:hidden;";return t+=`opacity:${e?"1":"0"};`,t+=`visibility:${e?"visible":"hidden"};`,t+=`transition:all ${e?1.2:.5}s;`,t},chunkSubstr:function(e,t){const n=Math.ceil(e.length/t),r=new Array(n);for(let s=0,o=0;s<n;++s,o+=t)r[s]=e.substr(o,t);return r},getSysMsg:function(e){const t={id:bl(),type:"danger",msg:"Error",duration:7e3,autoclose:!0,countdown:!1,dismissible:!0};return e&&"DEF"==e.duration&&(e.duration=7e3),Object.assign({},t,e)},getRandomId:bl},Fl=(qe().getLogger("atf"),Xe(Ol.validatePath(po.exMenu,["root"]))),Rl=Xe({});const Dl=Xe({loadedFreeModules:{},loadedNonFreeModules:{},exSpec:null,partIdx:0}),Ul=Xe({initApp:!0,soundfonts:!0,data:[],login:!1}),Ll=Xe({currPage:"home",currSubPage:"",enableHelp:!1,hideAppMenu:!1,choices:"",volume:50,loggedIn:!1,sysMsgs:[],email:"",subs:[],fullAccessUntil:null});function Ql(t){let n,r,s;return n=new hr({props:{data:_r}}),{c(){Pe(n.$$.fragment),r=Q()},m(e,t){Ye(n,e,t),O(e,r,t),s=!0},p:e,i(e){s||(Te(n.$$.fragment,e),s=!0)},o(e){Se(n.$$.fragment,e),s=!1},d(e){ze(n,e),e&&F(r)}}}function jl(e){let t;return{c(){t=L("Exercises")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Pl(e){let t,n,r;return t=new Rt({props:{color:Hl,class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",outline:"home"!=e[0].currPage,$$slots:{default:[Ql]},$$scope:{ctx:e}}}),t.$on("click",e[4]),n=new Rt({props:{color:Hl,class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",outline:"exercises"!=e[0].currPage,$$slots:{default:[jl]},$$scope:{ctx:e}}}),n.$on("click",e[3]),{c(){Pe(t.$$.fragment),Pe(n.$$.fragment)},m(e,s){Ye(t,e,s),Ye(n,e,s),r=!0},p(e,r){const s={};1&r&&(s.outline="home"!=e[0].currPage),4096&r&&(s.$$scope={dirty:r,ctx:e}),t.$set(s);const o={};1&r&&(o.outline="exercises"!=e[0].currPage),4096&r&&(o.$$scope={dirty:r,ctx:e}),n.$set(o)},i(e){r||(Te(t.$$.fragment,e),Te(n.$$.fragment,e),r=!0)},o(e){Se(t.$$.fragment,e),Se(n.$$.fragment,e),r=!1},d(e){ze(t,e),ze(n,e)}}}function Yl(e){let t,n,r,s;t=new Vt({props:{class:"me-auto px-0",$$slots:{default:[Pl]},$$scope:{ctx:e}}});let o=!1;return{c(){Pe(t.$$.fragment),n=Q(),o&&o.c(),r=j()},m(e,i){Ye(t,e,i),O(e,n,i),o&&o.m(e,i),O(e,r,i),s=!0},p(e,n){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(Te(t.$$.fragment,e),Te(o),s=!0)},o(e){Se(t.$$.fragment,e),Se(o),s=!1},d(e){ze(t,e),e&&F(n),o&&o.d(e),e&&F(r)}}}function zl(e){let t,n;return t=new Jn({props:{class:"pb-1",$$slots:{default:[Yl]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Vl(e){let t,n,r,s;return n=new qt({props:{fluid:!0,class:"bg-light bg-gradient",$$slots:{default:[zl]},$$scope:{ctx:e}}}),{c(){t=D("div"),Pe(n.$$.fragment),Y(t,"style",r=Gl(e[0].hideAppMenu))},m(e,r){O(e,t,r),Ye(n,t,null),s=!0},p(e,[o]){const i={};4097&o&&(i.$$scope={dirty:o,ctx:e}),n.$set(i),(!s||1&o&&r!==(r=Gl(e[0].hideAppMenu)))&&Y(t,"style",r)},i(e){s||(Te(n.$$.fragment,e),s=!0)},o(e){Se(n.$$.fragment,e),s=!1},d(e){e&&F(t),ze(n)}}}const Hl="secondary";function Gl(e){let t=`max-height: ${e?"0":"3rem"};`;return t+=`visibility: ${e?"hidden":"visibile"};`,t+=`opacity: ${e?"0":"1"};`,t+="transition: all 1.2s;",t}function ql(e,t,n){let r,s,o,i;u(e,Ll,(e=>n(0,r=e))),u(e,Dl,(e=>n(8,s=e))),u(e,Fl,(e=>n(9,o=e))),u(e,Rl,(e=>n(10,i=e)));const a=qe().getLogger("atf");async function c(){let e=await uo("/api/logout");if(e.error){let t=Ol.getSysMsg({type:"danger",msg:e.error});v(Ll,r.sysMsgs=[t],r)}else{let t=e.data;if("OK"==t.type){let e=Ol.getSysMsg({type:"success",msg:t.message,duration:"DEF",autoclose:!0});v(Ll,r.sysMsgs=[e],r),v(Ll,r.loggedIn=!1,r),v(Ll,r.currPage="login",r),v(Ll,r.currSubPage="login",r),v(Rl,i={},i),v(Fl,o=["root"],o),v(Dl,s={loadedNonFreeModules:{},loadedFreeModules:{},exSpec:null,partIdx:0},s)}else{let e=Ol.getSysMsg({msg:t.message});v(Ll,r.sysMsgs=[e],r)}}}return[r,a,c,function(){v(Ll,r={...r,currPage:"exercises"},r)},()=>{v(Ll,r={...r,currPage:"home"},r)},()=>{v(Ll,r={...r,currPage:"account",currSubPage:"account"},r)},()=>c(),()=>{v(Ll,r={...r,currPage:"login",currSubPage:"login"},r)}]}const Jl=class extends He{constructor(e){super(),Ve(this,e,ql,Vl,a,{})}};function Wl(t){let n,r,s;return{c(){n=D("button"),Y(n,"type","button"),Y(n,"class","btn-close ms-2 p-0"),Y(n,"aria-label","Close")},m(e,o){O(e,n,o),r||(s=P(n,"click",t[7]),r=!0)},p:e,d(e){e&&F(n),r=!1,s()}}}function Kl(e){let t,n,r,s,o,i=e[3]&&e[5]>-1?`(${e[5]})`:"",a=e[4]&&Wl(e);return{c(){t=L(e[2]),n=Q(),r=L(i),s=Q(),a&&a.c(),o=j()},m(e,i){O(e,t,i),O(e,n,i),O(e,r,i),O(e,s,i),a&&a.m(e,i),O(e,o,i)},p(e,n){4&n&&G(t,e[2]),40&n&&i!==(i=e[3]&&e[5]>-1?`(${e[5]})`:"")&&G(r,i),e[4]?a?a.p(e,n):(a=Wl(e),a.c(),a.m(o.parentNode,o)):a&&(a.d(1),a=null)},d(e){e&&F(t),e&&F(n),e&&F(r),e&&F(s),a&&a.d(e),e&&F(o)}}}function Xl(e){let t,n,r,s;return n=new $t({props:{class:"d-flex align-items-center px-2 py-1 my-1",color:e[1],$$slots:{default:[Kl]},$$scope:{ctx:e}}}),{c(){t=D("div"),Pe(n.$$.fragment),Y(t,"id",e[0]),Y(t,"class","d-flex justify-content-center align-items-center")},m(r,o){O(r,t,o),Ye(n,t,null),e[10](t),s=!0},p(e,[r]){const o={};2&r&&(o.color=e[1]),32828&r&&(o.$$scope={dirty:r,ctx:e}),n.$set(o),(!s||1&r)&&Y(t,"id",e[0])},i(e){s||(Te(n.$$.fragment,e),ve((()=>{s&&(r||(r=De(t,gt,{duration:0},!0)),r.run(1))})),s=!0)},o(e){Se(n.$$.fragment,e),r||(r=De(t,gt,{duration:0},!1)),r.run(0),s=!1},d(s){s&&F(t),ze(n),e[10](null),s&&r&&r.end()}}}function Zl(e,t,n){let r;u(e,Ll,(e=>n(13,r=e)));qe().getLogger("atf");let s,o,i,{id:a}=t,{type:c}=t,{msg:l}=t,{duration:f=-1}=t,{autoclose:d=!1}=t,{countdown:p=!1}=t,{dismissible:h=!0}=t,m=Math.round(f/1e3);function y(e){let t=[];for(let e of r.sysMsgs)e.id!=a&&t.push(e);v(Ll,r.sysMsgs=t,r)}return ae((async()=>{n(6,i.style.display="initial",i),(f>-1||d)&&(o=setTimeout((()=>{y()}),f+1e3)),p&&(s=setInterval((function(){n(5,m=Math.max(m-1,-1))}),1e3))})),ie((()=>{})),ce((()=>{})),le((()=>{clearInterval(s),clearTimeout(o)})),e.$$set=e=>{"id"in e&&n(0,a=e.id),"type"in e&&n(1,c=e.type),"msg"in e&&n(2,l=e.msg),"duration"in e&&n(8,f=e.duration),"autoclose"in e&&n(9,d=e.autoclose),"countdown"in e&&n(3,p=e.countdown),"dismissible"in e&&n(4,h=e.dismissible)},[a,c,l,p,h,m,i,y,f,d,function(e){he[e?"unshift":"push"]((()=>{i=e,n(6,i)}))}]}const eu=class extends He{constructor(e){super(),Ve(this,e,Zl,Xl,a,{id:0,type:1,msg:2,duration:8,autoclose:9,countdown:3,dismissible:4})}};function tu(e,t,n){const r=e.slice();return r[2]=t[n],r}function nu(e,t){let n,r,s;return r=new eu({props:{id:t[2].id,type:t[2].type,msg:t[2].msg,dismissible:t[2].dismissible,duration:t[2].duration,autoclose:t[2].autoclose,countdown:t[2].countdown}}),{key:e,first:null,c(){n=j(),Pe(r.$$.fragment),this.first=n},m(e,t){O(e,n,t),Ye(r,e,t),s=!0},p(e,n){t=e;const s={};1&n&&(s.id=t[2].id),1&n&&(s.type=t[2].type),1&n&&(s.msg=t[2].msg),1&n&&(s.dismissible=t[2].dismissible),1&n&&(s.duration=t[2].duration),1&n&&(s.autoclose=t[2].autoclose),1&n&&(s.countdown=t[2].countdown),r.$set(s)},i(e){s||(Te(r.$$.fragment,e),s=!0)},o(e){Se(r.$$.fragment,e),s=!1},d(e){e&&F(n),ze(r,e)}}}function ru(e){let t,n,r=[],s=new Map,i=e[0].sysMsgs;const a=e=>e[2].id;for(let t=0;t<i.length;t+=1){let n=tu(e,i,t),o=a(n);s.set(o,r[t]=nu(o,n))}return{c(){t=D("div");for(let e=0;e<r.length;e+=1)r[e].c();Y(t,"style",su)},m(e,s){O(e,t,s);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null);n=!0},p(e,[n]){1&n&&(i=e[0].sysMsgs,Ne(),r=function(e,t,n,r,s,i,a,c,l,u,f,d){let p=e.length,h=i.length,m=p;const y={};for(;m--;)y[e[m].key]=m;const g=[],A=new Map,_=new Map,v=[];for(m=h;m--;){const e=d(s,i,m),o=n(e);let c=a.get(o);c?r&&v.push((()=>c.p(e,t))):(c=u(o,e),c.c()),A.set(o,g[m]=c),o in y&&_.set(o,Math.abs(m-y[o]))}const b=new Set,x=new Set;function w(e){Te(e,1),e.m(c,f),a.set(e.key,e),f=e.first,h--}for(;p&&h;){const t=g[h-1],n=e[p-1],r=t.key,s=n.key;t===n?(f=t.first,p--,h--):A.has(s)?!a.has(r)||b.has(r)?w(t):x.has(s)?p--:_.get(r)>_.get(s)?(x.add(r),w(t)):(b.add(s),p--):(l(n,a),p--)}for(;p--;){const t=e[p];A.has(t.key)||l(t,a)}for(;h;)w(g[h-1]);return o(v),g}(r,n,a,1,e,i,s,t,Ue,nu,null,tu),Ie())},i(e){if(!n){for(let e=0;e<i.length;e+=1)Te(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)Se(r[e]);n=!1},d(e){e&&F(t);for(let e=0;e<r.length;e+=1)r[e].d()}}}let su="position:absolute;left:50%;transform:translate(-50%, 0);z-index:100;";function ou(e,t,n){let r;u(e,Ll,(e=>n(0,r=e)));qe().getLogger("atf");return[r]}const iu=class extends He{constructor(e){super(),Ve(this,e,ou,ru,a,{})}},au={"question-circle":{width:1536,height:1792,paths:[{d:"M896 1376v-192q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v192q0 14 9 23t23 9h192q14 0 23-9t9-23zM1152 704q0-88-55.5-163t-138.5-116-170-41q-243 0-371 213-15 24 8 42l132 100q7 6 19 6 16 0 25-12 53-68 86-92 34-24 86-24 48 0 85.5 26t37.5 59q0 38-20 61t-68 45q-63 28-115.5 86.5t-52.5 125.5v36q0 14 9 23t23 9h192q14 0 23-9t9-23q0-19 21.5-49.5t54.5-49.5q32-18 49-28.5t46-35 44.5-48 28-60.5 12.5-81zM1536 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}]}};function cu(e){let t,n,r,s;return t=new Rt({props:{color:"info",class:"btn-sm rounded-3 bg-gradient",$$slots:{default:[lu]},$$scope:{ctx:e}}}),t.$on("click",e[2]),r=new Sn({props:{isOpen:e[1],toggle:e[2],$$slots:{default:[pu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};16&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};2&n&&(o.isOpen=e[1]),17&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function lu(t){let n,r;return n=new hr({props:{style:"display:flex",data:au}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function uu(e){let t,n;return{c(){t=new K(!1),n=j(),t.a=n},m(r,s){t.m(e[0],r,s),O(r,n,s)},p(e,n){1&n&&t.p(e[0])},d(e){e&&F(n),e&&t.d()}}}function fu(e){let t;return{c(){t=L("Close")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function du(e){let t,n;return t=new Rt({props:{color:"secondary",$$slots:{default:[fu]},$$scope:{ctx:e}}}),t.$on("click",e[2]),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};16&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function pu(e){let t,n,r,s;return t=new sn({props:{$$slots:{default:[uu]},$$scope:{ctx:e}}}),r=new Rn({props:{$$slots:{default:[du]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};17&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};16&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function hu(e){let t,n,r=e[0]&&cu(e);return{c(){r&&r.c(),t=j()},m(e,s){r&&r.m(e,s),O(e,t,s),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&Te(r,1)):(r=cu(e),r.c(),Te(r,1),r.m(t.parentNode,t)):r&&(Ne(),Se(r,1,1,(()=>{r=null})),Ie())},i(e){n||(Te(r),n=!0)},o(e){Se(r),n=!1},d(e){r&&r.d(e),e&&F(t)}}}function mu(e,t,n){let{html:r=""}=t;let s=!1;return e.$$set=e=>{"html"in e&&n(0,r=e.html)},[r,s,function(){n(1,s=!s)},""]}const yu=class extends He{constructor(e){super(),Ve(this,e,mu,hu,a,{html:0,slot:3})}get slot(){return this.$$.ctx[3]}};function gu(t){let n,r,s,o,i,a,c;const l=t[2].default,u=f(l,t,t[3],null),d=u||function(t){let n;return{c(){n=D("em"),n.textContent="No Title Provided"},m(e,t){O(e,n,t)},p:e,d(e){e&&F(n)}}}();return i=new yu({props:{html:t[0]}}),{c(){n=D("div"),r=D("div"),d&&d.c(),s=Q(),o=D("div"),Pe(i.$$.fragment),Y(o,"class","mt-1"),Y(o,"style",a=Ol.getHelpTransitionStyle(t[1].enableHelp)),q(r,"background","var(--atf-gray-400)"),Y(r,"class","text-center ms-1 mt-1 p-1 border border-light rounded-3"),q(n,"position","relative"),Y(n,"class","col me-1 px-0")},m(e,t){O(e,n,t),N(n,r),d&&d.m(r,null),N(r,s),N(r,o),Ye(i,o,null),c=!0},p(e,t){u&&u.p&&(!c||8&t)&&h(u,l,e,e[3],c?p(l,e[3],t,null):m(e[3]),null);const n={};1&t&&(n.html=e[0]),i.$set(n),(!c||2&t&&a!==(a=Ol.getHelpTransitionStyle(e[1].enableHelp)))&&Y(o,"style",a)},i(e){c||(Te(d,e),Te(i.$$.fragment,e),c=!0)},o(e){Se(d,e),Se(i.$$.fragment,e),c=!1},d(e){e&&F(n),d&&d.d(e),ze(i)}}}function Au(e){let t,n;return t=new Jn({props:{class:"px-0 pb-1 align-items-center",$$slots:{default:[gu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,[n]){const r={};11&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function _u(e,t,n){let r;u(e,Ll,(e=>n(1,r=e)));let{$$slots:s={},$$scope:o}=t;qe().getLogger("atf"),Ol.assert;let{help:i=""}=t;return e.$$set=e=>{"help"in e&&n(0,i=e.help),"$$scope"in e&&n(3,o=e.$$scope)},[i,r,s,o]}const vu=class extends He{constructor(e){super(),Ve(this,e,_u,Au,a,{help:0})}};const bu={question:{width:1024,height:1792,paths:[{d:"M704 1256v240q0 16-12 28t-28 12h-240q-16 0-28-12t-12-28v-240q0-16 12-28t28-12h240q16 0 28 12t12 28zM1020 656q0 54-15.5 101t-35 76.5-55 59.5-57.5 43.5-61 35.5q-41 23-68.5 65t-27.5 67q0 17-12 32.5t-28 15.5h-240q-15 0-25.5-18.5t-10.5-37.5v-45q0-83 65-156.5t143-108.5q59-27 84-56t25-76q0-42-46.5-74t-107.5-32q-65 0-108 29-35 25-107 115-13 16-31 16-12 0-25-8l-164-125q-13-10-15.5-25t5.5-28q160-266 464-266 80 0 161 31t146 83 106 127.5 41 158.5z"}]}},xu=[{type:"FULL_30",amount:2,period:"30 days",desc:"Full access for 30 days"},{type:"FULL_MONTHLY",amount:2,period:"per month",desc:"Full access",plan_id:"zxc"},{type:"FULL_DAILY",amount:2,period:"per day",desc:"Full access",plan_id:"zxc"}];const wu={getSubByType:function(e){let t=xu.find((t=>t.type===e))||xu[0];return t},getSubTypes:function(){return xu}};function Eu(t){let n;return{c(){n=L("Aural Practice")},m(e,t){O(e,n,t)},p:e,d(e){e&&F(n)}}}function ku(e){let t;return{c(){t=L("About")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Cu(t){let n,r,s,o,i,a,c,l,u,f,d=!1;return{c(){n=D("div"),r=D("p"),r.innerHTML="This website presents practice exercises designed to help you\n                prepare for Trinity<span></span>* and ABRSM<span></span>* aural exams.\n                Grades currently covered are Initial to 5.",s=Q(),o=D("p"),o.textContent="Exercises consist of players, scores, and questions/answers\n                reflecting a particular part of a syllabus.",i=Q(),d&&d.c(),a=Q(),c=D("p"),c.textContent="Before continuing, please ensure that you have read and accepted\n                the Terms (see below).",l=Q(),u=D("p"),u.textContent="* These terms are used only to identify material designed\n                to correspond to a particular syllabus.\n                This website is not associated with, or endorsed by, any external\n                organisation.",Y(n,"class",f="alert alert-"+Ju+" m-0"),Y(n,"role","alert")},m(e,t){O(e,n,t),N(n,r),N(n,s),N(n,o),N(n,i),d&&d.m(n,null),N(n,a),N(n,c),N(n,l),N(n,u)},p:e,d(e){e&&F(n),d&&d.d()}}}function $u(e){let t,n;return t=new Pt({props:{$$slots:{default:[Cu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Bu(e){let t,n,r,s;return t=new Rt({props:{id:"about",class:"border-light",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$slots:{default:[ku]},$$scope:{ctx:e}}}),t.$on("click",e[3]),r=new yt({props:{class:"m-2",isOpen:e[0].about,$$slots:{default:[$u]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};4096&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};1&n&&(o.isOpen=e[0].about),4096&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function Mu(e){let t;return{c(){t=L("Privacy, Terms, Copyright")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Nu(e){let t;return{c(){t=L("This site does not use cookies, except to enable account logins.")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Iu(t){let n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g;let A=Nu(t),_=!1;return{c(){n=D("div"),r=D("p"),A.c(),s=Q(),_&&_.c(),o=Q(),i=D("p"),i.textContent="There is no express or implied warranty that this website is fit\n                for any purpose.",a=Q(),c=D("div"),c.textContent="Users:",l=Q(),u=D("div"),u.innerHTML="<ul><li>Should always refer to official publications, and</li> \n                  <li>Must make their own assessment as to whether they find this\n                    website helpful, and use it entirely at their own risk.</li></ul>",f=Q(),d=D("div"),d.textContent="All content is either:",p=Q(),h=D("ul"),h.innerHTML="<li>Original material, or</li> \n                <li>Derived from material in the Public Domain, often with\n                    substantial modification.</li>",m=Q(),y=D("p"),y.textContent="If you would like to use anything from this website, please contact us.",Y(n,"class",g="alert alert-"+Ju+" m-0"),Y(n,"role","alert")},m(e,t){O(e,n,t),N(n,r),A.m(r,null),N(n,s),_&&_.m(n,null),N(n,o),N(n,i),N(n,a),N(n,c),N(n,l),N(n,u),N(n,f),N(n,d),N(n,p),N(n,h),N(n,m),N(n,y)},p:e,d(e){e&&F(n),A.d(),_&&_.d()}}}function Tu(e){let t,n;return t=new Pt({props:{$$slots:{default:[Iu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Su(e){let t,n,r,s;return t=new Rt({props:{class:"border-light",id:"priv",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$slots:{default:[Mu]},$$scope:{ctx:e}}}),t.$on("click",e[5]),r=new yt({props:{class:"m-2",isOpen:e[0].priv,$$slots:{default:[Tu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};4096&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};1&n&&(o.isOpen=e[0].priv),4096&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function Ou(e){let t;return{c(){t=L("Useage Tips")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Fu(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:bu}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Ru(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:au}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Du(t){let n,r,s;return n=new hr({props:{style:"position:relative;top:-1px",data:bu}}),{c(){Pe(n.$$.fragment),r=Q()},m(e,t){Ye(n,e,t),O(e,r,t),s=!0},p:e,i(e){s||(Te(n.$$.fragment,e),s=!0)},o(e){Se(n.$$.fragment,e),s=!1},d(e){ze(n,e),e&&F(r)}}}function Uu(e){let t,n,r,s,o,i,a,c,l,u,f,d,p,h,m,y,g;return i=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"info",$$slots:{default:[Fu]},$$scope:{ctx:e}}}),c=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"info",$$slots:{default:[Ru]},$$scope:{ctx:e}}}),u=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"primary",$$slots:{default:[Du]},$$scope:{ctx:e}}}),{c(){t=D("div"),n=D("p"),n.textContent="Exercises are intended to follow the prescribed syllabuses closely,\n              however the first point of reference should always be the official\n              publications of the relevant organisation.",r=Q(),s=D("p"),o=L("To get help on the role of individual elements, and additional\n                information about the exercises, click on"),Pe(i.$$.fragment),a=L(" to reveal"),Pe(c.$$.fragment),l=L(" buttons. When clicked, these will display the relevant help.\n                  Disable help with"),Pe(u.$$.fragment),f=L("."),d=Q(),p=D("p"),p.textContent="It is recommended to work through the examples slowly and carefully,\n              say one per day, rather than clicking through them quickly.",h=Q(),m=D("p"),m.textContent="In many cases, for example when it is required to describe\n              characteristics of pieces, answers to questions are subjective and\n              the suggested responses are not definitive or comprehensive.\n              The answers given should be considered suggestions only.",Y(t,"class",y="alert alert-"+Ju+" m-0"),Y(t,"role","alert")},m(e,y){O(e,t,y),N(t,n),N(t,r),N(t,s),N(s,o),Ye(i,s,null),N(s,a),Ye(c,s,null),N(s,l),Ye(u,s,null),N(s,f),N(t,d),N(t,p),N(t,h),N(t,m),g=!0},p(e,t){const n={};4096&t&&(n.$$scope={dirty:t,ctx:e}),i.$set(n);const r={};4096&t&&(r.$$scope={dirty:t,ctx:e}),c.$set(r);const s={};4096&t&&(s.$$scope={dirty:t,ctx:e}),u.$set(s)},i(e){g||(Te(i.$$.fragment,e),Te(c.$$.fragment,e),Te(u.$$.fragment,e),g=!0)},o(e){Se(i.$$.fragment,e),Se(c.$$.fragment,e),Se(u.$$.fragment,e),g=!1},d(e){e&&F(t),ze(i),ze(c),ze(u)}}}function Lu(e){let t,n;return t=new Pt({props:{$$slots:{default:[Uu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Qu(e){let t,n,r,s;return t=new Rt({props:{class:"border-light",id:"tips",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$slots:{default:[Ou]},$$scope:{ctx:e}}}),t.$on("click",e[6]),r=new yt({props:{class:"m-2",isOpen:e[0].tips,$$slots:{default:[Lu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};4096&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};1&n&&(o.isOpen=e[0].tips),4096&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function ju(e){let t;return{c(){t=L("Contact")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Pu(t){let n,r,s;return{c(){n=D("div"),r=D("bdo"),r.textContent="ku.oc.sysdl@nimda",Y(r,"dir","rtl"),Y(n,"class",s="alert alert-"+Ju+" m-0"),Y(n,"role","alert")},m(e,t){O(e,n,t),N(n,r)},p:e,d(e){e&&F(n)}}}function Yu(e){let t,n;return t=new Pt({props:{$$slots:{default:[Pu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function zu(e){let t,n,r,s;return t=new Rt({props:{class:"border-light",id:"contact",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$slots:{default:[ju]},$$scope:{ctx:e}}}),t.$on("click",e[7]),r=new yt({props:{class:"m-2",isOpen:e[0].contact,$$slots:{default:[Yu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};4096&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};1&n&&(o.isOpen=e[0].contact),4096&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function Vu(e){let t,n,r,s,o,i,a,c,l;t=new qt({props:{fluid:!0,style:"padding-bottom:.25rem",$$slots:{default:[Bu]},$$scope:{ctx:e}}});let u=!1;return s=new qt({props:{fluid:!0,style:"padding-bottom:.25rem",$$slots:{default:[Su]},$$scope:{ctx:e}}}),i=new qt({props:{fluid:!0,style:"padding-bottom:.25rem",$$slots:{default:[Qu]},$$scope:{ctx:e}}}),c=new qt({props:{fluid:!0,style:"padding-bottom:.25rem",$$slots:{default:[zu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),u&&u.c(),r=Q(),Pe(s.$$.fragment),o=Q(),Pe(i.$$.fragment),a=Q(),Pe(c.$$.fragment)},m(e,f){Ye(t,e,f),O(e,n,f),u&&u.m(e,f),O(e,r,f),Ye(s,e,f),O(e,o,f),Ye(i,e,f),O(e,a,f),Ye(c,e,f),l=!0},p(e,n){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const o={};4097&n&&(o.$$scope={dirty:n,ctx:e}),s.$set(o);const a={};4097&n&&(a.$$scope={dirty:n,ctx:e}),i.$set(a);const l={};4097&n&&(l.$$scope={dirty:n,ctx:e}),c.$set(l)},i(e){l||(Te(t.$$.fragment,e),Te(u),Te(s.$$.fragment,e),Te(i.$$.fragment,e),Te(c.$$.fragment,e),l=!0)},o(e){Se(t.$$.fragment,e),Se(u),Se(s.$$.fragment,e),Se(i.$$.fragment,e),Se(c.$$.fragment,e),l=!1},d(e){ze(t,e),e&&F(n),u&&u.d(e),e&&F(r),ze(s,e),e&&F(o),ze(i,e),e&&F(a),ze(c,e)}}}function Hu(e){let t,n;return t=new Vt({props:{class:"p-0",$$slots:{default:[Vu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Gu(e){let t,n,r,s,o,i;t=new vu({props:{help:"",$$slots:{default:[Eu]},$$scope:{ctx:e}}}),r=new Jn({props:{$$slots:{default:[Hu]},$$scope:{ctx:e}}});let a=!1;return{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment),s=Q(),a&&a.c(),o=j()},m(e,c){Ye(t,e,c),O(e,n,c),Ye(r,e,c),O(e,s,c),a&&a.m(e,c),O(e,o,c),i=!0},p(e,n){const s={};4096&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};4097&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){i||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),Te(a),i=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),Se(a),i=!1},d(e){ze(t,e),e&&F(n),ze(r,e),e&&F(s),a&&a.d(e),e&&F(o)}}}function qu(e){let t,n;return t=new qt({props:{fluid:!0,style:"",$$slots:{default:[Gu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,[n]){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}const Ju="warning";function Wu(e,t,n){qe().getLogger("atf");const r=wu.getSubTypes();let s={about:!0};function o(e){let t=s[e.target.id];t?n(0,s={}):(n(0,s={}),n(0,s[e.target.id]=!t,s))}return[s,r,o,e=>o(e),e=>o(e),e=>o(e),e=>o(e),e=>o(e)]}const Ku=class extends He{constructor(e){super(),Ve(this,e,Wu,qu,a,{})}};function Xu(t){let n;const r=t[0].default,s=f(r,t,t[1],null),o=s||function(t){let n;return{c(){n=D("em"),n.textContent="No Body"},m(e,t){O(e,n,t)},p:e,d(e){e&&F(n)}}}();return{c(){o&&o.c()},m(e,t){o&&o.m(e,t),n=!0},p(e,t){s&&s.p&&(!n||2&t)&&h(s,r,e,e[1],n?p(r,e[1],t,null):m(e[1]),null)},i(e){n||(Te(o,e),n=!0)},o(e){Se(o,e),n=!1},d(e){o&&o.d(e)}}}function Zu(e){let t,n;return t=new qt({props:{fluid:!0,class:"p-0 m-0",$$slots:{default:[Xu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function ef(e){let t,n;return t=new Vt({props:{class:"px-0",$$slots:{default:[Zu]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function tf(e){let t,n;return t=new Jn({props:{$$slots:{default:[ef]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,[n]){const r={};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function nf(e,t,n){let{$$slots:r={},$$scope:s}=t;qe().getLogger("atf");return e.$$set=e=>{"$$scope"in e&&n(1,s=e.$$scope)},[r,s]}const rf=class extends He{constructor(e){super(),Ve(this,e,nf,tf,a,{})}},sf=e=>({}),of=e=>({}),af=e=>({}),cf=e=>({}),lf=e=>({}),uf=e=>({}),ff=e=>({}),df=e=>({});function pf(e){let t,n,r,s,o,i=e[7].content_info&&mf(e);return r=new Jn({props:{class:"m-0 p-0",$$slots:{default:[bf]},$$scope:{ctx:e}}}),{c(){t=D("div"),i&&i.c(),n=Q(),Pe(r.$$.fragment),Y(t,"class","pb-1")},m(e,s){O(e,t,s),i&&i.m(t,null),N(t,n),Ye(r,t,null),o=!0},p(s,o){(e=s)[7].content_info?i?(i.p(e,o),128&o&&Te(i,1)):(i=mf(e),i.c(),Te(i,1),i.m(t,n)):i&&(Ne(),Se(i,1,1,(()=>{i=null})),Ie());const a={};8193&o&&(a.$$scope={dirty:o,ctx:e}),r.$set(a)},i(n){o||(Te(i),Te(r.$$.fragment,n),n&&(s||ve((()=>{s=Fe(t,gt,{duration:e[4][e[5]].delayShow}),s.start()}))),o=!0)},o(e){Se(i),Se(r.$$.fragment,e),o=!1},d(e){e&&F(t),i&&i.d(),ze(r)}}}function hf(e){let t,n,r,s;return n=new Rt({props:{outline:!0,color:e[4][e[5]].btnColor,size:"sm",$$slots:{default:[xf]},$$scope:{ctx:e}}}),n.$on("click",e[10]),{c(){t=D("div"),Pe(n.$$.fragment),Y(t,"class","pb-1")},m(e,r){O(e,t,r),Ye(n,t,null),s=!0},p(t,r){e=t;const s={};8192&r&&(s.$$scope={dirty:r,ctx:e}),n.$set(s)},i(o){s||(Te(n.$$.fragment,o),o&&(r||ve((()=>{r=Fe(t,gt,{duration:e[4][e[5]].delayHide}),r.start()}))),s=!0)},o(e){Se(n.$$.fragment,e),s=!1},d(e){e&&F(t),ze(n)}}}function mf(e){let t,n;return t=new Jn({props:{class:"m-0 p-0",$$slots:{default:[gf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8192&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function yf(e){let t;const n=e[9].content_info,r=f(n,e,e[13],df);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8192&s)&&h(r,n,e,e[13],t?p(n,e[13],s,ff):m(e[13]),df)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function gf(e){let t,n;return t=new Vt({props:{class:"px-0",$$slots:{default:[yf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8192&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Af(e){let t;const n=e[9].content,r=f(n,e,e[13],cf);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,s){r&&r.p&&(!t||8192&s)&&h(r,n,e,e[13],t?p(n,e[13],s,af):m(e[13]),cf)},i(e){t||(Te(r,e),t=!0)},o(e){Se(r,e),t=!1},d(e){r&&r.d(e)}}}function _f(e){let t,n,r,s;const i=e[9].content,a=f(i,e,e[13],uf);return{c(){t=D("div"),a&&a.c(),q(t,"cursor","pointer")},m(o,i){O(o,t,i),a&&a.m(t,null),n=!0,r||(s=[P(t,"click",e[11]),P(t,"keydown",e[12])],r=!0)},p(e,t){a&&a.p&&(!n||8192&t)&&h(a,i,e,e[13],n?p(i,e[13],t,lf):m(e[13]),uf)},i(e){n||(Te(a,e),n=!0)},o(e){Se(a,e),n=!1},d(e){e&&F(t),a&&a.d(e),r=!1,o(s)}}}function vf(e){let t,n,r,s;const o=[_f,Af],i=[];function a(e,t){return e[0][0]!=e[5]?0:1}return t=a(e),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,s){let c=t;t=a(e),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function bf(e){let t,n;return t=new Vt({props:{class:"px-0",$$slots:{default:[vf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8193&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function xf(t){let n,r,s=t[4][t[5]].label+"";return{c(){n=L("Show "),r=L(s)},m(e,t){O(e,n,t),O(e,r,t)},p:e,d(e){e&&F(n),e&&F(r)}}}function wf(e){let t,n,r,s,o,i,a,c;const l=[hf,pf],u=[];function d(e,t){return e[2]?1:0}r=d(e),s=u[r]=l[r](e);const y=e[9].info,g=f(y,e,e[13],of);return{c(){t=D("div"),n=D("div"),s.c(),o=Q(),i=D("div"),g&&g.c(),Y(i,"style",a=Ol.getHelpTransitionStyle(e[3].enableHelp)),q(n,"background","var(--atf-gray-200)"),Y(n,"class","text-center ms-1 mt-0 px-1 pt-1 border border-light rounded-3"),q(t,"position","relative"),Y(t,"class","col me-1 px-0")},m(e,s){O(e,t,s),N(t,n),u[r].m(n,null),N(n,o),N(n,i),g&&g.m(i,null),c=!0},p(e,t){let f=r;r=d(e),r===f?u[r].p(e,t):(Ne(),Se(u[f],1,1,(()=>{u[f]=null})),Ie(),s=u[r],s?s.p(e,t):(s=u[r]=l[r](e),s.c()),Te(s,1),s.m(n,o)),g&&g.p&&(!c||8192&t)&&h(g,y,e,e[13],c?p(y,e[13],t,sf):m(e[13]),of),(!c||8&t&&a!==(a=Ol.getHelpTransitionStyle(e[3].enableHelp)))&&Y(i,"style",a)},i(e){c||(Te(s),Te(g,e),c=!0)},o(e){Se(s),Se(g,e),c=!1},d(e){e&&F(t),u[r].d(),g&&g.d(e)}}}function Ef(e){let t,n;return t=new Jn({props:{class:"mx-0 px-0 pb-0 align-items-center "+(e[1]?"d-none":""),$$slots:{default:[wf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,[n]){const r={};2&n&&(r.class="mx-0 px-0 pb-0 align-items-center "+(e[1]?"d-none":"")),8333&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function kf(e,t,n){let r;u(e,Ll,(e=>n(3,r=e)));let{$$slots:s={},$$scope:o}=t;const i=A(s);qe().getLogger("atf");let a=fe("app"),{id:c}=t,{showsElems:l=[]}=t,{isHidden:f=!1}=t,d=c[0].toUpperCase(),p=c[0]==d,h=a.showElemFunctions;function m(e,t){n(2,p=e),t&&function(e){for(let t=0;t<l.length;t++){let n=l[t];h[n](e,!0)}}(e)}ae((()=>{h[c.substr(0,2).toUpperCase()]=m}));return e.$$set=e=>{"id"in e&&n(0,c=e.id),"showsElems"in e&&n(8,l=e.showsElems),"isHidden"in e&&n(1,f=e.isHidden),"$$scope"in e&&n(13,o=e.$$scope)},[c,f,p,r,{I:{label:"Information",btnColor:"info",delayShow:0,delayHide:0},Q:{label:"Question",btnColor:"primary",delayShow:1200,delayHide:300},A:{label:"Answer",btnColor:"success",delayShow:400,delayHide:300},S:{label:"Score",btnColor:"dark",delayShow:0,delayHide:0},P:{label:"Player",btnColor:"secondary",delayShow:0,delayHide:0},K:{label:"Keyboard",btnColor:"dark",delayShow:0,delayHide:0}},d,m,i,l,s,()=>"P"!=c[0].toUpperCase()?m(!0,!0):m(!0,!1),()=>m(!1,!1),()=>m(!1,!1),o]}const Cf=class extends He{constructor(e){super(),Ve(this,e,kf,Ef,a,{id:0,showsElems:8,isHidden:1})}},$f={bars:{width:1536,height:1792,paths:[{d:"M1536 1344v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zM1536 832v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zM1536 320v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45z"}]}},Bf={"window-maximize":{width:1792,height:1792,paths:[{d:"M256 1408h1280v-768h-1280v768zM1792 288v1216q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-1216q0-66 47-113t113-47h1472q66 0 113 47t47 113z"}]}},Mf={"window-minimize":{width:1792,height:1792,paths:[{d:"M1792 1312v192q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-192q0-66 47-113t113-47h1472q66 0 113 47t47 113z"}]}};function Nf(e,t,n){const r=e.slice();return r[19]=t[n],r}function If(e,t,n){const r=e.slice();return r[19]=t[n],r[23]=n,r}function Tf(e){let t,n;return t=new Ar({props:{duration_out:200}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Sf(t){let n,r,s=(t[19].desc||t[19].id)+"";return{c(){n=new K(!1),r=j(),n.a=r},m(e,t){n.m(s,e,t),O(e,r,t)},p(e,t){1&t&&s!==(s=(e[19].desc||e[19].id)+"")&&n.p(s)},i:e,o:e,d(e){e&&F(r),e&&n.d()}}}function Of(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:$f}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Ff(e){let t,n,r,s;const o=[Of,Sf],i=[];return t=function(e,t){return 0==e[23]?0:1}(e),n=i[t]=o[t](e),{c(){n.c(),r=Q()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,t){n.p(e,t)},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function Rf(e){let t,n;function r(...t){return e[6](e[19],...t)}return t=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:e[23]<e[0].length-1?"success":"warning",active:e[23]==e[0].length-1,$$slots:{default:[Ff]},$$scope:{ctx:e}}}),t.$on("click",(function(){i(e[23]==e[0].length-1?null:r)&&(e[23]==e[0].length-1?null:r).apply(this,arguments)})),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(n,r){e=n;const s={};1&r&&(s.color=e[23]<e[0].length-1?"success":"warning"),1&r&&(s.active=e[23]==e[0].length-1),16777217&r&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Df(e){let t,n,r=e[1].children,s=[];for(let t=0;t<r.length;t+=1)s[t]=Lf(Nf(e,r,t));const o=e=>Se(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=j()},m(e,r){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,r);O(e,t,r),n=!0},p(e,n){if(18&n){let i;for(r=e[1].children,i=0;i<r.length;i+=1){const o=Nf(e,r,i);s[i]?(s[i].p(o,n),Te(s[i],1)):(s[i]=Lf(o),s[i].c(),Te(s[i],1),s[i].m(t.parentNode,t))}for(Ne(),i=r.length;i<s.length;i+=1)o(i);Ie()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)Te(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)Se(s[e]);n=!1},d(e){R(s,e),e&&F(t)}}}function Uf(e){let t,n,r=(e[19].desc||e[19].id)+"";return{c(){t=new K(!1),n=Q(),t.a=n},m(e,s){t.m(r,e,s),O(e,n,s)},p(e,n){2&n&&r!==(r=(e[19].desc||e[19].id)+"")&&t.p(r)},d(e){e&&t.d(),e&&F(n)}}}function Lf(e){let t,n;return t=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"primary",$$slots:{default:[Uf]},$$scope:{ctx:e}}}),t.$on("click",(function(...t){return e[7](e[19],...t)})),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(n,r){e=n;const s={};16777218&r&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Qf(t){return{c:e,m:e,d:e}}function jf(e){let t,n,r,s,o=Ol.getPathMenuItems(e[0]),i=[];for(let t=0;t<o.length;t+=1)i[t]=Rf(If(e,o,t));const a=e=>Se(i[e],1,1,(()=>{i[e]=null}));let c="ExContent"!=e[1].cmpt&&Df(e),l="ExContent"==e[1].cmpt&&Qf();return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=j(),c&&c.c(),n=j(),l&&l.c(),r=j()},m(e,o){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,o);O(e,t,o),c&&c.m(e,o),O(e,n,o),l&&l.m(e,o),O(e,r,o),s=!0},p(e,s){if(33&s){let n;for(o=Ol.getPathMenuItems(e[0]),n=0;n<o.length;n+=1){const r=If(e,o,n);i[n]?(i[n].p(r,s),Te(i[n],1)):(i[n]=Rf(r),i[n].c(),Te(i[n],1),i[n].m(t.parentNode,t))}for(Ne(),n=o.length;n<i.length;n+=1)a(n);Ie()}"ExContent"!=e[1].cmpt?c?(c.p(e,s),2&s&&Te(c,1)):(c=Df(e),c.c(),Te(c,1),c.m(n.parentNode,n)):c&&(Ne(),Se(c,1,1,(()=>{c=null})),Ie()),"ExContent"==e[1].cmpt?l||(l=Qf(),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},i(e){if(!s){for(let e=0;e<o.length;e+=1)Te(i[e]);Te(c),s=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)Se(i[e]);Se(c),s=!1},d(e){R(i,e),e&&F(t),c&&c.d(e),e&&F(n),l&&l.d(e),e&&F(r)}}}function Pf(e){let t,n;return t=new Rt({props:{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:e[3].enableHelp?"primary":"info",$$slots:{default:[Yf]},$$scope:{ctx:e}}}),t.$on("click",e[8]),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8&n&&(r.color=e[3].enableHelp?"primary":"info"),16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Yf(t){let n,r,s;return n=new hr({props:{style:"position:relative;top:-1px",data:bu}}),{c(){Pe(n.$$.fragment),r=Q()},m(e,t){Ye(n,e,t),O(e,r,t),s=!0},p:e,i(e){s||(Te(n.$$.fragment,e),s=!0)},o(e){Se(n.$$.fragment,e),s=!1},d(e){ze(n,e),e&&F(r)}}}function zf(e){let t,n;return t=new hr({props:{style:"position:relative;top:-1px",data:e[3].hideAppMenu?Mf:Bf}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};8&n&&(r.data=e[3].hideAppMenu?Mf:Bf),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Vf(e){let t,n,r,s="ExContent"==e[1].cmpt&&Pf(e);return n=new Rt({props:{class:"btn-sm mt-1 mx-1 rounded-3 bg-gradient",color:"secondary",$$slots:{default:[zf]},$$scope:{ctx:e}}}),n.$on("click",e[9]),{c(){s&&s.c(),t=j(),Pe(n.$$.fragment)},m(e,o){s&&s.m(e,o),O(e,t,o),Ye(n,e,o),r=!0},p(e,r){"ExContent"==e[1].cmpt?s?(s.p(e,r),2&r&&Te(s,1)):(s=Pf(e),s.c(),Te(s,1),s.m(t.parentNode,t)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie());const o={};16777224&r&&(o.$$scope={dirty:r,ctx:e}),n.$set(o)},i(e){r||(Te(s),Te(n.$$.fragment,e),r=!0)},o(e){Se(s),Se(n.$$.fragment,e),r=!1},d(e){s&&s.d(e),e&&F(t),ze(n,e)}}}function Hf(e){let t,n,r,s;return t=new Vt({props:{class:"me-auto px-0",$$slots:{default:[jf]},$$scope:{ctx:e}}}),r=new Vt({props:{class:"col-auto px-0",$$slots:{default:[Vf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};16777219&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};16777226&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function Gf(e){let t,n,r,s=e[2].data.length>0&&Tf();return n=new Jn({props:{class:"px-0 pb-1",$$slots:{default:[Hf]},$$scope:{ctx:e}}}),{c(){s&&s.c(),t=Q(),Pe(n.$$.fragment)},m(e,o){s&&s.m(e,o),O(e,t,o),Ye(n,e,o),r=!0},p(e,r){e[2].data.length>0?s?4&r&&Te(s,1):(s=Tf(),s.c(),Te(s,1),s.m(t.parentNode,t)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie());const o={};16777227&r&&(o.$$scope={dirty:r,ctx:e}),n.$set(o)},i(e){r||(Te(s),Te(n.$$.fragment,e),r=!0)},o(e){Se(s),Se(n.$$.fragment,e),r=!1},d(e){s&&s.d(e),e&&F(t),ze(n,e)}}}function qf(e){let t,n;return t=new qt({props:{fluid:!0,style:"background:var(--atf-gray-500);position:relative",$$slots:{default:[Gf]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,[n]){const r={};16777231&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Jf(e,t,n){let r,s,o,i,a,c;u(e,Fl,(e=>n(0,s=e))),u(e,Dl,(e=>n(10,o=e))),u(e,Ul,(e=>n(2,i=e))),u(e,Rl,(e=>n(11,a=e))),u(e,Ll,(e=>n(3,c=e)));const l=qe().getLogger("atf"),f=Ol.assert;function d(e,t=!0){let n=!1;if("NONE"!=e){let r=Ol.hasFullAccess(c),l=Ol.getMenuItemAtPath(po.exMenu,s),u=Promise.resolve();o.loadedFreeModules[e]||(u=function(e){return uo(`/data/${e}.json`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}},"APP").then((t=>{if(t.error){let e=`${t.error}. Could not load data.`,n=Ol.getSysMsg({msg:e});v(Ll,c.sysMsgs=[...c.sysMsgs,n],c)}else{let n=We().utils.cloneRot(t.data);v(Rl,a=go().merge(a,n),a),v(Dl,o.loadedFreeModules[e]=!0,o)}}))}(e),n=!0);let d=Promise.resolve();o.loadedNonFreeModules[e]||!r||l.allFree||(d=function(e){return fo("/api/get_module",{id:e}).then((t=>{if(t.error){let e=`${t.error}. Could not load data.`,n=Ol.getSysMsg({msg:e});v(Ll,c.sysMsgs=[...c.sysMsgs,n],c)}else if("ERR"==t.data.type)if("NLI"==t.data.subtype)v(Ll,c.loggedIn=!1,c),v(Rl,a={},a),v(Dl,o={loadedNonFreeModules:{},loadedFreeModules:{},exSpec:null,partIdx:0},o);else{let e=Ol.getSysMsg({msg:t.data.message});v(Ll,c.sysMsgs=[...c.sysMsgs,e],c)}else{t.data;let n=We().utils.cloneRot(t.data.data);v(Rl,a=go().merge(a,n),a),v(Dl,o.loadedNonFreeModules[e]=!0,o)}}))}(e),n=!0),n&&v(Ul,i.data=[...i.data,!0],i),Promise.allSettled([u,d]).then((e=>{"ExContent"==l.cmpt&&t&&function(){let e=Ol.getMenuItemAtPath(po.exMenu,s);f("ExContent"==e.cmpt),v(Dl,o.exSpec=Ol.getNextExSpec(a,s,o.exSpec),o),o.exSpec,v(Dl,o.partIdx=0,o),o.partIdx}(),n&&v(Ul,i.data=i.data.slice(0,-1),i),i.data}))}else l.warn(` ExMenu No module at path ${e}`)}function p(e,t){if(i.data.length>0)return;v(Fl,s=Ol.validatePath(po.exMenu,[...s,e.id]),s);let n=Ol.getPathModuleId(s);"NONE"!=n&&d(n,!0)}function h(e,t){if(i.data.length>0)return;let n=s.findIndex((t=>t==e));v(Dl,o.exSpec=null,o),v(Fl,s=s.slice(0,n+1),s);let r=Ol.getPathModuleId(s);"NONE"!=r&&d(r,!1)}ae((()=>{o.exSpec;let e=Ol.getPathModuleId(s);"NONE"!=e&&d(e,null==o.exSpec)}));return e.$$.update=()=>{1&e.$$.dirty&&n(1,r=Ol.getMenuItemAtPath(po.exMenu,s))},[s,r,i,c,p,h,(e,t)=>h(e.id),(e,t)=>p(e),e=>{v(Ll,c.enableHelp=!c.enableHelp,c)},()=>{v(Ll,c.hideAppMenu=!c.hideAppMenu,c)}]}const Wf=class extends He{constructor(e){super(),Ve(this,e,Jf,qf,a,{})}};function Kf(t){let n,r,s;return{c(){n=D("div"),r=D("div"),Y(r,"class",s="alert alert-"+t[1]+" m-0"),Y(r,"role","alert"),Y(n,"class","card m-0")},m(e,s){O(e,n,s),N(n,r),r.innerHTML=t[0]},p(e,[t]){1&t&&(r.innerHTML=e[0]),2&t&&s!==(s="alert alert-"+e[1]+" m-0")&&Y(r,"class",s)},i:e,o:e,d(e){e&&F(n)}}}function Xf(e,t,n){qe().getLogger("atf");let{html:r}=t,{color:s=""}=t;return e.$$set=e=>{"html"in e&&n(0,r=e.html),"color"in e&&n(1,s=e.color)},[r,s]}const Zf=class extends He{constructor(e){super(),Ve(this,e,Xf,Kf,a,{html:0,color:1})}};function ed(t){let n,r,s,o;return{c(){n=D("div"),r=D("div"),Y(r,"class",s="alert "+(t[2][t[1]]||"alert-info")+" m-0"),Y(n,"class",o="card m-0 "+("P"==t[1]?"mb-1":""))},m(e,s){O(e,n,s),N(n,r),r.innerHTML=t[0]},p(e,[t]){1&t&&(r.innerHTML=e[0]),2&t&&s!==(s="alert "+(e[2][e[1]]||"alert-info")+" m-0")&&Y(r,"class",s),2&t&&o!==(o="card m-0 "+("P"==e[1]?"mb-1":""))&&Y(n,"class",o)},i:e,o:e,d(e){e&&F(n)}}}function td(e,t,n){qe().getLogger("atf");let{html:r}=t,{elId0:s=""}=t;return e.$$set=e=>{"html"in e&&n(0,r=e.html),"elId0"in e&&n(1,s=e.elId0)},[r,s,{Q:"alert-primary",A:"alert-success",I:"alert-info"},""]}const nd=class extends He{constructor(e){super(),Ve(this,e,td,ed,a,{html:0,elId0:1,slot:3})}get slot(){return this.$$.ctx[3]}};var rd=__webpack_require__(253);function sd(t){let n;return{c(){n=D("div")},m(e,r){O(e,n,r),n.innerHTML=t[0]},p(e,[t]){1&t&&(n.innerHTML=e[0])},i:e,o:e,d(e){e&&F(n)}}}function od(e,t,n){let r;const s=qe().getLogger("atf");let{abc:o}=t;return e.$$set=e=>{"abc"in e&&n(1,o=e.abc)},e.$$.update=()=>{2&e.$$.dirty&&n(0,r=function(e){let t="",n={errmsg:e=>s.log(e),img_out:e=>t+=e,page_format:!0,imagesize:'width="100%"'};return new rd.y(n).tosvg("abc2svg",e),t}(o))},[r,o]}const id=class extends He{constructor(e){super(),Ve(this,e,od,sd,a,{abc:1})}},ad={play:{width:1408,height:1792,paths:[{d:"M1384 927l-1328 738q-23 13-39.5 3t-16.5-36v-1472q0-26 16.5-36t39.5 3l1328 738q23 13 23 31t-23 31z"}]}},cd={"play-circle-o":{width:1536,height:1792,paths:[{d:"M1184 896q0 37-32 55l-544 320q-15 9-32 9-16 0-32-8-32-19-32-56v-640q0-37 32-56 33-18 64 1l544 320q32 18 32 55zM1312 896q0-148-73-273t-198-198-273-73-273 73-198 198-73 273 73 273 198 198 273 73 273-73 198-198 73-273zM1536 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}]}},ld={pause:{width:1536,height:1792,paths:[{d:"M1536 192v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45zM640 192v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45z"}]}},ud={"fast-backward":{width:1792,height:1792,paths:[{d:"M1747 141q19-19 32-13t13 32v1472q0 26-13 32t-32-13l-710-710q-9-9-13-19v710q0 26-13 32t-32-13l-710-710q-9-9-13-19v678q0 26-19 45t-45 19h-128q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h128q26 0 45 19t19 45v678q4-10 13-19l710-710q19-19 32-13t13 32v710q4-10 13-19z"}]}},fd={"volume-down":{width:1152,height:1792,paths:[{d:"M768 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45zM1152 896q0 76-42.5 141.5t-112.5 93.5q-10 5-25 5-26 0-45-18.5t-19-45.5q0-21 12-35.5t29-25 34-23 29-36 12-56.5-12-56.5-29-36-34-23-29-25-12-35.5q0-27 19-45.5t45-18.5q15 0 25 5 70 27 112.5 93t42.5 142z"}]}},dd={"volume-up":{width:1664,height:1792,paths:[{d:"M768 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45zM1152 896q0 76-42.5 141.5t-112.5 93.5q-10 5-25 5-26 0-45-18.5t-19-45.5q0-21 12-35.5t29-25 34-23 29-36 12-56.5-12-56.5-29-36-34-23-29-25-12-35.5q0-27 19-45.5t45-18.5q15 0 25 5 70 27 112.5 93t42.5 142zM1408 896q0 153-85 282.5t-225 188.5q-13 5-25 5-27 0-46-19t-19-45q0-39 39-59 56-29 76-44 74-54 115.5-135.5t41.5-173.5-41.5-173.5-115.5-135.5q-20-15-76-44-39-20-39-59 0-26 19-45t45-19q13 0 26 5 140 59 225 188.5t85 282.5zM1664 896q0 230-127 422.5t-338 283.5q-13 5-26 5-26 0-45-19t-19-45q0-36 39-59 7-4 22.5-10.5t22.5-10.5q46-25 82-51 123-91 192-227t69-289-69-289-192-227q-36-26-82-51-7-4-22.5-10.5t-22.5-10.5q-39-23-39-59 0-26 19-45t45-19q13 0 26 5 211 91 338 283.5t127 422.5z"}]}};function pd(e){let t,n;return t=new hr({props:{style:"position:relative;top:-1px",data:"STARTED"==e[4].status?ld:e[0].replay?cd:ad}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.data="STARTED"==e[4].status?ld:e[0].replay?cd:ad),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function hd(t){let n,r;return n=new hr({props:{style:"display:flex",data:ud}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function md(e){let t,n,r,s;return t=new Rt({props:{id:"play-pause",class:"px-4 me-1 btn-dark rounded-pill bg-gradient",style:"width:4rem;background:var(--atf-gray-800)",$$slots:{default:[pd]},$$scope:{ctx:e}}}),t.$on("click",e[8]),r=new Rt({props:{id:"rewind",class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$slots:{default:[hd]},$$scope:{ctx:e}}}),r.$on("click",e[9]),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};4194305&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};4194304&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function yd(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:fd}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function gd(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:dd}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Ad(e){let t,n,r,s,o,i,a,c,l,u,f;return t=new Rt({props:{id:"vol-down",disabled:e[1].volume<5,class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$slots:{default:[yd]},$$scope:{ctx:e}}}),t.$on("click",e[10]),u=new Rt({props:{id:"vol-up",disabled:e[1].volume>95,class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$slots:{default:[gd]},$$scope:{ctx:e}}}),u.$on("click",e[11]),{c(){Pe(t.$$.fragment),n=Q(),r=D("div"),s=D("div"),i=Q(),a=D("div"),l=Q(),Pe(u.$$.fragment),Y(s,"class",o=_((e[1].volume<5?"rounded-bottom":"")+" rounded-top bg-gradient")+" svelte-1qpuo59"),q(s,"background","white"),q(s,"height",100-e[1].volume+"%"),Y(a,"class",c=_((e[1].volume>95?"rounded-top":"")+" rounded-bottom bg-gradient")+" svelte-1qpuo59"),q(a,"background","var(--bs-primary)"),q(a,"height",e[1].volume+"%"),q(r,"width","1rem"),q(r,"padding","0 0.3rem"),Y(r,"class","svelte-1qpuo59")},m(e,o){Ye(t,e,o),O(e,n,o),O(e,r,o),N(r,s),N(r,i),N(r,a),O(e,l,o),Ye(u,e,o),f=!0},p(e,n){const r={};2&n&&(r.disabled=e[1].volume<5),4194304&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r),(!f||2&n&&o!==(o=_((e[1].volume<5?"rounded-bottom":"")+" rounded-top bg-gradient")+" svelte-1qpuo59"))&&Y(s,"class",o),(!f||2&n)&&q(s,"height",100-e[1].volume+"%"),(!f||2&n&&c!==(c=_((e[1].volume>95?"rounded-top":"")+" rounded-bottom bg-gradient")+" svelte-1qpuo59"))&&Y(a,"class",c),(!f||2&n)&&q(a,"height",e[1].volume+"%");const i={};2&n&&(i.disabled=e[1].volume>95),4194304&n&&(i.$$scope={dirty:n,ctx:e}),u.$set(i)},i(e){f||(Te(t.$$.fragment,e),Te(u.$$.fragment,e),f=!0)},o(e){Se(t.$$.fragment,e),Se(u.$$.fragment,e),f=!1},d(e){ze(t,e),e&&F(n),e&&F(r),e&&F(l),ze(u,e)}}}function _d(e){let t,n;return t=new Ar({}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function vd(e){let t,n,r,s,o,i,a,c,l,u;r=new Lt({props:{class:"mt-1 ps-1",style:"flex-grow:0;",$$slots:{default:[md]},$$scope:{ctx:e}}}),i=new Hn({props:{id:e[3],class:"mt-1 rounded-1",max:1e3,value:e[0].progress}}),c=new Lt({props:{class:"mt-1 pe-1",$$slots:{default:[Ad]},$$scope:{ctx:e}}});let f=e[2].soundfonts&&_d();return{c(){t=D("div"),n=D("div"),Pe(r.$$.fragment),s=Q(),o=D("div"),Pe(i.$$.fragment),a=Q(),Pe(c.$$.fragment),l=Q(),f&&f.c(),Y(o,"class","px-1 svelte-1qpuo59"),q(o,"flex-grow","1"),q(o,"min-width","6rem"),Y(n,"class","pb-1 rounded-3 bg-gradient svelte-1qpuo59"),q(n,"display","flex"),q(n,"max-width","40rem"),q(n,"flex-grow","1"),q(n,"justify-content","center"),q(n,"align-items","center"),q(n,"flex-wrap","wrap"),q(n,"position","relative"),q(n,"background","var(--atf-gray-600)"),q(t,"display","flex"),q(t,"justify-content","center"),Y(t,"class","svelte-1qpuo59")},m(e,d){O(e,t,d),N(t,n),Ye(r,n,null),N(n,s),N(n,o),Ye(i,o,null),N(n,a),Ye(c,n,null),N(n,l),f&&f.m(n,null),u=!0},p(e,[t]){const s={};4194305&t&&(s.$$scope={dirty:t,ctx:e}),r.$set(s);const o={};1&t&&(o.value=e[0].progress),i.$set(o);const a={};4194306&t&&(a.$$scope={dirty:t,ctx:e}),c.$set(a),e[2].soundfonts?f?4&t&&Te(f,1):(f=_d(),f.c(),Te(f,1),f.m(n,null)):f&&(Ne(),Se(f,1,1,(()=>{f=null})),Ie())},i(e){u||(Te(r.$$.fragment,e),Te(i.$$.fragment,e),Te(c.$$.fragment,e),Te(f),u=!0)},o(e){Se(r.$$.fragment,e),Se(i.$$.fragment,e),Se(c.$$.fragment,e),Se(f),u=!1},d(e){e&&F(t),ze(r),ze(i),ze(c),f&&f.d()}}}function bd(e,t,n){let r,s;u(e,Ll,(e=>n(1,r=e))),u(e,Ul,(e=>n(2,s=e)));qe().getLogger("atf");let{abc:o}=t,{showsElems:i}=t,a="progress"+Math.floor(1e5*Math.random());le((()=>{h.stop()}));let c={replay:!1,progress:0,restart:0},l=fe("app"),f=l.playerContext,d=l.stopPlayerFunctions,p=l.showElemFunctions,h=new Je.Player(f,(function(e){n(0,c.progress=10*e,c),c.progress,e<100||n(0,c={...c,replay:!0})}),(function(){for(let e=0;e<i.length;e++){let t=i[e];p[t](!0)}}));function m(){return"STARTED"==h.status&&(h.stop(),n(0,c.replay=!1,c),!0)}function y(e,t){t.stopPropagation(),"play-pause"==e?m()||(c.replay&&h.seek(0),function(){for(let e=0;e<d.length;e++)d[e]!==m&&d[e]()}(),h.start(),n(0,c.replay=!1,c)):"rewind"==e?(h.seek(0),n(0,c={...c,progress:0,replay:!1})):"vol-down"==e?r.volume>-1&&(v(Ll,r.volume=Math.max(r.volume-10,0),r),h.context.setVolume(r.volume)):"vol-up"==e&&r.volume<101&&(v(Ll,r.volume=Math.min(r.volume+10,100),r),h.context.setVolume(r.volume))}function g(e){let t;e.stopPropagation(),t=e.target.id?e.target:e.target.parentElement;const r=t.getBoundingClientRect();let s=(e.clientX-r.left)/(r.right-r.left);"STARTED"==h.status?(n(0,c={...c,replay:!1,progress:1e3*s}),h.seek(100*s,!0)):(n(0,c={...c,replay:!1,progress:1e3*s}),h.seek(100*s,!1))}h.loadAbc(o),ae((()=>{document.getElementById(a).onclick=g,d.push(m)}));return e.$$set=e=>{"abc"in e&&n(6,o=e.abc),"showsElems"in e&&n(7,i=e.showsElems)},[c,r,s,a,h,y,o,i,e=>y("play-pause",e),e=>y("rewind",e),e=>y("vol-down",e),e=>y("vol-up",e)]}const xd=class extends He{constructor(e){super(),Ve(this,e,bd,vd,a,{abc:6,showsElems:7})}};function wd(e,t,n){const r=e.slice();return r[44]=t[n],r}function Ed(e,t,n){const r=e.slice();return r[44]=t[n],r[48]=n,r}function kd(t){let n,r,s,a,c,l,u,f,d,p=t[13](Je.abcUtils.incAbsNote(t[44],-1)),h=p&&function(t){let n;return{c(){n=D("div"),Y(n,"class","label kmark svelte-1xz4lh1")},m(e,t){O(e,n,t),n.innerHTML=Dd},p:e,d(e){e&&F(n)}}}(),m=t[5]&&function(t){let n,r,s,o=t[12](t[44][0],-1)+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ud,n)},p:e,d(e){e&&F(n)}}}(t),y=t[6]&&function(t){let n,r,s,o=t[44][0]+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ld,n)},p:e,d(e){e&&F(n)}}}(t);return{c(){n=D("div"),r=D("div"),h&&h.c(),s=Q(),m&&m.c(),a=Q(),y&&y.c(),l=Q(),u=D("div"),Y(r,"class","bk-key bk-key-right pb-1 svelte-1xz4lh1"),q(r,"flex-grow",t[9][t[44][0]][0]),Y(r,"absnote",c=Je.midiUtils.getNote(Je.midiUtils.getMidiKey(t[44],-1))),q(u,"flex-grow",t[9][t[44][0]][1]),Y(n,"class","bk-half svelte-1xz4lh1")},m(e,o){O(e,n,o),N(n,r),h&&h.m(r,null),N(r,s),m&&m.m(r,null),N(r,a),y&&y.m(r,null),N(n,l),N(n,u),f||(d=[P(r,"pointerdown",(function(){i(t[0]?t[20]:null)&&(t[0]?t[20]:null).apply(this,arguments)})),P(r,"pointerup",(function(){i(t[0]?t[21]:null)&&(t[0]?t[21]:null).apply(this,arguments)}))],f=!0)},p(e,n){t=e,p&&h.p(t,n),t[5]&&m.p(t,n),t[6]&&y.p(t,n)},d(e){e&&F(n),h&&h.d(),m&&m.d(),y&&y.d(),f=!1,o(d)}}}function Cd(t){let n,r,s,a,c,l,u,f,d,p,h=t[13](t[44]),m=h&&function(t){let n;return{c(){n=D("div"),Y(n,"class","label kmark svelte-1xz4lh1")},m(e,t){O(e,n,t),n.innerHTML=Dd},p:e,d(e){e&&F(n)}}}(),y=t[5]&&function(t){let n,r,s,o=t[44][0]+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ud,n)},p:e,d(e){e&&F(n)}}}(t),g=t[6]&&function(t){let n,r,s,o=t[12](t[44][0],1)+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ld,n)},p:e,d(e){e&&F(n)}}}(t);return{c(){n=D("div"),r=D("div"),s=Q(),a=D("div"),m&&m.c(),c=Q(),y&&y.c(),l=Q(),g&&g.c(),f=Q(),q(r,"flex-grow",t[10][t[44][0]][0]),Y(a,"class","bk-key bk-key-left pb-1 svelte-1xz4lh1"),q(a,"flex-grow",t[10][t[44][0]][1]),Y(a,"absnote",u=Je.midiUtils.getNote(Je.midiUtils.getMidiKey(t[44],1))),Y(n,"class","bk-half svelte-1xz4lh1")},m(e,o){O(e,n,o),N(n,r),N(n,s),N(n,a),m&&m.m(a,null),N(a,c),y&&y.m(a,null),N(a,l),g&&g.m(a,null),N(n,f),d||(p=[P(a,"pointerdown",(function(){i(t[0]?t[24]:null)&&(t[0]?t[24]:null).apply(this,arguments)})),P(a,"pointerup",(function(){i(t[0]?t[25]:null)&&(t[0]?t[25]:null).apply(this,arguments)}))],d=!0)},p(e,n){t=e,h&&m.p(t,n),t[5]&&y.p(t,n),t[6]&&g.p(t,n)},d(e){e&&F(n),m&&m.d(),y&&y.d(),g&&g.d(),d=!1,o(p)}}}function $d(t){let n,r,s,a,c,l,u,f,d,p,h,m,y,g=t[13](t[44]),A=g&&function(t){let n;return{c(){n=D("div"),Y(n,"class","label kmark svelte-1xz4lh1")},m(e,t){O(e,n,t),n.innerHTML=Dd},p:e,d(e){e&&F(n)}}}(),_=t[5]&&function(t){let n,r,s,o=t[44][0]+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ud,n)},p:e,d(e){e&&F(n)}}}(t),v=t[6]&&function(t){let n,r,s,o=t[12](t[44][0])+"";return{c(){n=D("div"),r=L(o),s=new K(!1),s.a=null,Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r),s.m(Ld,n)},p:e,d(e){e&&F(n)}}}(t);return{c(){n=D("div"),r=D("div"),s=Q(),a=D("div"),A&&A.c(),c=Q(),_&&_.c(),l=Q(),v&&v.c(),d=Q(),p=D("div"),h=Q(),q(r,"flex-grow",t[8][t[44][0]][0]),Y(a,"class",u="bk-key "+(0==t[8][t[44][0]][1]?"bk-key-no-border ":"")+"pb-1 svelte-1xz4lh1"),q(a,"flex-grow",t[8][t[44][0]][1]),Y(a,"absnote",f=Je.midiUtils.getNote(Je.midiUtils.getMidiKey(t[44],1))),q(p,"flex-grow",t[8][t[44][0]][2]),Y(n,"class","bk svelte-1xz4lh1")},m(e,o){O(e,n,o),N(n,r),N(n,s),N(n,a),A&&A.m(a,null),N(a,c),_&&_.m(a,null),N(a,l),v&&v.m(a,null),N(n,d),N(n,p),N(n,h),m||(y=[P(a,"pointerdown",(function(){i(t[0]?t[22]:null)&&(t[0]?t[22]:null).apply(this,arguments)})),P(a,"pointerup",(function(){i(t[0]?t[23]:null)&&(t[0]?t[23]:null).apply(this,arguments)}))],m=!0)},p(e,n){t=e,g&&A.p(t,n),t[5]&&_.p(t,n),t[6]&&v.p(t,n)},d(e){e&&F(n),A&&A.d(),_&&_.d(),v&&v.d(),m=!1,o(y)}}}function Bd(e){let t,n,r=0==e[48]&&kd(e);let s=function(e,t){return e[48]<e[11].length-1?$d:Cd}(e),o=s(e);return{c(){r&&r.c(),t=Q(),o.c(),n=j()},m(e,s){r&&r.m(e,s),O(e,t,s),o.m(e,s),O(e,n,s)},p(e,t){0==e[48]&&r.p(e,t),o.p(e,t)},d(e){r&&r.d(e),e&&F(t),o.d(e),e&&F(n)}}}function Md(t){let n;return{c(){n=D("div"),Y(n,"class","label kmark svelte-1xz4lh1")},m(e,t){O(e,n,t),n.innerHTML=Dd},p:e,d(e){e&&F(n)}}}function Nd(t){let n,r,s,a,c,l,u=t[1].indexOf(t[44])>-1,f=u&&Md(),d=t[7]&&function(t){let n,r,s=t[44][0]+"";return{c(){n=D("div"),r=L(s),Y(n,"class","label svelte-1xz4lh1")},m(e,t){O(e,n,t),N(n,r)},p:e,d(e){e&&F(n)}}}(t);return{c(){n=D("div"),f&&f.c(),r=Q(),d&&d.c(),s=Q(),Y(n,"class","wk pb-1 svelte-1xz4lh1"),Y(n,"absnote",a=t[44])},m(e,o){O(e,n,o),f&&f.m(n,null),N(n,r),d&&d.m(n,null),N(n,s),c||(l=[P(n,"pointerdown",(function(){i(t[0]?t[26]:null)&&(t[0]?t[26]:null).apply(this,arguments)})),P(n,"pointerup",(function(){i(t[0]?t[27]:null)&&(t[0]?t[27]:null).apply(this,arguments)}))],c=!0)},p(e,s){t=e,2&s[0]&&(u=t[1].indexOf(t[44])>-1),u?f?f.p(t,s):(f=Md(),f.c(),f.m(n,r)):f&&(f.d(1),f=null),t[7]&&d.p(t,s)},d(e){e&&F(n),f&&f.d(),d&&d.d(),c=!1,o(l)}}}function Id(e){let t,n,r,s;return r=new Lt({props:{class:"p-1",$$slots:{default:[Od]},$$scope:{ctx:e}}}),{c(){t=D("div"),n=D("div"),Pe(r.$$.fragment),Y(n,"class","rounded-3 bg-gradient"),q(n,"height","100%"),q(n,"background","var(--atf-gray-600)"),q(t,"position","absolute"),q(t,"top","0px"),q(t,"right","0px"),q(t,"z-index","20")},m(e,o){O(e,t,o),N(t,n),Ye(r,n,null),s=!0},p(e,t){const n={};8&t[0]|262144&t[1]&&(n.$$scope={dirty:t,ctx:e}),r.$set(n)},i(e){s||(Te(r.$$.fragment,e),s=!0)},o(e){Se(r.$$.fragment,e),s=!1},d(e){e&&F(t),ze(r)}}}function Td(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:fd}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Sd(t){let n,r;return n=new hr({props:{style:"position:relative;top:-1px",data:dd}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Od(e){let t,n,r,s,o,i,a,c,l,u,f;return t=new Rt({props:{id:"vol-down",disabled:e[3].volume<5,class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800);",$$slots:{default:[Td]},$$scope:{ctx:e}}}),t.$on("click",e[28]),u=new Rt({props:{id:"vol-up",disabled:e[3].volume>95,class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800);",$$slots:{default:[Sd]},$$scope:{ctx:e}}}),u.$on("click",e[29]),{c(){Pe(t.$$.fragment),n=Q(),r=D("div"),s=D("div"),i=Q(),a=D("div"),l=Q(),Pe(u.$$.fragment),Y(s,"class",o=_((e[3].volume<5?"rounded-bottom":"")+" rounded-top bg-gradient")+" svelte-1xz4lh1"),q(s,"background","white"),q(s,"height",100-e[3].volume+"%"),Y(a,"class",c=_((e[3].volume>95?"rounded-top":"")+" rounded-bottom bg-gradient")+" svelte-1xz4lh1"),q(a,"background","var(--bs-primary)"),q(a,"height",e[3].volume+"%"),Y(r,"class","p-1"),q(r,"width","1rem")},m(e,o){Ye(t,e,o),O(e,n,o),O(e,r,o),N(r,s),N(r,i),N(r,a),O(e,l,o),Ye(u,e,o),f=!0},p(e,n){const r={};8&n[0]&&(r.disabled=e[3].volume<5),262144&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r),(!f||8&n[0]&&o!==(o=_((e[3].volume<5?"rounded-bottom":"")+" rounded-top bg-gradient")+" svelte-1xz4lh1"))&&Y(s,"class",o),(!f||8&n[0])&&q(s,"height",100-e[3].volume+"%"),(!f||8&n[0]&&c!==(c=_((e[3].volume>95?"rounded-top":"")+" rounded-bottom bg-gradient")+" svelte-1xz4lh1"))&&Y(a,"class",c),(!f||8&n[0])&&q(a,"height",e[3].volume+"%");const i={};8&n[0]&&(i.disabled=e[3].volume>95),262144&n[1]&&(i.$$scope={dirty:n,ctx:e}),u.$set(i)},i(e){f||(Te(t.$$.fragment,e),Te(u.$$.fragment,e),f=!0)},o(e){Se(t.$$.fragment,e),Se(u.$$.fragment,e),f=!1},d(e){ze(t,e),e&&F(n),e&&F(r),e&&F(l),ze(u,e)}}}function Fd(e){let t,n;return t=new Ar({}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Rd(e){let t,n,r,s,o,i,a,c,l=e[11],u=[];for(let t=0;t<l.length;t+=1)u[t]=Bd(Ed(e,l,t));let f=e[11],d=[];for(let t=0;t<f.length;t+=1)d[t]=Nd(wd(e,f,t));let p=e[0]&&Id(e),h=e[0]&&e[4].soundfonts&&Fd();return{c(){t=D("div"),n=D("div"),r=D("div");for(let e=0;e<u.length;e+=1)u[e].c();s=Q(),o=D("div");for(let e=0;e<d.length;e+=1)d[e].c();i=Q(),p&&p.c(),a=Q(),h&&h.c(),Y(r,"class","black-keys svelte-1xz4lh1"),q(r,"pointer-events","none"),Y(o,"class","white-keys svelte-1xz4lh1"),Y(n,"class","keyboard svelte-1xz4lh1"),Y(t,"id","container"),q(t,"position","relative"),Y(t,"class","svelte-1xz4lh1")},m(l,f){O(l,t,f),N(t,n),N(n,r);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(r,null);N(n,s),N(n,o);for(let e=0;e<d.length;e+=1)d[e]&&d[e].m(o,null);N(n,i),p&&p.m(n,null),e[30](n),N(t,a),h&&h.m(t,null),c=!0},p(e,s){if(65377&s[0]){let t;for(l=e[11],t=0;t<l.length;t+=1){const n=Ed(e,l,t);u[t]?u[t].p(n,s):(u[t]=Bd(n),u[t].c(),u[t].m(r,null))}for(;t<u.length;t+=1)u[t].d(1);u.length=l.length}if(51331&s[0]){let t;for(f=e[11],t=0;t<f.length;t+=1){const n=wd(e,f,t);d[t]?d[t].p(n,s):(d[t]=Nd(n),d[t].c(),d[t].m(o,null))}for(;t<d.length;t+=1)d[t].d(1);d.length=f.length}e[0]?p?(p.p(e,s),1&s[0]&&Te(p,1)):(p=Id(e),p.c(),Te(p,1),p.m(n,null)):p&&(Ne(),Se(p,1,1,(()=>{p=null})),Ie()),e[0]&&e[4].soundfonts?h?17&s[0]&&Te(h,1):(h=Fd(),h.c(),Te(h,1),h.m(t,null)):h&&(Ne(),Se(h,1,1,(()=>{h=null})),Ie())},i(e){c||(Te(p),Te(h),c=!0)},o(e){Se(p),Se(h),c=!1},d(n){n&&F(t),R(u,n),R(d,n),p&&p.d(),e[30](null),h&&h.d()}}}const Dd="&#11044;",Ud="&sharp;",Ld="&flat;",Qd=100;function jd(e,t,n){let r,s;u(e,Ll,(e=>n(3,r=e))),u(e,Ul,(e=>n(4,s=e)));qe().getLogger("atf");const o=Ol.assert;let{playable:i=!0}=t,{low:a="C3"}=t,{range:c=15}=t,{mark:l=[]}=t,{label:f=""}=t;const d=f.indexOf("#")>-1,p=f.indexOf("b")>-1,h=f.indexOf("W")>-1;let m,y=fe("app").playerContext,g=y.instr.acoustic_grand_piano;const A=72,_=25.2,b=28*(1-.9),x={G:[14,A,14],C:[b,A,_],F:[b,A,_],D:[_,A,b],A:[_,A,b],B:[0,0,Qd],E:[0,0,Qd]},w={G:[24.8,_],D:[24.8,_],A:[A,28],B:[47.2,b],E:[47.2,b],C:[0,Qd],F:[0,Qd]},E={G:[28,A],C:[b,47.2],F:[b,47.2],D:[_,24.8],A:[_,24.8],B:[Qd,0],E:[Qd,0]};let k=function(e,t){o(2==e.length,"Keyboard.getKeyArray() bad low: "+e);let n=e,r=[n];for(let e=1;e<t;e++)n=Je.abcUtils.incAbsNote(n,1,0),r.push(n);return r}(a,c);let C={};function $(e){let t=e.target.getAttribute("absNote"),n=t.length>2?"bk":"wk";e.target.style["background-image"]=`var(--${n}-down-gradient)`;let r=C[t];r&&(g.stop(y.audioCtx.currentTime,[r.id]),C[t]=null);let s=g.start(t,y.audioCtx.currentTime+0,{gain:1});C[t]=s}function B(e){let t=e.target.getAttribute("absNote"),n=t.length>2?"bk":"wk";e.target.style["background-image"]=`var(--${n}-up-gradient)`;let r=C[t];r&&(g.stop(y.audioCtx.currentTime+.5,[r.id]),C[t]=null)}function M(e,t){"vol-down"==e?r.volume>-1&&(v(Ll,r.volume=Math.max(r.volume-10,0),r),y.setVolume(r.volume)):"vol-up"==e&&r.volume<101&&(v(Ll,r.volume=Math.min(r.volume+10,100),r),y.setVolume(r.volume))}return e.$$set=e=>{"playable"in e&&n(0,i=e.playable),"low"in e&&n(17,a=e.low),"range"in e&&n(18,c=e.range),"mark"in e&&n(1,l=e.mark),"label"in e&&n(19,f=e.label)},[i,l,m,r,s,d,p,h,x,w,E,k,function(e,t=1){o(1==t||-1==t,`Keyboard.getNextKey() Bad param step: ${t}`);const n=["A","B","C","D","E","F","G"];let r=n.indexOf(e);o(r>-1,`Keyboard.getNextKey() Bad param k: ${e}`);const s=n.length;return n[t<0?(t+r+s)%s:(t+r)%s]},function(e){let t=e[0]+"#"+e[1];if(l.indexOf(t)>-1)return!0;let n=Je.abcUtils.incAbsNote(e,1);return l.indexOf(n[0]+"b"+n[1])>-1},$,B,M,a,c,f,e=>$(e),e=>B(e),e=>$(e),e=>B(e),e=>$(e),e=>B(e),e=>$(e),e=>B(e),e=>M("vol-down"),e=>M("vol-up"),function(e){he[e?"unshift":"push"]((()=>{m=e,n(2,m)}))}]}const Pd=class extends He{constructor(e){super(),Ve(this,e,jd,Rd,a,{playable:0,low:17,range:18,mark:1,label:19},null,[-1,-1])}};function Yd(e,t,n){const r=e.slice();return r[14]=t[n],r[16]=n,r}function zd(e){let t,n,r="iIqQaAsSpPkK".indexOf(e[14].id[0])>-1,s=r&&Vd(e);return{c(){s&&s.c(),t=j()},m(e,r){s&&s.m(e,r),O(e,t,r),n=!0},p(e,n){1&n&&(r="iIqQaAsSpPkK".indexOf(e[14].id[0])>-1),r?s?(s.p(e,n),1&n&&Te(s,1)):(s=Vd(e),s.c(),Te(s,1),s.m(t.parentNode,t)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie())},i(e){n||(Te(s),n=!0)},o(e){Se(s),n=!1},d(e){s&&s.d(e),e&&F(t)}}}function Vd(e){let t,n,r,s,o;const i=[Gd,Hd],a=[];function c(e,n){return 1&n&&(t=null),null==t&&(t=!!e[3](e[14].id[0],e[14].id[1])),t?0:1}return n=c(e,-1),r=a[n]=i[n](e),{c(){r.c(),s=j()},m(e,t){a[n].m(e,t),O(e,s,t),o=!0},p(e,t){let o=n;n=c(e,t),n===o?a[n].p(e,t):(Ne(),Se(a[o],1,1,(()=>{a[o]=null})),Ie(),r=a[n],r?r.p(e,t):(r=a[n]=i[n](e),r.c()),Te(r,1),r.m(s.parentNode,s))},i(e){o||(Te(r),o=!0)},o(e){Se(r),o=!1},d(e){a[n].d(e),e&&F(s)}}}function Hd(e){let t,n;return t=new Cf({props:{id:e[14].id,showsElems:e[4](e[14].id),$$slots:{info:[Jd],content:[qd]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.id=e[14].id),1&n&&(r.showsElems=e[4](e[14].id)),131073&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Gd(e){let t,n;return t=new Cf({props:{id:e[14].id,showsElems:e[4](e[14].id),$$slots:{info:[Xd],content:[Kd],content_info:[Wd]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.id=e[14].id),1&n&&(r.showsElems=e[4](e[14].id)),131073&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function qd(e){let t,r,s;const o=[{slot:"content"},e[5](e[14].id)];var i=e[2][e[14].id[0]];function a(e){let t={};for(let e=0;e<o.length;e+=1)t=n(t,o[e]);return{props:t}}return i&&(t=X(i,a())),{c(){t&&Pe(t.$$.fragment),r=j()},m(e,n){t&&Ye(t,e,n),O(e,r,n),s=!0},p(e,n){const s=33&n?Le(o,[o[0],Qe(e[5](e[14].id))]):{};if(1&n&&i!==(i=e[2][e[14].id[0]])){if(t){Ne();const e=t;Se(e.$$.fragment,1,0,(()=>{ze(e,1)})),Ie()}i?(t=X(i,a()),Pe(t.$$.fragment),Te(t.$$.fragment,1),Ye(t,r.parentNode,r)):t=null}else i&&t.$set(s)},i(e){s||(t&&Te(t.$$.fragment,e),s=!0)},o(e){t&&Se(t.$$.fragment,e),s=!1},d(e){e&&F(r),t&&ze(t,e)}}}function Jd(e){let t,n;return t=new yu({props:{slot:"info",html:e[14].info||""}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.html=e[14].info||""),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Wd(e){let t,n;return t=new nd({props:{slot:"content_info",elId0:e[14].id[0].toUpperCase(),html:e[3](e[14].id[0],e[14].id[1])}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.elId0=e[14].id[0].toUpperCase()),1&n&&(r.html=e[3](e[14].id[0],e[14].id[1])),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Kd(e){let t,r,s;const o=[{slot:"content"},e[5](e[14].id)];var i=e[2][e[14].id[0]];function a(e){let t={};for(let e=0;e<o.length;e+=1)t=n(t,o[e]);return{props:t}}return i&&(t=X(i,a())),{c(){t&&Pe(t.$$.fragment),r=j()},m(e,n){t&&Ye(t,e,n),O(e,r,n),s=!0},p(e,n){const s=33&n?Le(o,[o[0],Qe(e[5](e[14].id))]):{};if(1&n&&i!==(i=e[2][e[14].id[0]])){if(t){Ne();const e=t;Se(e.$$.fragment,1,0,(()=>{ze(e,1)})),Ie()}i?(t=X(i,a()),Pe(t.$$.fragment),Te(t.$$.fragment,1),Ye(t,r.parentNode,r)):t=null}else i&&t.$set(s)},i(e){s||(t&&Te(t.$$.fragment,e),s=!0)},o(e){t&&Se(t.$$.fragment,e),s=!1},d(e){e&&F(r),t&&ze(t,e)}}}function Xd(e){let t,n;return t=new yu({props:{slot:"info",html:e[14].info||""}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.html=e[14].info||""),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Zd(e){let t,n,r=e[6](e[14].id,e[1].choices),s=r&&zd(e);return{c(){s&&s.c(),t=j()},m(e,r){s&&s.m(e,r),O(e,t,r),n=!0},p(e,n){3&n&&(r=e[6](e[14].id,e[1].choices)),r?s?(s.p(e,n),3&n&&Te(s,1)):(s=zd(e),s.c(),Te(s,1),s.m(t.parentNode,t)):s&&(Ne(),Se(s,1,1,(()=>{s=null})),Ie())},i(e){n||(Te(s),n=!0)},o(e){Se(s),n=!1},d(e){s&&s.d(e),e&&F(t)}}}function ep(e){let t,n,r=e[0].layout,s=[];for(let t=0;t<r.length;t+=1)s[t]=Zd(Yd(e,r,t));const o=e=>Se(s[e],1,1,(()=>{s[e]=null}));return{c(){t=D("div");for(let e=0;e<s.length;e+=1)s[e].c()},m(e,r){O(e,t,r);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);n=!0},p(e,[n]){if(127&n){let i;for(r=e[0].layout,i=0;i<r.length;i+=1){const o=Yd(e,r,i);s[i]?(s[i].p(o,n),Te(s[i],1)):(s[i]=Zd(o),s[i].c(),Te(s[i],1),s[i].m(t,null))}for(Ne(),i=r.length;i<s.length;i+=1)o(i);Ie()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)Te(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)Se(s[e]);n=!1},d(e){e&&F(t),R(s,e)}}}function tp(e,t,n){let r;u(e,Ll,(e=>n(1,r=e)));qe().getLogger("atf"),Ol.assert;let{ex:s}=t,{partInfo:o}=t,{qkeys:i}=t,{qaidx:a}=t,c={i:nd,I:nd,q:nd,Q:nd,a:nd,A:nd,s:id,S:id,p:xd,P:xd,k:Pd,K:Pd},l=fe("app");function f(){let e=Object.entries(i).sort(),t=e.length,n=`Your question${t>1?"s":""} will be about`;return e.forEach((([e,r],o)=>{let i=o==t-1;t>1&&o>0&&(n+=", ",i&&(n+="and")),n+=` ${s.questions_desc[r]}`,i&&(n+=".")})),n}function d(e){let t=e.split(":")[0].split("#"),n=[];return t.length>1&&(n=Ol.chunkSubstr(t[1],2)),n}return ae((()=>{})),le((()=>{l.stopPlayerFunctions=[],l.toggleElemFunctions={}})),e.$$set=e=>{"ex"in e&&n(7,s=e.ex),"partInfo"in e&&n(0,o=e.partInfo),"qkeys"in e&&n(8,i=e.qkeys),"qaidx"in e&&n(9,a=e.qaidx)},[o,r,c,function(e,t){return"P"==e.toUpperCase()&&s.players[t].info?s.players[t].info:""},d,function(e){let t=e[0].toUpperCase(),n=e[1];if("Q"==t)return{elId0:t,html:s.questions[i[n]][a[n]]};if("A"==t)return{elId0:t,html:`<i>${s.answers[i[n]][a[n]]}</i>`};if("I"==t)return{elId0:t,html:f()};if("S"==t)return{abc:s.scores[n].data};if("P"==t)return{abc:s.players[n].data,showsElems:d(e)};if("K"==t)return s.keyboards&&s.keyboards[n]?s.keyboards[n]:{};throw"Unknown element type: "+t},function(e,t){let n=e.split(":");if(n.length>1){let e=n[1];if(t.indexOf(e)>-1)return!0;for(let e of o.choices)for(let n of e.choices)if(t.indexOf(n.id)>-1)return!1;for(let t of o.choices){if(t.choices[0].id==e)return!0}return!1}return!0},s,i,a]}const np=class extends He{constructor(e){super(),Ve(this,e,tp,ep,a,{ex:7,partInfo:0,qkeys:8,qaidx:9})}};function rp(e,t,n){const r=e.slice();return r[6]=t[n],r[8]=n,r}function sp(e){let t,n,r=e[6].desc+"";return{c(){t=L(r),n=Q()},m(e,r){O(e,t,r),O(e,n,r)},p(e,n){1&n&&r!==(r=e[6].desc+"")&&G(t,r)},d(e){e&&F(t),e&&F(n)}}}function op(e){let t,n;return t=new Rt({props:{class:"btn-sm rounded-3 bg-gradient "+(e[8]<e[0].choices.length-1?" me-1":""),outline:e[1]!=e[6].id,$$slots:{default:[sp]},$$scope:{ctx:e}}}),t.$on("click",(function(){i(e[2](e[6].id))&&e[2](e[6].id).apply(this,arguments)})),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(n,r){e=n;const s={};1&r&&(s.class="btn-sm rounded-3 bg-gradient "+(e[8]<e[0].choices.length-1?" me-1":"")),3&r&&(s.outline=e[1]!=e[6].id),513&r&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function ip(e){let t,n,r,s,o=e[0].desc+":",i=e[0].choices,a=[];for(let t=0;t<i.length;t+=1)a[t]=op(rp(e,i,t));const c=e=>Se(a[e],1,1,(()=>{a[e]=null}));return{c(){t=D("div"),n=L(o),r=Q();for(let e=0;e<a.length;e+=1)a[e].c();q(t,"background","var(--atf-gray-400)"),Y(t,"class","ms-1 mt-0 px-2 py-1 border border-light rounded-3")},m(e,o){O(e,t,o),N(t,n),N(t,r);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,null);s=!0},p(e,[r]){if((!s||1&r)&&o!==(o=e[0].desc+":")&&G(n,o),7&r){let n;for(i=e[0].choices,n=0;n<i.length;n+=1){const s=rp(e,i,n);a[n]?(a[n].p(s,r),Te(a[n],1)):(a[n]=op(s),a[n].c(),Te(a[n],1),a[n].m(t,null))}for(Ne(),n=i.length;n<a.length;n+=1)c(n);Ie()}},i(e){if(!s){for(let e=0;e<i.length;e+=1)Te(a[e]);s=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)Se(a[e]);s=!1},d(e){e&&F(t),R(a,e)}}}function ap(e,t,n){let r,s;u(e,Ll,(e=>n(3,s=e)));qe().getLogger("atf");let{choice:o}=t;return e.$$set=e=>{"choice"in e&&n(0,o=e.choice)},e.$$.update=()=>{8&e.$$.dirty&&n(1,r=function(e){for(let t=0;t<o.choices.length;t++){let n=o.choices[t];if(e.indexOf(n.id)>-1)return n.id}return o.choices[0].id}(s.choices))},[o,r,function(e){for(let t=0;t<o.choices.length;t++){let n=o.choices[t];if(s.choices.indexOf(n.id)>-1)return v(Ll,s.choices=s.choices.replace(n.id,e),s),void s.choices}v(Ll,s.choices+=e,s),s.choices},s]}const cp=class extends He{constructor(e){super(),Ve(this,e,ap,ip,a,{choice:0})}};function lp(e,t,n){const r=e.slice();return r[16]=t[n],r[18]=n,r}function up(e,t,n){const r=e.slice();return r[19]=t[n],r}function fp(e){let t,n,r,s;const o=[hp,pp],i=[];function a(e,t){return e[5].data.length>0?0:1}return t=a(e),n=i[t]=o[t](e),{c(){n.c(),r=j()},m(e,n){i[t].m(e,n),O(e,r,n),s=!0},p(e,s){let c=t;t=a(e),t===c?i[t].p(e,s):(Ne(),Se(i[c],1,1,(()=>{i[c]=null})),Ie(),n=i[t],n?n.p(e,s):(n=i[t]=o[t](e),n.c()),Te(n,1),n.m(r.parentNode,r))},i(e){s||(Te(n),s=!0)},o(e){Se(n),s=!1},d(e){i[t].d(e),e&&F(r)}}}function dp(e){let t,n;return t=new Cf({props:{id:"I1",$$slots:{content_info:[Dp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194308&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function pp(e){let t,n,r,s,o,i,a,c,l,u;n=new vu({props:{help:e[4].info.instruction,$$slots:{default:[mp]},$$scope:{ctx:e}}});let f=e[4].info.choices&&yp(e);const d=[bp,vp],p=[];function h(e,t){return e[0].exSpec?0:1}o=h(e),i=p[o]=d[o](e);let m=e[4].partIdArray.length>1&&Ep(e),y=null!=e[0].exSpec&&Bp(e);return{c(){t=D("div"),Pe(n.$$.fragment),r=Q(),f&&f.c(),s=Q(),i.c(),a=Q(),m&&m.c(),c=Q(),y&&y.c(),l=j(),Y(t,"class","container-fluid")},m(e,i){O(e,t,i),Ye(n,t,null),N(t,r),f&&f.m(t,null),N(t,s),p[o].m(t,null),N(t,a),m&&m.m(t,null),O(e,c,i),y&&y.m(e,i),O(e,l,i),u=!0},p(e,r){const c={};16&r&&(c.help=e[4].info.instruction),4194320&r&&(c.$$scope={dirty:r,ctx:e}),n.$set(c),e[4].info.choices?f?(f.p(e,r),16&r&&Te(f,1)):(f=yp(e),f.c(),Te(f,1),f.m(t,s)):f&&(Ne(),Se(f,1,1,(()=>{f=null})),Ie());let u=o;o=h(e),o===u?p[o].p(e,r):(Ne(),Se(p[u],1,1,(()=>{p[u]=null})),Ie(),i=p[o],i?i.p(e,r):(i=p[o]=d[o](e),i.c()),Te(i,1),i.m(t,a)),e[4].partIdArray.length>1?m?(m.p(e,r),16&r&&Te(m,1)):(m=Ep(e),m.c(),Te(m,1),m.m(t,null)):m&&(Ne(),Se(m,1,1,(()=>{m=null})),Ie()),null!=e[0].exSpec?y?(y.p(e,r),1&r&&Te(y,1)):(y=Bp(e),y.c(),Te(y,1),y.m(l.parentNode,l)):y&&(Ne(),Se(y,1,1,(()=>{y=null})),Ie())},i(e){u||(Te(n.$$.fragment,e),Te(f),Te(i),Te(m),Te(y),u=!0)},o(e){Se(n.$$.fragment,e),Se(f),Se(i),Se(m),Se(y),u=!1},d(e){e&&F(t),ze(n),f&&f.d(),p[o].d(),m&&m.d(),e&&F(c),y&&y.d(e),e&&F(l)}}}function hp(t){let n,r,s,o,i;return o=new Ar({props:{duration_out:0}}),{c(){n=D("div"),r=D("div"),s=L(" \n      "),Pe(o.$$.fragment),q(r,"display","flex"),q(r,"flex-grow","1"),q(r,"align-items","center"),q(r,"position","relative"),q(r,"background","var(--atf-gray-400)"),Y(r,"class","m-2"),q(n,"display","flex")},m(e,t){O(e,n,t),N(n,r),N(r,s),Ye(o,r,null),i=!0},p:e,i(e){i||(Te(o.$$.fragment,e),i=!0)},o(e){Se(o.$$.fragment,e),i=!1},d(e){e&&F(n),ze(o)}}}function mp(e){let t,n=e[4].title+"";return{c(){t=L(n)},m(e,n){O(e,t,n)},p(e,r){16&r&&n!==(n=e[4].title+"")&&G(t,n)},d(e){e&&F(t)}}}function yp(e){let t,n,r=e[4].info.choices,s=[];for(let t=0;t<r.length;t+=1)s[t]=_p(up(e,r,t));const o=e=>Se(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=j()},m(e,r){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,r);O(e,t,r),n=!0},p(e,n){if(16&n){let i;for(r=e[4].info.choices,i=0;i<r.length;i+=1){const o=up(e,r,i);s[i]?(s[i].p(o,n),Te(s[i],1)):(s[i]=_p(o),s[i].c(),Te(s[i],1),s[i].m(t.parentNode,t))}for(Ne(),i=r.length;i<s.length;i+=1)o(i);Ie()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)Te(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)Se(s[e]);n=!1},d(e){R(s,e),e&&F(t)}}}function gp(e){let t,n;return t=new cp({props:{choice:e[19]}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};16&n&&(r.choice=e[19]),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Ap(e){let t,n,r;return t=new Vt({props:{class:"me-1 px-0",$$slots:{default:[gp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q()},m(e,s){Ye(t,e,s),O(e,n,s),r=!0},p(e,n){const r={};4194320&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(Te(t.$$.fragment,e),r=!0)},o(e){Se(t.$$.fragment,e),r=!1},d(e){ze(t,e),e&&F(n)}}}function _p(e){let t,n;return t=new Jn({props:{class:"pb-1",$$slots:{default:[Ap]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194320&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function vp(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function bp(e){let t,n;return t=new rf({props:{$$slots:{default:[wp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194329&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function xp(e){let t,n;return t=new np({props:{partInfo:e[4].info,ex:e[4].data,qkeys:e[0].exSpec.parts_qkeys[e[4].partId],qaidx:e[0].exSpec.parts_qa_idx[e[4].partId]}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};16&n&&(r.partInfo=e[4].info),16&n&&(r.ex=e[4].data),17&n&&(r.qkeys=e[0].exSpec.parts_qkeys[e[4].partId]),17&n&&(r.qaidx=e[0].exSpec.parts_qa_idx[e[4].partId]),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function wp(t){let n,r,s=t[3],o=xp(t);return{c(){o.c(),n=j()},m(e,t){o.m(e,t),O(e,n,t),r=!0},p(t,r){8&r&&a(s,s=t[3])?(Ne(),Se(o,1,1,e),Ie(),o=xp(t),o.c(),Te(o,1),o.m(n.parentNode,n)):o.p(t,r)},i(e){r||(Te(o),r=!0)},o(e){Se(o),r=!1},d(e){e&&F(n),o.d(e)}}}function Ep(e){let t,n;return t=new Jn({props:{class:"px-0 pb-1 align-items-center",$$slots:{default:[$p]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194325&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function kp(e){let t,n,r=`${e[18]==e[0].partIdx?e[2].partDesc:""} (${"num"==e[2].partLabel?e[18]+1:e[16]})`;return{c(){t=L(r),n=Q()},m(e,r){O(e,t,r),O(e,n,r)},p(e,n){21&n&&r!==(r=`${e[18]==e[0].partIdx?e[2].partDesc:""} (${"num"==e[2].partLabel?e[18]+1:e[16]})`)&&G(t,r)},d(e){e&&F(t),e&&F(n)}}}function Cp(e){let t,n;function r(...t){return e[10](e[18],...t)}return t=new Rt({props:{color:e[18]<e[0].partIdx?"success":e[18]>e[0].partIdx?"primary":"warning",class:"btn-sm ms-1 pt-0 rounded-3 bg-gradient",active:e[16]==e[4].partId,$$slots:{default:[kp]},$$scope:{ctx:e}}}),t.$on("click",(function(){i(e[16]!=e[4].partId?r:null)&&(e[16]!=e[4].partId?r:null).apply(this,arguments)})),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(n,r){e=n;const s={};1&r&&(s.color=e[18]<e[0].partIdx?"success":e[18]>e[0].partIdx?"primary":"warning"),16&r&&(s.active=e[16]==e[4].partId),4194325&r&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function $p(e){let t,n,r,s=e[4].partIdArray,o=[];for(let t=0;t<s.length;t+=1)o[t]=Cp(lp(e,s,t));const i=e=>Se(o[e],1,1,(()=>{o[e]=null}));return{c(){t=D("div"),n=D("div");for(let e=0;e<o.length;e+=1)o[e].c();q(n,"background","var(--atf-gray-200)"),Y(n,"class","text-center ms-1 mt-0 p-1 border border-light rounded-3"),q(t,"position","relative"),Y(t,"class","col me-1 px-0")},m(e,s){O(e,t,s),N(t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(n,null);r=!0},p(e,t){if(533&t){let r;for(s=e[4].partIdArray,r=0;r<s.length;r+=1){const i=lp(e,s,r);o[r]?(o[r].p(i,t),Te(o[r],1)):(o[r]=Cp(i),o[r].c(),Te(o[r],1),o[r].m(n,null))}for(Ne(),r=s.length;r<o.length;r+=1)i(r);Ie()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)Te(o[e]);r=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)Se(o[e]);r=!1},d(e){e&&F(t),R(o,e)}}}function Bp(e){let t,n,r,s,o=!1,i=o&&Mp(e);return r=new Jn({props:{class:"justify-content-end p-1",$$slots:{default:[Op]},$$scope:{ctx:e}}}),{c(){t=D("div"),i&&i.c(),n=Q(),Pe(r.$$.fragment),Y(t,"class","container-fluid mb-1"),q(t,"background","var(--atf-gray-400)")},m(e,o){O(e,t,o),i&&i.m(t,null),N(t,n),Ye(r,t,null),s=!0},p(e,s){67&s&&(o=!1),o?i?67&s&&Te(i,1):(i=Mp(e),i.c(),Te(i,1),i.m(t,n)):i&&(Ne(),Se(i,1,1,(()=>{i=null})),Ie());const a={};4194304&s&&(a.$$scope={dirty:s,ctx:e}),r.$set(a)},i(e){s||(Te(i),Te(r.$$.fragment,e),s=!0)},o(e){Se(i),Se(r.$$.fragment,e),s=!1},d(e){e&&F(t),i&&i.d(),ze(r)}}}function Mp(e){let t,n;return t=new Jn({props:{class:"justify-content-center py-1",style:"background:var(--atf-gray-200)",$$slots:{default:[Ip]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Np(t){let n,r;return n=new Zf({props:{color:"warning",html:"For more content, please subscribe."}}),{c(){Pe(n.$$.fragment)},m(e,t){Ye(n,e,t),r=!0},p:e,i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){ze(n,e)}}}function Ip(e){let t,n;return t=new Vt({props:{class:"col-auto m-0 p-0",$$slots:{default:[Np]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194304&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Tp(e){let t;return{c(){t=L("New Exercise ...")},m(e,n){O(e,t,n)},d(e){e&&F(t)}}}function Sp(e){let t,n;return t=new Rt({props:{class:"btn-sm btn-light btn-outline-secondary rounded-3 bg-gradient",$$slots:{default:[Tp]},$$scope:{ctx:e}}}),t.$on("click",e[11]),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194304&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Op(e){let t,n;return t=new Vt({props:{class:"col-auto m-0 p-0",$$slots:{default:[Sp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194304&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Fp(e){let t,n;return t=new Zf({props:{color:"warning",html:e[2].msg}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.html=e[2].msg),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Rp(e){let t,n;return t=new Vt({props:{$$slots:{default:[Fp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};4194308&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Dp(e){let t,n,r;return n=new Jn({props:{$$slots:{default:[Rp]},$$scope:{ctx:e}}}),{c(){t=D("div"),Pe(n.$$.fragment),Y(t,"class","p-0 m-0"),Y(t,"slot","content_info")},m(e,s){O(e,t,s),Ye(n,t,null),r=!0},p(e,t){const r={};4194308&t&&(r.$$scope={dirty:t,ctx:e}),n.$set(r)},i(e){r||(Te(n.$$.fragment,e),r=!0)},o(e){Se(n.$$.fragment,e),r=!1},d(e){e&&F(t),ze(n)}}}function Up(e){let t,n,r,s,o,i,a;n=new Wf({});const c=[dp,fp],l=[];function u(e,t){return"MsgContent"==e[2].cmpt?0:"ExContent"==e[2].cmpt?1:-1}~(s=u(e))&&(o=l[s]=c[s](e));let f=!1;return{c(){t=D("div"),Pe(n.$$.fragment),r=Q(),o&&o.c(),i=Q(),f&&f.c()},m(e,o){O(e,t,o),Ye(n,t,null),N(t,r),~s&&l[s].m(t,null),N(t,i),f&&f.m(t,null),a=!0},p(e,[n]){let r=s;s=u(e),s===r?~s&&l[s].p(e,n):(o&&(Ne(),Se(l[r],1,1,(()=>{l[r]=null})),Ie()),~s?(o=l[s],o?o.p(e,n):(o=l[s]=c[s](e),o.c()),Te(o,1),o.m(t,i)):o=null)},i(e){a||(Te(n.$$.fragment,e),Te(o),Te(f),a=!0)},o(e){Se(n.$$.fragment,e),Se(o),Se(f),a=!1},d(e){e&&F(t),ze(n),~s&&l[s].d(),f&&f.d()}}}function Lp(e,t,n){let r,s,o,i,a,c;u(e,Dl,(e=>n(0,s=e))),u(e,Fl,(e=>n(1,o=e))),u(e,Rl,(e=>n(12,i=e))),u(e,Ul,(e=>n(5,a=e))),u(e,Ll,(e=>n(6,c=e)));qe().getLogger("atf");const l=Ol.assert;let f,d;function p(){JSON.stringify(f),l.ok("ExContent"==f.cmpt),v(Dl,s.exSpec=Ol.getNextExSpec(i,o,s.exSpec),s)}function h(e){v(Dl,s.partIdx=e,s)}function m(e){h(e)}ae((()=>{})),ie((()=>{})),ce((()=>{}));return e.$$.update=()=>{2&e.$$.dirty&&n(2,f=Ol.getMenuItemAtPath(po.exMenu,o)),1&e.$$.dirty&&n(4,r=function(e){let t=s.exSpec;if("ExContent"==f.cmpt&&t){let r=Ol.getPartsObj(i,o),s=Object.keys(t.parts_ex_id),a=s[e],c=a;"num"==f.partLabel&&(c=e+1);let l={id:a,desc:c},u=r[a][t.parts_ex_id[a]],p=Ol.getExPartInfo(o,a,u.xi),h=(s.length>1?`(${l.desc}) `:"")+p.title;return t.end,n(3,d=new Set([t,a])),{title:h,info:p,partId:a,partIdArray:s,part:l,data:u}}return{title:"No Data",info:{instruction:"No Data"},partId:null,partIdArray:[],part:{id:"No Data",desc:"No Data"},data:null}}(s.partIdx))},[s,o,f,d,r,a,c,p,h,m,(e,t)=>m(e),()=>{p(),h(0)}]}const Qp=class extends He{constructor(e){super(),Ve(this,e,Lp,Up,a,{})}};const{document:jp}=$;function Pp(e){let t,n;return t=new qt({props:{fluid:!0,class:"p-0 bg-gradient",style:"background:var(--atf-gray-300)",$$slots:{default:[zp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};65542&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Yp(e){let t,n;return t=new qt({props:{fluid:!0,class:"d-flex",style:"height:100%;justify-content:center;",$$slots:{default:[qp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};65537&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function zp(e){let t,n,r,s,o,i,a;t=new iu({}),r=new Jl({});var c=e[1][e[2].currPage];return c&&(o=X(c,{})),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment),s=Q(),o&&Pe(o.$$.fragment),i=j()},m(e,c){Ye(t,e,c),O(e,n,c),Ye(r,e,c),O(e,s,c),o&&Ye(o,e,c),O(e,i,c),a=!0},p(e,t){if(6&t&&c!==(c=e[1][e[2].currPage])){if(o){Ne();const e=o;Se(e.$$.fragment,1,0,(()=>{ze(e,1)})),Ie()}c?(o=X(c,{}),Pe(o.$$.fragment),Te(o.$$.fragment,1),Ye(o,i.parentNode,i)):o=null}},i(e){a||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),o&&Te(o.$$.fragment,e),a=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),o&&Se(o.$$.fragment,e),a=!1},d(e){ze(t,e),e&&F(n),ze(r,e),e&&F(s),e&&F(i),o&&ze(o,e)}}}function Vp(e){let t;return{c(){t=L(e[0])},m(e,n){O(e,t,n)},p(e,n){1&n&&G(t,e[0])},d(e){e&&F(t)}}}function Hp(t){let n,r,s;return r=new Ar({props:{duration_out:0}}),{c(){n=L(" \n       \n      "),Pe(r.$$.fragment)},m(e,t){O(e,n,t),Ye(r,e,t),s=!0},p:e,i(e){s||(Te(r.$$.fragment,e),s=!0)},o(e){Se(r.$$.fragment,e),s=!1},d(e){e&&F(n),ze(r,e)}}}function Gp(e){let t,n,r,s;return t=new Vt({props:{class:"display-4 p-2 rounded-3",style:"opacity:0.5",$$slots:{default:[Vp]},$$scope:{ctx:e}}}),r=new Vt({props:{class:"p-2",style:"width:40px;align-self:center;position:relative;",$$slots:{default:[Hp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment),n=Q(),Pe(r.$$.fragment)},m(e,o){Ye(t,e,o),O(e,n,o),Ye(r,e,o),s=!0},p(e,n){const s={};65537&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const o={};65536&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){s||(Te(t.$$.fragment,e),Te(r.$$.fragment,e),s=!0)},o(e){Se(t.$$.fragment,e),Se(r.$$.fragment,e),s=!1},d(e){ze(t,e),e&&F(n),ze(r,e)}}}function qp(e){let t,n;return t=new Jn({props:{class:"d-flex",style:"flex-direction:column;align-self:center;",$$slots:{default:[Gp]},$$scope:{ctx:e}}}),{c(){Pe(t.$$.fragment)},m(e,r){Ye(t,e,r),n=!0},p(e,n){const r={};65537&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(Te(t.$$.fragment,e),n=!0)},o(e){Se(t.$$.fragment,e),n=!1},d(e){ze(t,e)}}}function Jp(e){let t,n,r,s,o,i,a,c;jp.title=t="Aural Practice (music)";const l=[Yp,Pp],u=[];function f(e,t){return e[3].initApp?0:1}return r=f(e),s=u[r]=l[r](e),{c(){n=Q(),s.c(),o=j()},m(t,s){O(t,n,s),u[r].m(t,s),O(t,o,s),i=!0,a||(c=P(window,"keyup",e[4]),a=!0)},p(e,[n]){(!i||0&n)&&t!==(t="Aural Practice (music)")&&(jp.title=t);let a=r;r=f(e),r===a?u[r].p(e,n):(Ne(),Se(u[a],1,1,(()=>{u[a]=null})),Ie(),s=u[r],s?s.p(e,n):(s=u[r]=l[r](e),s.c()),Te(s,1),s.m(o.parentNode,o))},i(e){i||(Te(s),i=!0)},o(e){Se(s),i=!1},d(e){e&&F(n),u[r].d(e),e&&F(o),a=!1,c()}}}function Wp(e,t,n){let r,s,o;u(e,Ll,(e=>n(2,r=e))),u(e,Ul,(e=>n(3,s=e))),u(e,Rl,(e=>n(6,o=e)));const i=qe().getLogger("atf");try{let e="WARN";i.setLevel(e),We().log.setLevel(e),We().instr.log.setLevel(e)}catch(e){let t="WARN";i.setLevel(t),We().log.setLevel(t),We().instr.log.setLevel(t)}let{name:a}=t;document.getElementById("loading").remove();const c={home:Ku,exercises:Qp};let l={playerContext:new(We().PlayerContext),stopPlayerFunctions:[],showElemFunctions:{},exData:{}};var f,d;f="app",d=l,oe().$$.context.set(f,d),async function(){v(Ul,s.initApp=!1,s)}();let p=l.playerContext.loadInstrument("acoustic_grand_piano","sm").then((e=>{i.info("loaded piano")})),h=l.playerContext.loadInstrument("flute","mk").then((e=>{i.info("loaded flute")})),m=l.playerContext.loadInstrument("woodblock","mk","woodblockx").then((e=>{i.info("loaded woodblockx")}));return Promise.all([p,h,m]).then((e=>{v(Ul,s.soundfonts=!1,s)})),e.$$set=e=>{"name"in e&&n(0,a=e.name)},[a,c,r,s,function({key:e}){"Escape"===e&&"exercises"==r.currPage&&r.hideAppMenu&&v(Ll,r.hideAppMenu=!1,r)}]}const Kp=class extends He{constructor(e){super(),Ve(this,e,Wp,Jp,a,{name:0})}};let Xp=null;"aural.ldsys.co.uk"==window.location.hostname&&(Xp=new Kp({target:document.body,props:{name:"Aural Practice"}}))})()})();
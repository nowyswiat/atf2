(()=>{var __webpack_modules__={937:(__unused_webpack_module,exports)=>{var __webpack_unused_export__;if(void 0===abc2svg)var abc2svg={};abc2svg.C={BLEN:1536,BAR:0,CLEF:1,CUSTOS:2,SM:3,GRACE:4,KEY:5,METER:6,MREST:7,NOTE:8,PART:9,REST:10,SPACE:11,STAVES:12,STBRK:13,TEMPO:14,BLOCK:16,REMARK:17,FULL:0,EMPTY:1,OVAL:2,OVALBARS:3,SQUARE:4,SL_ABOVE:1,SL_BELOW:2,SL_AUTO:3,SL_HIDDEN:4,SL_DOTTED:8,SL_ALI_MSK:112,SL_ALIGN:16,SL_CENTER:32,SL_CLOSE:64},abc2svg.sym_name=["bar","clef","custos","smark","grace","key","meter","Zrest","note","part","rest","yspace","staves","Break","tempo","","block","remark"],abc2svg.keys=[new Int8Array([-1,-1,-1,-1,-1,-1,-1]),new Int8Array([-1,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,-1,-1,-1]),new Int8Array([0,-1,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,-1,-1]),new Int8Array([0,0,-1,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,-1]),new Int8Array([0,0,0,0,0,0,0]),new Int8Array([0,0,0,1,0,0,0]),new Int8Array([1,0,0,1,0,0,0]),new Int8Array([1,0,0,1,1,0,0]),new Int8Array([1,1,0,1,1,0,0]),new Int8Array([1,1,0,1,1,1,0]),new Int8Array([1,1,1,1,1,1,0]),new Int8Array([1,1,1,1,1,1,1])],abc2svg.p_b40=new Int8Array([2,8,14,19,25,31,37]),abc2svg.b40_p=new Int8Array([0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6]),abc2svg.b40_a=new Int8Array([-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2,0,-2,-1,0,1,2]),abc2svg.b40_m=new Int8Array([-2,-1,0,1,2,0,0,1,2,3,4,0,2,3,4,5,6,3,4,5,6,7,0,5,6,7,8,9,0,7,8,9,10,11,0,9,10,11,12,13]),abc2svg.b40k=new Int8Array([36,1,2,3,8,2,2,7,8,13,14,2,8,13,14,19,20,13,14,19,20,25,2,19,24,25,30,31,2,25,30,31,36,37,2,31,36,37,2,3]),abc2svg.b40sf=new Int8Array([-2,-7,0,7,2,88,0,-5,2,-3,4,88,2,-3,4,-1,6,-3,4,-1,6,1,88,-1,-6,1,-4,3,88,1,-4,3,-2,5,88,3,-2,5,0,7]),abc2svg.isb40=new Int8Array([0,1,6,11,12,17,18,23,28,29,34,35]),abc2svg.ifb40=new Int8Array([0,5,6,11,12,17,22,23,28,29,34,39]),abc2svg.pab40=function(e,t){var n=40*((e+=19)/7|0)+abc2svg.p_b40[e%7];return t&&3!=t&&(n+=t),n},abc2svg.b40p=function(e){return 7*(e/40|0)+abc2svg.b40_p[e%40]-19},abc2svg.b40a=function(e){return abc2svg.b40_a[e%40]},abc2svg.b40m=function(e){return 12*(e/40|0)+abc2svg.b40_m[e%40]},abc2svg.ch_alias={maj:"",min:"m","-":"m","°":"dim","+":"aug","+5":"aug",maj7:"M7",Δ7:"M7",Δ:"M7",min7:"m7","-7":"m7",ø7:"m7b5","°7":"dim7","min+7":"m+7",aug7:"+7","7+5":"+7","7#5":"+7",sus:"sus4","7sus":"7sus4"},abc2svg.ft_w={thin:100,extralight:200,light:300,regular:400,medium:500,semi:600,demi:600,semibold:600,demibold:600,bold:700,extrabold:800,ultrabold:800,black:900,heavy:900},abc2svg.ft_re=new RegExp("-?Thin|-?Extra Light|-?Light|-?Regular|-?Medium|-?[DS]emi|-?[DS]emi[ -]?Bold|-?Bold|-?Extra[ -]?Bold|-?Ultra[ -]?Bold|-?Black|-?Heavy/","i"),abc2svg.rat=function(e,t){for(var n,r,s=0,i=0,o=1,a=1;0!=t;)r=t,n=e/t|0,t=e%t,e=r,r=s+n*o,s=o,o=r,r=a+n*i,a=i,i=r;return[o,i]},abc2svg.pitcmp=function(e,t){return e.pit-t.pit},abc2svg.Abc=function(user){"use strict";var C=abc2svg.C,require=empty_function,system=empty_function,write=empty_function,XMLHttpRequest=empty_function,OPEN_BRACE=1,CLOSE_BRACE=2,OPEN_BRACKET=4,CLOSE_BRACKET=8,OPEN_PARENTH=16,CLOSE_PARENTH=32,STOP_BAR=64,FL_VOICE=128,OPEN_BRACE2=256,CLOSE_BRACE2=512,OPEN_BRACKET2=1024,CLOSE_BRACKET2=2048,MASTER_VOICE=4096,IN=96,CM=37.8,YSTEP,errs={bad_char:"Bad character '$1'",bad_grace:"Bad character in grace note sequence",bad_transp:"Bad transpose value",bad_val:"Bad value in $1",bar_grace:"Cannot have a bar in grace notes",ignored:"$1: inside tune - ignored",misplaced:"Misplaced '$1' in %%score",must_note:"!$1! must be on a note",must_note_rest:"!$1! must be on a note or a rest",nonote_vo:"No note in voice overlay",not_ascii:"Not an ASCII character",not_enough_n:"Not enough notes/rests for %%repeat",not_enough_m:"Not enough measures for %%repeat",not_enough_p:"Not enough parameters in %%map",not_in_tune:"Cannot have '$1' inside a tune",notransp:"Cannot transpose with a temperament"},self=this,glovar={meter:{type:C.METER,wmeasure:1,a_meter:[]}},info={},parse={ctx:{},prefix:"%",state:0,ottava:[],line:new scanBuf},tunes=[],psvg;function clone(e,t){if(!e)return e;var n=new e.constructor;for(var r in e)e.hasOwnProperty(r)&&(t&&"object"==typeof e[r]?n[r]=clone(e[r],t-1):n[r]=e[r]);return n}function errbld(e,t,n,r){var s,i,o,a,c;if(user.errbld){switch(e){case 0:e="warn";break;case 1:e="error";break;default:e="fatal"}user.errbld(e,t,n,r)}else{if(null!=r&&r>=0){for(s=o=0;!((i=parse.file.indexOf("\n",s))<0||i>r);)o++,s=i+1;a=r-s}switch(c="",n&&(c=n,o&&(c+=":"+(o+1)+":"+(a+1)),c+=" "),e){case 0:c+="Warning: ";break;case 1:c+="Error: ";break;default:c+="Internal bug: "}user.errmsg(c+t,o,a)}}function error(e,t,n,r,s,i,o){var a;if(e||!cfmt.quiet){if(t){if(t.err)return;t.err=!0}user.textrans&&(a=user.textrans[n])&&(n=a),arguments.length>3&&(n=n.replace(/\$./g,(function(e){switch(e){case"$1":return r;case"$2":return s;case"$3":return i;default:return o}}))),t&&t.fname?errbld(e,n,t.fname,t.istart):errbld(e,n)}}function scanBuf(){this.index=0,scanBuf.prototype.char=function(){return this.buffer[this.index]},scanBuf.prototype.next_char=function(){return this.buffer[++this.index]},scanBuf.prototype.get_int=function(){for(var e=0,t=this.buffer[this.index];t>="0"&&t<="9";)e=10*e+Number(t),t=this.next_char();return e}}function syntax(e,t,n,r,s,i){error(e,{fname:parse.fname,istart:parse.istart+parse.line.index},t,n,r,s,i)}function js_inject(js){/eval *\(|Function|setTimeout|setInterval/.test(js)?syntax(1,"Unsecure code"):eval('"use strict";\n'+js)}var dd_tb={},a_de,cross,decos={dot:"0 stc 6 1 1",tenuto:"0 emb 6 3 3",slide:"1 sld 3 7 0",arpeggio:"2 arp 12 10 2",roll:"3 roll 3,3 6 6",emphasis:"3 accent 3.5,3.5 4 4",lowermordent:"3 lmrd 4,4 5 5",uppermordent:"3 umrd 4,4 5 5",trill:"3 trl 14 5 5",upbow:"3 upb 10 5 5",downbow:"3 dnb 9 5 5",gmark:"3 grm 6 5 5",wedge:"0 wedge 8 3 3",longphrase:"3 lphr 0 1 1",mediumphrase:"3 mphr 0 1 1",shortphrase:"3 sphr 0 1 1",turnx:"3 turnx 5,5 6 6",invertedturn:"3 turn 5,5 6 6",0:"3 fng 5,5 3 3 0",1:"3 fng 5,5 3 3 1",2:"3 fng 5,5 3 3 2",3:"3 fng 5,5 3 3 3",4:"3 fng 5,5 3 3 4",5:"3 fng 5,5 3 3 5",plus:"3 dplus 7 3 3","+":"3 dplus 7 3 3",accent:"3 accent 3.5,3.5 4 4",">":"3 accent 3.5,3.5 4 4",marcato:"3 marcato 9 3 3","^":"3 marcato 9 3 3",mordent:"3 lmrd 4,4 5 5",open:"3 opend 10 3 3",snap:"3 snap 14 3 3",thumb:"3 thumb 14 3 3",turn:"3 turn 5,5 6 6","trill(":"3 ltr 8 4 0","trill)":"3 ltr 8 4 0","8va(":"5 8va 12 6 6","8va)":"5 8va 12 6 6","8vb(":"7 8vb 12 6 6","8vb)":"7 8vb 12 6 6","15ma(":"5 15ma 12 9 9","15ma)":"5 15ma 12 9 9","15mb(":"7 15mb 12 9 9","15mb)":"7 15mb 12 9 9",breath:"5 brth 0 1 20",caesura:"5 caes 0 1 10",short:"5 short 0 1 4",tick:"5 tick 0 1 4",coda:"5 coda 24 10 10",dacapo:"5 dacs 16 20 20 Da Capo",dacoda:"5 dacs 16 20 20 Da Coda","D.C.":"5 dcap 16 10 10","D.S.":"5 dsgn 16 10 10","D.C.alcoda":"5 dacs 16 38 38 D.C. al Coda","D.S.alcoda":"5 dacs 16 38 38 D.S. al Coda","D.C.alfine":"5 dacs 16 38 38 D.C. al Fine","D.S.alfine":"5 dacs 16 38 38 D.S. al Fine",fermata:"3 hld 12 7 7",fine:"5 dacs 16 10 10 Fine",invertedfermata:"4 hld 12 7 7",segno:"5 sgno 22 8 8",f:"6 f 18 4 4",ff:"6 ff 18 6 6",fff:"6 fff 18 9 9",ffff:"6 ffff 18 12 12",mf:"6 mf 18 9 9",mp:"6 mp 18 10 10",p:"6 p 18 5 5",pp:"6 pp 18 9 9",ppp:"6 ppp 18 13 13",pppp:"6 pppp 18 17 17",pralltriller:"3 umrd 4,4 5 5",sfz:"6 sfz 18 8 8",ped:"7 ped 18 6 10","ped-up":"7 pedoff 12 4 4","ped(":"7 lped 20 5 5","ped)":"7 lped 20 5 5","crescendo(":"6 cresc 18 0 0","crescendo)":"6 cresc 18 0 0","<(":"6 cresc 18 0 0","<)":"6 cresc 18 0 0","diminuendo(":"6 dim 18 0 0","diminuendo)":"6 dim 18 0 0",">(":"6 dim 18 0 0",">)":"6 dim 18 0 0","-(":"8 gliss 0 0 0","-)":"8 gliss 0 0 0","~(":"8 glisq 0 0 0","~)":"8 glisq 0 0 0",invisible:"32 0 0 0 0",beamon:"33 0 0 0 0",trem1:"34 0 0 0 0",trem2:"34 0 0 0 0",trem3:"34 0 0 0 0",trem4:"34 0 0 0 0",xstem:"35 0 0 0 0",beambr1:"36 0 0 0 0",beambr2:"36 0 0 0 0",rbstop:"37 0 0 0 0","/":"38 0 0 6 6","//":"38 0 0 6 6","///":"38 0 0 6 6","beam-accel":"39 0 0 0 0","beam-rall":"39 0 0 0 0",stemless:"40 0 0 0 0",rbend:"41 0 0 0 0",editorial:"42 0 0 0 0","sacc-1":"3 sacc-1 6,4 4 4",sacc3:"3 sacc3 6,5 4 4",sacc1:"3 sacc1 6,4 4 4",courtesy:"43 0 0 0 0","cacc-1":"3 cacc-1 0 0 0",cacc3:"3 cacc3 0 0 0",cacc1:"3 cacc1 0 0 0","tie(":"44 0 0 0 0","tie)":"44 0 0 0 0"},f_near=[d_near,d_slide,d_arp],f_note=[null,null,null,d_upstaff,d_upstaff],f_staff=[null,null,null,null,null,d_upstaff,d_pf,d_upstaff];function y_get(e,t,n,r){var s,i=staff_tb[e],o=n/2|0,a=(n+r)/2|0;if(o<0&&(o=0),a>=YSTEP&&o>(a=YSTEP-1)&&(o=a),t)for(s=i.top[o++];o<=a;)s<i.top[o]&&(s=i.top[o]),o++;else for(s=i.bot[o++];o<=a;)s>i.bot[o]&&(s=i.bot[o]),o++;return s}function y_set(e,t,n,r,s){var i=staff_tb[e],o=n/2|0,a=(n+r)/2|0;if(o<0&&(o=0),a>=YSTEP&&o>(a=YSTEP-1)&&(o=a),t)for(;o<=a;)i.top[o]<s&&(i.top[o]=s),o++;else for(;o<=a;)i.bot[o]>s&&(i.bot[o]=s),o++}function up3(e,t){switch(7&t){case C.SL_ABOVE:return 1;case C.SL_BELOW:return 0}return!e.second}function up6(e,t){switch(7&t){case C.SL_ABOVE:return!0;case C.SL_BELOW:return!1}return e.multi?e.multi>0:!!e.p_v.have_ly&&(7&e.pos.voc)!=C.SL_ABOVE}function d_arp(e){var t,n,r,s=e.s,i=e.dd,o=i.wr;if(s.type==C.NOTE)for(t=0;t<=s.nhd;t++){if(s.notes[t].acc)r=s.notes[t].shac;else switch(r=1-s.notes[t].shhd,s.head){case C.SQUARE:r+=3.5;break;case C.OVALBARS:case C.OVAL:r+=2}r>o&&(o=r)}(n=3*(s.notes[s.nhd].pit-s.notes[0].pit)+4)<(t=i.h)&&(n=t),e.has_val=!0,e.val=n,e.x-=o,e.y=3*((s.notes[0].pit+s.notes[s.nhd].pit)/2-18)-n/2-3}function d_cresc(e){if(!e.ldst){var t,n,r,s,i,o=e.dd,a=e.s,c=e.start,l=c.s,u=l.x+3;for(e.st=a.st,e.lden=!1,e.has_val=!0,"^"==o.ty?t=1:"_"!=o.ty&&(t=up6(a,a.pos.dyn)),t&&(e.up=!0),s=c.ix;--s>=0&&(i=a_de[s])&&i.s==l;);for(;s++,(i=a_de[s])&&i.s==l;)if(i!=e&&i!=c&&!(e.up^i.up)&&f_staff[i.dd.func]){(r=i.x+i.dd.wr+2)>u&&(u=r);break}if(e.defl.noen)(n=e.x-u)<20&&(u=e.x-20-3,n=20);else{for(r=a.x,s=e.ix;--s>0&&(i=a_de[s])&&i.s==a;);for(;s++,(i=a_de[s])&&i.s==a;)if(i!=e&&i!=c&&!(e.up^i.up)&&f_staff[i.dd.func]){r-=i.dd.wl;break}(n=r-u-4)<20&&(u-=.5*(20-n),n=20)}e.val=n,e.x=u,e.y=y_get(e.st,t,u,n),t?e.y+=o.hd:e.y-=o.h}}function d_near(e){var t,n,r=e.s,s=e.dd;s.str||((t=(n="^"==s.ty?1:"_"==s.ty?0:r.multi?r.multi>0:r.stem<0)?r.ymx:r.ymn)>0&&t<24&&(t=6*((t+9)/6|0)-6),n?(t+=s.hd,r.ymx=t+s.h):"w"==s.name[0]?(e.inv=!0,t-=s.h,r.ymn=t):(t-=s.h,r.ymn=t-s.hd),e.y=t,r.type==C.NOTE&&(e.x+=r.notes[r.stem>=0?0:r.nhd].shhd),"d"==s.name[0]&&(r.beam_st&&r.beam_end?n&&r.stem>0&&(t=r.y+.6*(t-r.y))>=27&&(e.y=t,r.ymx=e.y+s.h):n?r.stem>0&&(e.x+=3.5):r.stem<0&&(e.x-=3.5)))}function d_pf(e){var t,n,r,s,i,o=e.s,a=e.dd;e.ldst||((e.pos&C.SL_ALI_MSK)==C.SL_CLOSE||!(e.pos&C.SL_ALI_MSK)&&o.fmt.dynalign<0?d_upstaff(e):e.start?d_cresc(e):(e.val=a.wl+a.wr,(s=up6(o,e.pos))&&(e.up=!0),r=o.x,e.ix>0&&(i=a_de[e.ix-1]).s==o&&(e.up&&!i.up||!e.up&&i.up)&&(t=i.dd,f_staff[t.func]&&(n=i.x+i.val+4)>r&&(r=n)),e.x=r,e.y=y_get(o.st,s,r-a.wl,e.val),s?e.y+=a.hd:e.y-=a.h))}function d_slide(e){var t,n,r=e.s,s=r.notes[0].pit,i=5;for(t=0;t<=r.nhd;t++){if(r.notes[t].acc)n=4+r.notes[t].shac;else switch(n=5-r.notes[t].shhd,r.head){case C.SQUARE:n+=3.5;break;case C.OVALBARS:case C.OVAL:n+=2}r.notes[t].pit<=s+3&&n>i&&(i=n)}e.x-=i,e.y=3*(s-18)}function d_trill(e){if(!e.ldst){var t,n,r,s,i=e.dd,o=e.prev,a=e.s,c=a.st,l=e.start.s,u=l.x;switch(o&&(u=o.s.x+e.dd.wl+2,o.val-=o.dd.wr,o.val<8&&(o.val=8)),e.st=c,i.func){case 5:t=1;break;case 4:case 7:break;case 3:case 6:t=6==i.func?up6(l,e.pos):up3(l,e.pos)}if("^"==i.ty?t=1:"_"==i.ty&&(t=0),e.defl.noen?(r=e.x-u)<20&&(u=e.x-20-3,r=20):(r=a.x-u-6,a.type==C.NOTE&&(r-=6),r<10&&(u-=10-r,r=10)),n=y_get(c,t,u-i.wl-5,r),t?n<(s=staff_tb[l.st].topbar+2)&&(n=s):(n>(s=staff_tb[l.st].botbar-2)&&(n=s),n-=i.h),o)if(t)n<o.y&&(n=o.y);else if(n>=o.y)n=o.y;else do{o.y=n,o=o.prev}while(o);e.lden=!1,e.has_val=!0,e.val=r,e.x=u,e.y=n,e.up=t,t&&(n+=i.h),y_set(c,t,u,r,n),t?l.ymx=a.ymx=n:l.ymn=a.ymn=n}}function d_upstaff(e){if(!e.ldst)if(e.start)d_trill(e);else{var t,n,r=e.s,s=e.dd,i=e.x,o=s.wl+s.wr,a=staff_tb[r.st].topbar+2+s.hd,c=staff_tb[r.st].botbar-2-s.h;switch(s.glyph){case"brth":case"caes":case"lphr":case"mphr":case"sphr":case"short":case"tick":if(t=a,r.type==C.BAR)r.invis=1;else{for("brth"==s.glyph&&t<r.ymx&&(t=r.ymx),r=r.ts_next;r&&!r.seqst;r=r.ts_next);i+=.45*((r?r.x:realwidth)-i)}return e.x=i,void(e.y=t)}switch(r.nhd&&(i+=r.notes[r.stem>=0?0:r.nhd].shhd),e.up=n=4==s.func||7==s.func?0:6==s.func?up6(r,e.pos):up3(r,e.pos),s.ty){case"@":case"<":case">":t=e.y}null==t&&(n?((t=y_get(r.st,!0,i-s.wl,o)+s.hd)<a&&(t=a),e.y>t&&(t=e.y),r.ymx=t+s.h):((t=y_get(r.st,!1,i-s.wl,o)-s.h)>c&&(t=c),e.y<t&&(t=e.y),"fermata"!=s.name&&"accent"!=s.glyph&&"roll"!=s.glyph||(e.inv=1),r.ymn=t-s.hd)),6!=s.func&&(t>=a?y_set(r.st,1,i-s.wl,o,t+s.h):t<=c&&y_set(r.st,0,i-s.wl,o,t-s.hd)),e.x=i,e.y=t}}function deco_add(e){var t=e.match(/(\S*)\s+(.*)/);decos[t[1]]=t[2]}function deco_def(e,t){t||(t=e);var n,r,s,i,o,a,c,l=decos[t];if(!l&&/\d[()]$/.test(t)&&(l=decos[t.replace(/\d/,"")]),l)if(n=l.match(/(\d+)\s+(.+?)\s+([0-9.,]+)\s+([0-9.]+)\s+([0-9.]+)/)){var u=Number(n[1]),f=n[3],d=parseFloat(n[4]),p=parseFloat(n[5]);if(isNaN(u))error(1,null,"%%deco: bad C function value '$1'",n[1]);else if(u>10&&(u<32||u>44))error(1,null,"%%deco: bad C function index '$1'",u);else{if(f.indexOf(",")>0?(c=(f=f.split(","))[1],f=f[0]):c=0,!(f>50||d>80||p>80)){if((r=dd_tb[e])||(r={name:e},dd_tb[e]=r),r.func=0==e.indexOf("head-")?9:u,r.glyph=n[2],r.h=Number(f),r.hd=Number(c),r.wl=d,r.wr=p,a=l.replace(n[0],"").trim()){if('"'==a[0]&&(a=a.slice(1,-1)),"@"==a[0]&&!a.match(/^@([0-9.-]+),([0-9.-]+);?/))return void error(1,null,"%%deco: bad position '$1'",a);r.str=a}return 6==r.func&&null==r.str&&(r.str=e),("("==(o=e.slice(-1))||")"==o&&e.indexOf("(")<0)&&(r.str=null,i=e.slice(0,-1)+("("==o?")":"("),(s=dd_tb[i])&&("("==o?(r.dd_en=s,s.dd_st=r):(r.dd_st=s,s.dd_en=r))),r}error(1,null,"%%deco: abnormal h/wl/wr value '$1'",l)}}else error(1,null,"Invalid decoration '$1'",e);else cfmt.decoerr&&error(1,null,"Unknown decoration '$1'",e)}function do_ctie(e,t,n){var r=cross[e],s=e.slice(0,-1)+("("==e.slice(-1)?")":"(");r?error(1,t,"Conflict on !$1!",e):(n.s=t,(r=cross[s])?(")"==e.slice(-1)&&(r=n,n=cross[s]),cross[s]=null,n.midi!=r.midi||n.s.time+n.s.dur!=r.s.time?error(1,t,"Bad tie"):(n.tie_ty=C.SL_AUTO,n.tie_e=r,r.tie_s=n,n.s.ti1=r.s.ti2=!0)):cross[e]=n)}function get_dd(e){var t,n,r=dd_tb[e];return r||("<>^_@".indexOf(e[0])>=0&&!/^([>^]|[<>]\d?[()])$/.test(e)?("@"==(t=e[0])&&(t=(n=e.match(/@([-\d]+),([-\d]+)/))?n[0]:""),r=deco_def(e,e.replace(t,""))):r=deco_def(e),r?(t&&("@"==t[0]&&(r.x=Number(n[1]),r.y=Number(n[2]),t="@"),r.ty=t),r):void 0)}function deco_cnv(e,t){for(var n,r,s,i,o;s=a_dcn.shift();)if(r=get_dd(s)){switch(r.func){case 0:if(e.type==C.BAR&&"dot"==s){e.bar_dotted=!0;continue}case 1:case 2:if(!e.notes){error(1,e,errs.must_note_rest,s);continue}break;case 8:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}(i=e.notes[e.nhd]).a_dd||(i.a_dd=[]),i.a_dd.push(r);continue;case 9:if(!e.notes){error(1,e,errs.must_note_rest,s);continue}for(n=0;n<=e.nhd;n++)(i=e.notes[n]).invis=!0,i.a_dd||(i.a_dd=[]),i.a_dd.push(r);continue;case 10:if(e.notes)for(n=0;n<=e.nhd;n++)e.notes[n].color=s;else e.color=s;break;case 32:e.invis=!0;break;case 33:if(e.type!=C.BAR){error(1,e,"!beamon! must be on a bar");continue}e.beam_on=!0;break;case 34:if(e.type!=C.NOTE||!t||t.type!=C.NOTE||e.dur!=t.dur){error(1,e,"!$1! must be on the last of a couple of notes",s);continue}for(e.trem2=!0,e.beam_end=!0,e.beam_st=!1,t.beam_st=!0,t.beam_end=!1,e.ntrem=t.ntrem=Number(s[4]),n=0;n<=e.nhd;n++)e.notes[n].dur*=2;for(n=0;n<=t.nhd;n++)t.notes[n].dur*=2;break;case 35:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.xstem=!0;break;case 36:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}"1"==s[6]?e.beam_br1=!0:e.beam_br2=!0;break;case 37:e.rbstop=1;break;case 38:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.trem1=!0,e.ntrem=s.length;break;case 39:if(e.type!=C.NOTE){error(1,e,errs.must_note,s);continue}e.feathered_beam="a"==s[5]?1:-1;break;case 40:e.stemless=!0;break;case 41:e.rbstop=2;break;case 42:if(!e.notes[0].acc)continue;if(s="sacc"+e.notes[0].acc.toString(),!(r=dd_tb[s])&&!(r=deco_def(s))){error(1,e,errs.bad_val,"!editorial!");continue}delete e.notes[0].acc,curvoice.acc[e.notes[0].pit+19]=0;break;case 43:if(n=curvoice.acc[e.notes[0].pit+19],e.notes[0].acc||!n)continue;o=1;break;case 44:do_ctie(s,e,e.notes[0]);continue}e.a_dd||(e.a_dd=[]),e.a_dd.push(r)}o&&(a_dcn.push("cacc"+n),dh_cnv(e,e.notes[0]))}function dh_cnv(e,t){for(var n,r;n=a_dcn.shift();)if(r=get_dd(n)){switch(r.func){case 0:case 1:case 3:case 4:case 8:break;default:error(1,e,"Cannot have !$1! on a head",n);continue;case 9:case 32:t.invis=!0;break;case 10:t.color=n;continue;case 40:e.stemless=!0;continue;case 44:do_ctie(n,e,t);continue}t.a_dd||(t.a_dd=[]),t.a_dd.push(r)}}function deco_update(e,t){var n,r,s=a_de.length;for(n=0;n<s;n++)(r=a_de[n]).s==e&&(r.x+=t)}function deco_width(e){var t,n,r,s=0,i=e.a_dd,o=i.length;for(n=0;n<o;n++)switch((t=i[n]).func){case 1:s<7&&(s=7);break;case 2:s<14&&(s=14);break;case 3:switch(t.glyph){case"brth":case"lphr":case"mphr":case"sphr":e.wr<20&&(e.wr=20)}default:switch(t.ty){case"<":s<(r=t.wl+t.wr+6)&&(s=r);break;case">":r=t.wl+t.wr+8,e.wr<r&&(e.wr=r)}}return s&&e.prev&&e.prev.type==C.BAR&&(s-=3),s}function deco_wch(e){var t,n,r,s=0,i=e.a_dd.length;for(t=0;t<i;t++)"<"==(r=e.a_dd[t]).ty&&(n=r.wl+r.wr+8)>s&&(s=n);return s}function draw_deco_near(){var e,t;function n(e,t){var n,r,s,i=e.notes[t],o=i.a_dd.length,a=e.x;for(r=0;r<o;r++)n={s:e,dd:s=i.a_dd[r],st:e.st,m:t,ix:0,defl:{},x:a,y:3*(i.pit-18)},s.ty&&("@"==s.ty?(n.x+=s.x,n.y+=s.y):(n.y-=(s.h-s.hd)/2,"<"==s.ty?n.x-=s.wr+8:">"==s.ty&&(n.x+=s.wr+8))),a_de.push(n),s.dd_en?n.ldst=!0:s.dd_st&&(n.lden=!0,n.defl.nost=!0)}function r(e){if((!e.invis||!e.play)&&(e.a_dd&&function(e){var t,n,r,s,i,o,a=e.a_dd.length;for(null==e.y&&(e.y=0),n=0;n<a;n++){switch(t=e.a_dd[n],i=e.x,o=e.y,t.func){default:if(t.func>=10)continue;r=0;break;case 3:case 4:case 5:case 7:r=e.pos.orn;break;case 6:r=e.pos.vol;break;case 7:r=e.pos.dyn}switch(t.ty){case"^":r=-8&r|C.SL_ABOVE;break;case"_":r=-8&r|C.SL_BELOW;break;case"<":case">":r=7&r|C.SL_CLOSE,"<"==t.ty?(i-=t.wr+8,e.notes[0].acc&&(i-=5.5)):i+=t.wl+8,o=3*(e.notes[0].pit-18)-(t.h-t.hd)/2;break;case"@":i+=t.x,o+=t.y}(7&r)!=C.SL_HIDDEN&&(s={s:e,dd:t,st:e.st,ix:a_de.length,defl:{},x:i,y:o,pos:r},t.name.indexOf("inverted")>=0&&(s.inv=1),e.type!=C.BAR||t.ty||(s.x-=e.wl/2-2),a_de.push(s),t.dd_en?s.ldst=!0:t.dd_st&&(s.lden=!0,s.defl.nost=!0),f_near[t.func]&&f_near[t.func](s))}}(e),e.notes))for(var t=0;t<e.notes.length;t++)e.notes[t].a_dd&&n(e,t)}for(e=tsfirst;e;e=e.ts_next){switch(e.type){case C.CLEF:case C.KEY:case C.METER:continue}break}for(a_de.length&&function(e){var t,n,r=e.x-e.wl,s=a_de.length;for(t=0;t<s;t++)(n=a_de[t]).ix=t,n.s.x=n.x=r,n.defl.nost=!0}(e);e;e=e.ts_next){switch(e.type){case C.BAR:case C.MREST:case C.NOTE:case C.REST:case C.SPACE:break;case C.GRACE:for(t=e.extra;t;t=t.next)r(t);break;default:continue}r(e)}!function(){var e,t,n,r,s,i,o,a,c,l=a_de.length;for(e=0;e<l;e++)if((n=a_de[e]).ldst){for(i=n.dd.dd_en,o=(a=n.s).v,t=e+1;t<l&&((r=a_de[t]).start||r.dd!=i||r.s.v!=o);t++);if(t==l)for(c=a.st,t=e+1;t<l&&((r=a_de[t]).start||r.dd!=i||r.s.st!=c);t++);for(t==l&&((r={s:a,st:n.st,dd:i,ix:a_de.length-1,x:realwidth-6,y:a.y,cont:!0,lden:!0,defl:{noen:!0}}).x<a.x+10&&(r.x=a.x+10),null!=n.m&&(r.m=n.m),a_de.push(r)),r.start=n,r.defl.nost=n.defl.nost,t=e;--t>=0;)if((s=a_de[t]).start){if(s.s.time<a.time)break;if(s.dd.name==r.dd.name){r.prev=s;break}}}for(e=0;e<l;e++)(r=a_de[e]).lden&&!r.start&&((n={s:prev_scut(a=r.s),st:r.st,dd:r.dd.dd_st,ix:a_de.length-1,y:a.y,ldst:!0}).x=n.s.x,null!=r.m&&(n.m=r.m),a_de.push(n),r.start=n)}()}function draw_deco_note(){var e,t,n,r=a_de.length;for(e=0;e<r;e++)n=(t=a_de[e]).dd.func,f_note[n]&&null==t.m&&f_note[n](t)}function draw_deco_staff(){var e,t,n,r,s,i,o=new Array(nstaff+1),a=a_de.length;function c(e){var t,n,r,s,i,o,a,c;for(s=staff_tb[e.st].topbar+15,t=e.sym;t;t=t.next)if(t.type==C.BAR&&t.rbstart&&!t.norepbra){if(!t.next)break;for(c||(c=t,set_font("repeat")),n=t;t.next&&!(t=t.next).rbstop;);s<(i=y_get(e.st,!0,n.x,t.x-n.x)+2)&&(s=i),2==n.rbstart&&s<(i=y_get(e.st,!0,n.x,3)+10)&&(s=i),2==t.rbstop&&s<(i=y_get(e.st,!0,t.x-3,3)+10)&&(s=i),n.text&&(a=strwh(n.text),s<(i=y_get(e.st,!0,n.x+4,a[0])+a[1])&&(s=i)),t.rbstart&&(t=t.prev)}if(t=c)for(set_dscale(e.st,!0),i=s*staff_tb[e.st].staffscale;t;t=t.next)if(t.rbstart&&!t.norepbra){for(n=t;t.next&&!(t=t.next).rbstop;);if(n==t)break;r=n.x,cfmt.measurenb>0&t.bar_num&&t.bar_num%cfmt.measurenb&&(r+=6),o=t.type!=C.BAR?t.rbstop?0:t.x-realwidth+4:t.bar_type.length>1&&"[]"!=t.bar_type||"]"==t.bar_type?n.st>0&&!(cur_sy.staves[n.st-1].flags&STOP_BAR)?t.wl:":"==t.bar_type.slice(-1)?12:":"!=t.bar_type[0]?0:8:t.rbstop&&!t.rbstart?0:8,o=t.x-r-o,t.next||t.rbstop||e.bar_start||(e.bar_start=_bar(t),e.bar_start.bar_type="",e.bar_start.rbstart=1),n.text&&xy_str(r+4,i-gene.curfont.size-2,n.text),xypath(r,i),2==n.rbstart&&(output+="m0 10v-10"),output+="h"+o.toFixed(1),2==t.rbstop&&(output+="v10"),output+='"/>\n',y_set(n.st,!0,r,o,s+2),t.rbstart&&(t=t.prev.prev)}}for(n=0;n<=nstaff;n++)o[n]={ymin:0,ymax:0};for(n=0;n<a;n++)(i=(s=a_de[n]).dd)&&f_staff[i.func]&&null==s.m&&(f_staff[i.func](s),i.dd_en||((s.pos&C.SL_ALI_MSK)==C.SL_ALIGN||!(s.pos&C.SL_ALI_MSK)&&s.s.fmt.dynalign>0)&&(s.up?s.y>o[s.st].ymax&&(o[s.st].ymax=s.y):s.y<o[s.st].ymin&&(o[s.st].ymin=s.y)));for(n=0;n<a;n++)(i=(s=a_de[n]).dd)&&!i.dd_en&&f_staff[i.func]&&(6==i.func&&((s.pos&C.SL_ALI_MSK)==C.SL_ALIGN||!(s.pos&C.SL_ALI_MSK)&&s.s.fmt.dynalign>0)?(t=s.up?o[s.st].ymax:o[s.st].ymin,s.y=t):t=s.y,s.up&&(t+=i.h),y_set(s.st,s.up,s.x,s.val,t));for(draw_all_chsy(),r=0;r<voice_tb.length;r++)(e=voice_tb[r]).second||!e.sym||e.ignore||c(e)}function draw_measnb(){var e,t,n,r,s,i,o,a,c,l=cur_sy;for(t=0;t<=nstaff&&!l.st_print[t];t++);if(!(t>nstaff)){if(set_dscale(t),1!=staff_tb[t].staffscale&&param_set_font("measurefont","* "+((a=get_font("measure").size)/staff_tb[t].staffscale).toString()),set_font("measure"),c=cwidf("0"),e=tsfirst,(n=gene.nbar)>1)if(0==cfmt.measurenb)o=!0,(s=y_get(t,!0,0,20))<staff_tb[t].topbar+14&&(s=staff_tb[t].topbar+14),xy_str(0,s,n.toString()),y_set(t,!0,0,20,s+gene.curfont.size+2);else if(n%cfmt.measurenb==0){for(;;e=e.ts_next){switch(e.type){case C.CLEF:case C.KEY:case C.METER:case C.STBRK:continue}break}e.type==C.BAR&&e.bar_num||(o=!0,i=c,n>=10&&(i*=n>=100?3:2),gene.curfont.pad&&(i+=2*gene.curfont.pad),(s=y_get(t,!0,r=e.x-e.wl+2,i))<staff_tb[t].topbar+6&&(s=staff_tb[t].topbar+6),xy_str(r,s+=2+gene.curfont.pad,n.toString()),y_set(t,!0,r,i,s+=gene.curfont.size+gene.curfont.pad))}for(;e;e=e.ts_next){switch(e.type){case C.STAVES:for(l=e.sy,t=0;t<nstaff&&!l.st_print[t];t++);set_dscale(t);continue;default:continue;case C.BAR:if(!e.bar_num||e.bar_num<=1)continue}n=e.bar_num,0!=cfmt.measurenb&&n%cfmt.measurenb==0&&e.next&&!e.bar_mrep&&(o||(o=!0),i=c,n>=10&&(i*=n>=100?3:2),gene.curfont.pad&&(i+=2*gene.curfont.pad),(s=y_get(t,!0,r=e.x,i))<staff_tb[t].topbar+6&&(s=staff_tb[t].topbar+6),e.next.type==C.NOTE&&(e.next.stem>0?s<e.next.ys-gene.curfont.size&&(s=e.next.ys-gene.curfont.size):s<e.next.y&&(s=e.next.y)),xy_str(r,s+=2+gene.curfont.pad,n.toString()),y_set(t,!0,r,i,s+=gene.curfont.size+gene.curfont.pad))}gene.nbar=n,a&&param_set_font("measurefont","* "+a.toString())}}function draw_partempo(e,t){var n,r,s,i,o,a,c,l=0,u=0,f=staff_tb[e].topbar+8,d=0,p=1,h=-100;for(n=tsfirst;n;n=n.ts_next)n.type!=C.TEMPO||n.invis||(i||(i=n),a=n.tempo_wh[0],0==n.time&&n.x>40&&(n.x=40),(c=y_get(e,!0,n.x-16,a))>f&&(f=c),h>=n.x-16&&!(d&p>>1)&&(d|=p),p<<=1,h=n.x-16+a);if(i)for(set_sscale(-1),set_font("tempo"),o=(c=2-(u=gene.curfont.size+8))-u,0!=d&&(u*=2),t<f+u&&(l=f+u-t),n=i;n;n=n.ts_next)n.type!=C.TEMPO||n.invis||((user.anno_start||user.anno_stop)&&(n.wl=16,n.wr=30,n.ymn=1&d?o:c,n.ymx=n.ymn+14,anno_start(n)),writempo(n,n.x-16,1&d?o:c),anno_stop(n),d>>=1);for(f=staff_tb[e].topbar+6,n=tsfirst;n;n=n.ts_next)(r=n.part)&&!r.invis&&(s||(s=n,set_font("parts"),o=gene.curfont.size+2+2*gene.curfont.pad),null==r.x&&(r.x=n.x-10),a=strwh(r.text)[0],f<(c=y_get(e,!0,r.x,a+3))&&(f=c));if(s)for(set_sscale(-1),t+l<f+(u+=o)&&(l=f+u-t),n=s;n;n=n.ts_next)(r=n.part)&&!r.invis&&((user.anno_start||user.anno_stop)&&(r.type=C.PART,r.p_v=n.p_v,r.v=n.v,r.st=r.wl=0,r.wr=strwh(r.text)[0],r.ymn=-u,r.ymx=r.ymn+o,anno_start(r)),xy_str(r.x,2-u,r.text),anno_stop(r));return l/staff_tb[0].staffscale}Abc.prototype.draw_all_deco=function(){if(a_de.length){var e,t,n,r,s,i,o,a,c,l,u,f,d,p,h=[],m=[];for(a=staff_tb[i=nstaff].y;--i>=0;)c=staff_tb[i].y,m[i]=.5*(a+24+c),a=c;for(;e=a_de.shift();)(t=e.dd)&&(t.dd_en||(n=e.s,(f=(s=t.glyph).indexOf("/"))>0&&(s=n.stem>=0?s.slice(0,f):s.slice(f+1)),f_staff[t.func]?set_sscale(n.st):set_scale(n),i=e.st,staff_tb[i].topbar&&(o=e.x,a=e.y+staff_tb[i].y,null!=e.m?(r=n.notes[e.m]).shhd&&(o+=r.shhd*stv_g.scale):6!=t.func||(e.pos&C.SL_ALI_MSK)!=C.SL_CENTER&&(e.pos&C.SL_ALI_MSK||n.fmt.dynalign)||!(e.up&&i>0||!e.up&&i<nstaff)||(l=e.up?m[--i]:m[i++],l-=.5*t.h,(e.up&&a<l||!e.up&&a>l)&&(c=y_get(i,!e.up,e.x,e.val)+staff_tb[i].y,e.up&&(c-=t.h),(e.up&&c>l||!e.up&&c<l)&&(a=l,1!=stv_g.scale&&(a+=stv_g.dy/2)))),(u=user[s])&&"function"==typeof u?u(o,a,e):self.psdeco(s,o,a,e)||(anno_start(n,"deco"),e.inv&&(g_open(o,a=a+t.h-t.hd,0,1,-1),o=a=0),e.has_val?(2!=t.func||stv_g.st<0?out_deco_val(o,a,s,e.val/stv_g.scale,e.defl):out_deco_val(o,a,s,e.val,e.defl),e.cont&&h.push(e.start)):null!=t.str?("@"==(d=t.str)[0]&&(p=d.match(/^@([0-9.-]+),([0-9.-]+);?/),o+=Number(p[1]),a+=Number(p[2]),d=d.replace(p[0],"")),out_deco_str(o,a,s,d)):e.lden?out_deco_long(o,a,e):xygl(o,a,s),stv_g.g&&g_close(),anno_stop(n,"deco")))));a_de=h}};var STEM_MIN=16,STEM_MIN2=14,STEM_MIN3=12,STEM_MIN4=10,STEM_CH_MIN=14,STEM_CH_MIN2=10,STEM_CH_MIN3=9,STEM_CH_MIN4=9,BEAM_DEPTH=3.2,BEAM_OFFSET=.25,BEAM_SHIFT=5,BEAM_STUB=7,SLUR_SLOPE=.5,GSTEM=15,GSTEM_XOFF=2.3,cache,anno_a=[];function b_pos(e,t,n,r){var s,i,o,a,c=e?3.5:BEAM_SHIFT,l=e?1.8:BEAM_DEPTH;function u(e){return 6*Math.round((e+12)/6)-12-e}if(t>0){if((i=r-(n-1)*c-l)>26)return 0;s=r}else{if((s=r+(n-1)*c+l)<-2)return 0;i=r}return(o=u(s-BEAM_OFFSET))*o>(a=u(i+BEAM_OFFSET))*a?a:o}function sym_dup(e){var t;for((e=clone(e)).invis=!0,delete e.extra,delete e.text,delete e.a_gch,delete e.a_ly,delete e.a_dd,delete e.tp,e.notes=clone(e.notes),t=0;t<=e.nhd;t++)delete(e.notes[t]=clone(e.notes[t])).a_dd;return e}var min_tb=[[STEM_MIN,STEM_MIN,STEM_MIN2,STEM_MIN3,STEM_MIN4,STEM_MIN4],[STEM_CH_MIN,STEM_CH_MIN,STEM_CH_MIN2,STEM_CH_MIN3,STEM_CH_MIN4,STEM_CH_MIN4]];function draw_beams(e){var t,n,r,s,i,o,a,c,l,u,f,d,p,h=e.s1,m=e.s2;function y(e,t,n,r,s,i){var o,a,c=s.s1,l=c.nflags;if(c.ntrem&&(l-=c.ntrem),c.trem2&&i>l)if(c.dur>=C.BLEN/2)e=c.x+6,t=s.s2.x-6;else if(c.dur<C.BLEN/4){var u=t-e;u<16?(e+=u/4,t-=u/4):(e+=5,t-=6)}o=s.a*e+s.b-n,t-=e,t/=stv_g.scale,a=s.a*t*stv_g.scale,xypath(e,o,!0),output+="l"+t.toFixed(1)+" "+(-a).toFixed(1)+"v"+r.toFixed(1)+"l"+(-t).toFixed(1)+" "+a.toFixed(1)+'z"/>\n'}for(anno_start(h,"beam"),h.grace?(i=3.5,o=3.2,s=.29,a=1.8):(i=BEAM_SHIFT,o=BEAM_STUB,s=.34,a=BEAM_DEPTH),a/=stv_g.scale,r=h.stem,h.stem!=m.stem&&h.nflags<m.nflags&&(r=m.stem),r<0&&(a=-a),y(h.xs-s,m.xs+s,0,a,e,1),c=0,t=h;t.type==C.NOTE&&t.stem!=r&&(t.ys=e.a*t.xs+e.b-staff_tb[t.st].y+i*(t.nflags-1)*t.stem-a),t!=m;t=t.next);for(h.feathered_beam&&(c=i/(m.xs-h.xs),i=h.feathered_beam>0?(c=-c)*h.xs:c*m.xs,c*=r),s=0,n=2;n<=e.nflags;n++)for(s+=i,0!=c&&(e.a+=c),t=h;;t=t.next)if(t.type!=C.NOTE||t.nflags<n){if(t==m)break}else if(t.trem1&&n>t.nflags-t.ntrem){if(y((p=t.dur>=C.BLEN/2?t.x:t.xs)-5,p+5,(s+2.5)*r,a,e,n),t==m)break}else{for(f=t;t!=m;){if((u=t.next).type==C.NOTE||u.type==C.REST)if(u.trem1){if(u.nflags-u.ntrem<n)break}else if(u.nflags<n)break;if(u.beam_br1||u.beam_br2&&n>2)break;t=u}for(d=t;d.type!=C.NOTE;)d=d.prev;if(p=f.xs,l=r,f==d){if(f==h)p+=o;else if(f==m)p-=o;else if(f.beam_br1||f.beam_br2&&n>2)p+=o;else{for(u=f.next;u.type!=C.NOTE;)u=u.next;if(u.beam_br1||u.beam_br2&&n>2)p-=o;else{for(f=f.prev;f.type!=C.NOTE;)f=f.prev;f.nflags<u.nflags||f.nflags==u.nflags&&f.dots<u.dots?p+=o:p-=o}}f.stem!=r&&(l=f.stem,f.ys=e.a*f.xs+e.b-staff_tb[f.st].y-a)}if(y(p,d.xs,s*l,a,e,n),t==m)break}h.tmp?unlksym(h):m.tmp&&unlksym(m),anno_stop(h,"beam")}function draw_lstaff(e){var t,n,r,s,i,o=cur_sy.nstaff,a=0;function c(e,t,n){for(var r,s,i,o;!cur_sy.st_print[t];){if(cur_sy.staves[t].flags&n)return;t++}for(r=s=t;cur_sy.st_print[r]&&(s=r),!(cur_sy.staves[r].flags&n);)r++;i=staff_tb[t].y+staff_tb[t].topbar*staff_tb[t].staffscale,o=staff_tb[s].y+staff_tb[s].botbar*staff_tb[s].staffscale,n&(CLOSE_BRACE|CLOSE_BRACE2)?out_brace(e,o,i-o):out_bracket(e,i,i-o)}for(t=0;((i=cur_sy.staves[t].flags)&(OPEN_BRACE|OPEN_BRACKET)&&a++,!cur_sy.st_print[t])&&(i&(CLOSE_BRACE|CLOSE_BRACKET)&&a--,t!=o);t++);for(n=o;n>t&&!cur_sy.st_print[n];n--);if(t!=n||0!=a)for(r=staff_tb[n].y+staff_tb[n].botbar*staff_tb[n].staffscale,s=staff_tb[t].y+staff_tb[t].topbar*staff_tb[t].staffscale-r,xypath(e,r),output+="v"+(-s).toFixed(1)+'"/>\n',t=0;t<=o;t++)(i=cur_sy.staves[t].flags)&OPEN_BRACE&&c(e,t,CLOSE_BRACE),i&OPEN_BRACKET&&c(e,t,CLOSE_BRACKET),i&OPEN_BRACE2&&c(e-6,t,CLOSE_BRACE2),i&OPEN_BRACKET2&&c(e-6,t,CLOSE_BRACKET2)}function draw_meter(e){if(e.a_meter){var t,n,r,s=e.st,i=staff_tb[s],o=i.y;for("|||||"!=i.stafflines&&(o+=(i.topbar+i.botbar)/2-12),t=0;t<e.a_meter.length;t++)n=e.a_meter[t],r=e.x+e.x_meter[t],n.bot?out_XYAB('<g transform="translate(X,Y)" text-anchor="middle">\n <text y="-12">A</text>\n <text>B</text>\n</g>\n',r,o+6,m_gl(n.top),m_gl(n.bot)):out_XYAB('<text x="X" y="Y" text-anchor="middle">A</text>\n',r,o+12,m_gl(n.top))}}Abc.prototype.calculate_beam=function(e,t){var n,r,s,i,o,a,c,l,u,f,d,p,h,m,y,A,g,v,_,b,w,x,k;for(t.beam_st||(lkvsym(n=sym_dup(t),t),lktsym(n,t),n.x-=12,n.x>t.prev.x+12&&(n.x=t.prev.x+12),n.beam_st=!0,delete n.beam_end,n.tmp=!0,delete n.sls,t=n),i=o=0,l=u=!1,a=t.st,c=t.v,b=t.grace?GSTEM_XOFF:3.5,r=t;r.type!=C.NOTE||(r.nflags>o&&(o=r.nflags),i++,r.st!=a&&(l=!0),r.stem!=t.stem&&(u=!0),x||r.invis||r.stemless&&!r.trem2||(x=!0),!r.beam_end);r=r.next)if(!r.next){for(;r.type!=C.NOTE;r=r.prev);(n=sym_dup(r)).next=r.next,n.next&&(n.next.prev=n),r.next=n,n.prev=r,n.ts_next=r.ts_next,n.ts_next&&(n.ts_next.ts_prev=n),r.ts_next=n,n.ts_prev=r,delete n.beam_st,n.beam_end=!0,n.tmp=!0,delete n.sls,n.x+=12,n.x<realwidth-12&&(n.x=realwidth-12),r=n,i++;break}if(!x)return!1;if(e.s2=r,0==staff_tb[a].y){if(l)return!1}else if(!l)return e.s1=t,e.a=(t.ys-r.ys)/(t.xs-r.xs),e.b=t.ys-t.xs*e.a+staff_tb[a].y,e.nflags=o,!0;for(_=t,g=100,v=0,n=t;n.type!=C.NOTE||(1==(w=n.p_v.scale)&&(w=staff_tb[n.st].staffscale),n.stem>=0?(f=b+n.notes[0].shhd,n.notes[n.nhd].pit>v&&(v=n.notes[n.nhd].pit,_=n)):(f=-b+n.notes[n.nhd].shhd,n.notes[0].pit<g&&(g=n.notes[0].pit,_=n)),n.xs=n.x+f*w,n!=r);n=n.next);if((n.grace&&t.fmt.flatbeams||!u&&i>=3&&_!=t&&_!=r)&&(h=0),d=t.ys+staff_tb[a].y,null==h&&(h=(r.ys+staff_tb[r.st].y-d)/(r.xs-t.xs)),0!=h&&(h=t.fmt.beamslope*h/(t.fmt.beamslope+Math.abs(h)))>-.04&&h<.04&&(h=0),m=(d+r.ys+staff_tb[r.st].y)/2-h*(r.xs+t.xs)/2,A=0,n=t,u)p=.5*((t.grace?3.5:BEAM_SHIFT)*(o-1)+BEAM_DEPTH),t.nflags==r.nflags||(t.stem!=r.stem&&t.nflags<r.nflags?m+=p*r.stem:m+=p*t.stem);else if(t.grace)for(;p=h*n.xs+m-staff_tb[n.st].y,y=GSTEM-2,n.stem>0?y-=p-3*(n.notes[n.nhd].pit-18):y+=p-3*(n.notes[0].pit-18),(y+=3*(n.nflags-1))>A&&(A=y),n!=r;n=n.next);else{for(var E=BEAM_DEPTH+BEAM_SHIFT*(o-1);n.ts_prev&&n.ts_prev.type==C.NOTE&&n.ts_prev.time==n.time&&n.ts_prev.x>t.xs;)n=n.ts_prev;for(;n&&n.time<=r.time;n=n.ts_next)if(!(n.type!=C.NOTE||n.invis||n.st!=a&&n.v!=c)){if(p=h*(f=n.v==c?n.xs:n.x)+m-staff_tb[n.st].y,n.v==c)y=min_tb[0==n.nhd?0:1][n.nflags],n.stem>0?(n.notes[n.nhd].pit>26&&(y-=2,n.notes[n.nhd].pit>28&&(y-=2)),y-=p-3*(n.notes[n.nhd].pit-18)):(n.notes[0].pit<18&&(y-=2,n.notes[0].pit<16&&(y-=2)),y-=3*(n.notes[0].pit-18)-p),y+=BEAM_DEPTH+BEAM_SHIFT*(n.nflags-1);else{if(t.stem>0)if(n.stem>0){if(n.ymn>p+4||n.ymx<p-E-2)continue;y=n.v>c?n.ymx-p:n.ymn+8-p}else y=n.ymx-p;else if(n.stem<0){if(n.ymx<p-4||n.ymn>p-E-2)continue;y=n.v<c?p-n.ymn:p-n.ymx+8}else y=p-n.ymn;y+=2+E}y>A&&(A=y)}}if(A>0&&(m+=t.stem*A),!l&&!u)for(n=t.next;;n=n.next){switch(n.type){case C.REST:if(!n.multi)break;if(!(s=n.ts_next)||s.st!=a||s.type!=C.NOTE&&s.type!=C.REST)break;case C.BAR:if(n.invis)break;case C.CLEF:d=h*n.x+m,t.stem>0?(d=n.ymx-d+BEAM_DEPTH+BEAM_SHIFT*(o-1)+2)>0&&(m+=d):(d=n.ymn-d-BEAM_DEPTH-BEAM_SHIFT*(o-1)-2)<0&&(m+=d);break;case C.GRACE:for(s=n.extra;s;s=s.next)d=h*s.x+m,t.stem>0?(d=s.ymx-d+BEAM_DEPTH+BEAM_SHIFT*(o-1)+2)>0&&(m+=d):(d=s.ymn-d-BEAM_DEPTH-BEAM_SHIFT*(o-1)-2)<0&&(m+=d)}if(n==r)break}for(0==h&&(m+=b_pos(t.grace,t.stem,o,m-staff_tb[a].y)),n=t;;n=n.next){switch(n.type){case C.NOTE:n.ys=h*n.xs+m-staff_tb[n.st].y,n.stem>0?(n.ymx=n.ys+2.5,n.ts_prev&&n.ts_prev.stem>0&&n.ts_prev.st==n.st&&n.ts_prev.ymn<n.ymx&&n.ts_prev.x==n.x&&0==n.notes[0].shhd&&(n.ts_prev.x-=3,n.ts_prev.xs-=3)):n.ymn=n.ys-2.5;break;case C.REST:if(d=h*n.x+m-staff_tb[n.st].y,k=BEAM_DEPTH+BEAM_SHIFT*(o-1)+(n.head!=C.FULL?4:9),t.stem>0){if(d-=k,0==t.multi&&d>12&&(d=12),n.y<=d)break}else if(d+=k,0==t.multi&&d<12&&(d=12),n.y>=d)break;n.head!=C.FULL&&(d=6*((d+3+12)/6|0)-12),n.y=d}if(n==r)break}return 0!=staff_tb[a].y&&(e.s1=t,e.a=h,e.b=m,e.nflags=o,!0)};var acc_nd={};function draw_acc(e,t,n){if("object"==typeof n){var r,s=n[0],i=n[1];(n=acc_nd[r=s+"_"+i])||(i=(n=abc2svg.rat(Math.abs(s),i))[1],n=(s<0?-n[0]:n[0]).toString(),1!=i&&(n+="_"+i),acc_nd[r]=n)}xygl(e,t,"acc"+n)}function set_hl(e,t,n,r,s){var i,o;for(t>=0?(o=e.hlu[t])||(o=e.hlu[t]=[]):(o=e.hld[-t])||(o=e.hld[-t]=[]),i=0;i<o.length&&!(n>=o[i][0]);i++);i==o.length?o.push([n,r,s]):n>o[i][0]?o.splice(++i,0,[n,r,s]):(r<o[i][1]&&(o[i][1]=r),s>o[i][2]&&(o[i][2]=s))}Abc.prototype.draw_hl=function(e){var t,n,r,s,i=[],o=e.st,a=staff_tb[o];if(a.hll&&!e.invis){for(t=0;t<=e.nhd;t++)s=e.notes[t],a.hlmap[s.pit-a.hll]||i.push([s.pit-18,s.shhd*stv_g.scale]);if(r=i.length){var c,l,u,f,d=a.stafflines,p=d.length-1,h=p,m=a.botline/6,y=m,A=e.grace?4:1.3*hw_tb[e.head];for(u=(s=e.notes[e.stem<0?e.nhd:0]).shhd,t=0;t<i.length;t++)f=i[t][0],c=(i[t][1]<u?i[t][1]:u)-A,l=(i[t][1]>u?i[t][1]:u)+A,f<2*m?(f<2*y&&(y=++f>>1),r--):f>2*p&&(h=f>>1,r--),set_hl(a,f>>1,e.x,c,l);for(c=u-A,l=u+A;++y<m;)set_hl(a,y,e.x,c,l);for(;--h>p;)set_hl(a,h,e.x,c,l);if(r){for(t=y,n=h;t>m&&"-"==d[t];)t--;for(;n<p&&"-"==d[n];)n++;for(;t<n;t++)"-"==d[t]&&set_hl(a,t,e.x,c,l)}}}};var sharp_cl=new Int8Array([24,9,15,21,6,12,18]),flat_cl=new Int8Array([12,18,24,9,15,21,6]),sharp1=new Int8Array([-9,12,-9,-9,12,-9]),sharp2=new Int8Array([12,-9,12,-9,12,-9]),flat1=new Int8Array([9,-12,9,-12,9,-12]),flat2=new Int8Array([-12,9,-12,9,-12,9]);function nrep_out(e,t,n){t-=3,n<10?xygl(e-4,t,"mtr"+n):(xygl(e-10,t,"mtr"+(n/10|0)),xygl(e-2,t,"mtr"+n%10))}function center_rest(e){var t,n;for(e.dur<2*C.BLEN?e.nflags=-2:e.dur<4*C.BLEN?e.nflags=-3:e.nflags=-4,e.dots=0,t=e.ts_next;t.time!=e.time+e.dur&&t.ts_next;)t=t.ts_next;for(n=t.x-t.wl,t=e;!t.seqst;)t=t.ts_prev;n=(n+(t=t.ts_prev).x+t.wr)/2,e.a_dd&&deco_update(e,n-e.x),e.x=n}Abc.prototype.draw_keysig=function(e,t){var n,r,s,i=t.k_old_sf,o=t.st,a=staff_tb[o].y,c=t.k_y_clef;for(1&c&&(c+=7),c/=2;c<0;)c+=7;if(c%=7,t.k_a_acc){if(t.k_a_acc.length){var l,u=t.k_a_acc[0].acc,f=100,d={st:o,nhd:0,notes:[{}]};for(n=0;n<t.k_a_acc.length;n++){for(l=t.k_a_acc[n],r=3*(t.k_y_clef+l.pit-18);r<-3;)r+=21;for(;r>27;)r-=21;0!=n&&(r>f+18||r<f-18)?e-=5.5:l.acc!=u&&(e+=3),u=l.acc,d.x=e,d.notes[0].pit=r/3+18,f=r,draw_acc(e,a+r,l.acc),e+=5.5}}}else{if((t.fmt.cancelkey||0==t.k_sf)&&(0==t.k_sf||i*t.k_sf<0)){for(s=(r=sharp_cl[c])>9?sharp1:sharp2,n=0;n<i;n++)xygl(e,a+r,"acc3"),r+=s[n],e+=5.5;for(s=(r=flat_cl[c])<18?flat1:flat2,n=0;n>i;n--)xygl(e,a+r,"acc3"),r+=s[-n],e+=5.5;0!=t.k_sf&&(e+=3)}if(t.k_sf>0){for(s=(r=sharp_cl[c])>9?sharp1:sharp2,n=0;n<t.k_sf;n++)xygl(e,a+r,"acc1"),r+=s[n],e+=5.5;if(t.fmt.cancelkey&&n<i)for(e+=2;n<i;n++)xygl(e,a+r,"acc3"),r+=s[n],e+=5.5}if(t.k_sf<0){for(s=(r=flat_cl[c])<18?flat1:flat2,n=0;n>t.k_sf;n--)xygl(e,a+r,"acc-1"),r+=s[-n],e+=5.5;if(t.fmt.cancelkey&&n>i)for(e+=2;n>i;n--)xygl(e,a+r,"acc3"),r+=s[-n],e+=5.5}}};var rest_tb=["r128","r64","r32","r16","r8","r4","r2","r1","r0","r00"];function draw_rest(e){var t,n,r,s=staff_tb[e.st],i=s.y,o=e.x;if(e.notes[0].shhd&&(o+=e.notes[0].shhd*stv_g.scale),e.rep_nb)return set_sscale(e.st),anno_start(e),"|||||"==s.stafflines?i+=12:i+=(s.topbar+s.botbar)/2,e.rep_nb<0?xygl(o,i,"srep"):(xygl(o,i,"mrep"),e.rep_nb>2&&e.v==cur_sy.top_voice&&e.fmt.measrepnb>0&&!(e.rep_nb%e.fmt.measrepnb)&&nrep_out(o,i+s.topbar,e.rep_nb)),void anno_a.push(e);if(set_scale(e),anno_start(e),e.notes[0].color&&set_color(e.notes[0].color),r=e.y,7==(t=5-e.nflags)&&12==r&&s.stafflines.length<=2&&(r-=6),e.notes[0].invis||xygl(o,r+i,rest_tb[t]),e.dots)for(o+=8,r+=i+3,n=e.dots,t=e.dur_orig/12>>5-e.nflags-n;n-- >0;)xygl(o,r,t&1<<n?"dot":"dot+"),o+=3.5;set_color(),anno_a.push(e)}function draw_mrest(e){var t,n,r,s=staff_tb[e.st],i=s.y+(s.topbar+s.botbar)/2,o=e.nmes.toString();if(e.next){for(set_scale(e),r=e;!r.seqst;)r=r.ts_prev;for(r=r.ts_prev;!r.seqst;)r=r.ts_prev;t=r.x+20,n=e.next.x-20,e.x=(t+n)/2,anno_start(e),out_XYAB('<path d="mX Y',t+.6,i-2.7),output+="v2.7h-1.4v-10.8h1.4v2.7h"+((n-t-2.8)/stv_g.scale).toFixed(1)+'v-2.7h1.4v10.8h-1.4v-2.7z"/>\n',out_XYAB('<text x ="X" y="Y" text-anchor="middle">A</text>\n',e.x,i+22,m_gl(o)),anno_a.push(e)}else error(1,e,"Lack of bar after multi-measure rest")}function grace_slur(e){for(var t,n,r,s,i,o,a,c,l,u,f,d=e,p=e.extra;p.next;)p=p.next;if(u=p,f=(p.stem>=0||e.multi<0)&&p.notes[0].pit<=28||p.notes[0].pit<16){for(t=127,p=e.extra;p;p=p.next)p.y<t&&(t=p.y,u=p);n=u.x,r=u.y-5,e.extra!=u&&(n-=4,r+=1),s=(e=e.next).x-1,e.stem<0&&e.nflags>-2&&(s-=4),(c=.4*(s-n))>3&&(c=3),l=c,o=.2,a=.8,r>(i=3*(e.notes[0].pit-18)-5)+7?(n=u.x-1,r+=.5,i+=6.5,s=e.x-5.5,c=.8*(r-i),l=.2*(r-i),o=0):i>r+4&&(i=r+4,n=u.x+2,r=u.y-4)}else{for(t=-127,p=e.extra;p;p=p.next)p.y>t&&(t=p.y,u=p);n=u.x,r=u.y+5,e.extra!=u&&(n-=4,r-=1),s=(e=e.next).x-1,e.stem>=0&&e.nflags>-2&&(s-=2),(c=.4*(n-s))<-3&&(c=-3),l=c,o=.2,a=.8,r<(i=3*(e.notes[e.nhd].pit-18)+5)-7?(n=u.x-1,r-=.5,i-=6.5,s=e.x-5.5,c=.8*(r-i),l=.2*(r-i),o=0):i<r-4&&(i=r-4,n=u.x+2,r=u.y+4)}d.slur={x0:n,y0:r,x1:o*s+(1-o)*n-n,y1:r-o*i-(1-o)*r+c,x2:a*s+(1-a)*n-n,y2:r-a*i-(1-a)*r+l,x3:s-n,y3:r-i},r-=d.slur.y1,p=d.extra,f?r<p.ymn&&(p.ymn=r):r>p.ymx&&(p.ymx=r)}function draw_gracenotes(e){for(var t,n,r,s={},i=e.extra;i.beam_st&&!i.beam_end&&self.calculate_beam(s,i)&&draw_beams(s),anno_start(i),draw_note(i,!s.s2),i==s.s2&&(s.s2=null),anno_a.push(e),i.next;)i=i.next;e.sappo&&((i=e.extra).next?(t=.5*(i.next.x-i.x)+4,n=.5*(i.ys+i.next.ys)-i.y,i.stem>0?n-=1:n+=1):(t=9,n=i.stem>0?5:-5),out_acciac(x_head(i,r=i.notes[i.stem<0?0:i.nhd]),y_head(i,r),t,n,i.stem>0)),(i=e.slur)&&(anno_start(e,"slur"),xypath(i.x0,i.y0+staff_tb[e.st].y),output+="c"+i.x1.toFixed(1)+" "+i.y1.toFixed(1)+" "+i.x2.toFixed(1)+" "+i.y2.toFixed(1)+" "+i.x3.toFixed(1)+" "+i.y3.toFixed(1)+'"/>\n',anno_stop(e,"slur"))}function setdoty(e,t){var n,r,s;for(n=0;n<=e.nhd;n++)(s=3*(e.notes[n].pit-18))%6==0&&(e.dot_low?s-=3:s+=3),t[n]=s;for(n=0;n<e.nhd;n++)if(!(t[n+1]>t[n])){for(r=n;r>0&&!(t[r]>t[r-1]+6);)r--;if(3*(e.notes[r].pit-18)-t[r]<t[n+1]-3*(e.notes[n+1].pit-18))for(;r<=n;)t[r++]-=6;else t[n+1]=t[n]+6}}function x_head(e,t){return e.x+t.shhd*stv_g.scale}function y_head(e,t){return staff_tb[e.st].y+3*(t.pit-18)}function draw_basic_note(e,t,n){var r,s,i,o,a,c=!1,l=e.notes[t],u=staff_tb[e.st].y,f=e.x,d=3*(l.pit-18),p=f+l.shhd*stv_g.scale,h=d+u,m=identify_note(e,l.dur),y=m[0],A=m[1],g=m[2];if(l.invis);else if(e.grace)s="ghd",p-=4.5*stv_g.scale;else if(l.map&&l.map[0])r=e.head,(s=l.map[0][r])||(s=l.map[0][l.map[0].length-1]),(r=s.indexOf("/"))>=0&&(s=e.stem>=0?s.slice(0,r):s.slice(r+1));else if(e.type==C.CUSTOS)s="custos";else switch(y){case C.OVAL:s="HD";break;case C.OVALBARS:if(e.head!=C.SQUARE){s="HDD";break}case C.SQUARE:g>-4?s="breve":(s="longa",a=e.stem>0),tsnext||!e.next||e.next.type!=C.BAR||e.next.next||(A=0),p+=1;break;case C.EMPTY:s="Hd";break;default:s="hd"}if(null!=l.color&&(c=set_color(l.color)),s&&(a&&(g_open(p,h,0,1,-1),p=h=0),self.psxygl(p,h,s)||xygl(p,h,s),a&&g_close()),A)for(i=f+(7.7+e.xmx)*stv_g.scale,null==n[t]&&(n[t]=3*(e.notes[t].pit-18),1&e.notes[t].pit||(n[t]+=3)),o=n[t]+u,r=l.dur/12>>5-g-A;A-- >0;)xygl(i,o,r&1<<A?"dot":"dot+"),i+=3.5;l.acc&&(f-=l.shac*stv_g.scale,e.grace?(g_open(f,d+u,0,.75),draw_acc(0,0,l.acc),g_close()):draw_acc(f,d+u,l.acc)),0!=c&&set_color(c)}function draw_note(e,t){var n,r,s,i,o=new Array(e.nhd+1),a=e.notes[e.stem<0?e.nhd:0],c=x_head(e,a),l=y_head(e,a),u=staff_tb[e.st].y;if(e.dots&&setdoty(e,o),e.stemless?e.xstem&&(s=((n=e.ts_prev).stem>0?n.y:n.ys)-e.y,out_stem(c,l,s+=staff_tb[n.st].y-u)):(s=e.ys-e.y,i=e.nflags,e.ntrem&&(i-=e.ntrem),!t||i<=0?(e.nflags>0&&(e.stem>=0?s-=1:s+=1),out_stem(c,l,s,e.grace)):out_stem(c,l,s,e.grace,i,e.fmt.straightflags)),t&&e.trem1){var f=e.ntrem||0,d=c;s=3*(e.notes[e.stem>0?e.nhd:0].pit-18),e.head==C.FULL||e.head==C.EMPTY?(d+=(e.grace?GSTEM_XOFF:3.5)*e.stem,e.stem>0?s+=6+5.4*f:s-=11.4):e.stem>0?s+=5+5.4*f:s-=10.4,out_trem(d,u+(s/=e.p_v.scale),f)}for(r=0;r<=e.nhd;r++)draw_basic_note(e,r,o)}function prev_scut(e){for(;e.prev;)if((e=e.prev).rbstart)return e;for(e=e.p_v.sym;e.type!=C.CLEF;)e=e.ts_prev;return e.next&&e.next.type==C.KEY&&(e=e.next),e.next&&e.next.type==C.METER?e.next:e}function slur_direction(e,t){var n,r,s,i,o,a;if(e.grace&&e.stem>0)return-1;if(a=t,i=(o=e).multi?o.multi:a.multi?a.multi:0)return i;for(n=e;;n=n.next){if(n.type==C.NOTE){if(!n.stemless){if(n.stem<0)return 1;r=!0}n.notes[0].pit<22&&(s=!0)}if(n.time==t.time)break}return r||s?-1:1}function slur_out(e,t,n,r,s,i,o){var a,c,l,u=.3,f=.45;(c=r-t)<0&&(c=-c),(a=n-e)>40&&c/a<.7&&(u=.3+.002*(a-40))>.7&&(u=.7);var d=.5*(e+n),p=.5*(t+r),h=d+u*(e-d),m=p+u*(t-p)+i;h=e+f*(h-e),m=t+f*(m-t);var y=d+u*(n-d),A=p+u*(r-p)+i;y=n+f*(y-n),A=r+f*(A-r),c=2*s,(l=.2+.001*a)>.6&&(l=.6),l*=s,a*=.03;output+=o?'<path class="stroke" stroke-dasharray="5,5" d="M':'<path d="M',out_sxsy(e," ",t),output+="c"+((h-e)/stv_g.scale).toFixed(1)+" "+((t-m)/1).toFixed(1)+" "+((y-e)/stv_g.scale).toFixed(1)+" "+((t-A)/1).toFixed(1)+" "+((n-e)/stv_g.scale).toFixed(1)+" "+((t-r)/1).toFixed(1),o||(output+="\n\tv"+(-l).toFixed(1)+"c"+((y-a-n)/stv_g.scale).toFixed(1)+" "+((r+l-A-c)/1).toFixed(1)+" "+((h+a-n)/stv_g.scale).toFixed(1)+" "+((r+l-m-c)/1).toFixed(1)+" "+((e-n)/stv_g.scale).toFixed(1)+" "+((r-t)/1).toFixed(1)),output+='"/>\n'}function draw_slur(e,t,n){var r,s,i,o,a,c,l,u,f,d,p,h,m,y,A,g=n.ty,v=(7&g)==C.SL_ABOVE?1:-1,_=e.length,b=_-1,w=e[0],x=e[b],k=1,E=w.st,B=!1;for(set_dscale(w.st),r=1;r<_;r++)(s=e[r]).type!=C.NOTE&&s.type!=C.REST||(k++,s.st!=E&&(B=!0,s.st<E&&(E=s.st)));if(B&&error(2,w,"*** multi-staves slurs not treated yet"),o=w.x,w.notes&&w.notes[0].shhd&&(o+=w.notes[0].shhd),c=x.x,x.notes&&(c+=x.notes[0].shhd),t?(a=3*(t.pit-18)+2*v,o+=3):(a=v>0?w.ymx+2:w.ymn-2,w.type==C.NOTE&&(v>0?w.stem>0?(o+=5,w.beam_end&&w.nflags>=-1&&!w.in_tuplet?w.nflags>0?(o+=2,a=w.ys-3):a=w.ys-6:a=w.ys+3):a=w.y+8:w.stem<0?(o-=1,x.grace?a=w.y-8:w.beam_end&&w.nflags>=-1&&(!w.in_tuplet||w.ys<a+3)?w.nflags>0?(o+=2,a=w.ys+3):a=w.ys+6:a=w.ys-3):a=w.y-8)),n.is_note?(l=3*(n.note.pit-18)+2*v,c-=3):(l=v>0?x.ymx+2:x.ymn-2,x.type==C.NOTE&&(v>0?x.stem>0?(c+=1,l=x.beam_st&&x.nflags>=-1&&!x.in_tuplet?x.ys-6:x.ys+3):l=x.y+8:x.stem<0?(c-=5,l=x.beam_st&&x.nflags>=-1&&!x.in_tuplet?x.ys+6:x.ys-3):l=x.y-8)),w.type!=C.NOTE&&(a=l+1.2*v,(o=w.x+.5*w.wr)>c-12&&(o=c-12)),x.type!=C.NOTE&&(l=w.type==C.NOTE?a+1.2*v:a,w!=x&&(c=x.x-.3*x.wl)),k>=3&&((s=e[1]).type!=C.BAR&&s.x<o+48&&(v>0?a<(p=s.ymx-2)&&(a=p):a>(p=s.ymn+2)&&(a=p)),(s=e[b-1]).type!=C.BAR&&s.x>c-48&&(v>0?l<(p=s.ymx-2)&&(l=p):l>(p=s.ymn+2)&&(l=p))),((d=(l-a)/(c-o))>SLUR_SLOPE||d<-SLUR_SLOPE)&&((d=d>SLUR_SLOPE?SLUR_SLOPE:-SLUR_SLOPE)*v>0?a=l-d*(c-o):l=a+d*(c-o)),(p=l-a)>8?p=8:p<-8&&(p=-8),(h=p)<0&&(h=-h),y=.5*h,A=.3*p,p*v>0?(c-=y,l-=A):(o+=y,a+=A),w.grace&&(o=w.x-.5*GSTEM_XOFF),x.grace&&(c=x.x+1.5*GSTEM_XOFF),m=0,d=(l-a)/(c-o),w!=x&&w.v==x.v){for(f=a-d*o,r=1;r<b;r++)if((s=e[r]).st==E)switch(s.type){case C.NOTE:case C.REST:v>0?((p=3*(s.notes[s.nhd].pit-18)+6)<s.ymx&&(p=s.ymx),(p-=d*s.x+f)>m&&(m=p)):((p=3*(s.notes[0].pit-18)-6)>s.ymn&&(p=s.ymn),(p-=d*s.x+f)<m&&(m=p));break;case C.GRACE:for(i=s.extra;i;i=i.next)v>0?((p=3*(i.notes[i.nhd].pit-18)+6)<i.ymx&&(p=i.ymx),(p-=d*i.x+f)>m&&(m=p)):((p=3*(i.notes[0].pit-18)-6)>i.ymn&&(p=i.ymn),(p-=d*i.x+f)<m&&(m=p))}a+=.45*m,l+=.45*m,m*=.65}for(u=k>3?(.08*(c-o)+12)*v:(.03*(c-o)+8)*v,v>0?(u<3*m&&(u=3*m),u>40&&(u=40)):(u>3*m&&(u=3*m),u<-40&&(u=-40)),(p=l-a)<0&&(p=-p),v>0?u<.8*p&&(u=.8*p):u>-.8*p&&(u=-.8*p),slur_out(o,a,c,l,v,u*=w.fmt.slurheight,g&C.SL_DOTTED),f=a-(d=(l-a)/(y=c-o))*o,u>0?f+=4*Math.sqrt(u)-2:f-=4*Math.sqrt(-u)-2,r=0;r<b;r++)(s=e[r]).st==E&&s.type!=C.BAR&&(p=d*s.x+f,s.ymx<p?s.ymx=p:s.ymn>p&&(s.ymn=p),r==b-1?(y=c,x.sl1&&(y-=5),r&&(p-=u/3)):y=e[r+1].x,0!=r?o=s.x:p-=u/3,y_set(E,v>0,o,y-=o,p))}function draw_slurs(e,t){var n,r,s,i,o,a;function c(e,r,s){var i,o,a,c,l,u=[],f=r.note.s;if(!(t&&f.time>t.time)){switch(r.loc){case"i":for(e=l=e.ts_prev;e;e=e.ts_prev)if(e.dur){if(e.v==f.v){l=e;break}if(e.st==f.st){l=e;continue}l||(l=e)}else l||(l=e);e=l;break;case"o":for(l=e;l.ts_next;l=l.ts_next);for(f=l;l;l=l.ts_prev){if(l.v==e.v){f=l;break}if(l.st==e.st&&(f=l),l.ts_prev.time!=f.time)break}}if(tsnext&&f.time>=tsnext.time){if(l=null,f.grace&&f.time==tsnext.time){for(l=tsnext;l.time==f.time&&l.type!=C.GRACE;l=l.ts_next);l.type!=C.GRACE&&(l=null)}if(l){for(e.p_v.sls.push(r),f=e.p_v.s_next.prev;f.next;)f=f.next;(r=Object.create(r)).note={s:f}}}switch(7&r.ty){case C.SL_ABOVE:c=1;break;case C.SL_BELOW:c=-1;break;default:c=e.v!=f.v?1:slur_direction(e,f),r.ty&=-8,r.ty|=c>0?C.SL_ABOVE:C.SL_BELOW}if(e.v==f.v&&(o=e.v),o=cur_sy.voices[e.v]&&cur_sy.voices[f.v]?c*(cur_sy.voices[e.v].range<=cur_sy.voices[f.v].range?1:-1)>0?e.v:f.v:e.v>f.v?e.v:f.v,!n||f.grace&&e.v==f.v&&e.time==f.time)u.push(e),e=e.grace?e.next:e.ts_next;else{do{u.push(e),e=e.next}while(e);e=n.next}if(f.grace)if(e.grace)for(;u.push(e),e!=f;)e=e.next;else{for(i=f;i.prev;)i=i.prev;for(;e.v==o&&u.push(e),e.extra!=i;)e=e.ts_next;for(e=i;u.push(e),e!=f;)e=e.next}else for(;e&&(e.v==o&&u.push(e),e!=f);)e=e.ts_next;for(a=1;a<u.length-1;a++)((e=u[a]).sls||e.sl1)&&draw_slurs(e,t),e.tp&&draw_tuplet(e);return draw_slur(u,s,r),1}}for(;;){if(!e||e==t){if(!n||!(e=n.next)||e==t)break;n=null}if(e.type!=C.GRACE){if(e.sls){for(o=e.sls,e.sls=null,a=[],r=0;r<o.length;r++)c(e,o[r])||a.push(o[r]);a.length&&(e.sls=a)}if(e.sl1)for(s=0;s<=e.nhd;s++)if((i=e.notes[s]).sls){for(o=i.sls,i.sls=null,a=[],r=0;r<o.length;r++)c(e,o[r],i)||a.push(o[r]);a.length&&(i.sls=a)}e=e.next}else n=e,e=e.extra}}function draw_tuplet(e){var t,n,r,s,i,o,a,c,l,u,f,d,p,h,m,y,A,g,v=e.tp.shift();for(e.tp.length||delete e.tp,s=e.st,set_dscale(e.st),t=e;t;t=t.next){switch(t.type){case C.GRACE:for(r=t.extra;r;r=r.next)(r.sls||r.sl1)&&draw_slurs(r);default:continue;case C.NOTE:case C.REST:}if((t.sls||t.sl1)&&draw_slurs(t),t.st<s&&(s=t.st),t.tp&&draw_tuplet(t),t.tpe)break}if(t&&t.tpe--,1!=v.f[0])if(t){if(!(A=v.f[3])){for(n=e;n&&!n.stem;)n=n.next;A=n&&n.stem<0?C.SL_BELOW:C.SL_ABOVE}if(e==t||2==v.f[1])i=!0;else if(1==v.f[1])i=!0,draw_slur([e,t],null,{ty:A});else if(2!=v.f[0]&&e.type==C.NOTE&&t.type==C.NOTE){for(i=!0,n=e;;n=n.next){if(n.type!=C.NOTE&&n.type!=C.REST){if(n.type==C.GRACE||n.type==C.SPACE)continue;i=!1;break}if(n==t)break;if(n.beam_end){i=!1;break}}if(i&&!e.beam_st&&!e.beam_br1&&!e.beam_br2)for(n=e.prev;n;n=n.prev)if(n.type==C.NOTE||n.type==C.REST){n.nflags>=e.nflags&&(i=!1);break}if(i&&!t.beam_end)for(n=t.next;n;n=n.next)if(n.type==C.NOTE||n.type==C.REST){!n.beam_br1&&!n.beam_br2&&n.nflags>=t.nflags&&(i=!1);break}}if(i){if(1==v.f[2])return;for(set_font("tuplet"),u=(t.x+e.x)/2,f=A==C.SL_ABOVE?y_get(s,1,u-4,8):y_get(s,0,u-4,8)-gene.curfont.size,e.stem*t.stem>0&&(e.stem>0?u+=1.5:u-=1.5),0==v.f[2]?xy_str(u,f,v.p.toString(),"c"):xy_str(u,f,v.p+":"+v.q,"c"),n=e;!(n.x>=u);n=n.next);A==C.SL_ABOVE?(f+=gene.curfont.size,n.ymx<f&&(n.ymx=f),y_set(s,!0,u-3,6,f)):(n.ymn>f&&(n.ymn=f),y_set(s,!1,u-3,6,f))}else{if(o=e.x-4,t.dur>t.prev.dur){if(!(n=t.next)||n.time!=t.time+t.dur)for(n=t.ts_next;n&&!(n.seqst&&n.time>=t.time+t.dur);n=n.ts_next);a=n?n.x-n.wl-5:realwidth-6}else a=t.x+4,g=t.stem>=0?0:t.nhd,t.notes[g].shhd>0&&(a+=t.notes[g].shhd),t.st==s&&t.stem>0&&(a+=3.5);if(A==C.SL_ABOVE){if(e.st==t.st?c=l=staff_tb[s].topbar+2:(c=e.ymx,l=t.ymx),e.st==s){for(n=e;!n.dur;n=n.next);(f=y_get(s,1,n.x-4,8))>c&&(c=f),e.stem>0&&(o+=3)}if(t.st==s){for(n=t;!n.dur;n=n.prev);(f=y_get(s,1,n.x-4,8))>l&&(l=f)}for(u=.5*(o+a),f=.5*(c+l),y=(l-c)/(a-o),(d=3*(t.notes[t.nhd].pit-e.notes[e.nhd].pit)/(a-o))>0?y<0?y=0:y>d&&(y=d):y>0?y=0:y<d&&(y=d),(y=e.fmt.beamslope*y/(e.fmt.beamslope+Math.abs(y)))*y<.1*.1&&(y=0),m=0,n=e;;n=n.next)if(n.dur&&n.st==s){if(p=f+(n.x-u)*y,(h=y_get(s,1,n.x-4,8)+2)-p>m&&(m=h-p),n==t)break}else if(n==t)break;for(c=(f+=m)+y*(o-u),l=f+y*(a-u),f+=6,n=e;n.st==s&&(p=f+(n.x-u)*y,n.ymx<p&&(n.ymx=p),y_set(s,!0,n.x-3,6,p)),n!=t;n=n.next);}else{if(e.stem<0&&(o-=2),e.st==s){for(n=e;!n.dur;n=n.next);c=y_get(s,0,n.x-4,8)}else c=0;if(t.st==s){for(n=t;!n.dur;n=n.prev);l=y_get(s,0,n.x-4,8)}else l=0;for(u=.5*(o+a),f=.5*(c+l),y=(l-c)/(a-o),(d=3*(t.notes[0].pit-e.notes[0].pit)/(a-o))>0?(y<0?y=0:y>d&&(y=d),y>.35&&(y=.35)):(y>0?y=0:y<d&&(y=d),y<-.35&&(y=-.35)),y*y<.1*.1&&(y=0),m=0,n=e;;n=n.next)if(n.dur&&n.st==s){if(p=f+(n.x-u)*y,(h=y_get(s,0,n.x-4,8))-p<m&&(m=h-p),n==t)break}else if(n==t)break;for(c=(f+=m-8)+y*(o-u),l=f+y*(a-u),f-=2,n=e;n.st==s&&(p=f+(n.x-u)*y,n.ymn>p&&(n.ymn=p),y_set(s,!1,n.x-3,6,p)),n!=t;n=n.next);}1!=v.f[2]?(out_tubrn(o,c,a-o,l-c,A==C.SL_ABOVE,0==v.f[2]?v.p.toString():v.p+":"+v.q),A==C.SL_ABOVE?y_set(s,!0,u-3,6,p+2):y_set(s,!1,u-3,6,p)):out_tubr(o,c+4,a-o,l-c,A==C.SL_ABOVE)}}else error(1,e,"No end of tuplet in this music line")}function draw_tie(e,t,n){var r,s,i,o=2==n?e.pit:t.pit,a=(7&e.tie_ty)==C.SL_ABOVE?1:-1,c=e.s,l=c.st,u=t.s,f=u.x,d=e.shhd;for(r=0;r<c.nhd&&c.notes[r]!=e;r++);if(a>0?r<c.nhd&&o+1==c.notes[r+1].pit&&c.notes[r+1].shhd>d&&(d=c.notes[r+1].shhd):r>0&&o==c.notes[r-1].pit+1&&c.notes[r-1].shhd>d&&(d=c.notes[r-1].shhd),s=c.x+d,2!=n){for(r=0;r<u.nhd&&u.notes[r]!=t;r++);d=u.notes[r].shhd,a>0?r<u.nhd&&o+1==u.notes[r+1].pit&&u.notes[r+1].shhd<d&&(d=u.notes[r+1].shhd):r>0&&o==u.notes[r-1].pit+1&&u.notes[r-1].shhd<d&&(d=u.notes[r-1].shhd),f+=d}switch(n){default:(o<t.pit||a<0)&&(o=e.pit);break;case 3:a=-a;case 1:s=u.prev?u.prev.x+u.wr:c.x,c.st!=u.st&&(l=u.st),(s+=.4*(f-s))>f-20&&(s=f-20);break;case 2:(f=c.next?c.next.x:realwidth)!=realwidth&&(f-=.4*(f-s)),f<s+16&&(f=s+16)}f-s>20?(s+=3.5,f-=3.5):(s+=1.5,f-=1.5),!c.dots||1&e.pit||!(a>0&&!c.dot_low||a<0&&c.dot_low)||(s+=5),slur_out(s,i=staff_tb[l].y+3*(o-18)+a,f,i,a,(.03*(f-s)+16)*a*c.fmt.tieheight,e.tie_ty&C.SL_DOTTED)}function draw_all_ties(e){var t,n,r,s,i,o,a,c=0;for(set_color((n=e.sym).color);n;n=n.next){if(n.ti2&&n.time!=c)for(i=0;i<=n.nhd;i++)(o=(a=n.notes[i]).tie_s)&&o.s.v==n.v&&draw_tie(o,a,1);if(n.ti1)if(n.type!=C.GRACE)for(i=0;i<=n.nhd;i++)if(a=(o=n.notes[i]).tie_e)if(r=a.s,tsnext&&r.time>=tsnext.time)draw_tie(o,a,2);else{for(c=r.time,t=n.ts_next;t!=r;t=t.ts_next)if(t.st==n.st&&t.type==C.CLEF){s=!0;break}s||n.st!=r.st?(draw_tie(o,a,2),draw_tie(o,a,3),s=!1):draw_tie(o,a)}else o.tie_ty&&draw_tie(o,o,2);else for(t=n.extra;t;t=t.next)for(i=0;i<=n.nhd;i++)(a=(o=t.notes[i]).tie_e)&&(draw_tie(o,a),c=a.s.time)}}function draw_sym_near(){var e,t,n,r,s,i,o,a,c,l,u,f,d,p,h=output;function m(e,t){var n,r=realwidth/YSTEP,s=e.x/r|0,i=t.x/r|0,o=(e.ys-t.ys)/(e.xs-t.xs),a=e.ys-e.xs*o,c=staff_tb[e.st];if(r*=o,e.stem>0)for(;s<=i;)n=r*s+a,c.top[s]<n&&(c.top[s]=n),s++;else for(;s<=i;)n=r*s+a,c.bot[s]>n&&(c.bot[s]=n),s++}for(output="",YSTEP=Math.ceil(realwidth/2),c=0;c<=nstaff;c++)for((t=staff_tb[c]).top=new Float32Array(YSTEP),t.bot=new Float32Array(YSTEP),a=0;a<YSTEP;a++)t.top[a]=0,t.bot[a]=24;for(r=0;r<voice_tb.length;r++){var y={},A=!0;for(n=(e=voice_tb[r]).sym;n;n=n.next)if(n.type===C.GRACE){for(p=0,i=n.extra;i;i=i.next)i.beam_st&&!i.beam_end&&(self.calculate_beam(y,i),y.s2&&m(i,y.s2)),(i.sls||i.sl1)&&p++;n.p_v.ckey.k_bagpipe||!n.fmt.graceslurs||n.gr_shift||p||n.ti1||!n.next||n.next.type!=C.NOTE||grace_slur(n)}for(n=e.sym;n;n=n.next)if(n.type===C.NOTE)(n.beam_st&&!n.beam_end||A&&!n.beam_st)&&(A=!1,self.calculate_beam(y,n),y.s2&&m(n,y.s2))}for(set_tie_room(),draw_deco_near(),n=tsfirst;n;n=n.ts_next)if(!n.invis){switch(n.type){case C.GRACE:for(i=n.extra;i;i=i.next)y_set(n.st,!0,i.x-2,4,i.ymx+1),y_set(n.st,!1,i.x-2,4,i.ymn-5);continue;case C.MREST:y_set(n.st,!0,n.x+16,32,n.ymx+2);continue;default:y_set(n.st,!0,n.x-n.wl,n.wl+n.wr,n.ymx+2),y_set(n.st,!1,n.x-n.wl,n.wl+n.wr,n.ymn-2);continue;case C.NOTE:}n.stem>0?(n.stemless?(l=-5,o=10):n.beam_st?(l=3,o=n.beam_end?4:10):(l=-8,o=n.beam_end?11:16),y_set(n.st,!0,n.x+l,o,n.ymx),d=n.ymn,n.notes[0].acc&&d>3*(n.notes[0].pit-18)-9&&(d=3*(n.notes[0].pit-18)-9),y_set(n.st,!1,n.x-n.wl,n.wl+n.wr,d)):(y_set(n.st,!0,n.x-n.wl,n.wl+n.wr,n.ymx),n.stemless?(l=-5,o=10):n.beam_st?(l=-6,o=n.beam_end?4:10):(l=-8,o=n.beam_end?5:16),l+=n.notes[0].shhd,y_set(n.st,!1,n.x+l,o,n.ymn)),n.notes[n.nhd].acc&&(s=n.y+8,n.ymx<s&&(n.ymx=s),y_set(n.st,!0,n.x,0,s)),n.notes[0].acc&&(s=n.y,1==n.notes[0].acc||3==n.notes[0].acc?s-=7:s-=5,n.ymn>s&&(n.ymn=s),y_set(n.st,!1,n.x,0,s))}for(draw_deco_note(),r=0;r<voice_tb.length;r++)if(n=(e=voice_tb[r]).sym)for(set_color(n.color),c=e.st;n;n=n.next)n.play||(n.tp&&draw_tuplet(n),(n.sls||n.sl1)&&draw_slurs(n));for(set_color(),c=0;c<=nstaff;c++)for(u=(t=staff_tb[c]).topbar+2,f=t.botbar-2,a=0;a<YSTEP;a++)u>t.top[a]&&(t.top[a]=u),f<t.bot[a]&&(t.bot[a]=f);for(cfmt.measurenb>=0&&draw_measnb(),set_dscale(-1),r=0;r<voice_tb.length;r++)if((e=voice_tb[r]).have_ly){draw_all_lyrics();break}draw_deco_staff(),set_dscale(-1),output=h}function draw_vname(e,t){var n,r,s,i,o,a,c,l,u,f=[];for(s=t.length;s>=0&&!t[s];s--);if(!(s<0)){for(i=0;i<voice_tb.length;i++)n=voice_tb[i],cur_sy.voices[i]&&t[s=cur_sy.voices[i].st]&&gene.vnt&&(a=2==gene.vnt?n.nm:n.snm)&&(delete n.new_name,f[s]?f[s]+="\n"+a:f[s]=a);if(f.length)for(set_font("voice"),u=(l=gene.curfont.size)/2,e=.5*-e,s=0;s<f.length;s++)if(f[s])for(o=f[s].split("\n"),c=staff_tb[s].y+.5*staff_tb[s].topbar*staff_tb[s].staffscale+u*(o.length-2),cur_sy.staves[s].flags&OPEN_BRACE&&s+1<staff_tb.length&&cur_sy.staves[s+1].flags&CLOSE_BRACE&&!f[s+1]&&(c-=.5*(staff_tb[s].y-staff_tb[s+1].y)),r=0;r<o.length;r++)xy_str(e,c,a=o[r],"c"),c-=l}}function set_staff(){var e,t,n,r,s,i,o,a,c,l,u,f,d=tsfirst.fmt,p=cur_sy;for(r=0;r<voice_tb.length;r++)1!=(u=voice_tb[r]).scale&&(u.scale_str='transform="scale('+u.scale.toFixed(2)+')"');for(t=0;t<=nstaff&&!gene.st_print[t];t++);for(s=0,t>nstaff&&(t--,f=staff_tb[t]),f=staff_tb[t],e=0;e<YSTEP;e++)s<(l=f.top[e])&&(s=l);for(s+=draw_partempo(t,s),(s*=f.staffscale)<(i=.5*d.staffsep+f.topbar*f.staffscale)&&(s=i),s<f.ann_top&&(s=f.ann_top),f.y=-s,n=0;n<t;n++)staff_tb[n].y=-s;if(!gene.st_print[t])return s;var h=p.staves[n];for(t++;t<=nstaff;t++)if(gene.st_print[t]){if(f=staff_tb[t],i=h.sep||cfmt.sysstaffsep,a=h.maxsep||cfmt.maxsysstaffsep,o=0,f.staffscale==staff_tb[n].staffscale){for(e=0;e<YSTEP;e++)o<(l=f.top[e]-staff_tb[n].bot[e])&&(o=l);o*=f.staffscale}else for(e=0;e<YSTEP;e++)o<(l=f.top[e]*f.staffscale-staff_tb[n].bot[e]*staff_tb[n].staffscale)&&(o=l);for(o<(i+=f.topbar*f.staffscale)&&(o=i),o>(a+=f.topbar*f.staffscale)&&(o=a),s+=o,f.y=-s;!gene.st_print[++n];)staff_tb[n].y=-s;for(;!(h=p.staves[n]);)p=p.next}for(c=0,e=0;e<YSTEP;e++)c>(l=staff_tb[n].bot[e])&&(c=l);for(c>f.ann_bot&&(c=f.ann_bot),c*=staff_tb[n].staffscale,t=0;t<=nstaff;t++)o=(f=staff_tb[t]).y,1!=f.staffscale&&(f.scale_str='transform="translate(0,'+(posy-o).toFixed(1)+") scale("+f.staffscale.toFixed(2)+')"');if(0==c){for(t=nstaff;t>=0&&!gene.st_print[t];t--);if(t<0)return s}return(o=-c)<(i=.5*d.staffsep)&&(o=i),o>(a=.5*d.maxstaffsep)&&(o=a),s+o}function draw_systems(e){var t,n,r,s,i,o,a=[],c=[],l=[],u=[],f=[],d="",p="";function h(){var e,t,n,r,s=0;for(e=0;e<=cur_sy.nstaff;e++)a[e]<0?l[e]=u[e]=0:(t=staff_tb[e].staffscale,n=staff_tb[e].topbar*t,r=staff_tb[e].botbar*t,0==s&&(s=staff_tb[e].y+n),l[e]=staff_tb[e].y+r,u[e]=s-l[e],s=cur_sy.staves[e].flags&STOP_BAR?0:l[e])}function m(e,t,n){var r,s,i,o,a,c=0,l="",u=staff_tb[e].stafflines,f=u.length,d=6*staff_tb[e].staffscale;if(/[\[|]/.test(u))if(r=n-t,set_sscale(-1),s=r/staff_tb[e].staffscale,cache&&cache.st_l==u&&cache.st_ws==(0|s))xygl(t,staff_tb[e].y,"stdef"+cfmt.fullsvg);else{for(i=0;i<f;i++,c-=d)if("."!=u[i]){for(o=0;i<f;i++,c-=d,o-=d){switch(u[i]){case".":case"-":continue;case a:l+="m-"+r.toFixed(1)+" "+o+"h"+r.toFixed(1),o=0;continue}null!=a&&(l+='"/>\n'),l+='<path class="'+("["==(a=u[i])?"slthW":"slW")+'" d="m0 '+c+"h"+r.toFixed(1),o=0}l+='"/>'}if(c=staff_tb[e].y,!cache&&r>get_lwidth()-10)return cache={st_l:u,st_ws:0|s},i="stdef"+cfmt.fullsvg,l.indexOf("<path",1)<0?glyphs[i]=l.replace("path",'path id="'+i+'"'):glyphs[i]='<g id="'+i+'">\n'+l+"\n</g>",void xygl(t,c,i);out_XYAB('<g transform="translate(X, Y)">\n'+l+"\n</g>\n",t,c)}}function y(e,t,n){var r,s,i,o=e.bar_type,a=e.st,c=staff_tb[a],l=e.x;if(0!=a&&e.ts_prev&&e.ts_prev.type!=C.BAR&&(n=c.topbar*c.staffscale),e.ymx=e.ymn+n,set_sscale(-1),anno_start(e),e.color&&set_color(e.color),i=c.y+12,"|||||"!=c.stafflines&&(i+=(c.topbar+c.botbar)/2-12),e.bar_mrep){if(set_sscale(a),1==e.bar_mrep){for(s=e.prev;s.type!=C.REST;s=s.prev);xygl(s.x,i,"mrep")}else xygl(l,i,"mrep2"),e.v==cur_sy.top_voice&&nrep_out(l,i+c.topbar,e.bar_mrep);set_sscale(-1)}for("||:"==o&&(o="[|:"),r=o.length;--r>=0;){switch(o[r]){case"|":e.bar_dotted?out_XYAB('<path class="bW" stroke-dasharray="A,A" d="MX Yv-G"/>\n',l,t,(5*c.staffscale).toFixed(1),n):e.color?out_XYAB('<path class="bW" d="MX Yv-F"/>\n',l,t,n):d+="M"+sx(l).toFixed(1)+" "+self.sy(t).toFixed(1)+"v-"+n.toFixed(1);break;default:l-=3,e.color?out_XYAB('<path class="bthW" d="MX Yv-F"/>\n',l+1.5,t,n):p+="M"+sx(l+1.5).toFixed(1)+" "+self.sy(t).toFixed(1)+"v-"+n.toFixed(1);break;case":":l-=2,set_sscale(a),xygl(l+1,i-12,"rdots"),set_sscale(-1)}l-=3}set_color(),anno_stop(e)}function A(e){var t,n=staff_tb[e.st],r=5-e.nflags,s=e.x,i=e.y;if(!(r<6)){switch(7==r&&12==i&&n.stafflines.length<=2&&(i-=6),t=i/6,r){default:switch(n.stafflines[t+1]){case"|":case"[":break;default:set_hl(n,t+1,s,-7,7)}9==r&&(i-=6,t--);break;case 7:i+=6,t++;case 6:}switch(n.stafflines[t]){case"|":case"[":break;default:set_hl(n,t,s,-7,7)}}}for(r=0;r<=nstaff;r++)a[r]=cur_sy.st_print[r]?0:-1,c[r]=cur_sy.st_print[r];for(h(),draw_lstaff(0),t=tsfirst;t;t=t.ts_next)switch(t.type){case C.STAVES:for(o=t.sy,r=0;r<=nstaff;r++)(s=a[r])<0?o.st_print[r]&&(t.ts_prev.bar_type?a[r]=t.ts_prev.x:t.ts_next.bar_type?a[r]=t.x:a[r]=t.ts_prev.x+t.ts_prev.wr,c[r]=!0):o.st_print[r]&&o.staves[r].stafflines==cur_sy.staves[r].stafflines||(t.ts_prev.bar_type?i=t.ts_prev.x:(i=(t.ts_prev.x+t.x)/2,a[r]=-1),m(r,s,i),a[r]=o.st_print[r]?i:-1);cur_sy=o,h();continue;case C.BAR:if(t.invis||!t.bar_type||!cur_sy.st_print[t.st])break;if(t.second&&(!t.ts_prev||t.ts_prev.type==C.BAR&&t.ts_prev.st==t.st))break;f.push([t,l[t.st],u[t.st]]);break;case C.STBRK:if(cur_sy.voices[t.v]&&0==cur_sy.voices[t.v].range&&t.xmx>14){for(var g=0,v=0;v<voice_tb.length;v++)cur_sy.voices[v]&&cur_sy.voices[v].range>0&&g++;for(n=t.ts_next;n&&n.type==C.STBRK;n=n.ts_next)g--;0==g&&draw_lstaff(t.x)}if(r=t.st,(s=a[r])>=0){if(!(n=t.prev))break;if(s>=(i=n.type==C.BAR?n.x:t.x-t.xmx))break;m(r,s,i),a[r]=t.x}break;case C.GRACE:for(n=t.extra;n;n=n.next)self.draw_hl(n);break;case C.NOTE:t.invis||self.draw_hl(t);break;case C.REST:(t.fmr||t.rep_nb&&t.rep_nb>=0)&&center_rest(t),t.invis||A(t)}for(r=0;r<=nstaff;r++)(s=a[r])<0||s>=realwidth||m(r,s,realwidth);draw_all_hl(),function(){var e,t,n,r=f.length;for(set_font("annotation"),(n=gene.curfont.box)&&(gene.curfont.box=0),e=0;e<r;e++)y((t=f[e])[0],t[1],t[2]);n&&(gene.curfont.box=n),set_sscale(-1),d&&(output+='<path class="bW" d="'+d+'"/>\n'),p&&(output+='<path class="bthW" d="'+p+'"/>\n')}(),draw_vname(e,c)}function draw_all_sym(){var e,t,n=voice_tb.length;for(t=0;t<n;t++)(e=voice_tb[t]).sym&&null!=e.sym.x&&(self.draw_symbols(e),draw_all_ties(e),set_color());self.draw_all_deco(),glout(),anno_put(),set_sscale(-1)}function set_tie_dir(e){for(var t,n,r,s,i,o,a;e;e=e.next)if(e.ti1){for(s=n=0,i=128,t=0;t<=e.nhd;t++)e.notes[t].tie_ty&&(n++,i<128&&e.notes[t].pit<=i+1&&s++,i=e.notes[t].pit,a=e.notes[t].tie_e);if(r=a&&e.stem*a.stem<0?i>=22?C.SL_ABOVE:C.SL_BELOW:e.multi?e.multi>0?C.SL_ABOVE:C.SL_BELOW:e.stem<0?C.SL_ABOVE:C.SL_BELOW,e.multi)for(t=0;t<=e.nhd;t++)(7&(o=e.notes[t].tie_ty))==C.SL_AUTO&&(e.notes[t].tie_ty=o&C.SL_DOTTED|r);else if(n<=1){for(t=0;t<=e.nhd;t++)if(o=e.notes[t].tie_ty){(7&o)==C.SL_AUTO&&(e.notes[t].tie_ty=o&C.SL_DOTTED|r);break}}else if(s){for(i=128,t=0;t<=e.nhd;t++)if(e.notes[t].tie_ty){if(i<128&&e.notes[t].pit<=i+1){n=t;break}i=e.notes[t].pit}for(r=C.SL_BELOW,t=0;t<=e.nhd;t++)(o=e.notes[t].tie_ty)&&(n==t&&(r=C.SL_ABOVE),(7&o)==C.SL_AUTO&&(e.notes[t].tie_ty=o&C.SL_DOTTED|r))}else{if(1&n){for(n=(n-1)/2,r=C.SL_BELOW,t=0;t<=e.nhd;t++)(o=e.notes[t].tie_ty)&&(0==n&&e.notes[t].pit>=22&&(r=C.SL_ABOVE),(7&o)==C.SL_AUTO&&(e.notes[t].tie_ty=o&C.SL_DOTTED|r),0==n--&&(r=C.SL_ABOVE));continue}for(n/=2,r=C.SL_BELOW,t=0;t<=e.nhd;t++)(o=e.notes[t].tie_ty)&&((7&o)==C.SL_AUTO&&(e.notes[t].tie_ty=o&C.SL_DOTTED|r),0==--n&&(r=C.SL_ABOVE))}}}function set_tie_room(){var e,t,n,r,s,i;for(n=0;n<voice_tb.length;n++)if((e=voice_tb[n].sym)&&(e=e.next))for(set_tie_dir(e);e;e=e.next)if(e.ti1){if(e.notes[0].pit<20&&e.notes[0].tie_ty&&(7&e.notes[0].tie_ty)==C.SL_BELOW);else if(!(e.notes[e.nhd].pit>24&&e.notes[e.nhd].tie_ty&&(7&e.notes[e.nhd].tie_ty)==C.SL_ABOVE))continue;for(t=e.next;t&&t.type!=C.NOTE;)t=t.next;if(t){if(t.st!=e.st)continue;r=t.x-e.x-10}else r=realwidth-e.x-10;i=r<100?9:r<300?12:16,e.notes[e.nhd].pit>24&&(s=3*(e.notes[e.nhd].pit-18)+i,e.ymx<s&&(e.ymx=s),t&&t.ymx<s&&(t.ymx=s),y_set(e.st,!0,e.x+5,r,s)),e.notes[0].pit<20&&(s=3*(e.notes[0].pit-18)-i,e.ymn>s&&(e.ymn=s),t&&t.ymn>s&&(t.ymn=s),y_set(e.st,!1,e.x+5,r,s))}}Abc.prototype.draw_symbols=function(e){var t,n,r,s,i={};for(t=e.sym;t;t=t.next){if(t.invis)switch(t.type){case C.KEY:e.ckey=t;default:continue;case C.NOTE:}switch(s=t.st,n=t.x,set_color(t.color),t.type){case C.NOTE:set_scale(t),t.beam_st&&!t.beam_end&&self.calculate_beam(i,t)&&draw_beams(i),t.invis||(anno_start(t),draw_note(t,!i.s2),anno_a.push(t)),t==i.s2&&(i.s2=null);break;case C.REST:if(!gene.st_print[s])break;draw_rest(t);break;case C.BAR:break;case C.CLEF:if(t.time>=staff_tb[s].clef.time&&(staff_tb[s].clef=t),t.second||!staff_tb[s].topbar)break;set_color(),set_sscale(s),anno_start(t),r=staff_tb[s].y,t.clef_name?xygl(n,r+t.y,t.clef_name):t.clef_small?xygl(n,r+t.y,"s"+t.clef_type+"clef"):xygl(n,r+t.y,t.clef_type+"clef"),t.clef_octave&&(t.clef_octave>0?(r+=t.ymx-10,t.clef_small&&(r-=1)):(r+=t.ymn+6,t.clef_small&&(r+=1)),xygl(n-2,r,7==t.clef_octave||-7==t.clef_octave?"oct":"oct2")),anno_a.push(t);break;case C.METER:if(e.meter=t,t.second||!staff_tb[t.st].topbar)break;set_color(),set_sscale(t.st),anno_start(t),draw_meter(t),anno_a.push(t);break;case C.KEY:if(e.ckey=t,t.second||!staff_tb[t.st].topbar)break;set_color(),set_sscale(t.st),anno_start(t),self.draw_keysig(n,t),anno_a.push(t);break;case C.MREST:draw_mrest(t);break;case C.GRACE:set_scale(t),draw_gracenotes(t);break;case C.SPACE:case C.STBRK:break;case C.CUSTOS:set_scale(t),draw_note(t,0);break;case C.BLOCK:case C.REMARK:case C.STAVES:case C.TEMPO:break;default:error(2,t,"draw_symbols - Cannot draw symbol "+t.type)}}set_scale(e.sym)};var musicfont='url("data:application/octet-stream;base64,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Ngd1bmlFMDg3B3VuaUUwODgHdW5pRTA4OQd1bmlFMDhBB3VuaUUwOEIHdW5pRTA4Qwd1bmlFMDk0B3VuaUUwOTUHdW5pRTBBMAd1bmlFMEExB3VuaUUwQTIHdW5pRTBBMwd1bmlFMEE0B3VuaUUwQTkHdW5pRTBCMwd1bmlFMTAxB3VuaUUxQjkHdW5pRTFCQgd1bmlFMUU3B3VuaUUxRjIHdW5pRTFGNAd1bmlFMUY3B3VuaUUxRjkHdW5pRTFGQwd1bmlFMUZFB3VuaUUxRkYHdW5pRTIwMAd1bmlFMjQwB3VuaUUyNDEHdW5pRTI0Mgd1bmlFMjQzB3VuaUUyNDQHdW5pRTI0NQd1bmlFMjQ2B3VuaUUyNDcHdW5pRTI0OAd1bmlFMjQ5B3VuaUUyNjAHdW5pRTI2MQd1bmlFMjYyB3VuaUUyNjMHdW5pRTI2NAd1bmlFMjZhB3VuaUUyNmIHdW5pRTI4MAd1bmlFMjgxB3VuaUUyODIHdW5pRTI4Mwd1bmlFNEEwB3VuaUU0QTIHdW5pRTRBNAd1bmlFNEE4B3VuaUU0QUMHdW5pRTRDMAd1bmlFNENFB3VuaUU0RDEHdW5pRTRFMQd1bmlFNEUyB3VuaUU0RTMHdW5pRTRFNAd1bmlFNEU1B3VuaUU0RTYHdW5pRTRFNwd1bmlFNEU4B3VuaUU0RTkHdW5pRTRFQQd1bmlFNTAwB3VuaUU1MDEHdW5pRTUyMAd1bmlFNTIxB3VuaUU1MjIHdW5pRTUyMwd1bmlFNTI0B3VuaUU1MjUHdW5pRTUyOQd1bmlFNTJBB3VuaUU1MkIHdW5pRTUyQwd1bmlFNTJEB3VuaUU1MkYHdW5pRTUzMAd1bmlFNTMxB3VuaUU1MzkHdW5pRTU2Ngd1bmlFNTY3B3VuaUU1NjkHdW5pRTU2Qwd1bmlFNTZEB3VuaUU1ODIHdW5pRTVEMAd1bmlFNUUyB3VuaUU2MTAHdW5pRTYxMgd1bmlFNjE0B3VuaUU2MTgHdW5pRTYyNAd1bmlFNjMwB3VuaUU2NTAHdW5pRTY1NQd1bmlFOTEwB3VuaUU5MTEHdW5pRTkxMgd1bmlFOTE0B3VuaUU5MTUHdW5pRTkxOAd1bmlFOTIwB3VuaUU5MjUHdW5pRTk1RAd1bmlFQTAyB3VuaUVBQTQHdW5pRUNBMgd1bmlFQ0EzB3VuaUVDQTUHdW5pRUNBNwd1bmlFQ0E5B3VuaUVDQjcAAAAAAAAB//8AAgABAAAAAAAAAAwAFAAEAAAAAgAAAAEAAAABAAAAAAABAAAAAN2HW+gAAAAA0ZciFwAAAADeLXWv") format("truetype")',font_tb=[],font_st={},font_scale_tb={serif:1,serifBold:1,"sans-serif":1,"sans-serifBold":1,Palatino:1.1,monospace:1.35},txt_ff="text,serif",fmt_lock={},cfmt={"abc-version":"1",annotationfont:{name:"text,sans-serif",size:12},aligncomposer:1,beamslope:.4,bardef:{"[":"","[]":"","|:":"[|:","|::":"[|::","|:::":"[|:::",":|":":|]","::|":"::|]",":::|":":::|]","::":":][:"},breaklimit:.7,breakoneoln:!0,cancelkey:!0,composerfont:{name:txt_ff,style:"italic",size:14},composerspace:6,decoerr:!0,dynalign:!0,footerfont:{name:txt_ff,size:16},fullsvg:"",gchordfont:{name:"text,sans-serif",size:12},gracespace:new Float32Array([6,8,11]),graceslurs:!0,headerfont:{name:txt_ff,size:16},historyfont:{name:txt_ff,size:16},hyphencont:!0,indent:0,infofont:{name:txt_ff,style:"italic",size:14},infoname:'R "Rhythm: "\nB "Book: "\nS "Source: "\nD "Discography: "\nN "Notes: "\nZ "Transcription: "\nH "History: "',infospace:0,keywarn:!0,leftmargin:1.4*CM,lineskipfac:1.1,linewarn:!0,maxshrink:.65,maxstaffsep:2e3,maxsysstaffsep:2e3,measrepnb:1,measurefont:{name:txt_ff,style:"italic",size:10},measurenb:-1,musicfont:{name:"music",src:musicfont,size:24},musicspace:6,partsfont:{name:txt_ff,size:15},parskipfac:.4,partsspace:8,pagewidth:21*CM,printmargin:0,rightmargin:1.4*CM,rbmax:4,rbmin:2,repeatfont:{name:txt_ff,size:9},scale:1,slurheight:1,spatab:new Float32Array([10.2,13.3,17.3,22.48,29.2,38,49.4,64.2,83.5,108.5]),staffsep:46,stemheight:21,stretchlast:.25,stretchstaff:!0,subtitlefont:{name:txt_ff,size:16},subtitlespace:3,sysstaffsep:34,tempofont:{name:txt_ff,weight:"bold",size:12},textfont:{name:txt_ff,size:16},textspace:14,tieheight:1,titlefont:{name:txt_ff,size:20},titlespace:6,titletrim:!0,topspace:22,tuplets:[0,0,0,0],tupletfont:{name:txt_ff,style:"italic",size:12},vocalfont:{name:txt_ff,weight:"bold",size:13},vocalspace:10,voicefont:{name:txt_ff,weight:"bold",size:13},writefields:"CMOPQsTWw",wordsfont:{name:txt_ff,size:16},wordsspace:5},sfmt={bardef:!0,barsperstaff:!0,beamslope:!0,breaklimit:!0,bstemdown:!0,cancelkey:!0,dynalign:!0,flatbeams:!0,gracespace:!0,hyphencont:!0,keywarn:!0,maxshrink:!0,maxstaffsep:!0,measrepnb:!0,rbmax:!0,rbmin:!0,shiftunison:!0,slurheight:!0,squarebreve:!0,staffsep:!0,stemheight:!0,stretchlast:!0,stretchstaff:!0,tieheight:!0,timewarn:!0,vocalspace:!0};function get_bool(e){return!e||!/^(0|n|f)/i.test(e)}function get_font_scale(e){var t=info_split(e);if(!(t.length<=1)){var n=+t[t.length-1];isNaN(n)||n<=.5?syntax(1,"Bad scale value in %%font"):font_scale_tb[t[0]]=n}}function set_font_fac(e){var t=font_scale_tb[e.fname||e.name];t||(t=1.1),e.swfac=e.size*t}function param_set_font(e,t){var n,r,s;if("-"==e[e.length-2]){if((r=e[e.length-1])<"1"||r>"9")return;e="u"+r+"font"}if(n=(n=cfmt[e])?{name:n.name,size:n.size,box:n.box,pad:n.pad||0}:{pad:0},cfmt[e]=n,(s=t.match(/\s+(no)?box(\s|$)/))&&(s[1]?(n.box=!1,n.pad=0):(n.box=!0,n.pad=.4*n.size-3),t=t.replace(s[0],s[2])),(s=t.match(/\s+padding=([\d.]+)(\s|$)/))&&(n.pad=s[1]?+s[1]:0,t=t.replace(s[0],s[2])),(s=t.match(/\s+class=(.*?)(\s|$)/))&&(n.class=s[1],t=t.replace(s[0],s[2])),s=t.match(/\s+wadj=(.*?)(\s|$)/)){if("undefined"==typeof document)switch(s[1]){case"none":n.wadj="";break;case"space":n.wadj="spacing";break;case"glyph":n.wadj="spacingAndGlyphs";break;default:syntax(1,errs.bad_val,"%%"+e)}t=t.replace(s[0],s[2])}if((s=t.match(/\s+([0-9.]+|\*)$/))&&("*"!=s[1]&&(n.size=+s[1]),t=t.replace(s[0],"")),n.fname=t,"u"==t[0]&&"url("==t.slice(0,4)){if((r=t.indexOf(")",1))<0)return void syntax(1,"No end of url in font family");t=t.slice(0,r+1),n.src=t,n.fid=font_tb.length,font_tb.push(n),n.normal=!0,t="ft"+n.fid}else{if('"'==t[0]){if((r=t.indexOf('"',1))<0)return void syntax(1,"No end of string in font family");t=t.slice(1,r)}switch((s=t.match(/[- ]?[nN]ormal/))&&(n.normal=!0,t=t.replace(s[0],"")),(s=t.match(abc2svg.ft_re))&&(n.weight=abc2svg.ft_w[s[0].replace(/[ -]/,"").toLowerCase()],t=t.replace(s[0],"")),(s=t.match(/[- ]?[iI]talic/))&&(n.style="italic",t=t.replace(s[0],"")),(s=t.match(/[- ]?[oO]blique/))&&(n.style="oblique",t=t.replace(s[0],"")),t=t.trim()){case"":case"*":return;case"Times-Roman":case"Times":t="serif";break;case"Helvetica":t="sans-serif";break;case"Courier":t="monospace";break;case"music":t=cfmt.musicfont.name;break;default:t.indexOf("Fig")>0&&(n.figb=!0)}}n.name=t,n.size?set_font_fac(n):n.swfac=0}function get_unit(e){var t=e.toLowerCase().match(/(-?[\d.]+)(.*)/);if(!t)return NaN;switch(t[1]=+t[1],t[2]){case"cm":return t[1]*CM;case"in":return t[1]*IN;case"pt":return.75*t[1];case"px":case"":return t[1]}return NaN}function set_infoname(e){for(var t=cfmt.infoname.split("\n"),n=e[0],r=0;r<t.length;r++){if(t[r][0]==n)return 1==e.length?t.splice(r,1):t[r]=e,void(cfmt.infoname=t.join("\n"))}cfmt.infoname+="\n"+e}var textopt={align:"j",center:"c",fill:"f",justify:"j",obeylines:"l",ragged:"f",right:"r",skip:"s"};function get_textopt(e){var t=e.indexOf(" ");return t>0&&(e=e.slice(0,t)),textopt[e]}var posval={above:C.SL_ABOVE,auto:0,below:C.SL_BELOW,down:C.SL_BELOW,hidden:C.SL_HIDDEN,opposite:C.SL_HIDDEN,under:C.SL_BELOW,up:C.SL_ABOVE};function set_pos(e,t){"ste"==(e=e.slice(0,3))&&(e="stm"),set_v_param("pos",'"'+e+" "+t+'"')}function set_writefields(e){var t,n,r=e.split(/\s+/);if(get_bool(r[1]))for(n=0;n<r[0].length;n++)t=r[0][n],cfmt.writefields.indexOf(t)<0&&(cfmt.writefields+=t);else for(n=0;n<r[0].length;n++)t=r[0][n],cfmt.writefields.indexOf(t)>=0&&(cfmt.writefields=cfmt.writefields.replace(t,""))}function set_v_param(e,t){e=[e+"=",t],parse.state<3?memo_kv_parm(curvoice?curvoice.id:"*",e):curvoice?set_kv_parm(e):memo_kv_parm("*",e)}function set_page(){img.chg&&(img.chg=!1,img.lm=cfmt.leftmargin-cfmt.printmargin,img.lm<0&&(img.lm=0),img.rm=cfmt.rightmargin-cfmt.printmargin,img.rm<0&&(img.rm=0),img.width=cfmt.pagewidth-2*cfmt.printmargin,img.width-img.lm-img.rm<100&&(error(0,void 0,"Bad staff width"),img.width=img.lm+img.rm+150),set_posx())}function st_font(e){var t=e.name,n="";return e.weight&&(n+=e.weight+" "),e.style&&(n+=e.style+" "),t.indexOf('"')<0&&t.indexOf(" ")>0&&(t='"'+t+'"'),n+e.size.toFixed(1)+"px "+t}function style_font(e){return"font:"+st_font(e)}function font_class(e){var t="f"+e.fid+cfmt.fullsvg;return e.class&&(t+=" "+e.class),e.box&&(t+=" box"),t}function use_font(e){e.used||(e.used=!0,null==e.fid&&(e.fid=font_tb.length,font_tb.push(e),e.swfac||set_font_fac(e),e.pad||(e.pad=0)),add_fstyle(".f"+e.fid+(cfmt.fullsvg||"")+"{"+style_font(e)+"}"),e.src&&add_fstyle("@font-face{\n font-family:"+e.name+";\n src:"+e.src+"}"),e==cfmt.musicfont&&add_fstyle(".f"+e.fid+(cfmt.fullsvg||"")+" text,tspan{white-space:pre}"))}function get_font(e){var t,n,r,s;if(!(t=cfmt[e+="font"]))return syntax(1,"Unknown font $1",e),gene.curfont;if(!t.name||!t.size){if(n=Object.create(gene.deffont),t.name&&(n.name=t.name),t.normal?(n.weight&&(n.weight=null),n.style&&(n.style=null)):(t.weight&&(n.weight=t.weight),t.style&&(n.style=t.style)),t.src&&(n.src=t.src),t.size&&(n.size=t.size),s=st_font(n),t.class&&(n.class=t.class,s+=" "+t.class),null!=(r=font_st[s]))return font_tb[r];font_st[s]=font_tb.length,n.fid=n.used=void 0,t=n}return use_font(t),t}Abc.prototype.set_format=function(e,t){var n,r,s,i;if(/.+font(-[\d])?$/.test(e))"soundfont"==e?cfmt.soundfont=t:param_set_font(e,t);else{switch(sfmt[e]&&parse.ufmt&&(cfmt=Object.create(cfmt)),e){case"aligncomposer":case"barsperstaff":case"infoline":case"measurenb":case"rbmax":case"rbmin":case"measrepnb":case"shiftunison":if(s=parseInt(t),isNaN(s)){syntax(1,"Bad integer value");break}cfmt[e]=s;break;case"abc-version":case"bgcolor":case"fgcolor":case"titleformat":cfmt[e]=t;break;case"beamslope":case"breaklimit":case"lineskipfac":case"maxshrink":case"pagescale":case"parskipfac":case"scale":case"slurheight":case"stemheight":case"tieheight":if(n=+t,isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}switch(e){case"scale":n/=.75;case"pagescale":e="scale",img.chg=!0}cfmt[e]=n;break;case"annotationbox":case"gchordbox":case"measurebox":case"partsbox":param_set_font(e.replace("box","font"),"* * "+(get_bool(t)?"box":"nobox"));break;case"altchord":case"bstemdown":case"breakoneoln":case"cancelkey":case"checkbars":case"contbarnb":case"custos":case"decoerr":case"flatbeams":case"graceslurs":case"graceword":case"hyphencont":case"keywarn":case"linewarn":case"quiet":case"singleline":case"squarebreve":case"splittune":case"straightflags":case"stretchstaff":case"timewarn":case"titlecaps":case"titleleft":cfmt[e]=get_bool(t);break;case"dblrepbar":t=":: "+t;case"bardef":2!=(s=t.split(/\s+/)).length?syntax(1,errs.bad_val,"%%bardef"):(parse.ufmt&&(cfmt.bardef=Object.create(cfmt.bardef)),cfmt.bardef[s[0]]=s[1]);break;case"chordalias":(s=t.split(/\s+/)).length?abc2svg.ch_alias[s[0]]=s[1]||"":syntax(1,errs.bad_val,"%%chordalias");break;case"composerspace":case"indent":case"infospace":case"maxstaffsep":case"maxsysstaffsep":case"musicspace":case"partsspace":case"staffsep":case"subtitlespace":case"sysstaffsep":case"textspace":case"titlespace":case"topspace":case"vocalspace":case"wordsspace":n=get_unit(t),isNaN(n)?syntax(1,errs.bad_val,"%%"+e):cfmt[e]=n;break;case"page-format":user.page_format=get_bool(t);break;case"print-leftmargin":syntax(0,"$1 is deprecated - use %%printmargin instead","%%"+e),e="printmargin";case"printmargin":case"leftmargin":case"pagewidth":case"rightmargin":if(n=get_unit(t),isNaN(n)){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=n,img.chg=!0;break;case"concert-score":"play"!=cfmt.sound&&(cfmt.sound="concert");break;case"writefields":set_writefields(t);break;case"dynamic":case"gchord":case"gstemdir":case"ornament":case"stemdir":case"vocal":case"volume":set_pos(e,t);break;case"font":get_font_scale(t);break;case"fullsvg":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%fullsvg");break}cfmt[e]=t;break;case"gracespace":for(s=t.split(/\s+/),i=0;i<3;i++)if(isNaN(+s[i])){syntax(1,errs.bad_val,"%%gracespace");break}for(parse.ufmt&&(cfmt[e]=new Float32Array(3)),i=0;i<3;i++)cfmt[e][i]=+s[i];break;case"tuplets":(n=(s=t.split(/\s+/))[3])&&(n=posval[n]),n&&(s[3]=n),curvoice?curvoice.tup=s:cfmt[e]=s;break;case"infoname":set_infoname(t);break;case"notespacingfactor":if((s=t.match(/([.\d]+)[,\s]*(\d+)?/))&&(n=+s[1],isNaN(n)||n<1||n>2?n=0:s[2]?(r=+s[2],isNaN(n)&&(n=0)):r=cfmt.spatab[5]),!n){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=t,cfmt.spatab=new Float32Array(10),i=5;do{cfmt.spatab[i]=r,r/=n}while(--i>=0);for(i=5,r=cfmt.spatab[i];++i<cfmt.spatab.length;)r*=n,cfmt.spatab[i]=r;break;case"play":cfmt.sound="play";break;case"pos":if(!(e=t.match(/(\w*)\s+(.*)/))||!e[2]){syntax(1,"Error in %%pos");break}if("tup"==e[1].slice(0,3)&&curvoice){switch(curvoice.tup?curvoice.tup=Object.create(curvoice.tup):curvoice.tup=cfmt.tuplets,s=posval[e[2]]){case C.SL_ABOVE:curvoice.tup[3]=1;break;case C.SL_BELOW:curvoice.tup[3]=2;break;case C.SL_HIDDEN:curvoice.tup[2]=1}break}set_pos(e[1],e[2]);break;case"sounding-score":"play"!=cfmt.sound&&(cfmt.sound="sounding");break;case"staffwidth":if(s=get_unit(t),isNaN(s)){syntax(1,errs.bad_val,"%%"+e);break}if(s<100){syntax(1,"%%staffwidth too small");break}if((s=cfmt.pagewidth-s-cfmt.leftmargin)<2){syntax(1,"%%staffwidth too big");break}cfmt.rightmargin=s,img.chg=!0;break;case"textoption":cfmt[e]=get_textopt(t);break;case"dynalign":case"stretchlast":case"titletrim":if(s=+t,isNaN(s)&&(s=get_bool(t)?0:1),"s"==e[0]&&(s<0||s>1)){syntax(1,errs.bad_val,"%%"+e);break}cfmt[e]=s;break;case"combinevoices":syntax(1,"%%combinevoices is deprecated - use %%voicecombine instead");break;case"voicemap":set_v_param("map",t);break;case"voicescale":set_v_param("scale",t);break;case"rbdbstop":(s=get_bool(t))&&cfmt["abc-version"]>="2.2"?cfmt["abc-version"]="1":!s&&cfmt["abc-version"]<"2.2"&&(cfmt["abc-version"]="2.2");break;default:parse.state||(cfmt[e]=t)}sfmt[e]&&parse.ufmt&&(parse.ufmt=!1)}},Abc.prototype.style_font=style_font;var sav={},mac={},maci={},abc_utf={"=D":"Đ","=H":"Ħ","=T":"Ŧ","=d":"đ","=h":"ħ","=t":"ŧ","/O":"Ø","/o":"ø","/L":"Ł","/l":"ł",vL:"Ľ",vl:"ľ",vd:"ď",".i":"ı",AA:"Å",aa:"å",AE:"Æ",ae:"æ",DH:"Ð",dh:"ð",OE:"Œ",oe:"œ",ss:"ß",TH:"Þ",th:"þ"},oct_acc={1:"♯",2:"♭",3:"♮",4:"&#x1d12a;",5:"&#x1d12b;"};function cnv_escape(e,t){for(var n,r,s,i="",o=0;!((s=e.indexOf("\\",o))<0);){if(i+=e.slice(o,s),!(n=e[++s]))return i+"\\";switch(n){case"0":case"2":if("0"!=e[s+1])break;if(r=oct_acc[e[s+2]]){i+=r,o=s+3;continue}break;case"u":if(o=Number("0x"+e.slice(s+1,s+5)),isNaN(o)||o<32){i+=e[++s]+"̆",o=s+1;continue}if("\\"==(n=String.fromCharCode(o))){s+=4;break}i+=n,o=s+5;continue;case"t":i+="\t",o=s+1;continue;case"n":i+="\n",o=s+1;continue;default:if(r=abc_utf[e.slice(s,s+2)]){i+=r,o=s+2;continue}if(!(r=e[s+1]))break;if(!/[A-Za-z]/.test(r))break;switch(n){case"`":i+=r+"̀",o=s+2;continue;case"'":i+=r+"́",o=s+2;continue;case"^":i+=r+"̂",o=s+2;continue;case"~":i+=r+"̃",o=s+2;continue;case"=":i+=r+"̄",o=s+2;continue;case"_":i+=r+"̅",o=s+2;continue;case".":i+=r+"̇",o=s+2;continue;case'"':i+=r+"̈",o=s+2;continue;case"o":i+=r+"̊",o=s+2;continue;case"H":i+=r+"̋",o=s+2;continue;case"v":i+=r+"̌",o=s+2;continue;case"c":i+=r+"̧",o=s+2;continue;case";":i+=r+"̨",o=s+2;continue}}"w"==t&&(i+="\\"),i+=n,o=s+1}return i+e.slice(o)}var include=0,gene,staff_tb,nstaff,tsnext,realwidth,insert_meter,spf_last,smallest_duration;function do_include(e){var t,n;user.read_file?include>2?syntax(1,"Too many include levels"):(t=user.read_file(e))?(include++,n=clone(parse),tosvg(e,t),n.state=parse.state,parse=n,include--):syntax(1,"Cannot read file '$1'",e):syntax(1,"No read_file support")}function tosvg(e,t,n,r){var s,i,o,a,c,l,u,f,d,p,h,m,y="\n";function A(){var e,s,o=t.indexOf("K:",n);return!(o<0)&&(o=t.indexOf("\n",o),!!parse.select.test(t.slice(parse.bol,o))||((e=/\n\w*\n/).lastIndex=o,s=e.exec(t),i=s?e.lastIndex:r,!1))}function g(e,t){if(!e)return e;var n=e.indexOf("%");return 0==n?"":(n>0&&(e=e.replace(/([^\\])%.*/,"$1").replace(/\\%/g,"%")),e=e.replace(/\s+$/,""),t&&e.indexOf("\\")>=0?cnv_escape(e,t):e)}function v(){generate(),cfmt=sav.cfmt,info=sav.info,char_tb=sav.char_tb,glovar=sav.glovar,maps=sav.maps,mac=sav.mac,maci=sav.maci,parse.tune_v_opts=null,parse.scores=null,parse.ufmt=!1,delete parse.ctrl,init_tune(),img.chg=!0,set_page()}function _(e,n){var r,s;if("end"!=e){for(n?(parse.tune_v_opts||(parse.tune_v_opts={}),r=parse.tune_v_opts):(parse.voice_opts||(parse.voice_opts={}),r=parse.voice_opts),r[e]=[];s=++i,"%"==t[s];)if(i=t.indexOf("\n",i),t[s+1]==l){switch(s+=2,d=i<0?t.slice(s):t.slice(s,i),(p=d.match(/\S+/))[0]){default:r[e].push(g(d,!0));continue;case"score":case"staves":case"tune":case"voice":s-=2}break}i=parse.eol=s-1}}function b(){var e,r,s,i,o=t.indexOf("K:",n);for(o in o=t.indexOf("\n",o),i=t.slice(parse.bol,o),parse.tune_opts)if(parse.tune_opts.hasOwnProperty(o)&&new RegExp(o).test(i)){for(e=parse.tune_opts[o],r=0;r<e.t_opts.length;r++)switch((s=e.t_opts[r]).match(/\S+/)[0]){case"score":case"staves":parse.scores||(parse.scores=[]),parse.scores.push(s);break;default:self.do_pscom(s)}if(e=e.v_opts)for(r in e)e.hasOwnProperty(r)&&(parse.tune_v_opts||(parse.tune_v_opts={}),parse.tune_v_opts[r]?parse.tune_v_opts[r]=parse.tune_v_opts[r].concat(e[r]):parse.tune_v_opts[r]=e[r])}}for(abc2svg.modules&&(abc2svg.modules.hooks.length||abc2svg.modules.g_hooks.length)&&set_hooks(),parse.file=t,parse.fname=e,null==n&&(n=0),r||(r=t.length),"%abc-"==t.slice(n,n+5)&&(cfmt["abc-version"]=/[1-9.]+/.exec(t.slice(n+5,n+10)));n<r;n=parse.eol+1){for(((i=t.indexOf("\n",n))<0||i>r)&&(i=r),parse.eol=i;;){switch(i--,t[i]){case" ":case"\t":continue}break}if(++i!=n){if(parse.istart=parse.bol=n,parse.iend=i,parse.line.index=0,c=t[n],l=t[n+1],"%"==c){if(parse.prefix.indexOf(l)<0)continue;"a"==t[n+2]&&"b"==t[n+3]&&"c"==t[n+4]&&" "==t[n+5]?(c=t[n+=6],l=t[n+1]):m=!0}else"I"==c&&":"==l&&(m=!0);if(m){if(m=!1,n+=2,d=t.slice(n,i),!(p=d.match(/([^\s]+)\s*(.*)/))||"%"==p[1][0])continue;switch(p[1]){case"abcm2ps":case"ss-pref":parse.prefix=p[2];continue;case"abc-include":do_include(g(p[2]));continue}if("begin"==p[1].slice(0,5)){if(h=p[1].substr(5),o="\n"+c+l+"end"+h,(s=t.indexOf(o,i))<0){syntax(1,"No $1 after %%$2",o.slice(1),p[1]),parse.eol=r;continue}self.do_begin_end(h,g(p[2]),t.slice(i+1,s).replace(/\n%[^%].*$/gm,"").replace(/^%%/gm,"")),parse.eol=t.indexOf("\n",s+6),parse.eol<0&&(parse.eol=r);continue}switch(p[1]){case"select":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%select");continue}if('"'==(a=g(d.slice(7)))[0]&&(a=a.slice(1,-1)),!a){delete parse.select;continue}a=(a=a.replace(/\(/g,"\\(")).replace(/\)/g,"\\)"),parse.select=new RegExp(a,"m");continue;case"tune":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%tune");continue}if(!(a=g(p[2]))){parse.tune_opts={};continue}if("end"==a)continue;for(parse.tune_opts||(parse.tune_opts={}),parse.tune_opts[a]=f={t_opts:[]};n=++i,"%"==t[n];)if(i=t.indexOf("\n",i),t[n+1]==l){switch(n+=2,d=i<0?t.slice(n):t.slice(n,i),(p=d.match(/([^\s]+)\s*(.*)/))[1]){case"tune":break;case"voice":_(g(p[2],!0),!0);continue;default:f.t_opts.push(g(d,!0));continue}break}parse.tune_v_opts&&(f.v_opts=parse.tune_v_opts,parse.tune_v_opts=null),parse.eol=n-1;continue;case"voice":if(0!=parse.state){syntax(1,errs.not_in_tune,"%%voice");continue}if(!(a=g(p[2]))){parse.voice_opts=null;continue}_(a);continue}self.do_pscom(g(d,!0))}else if(":"==l&&/[A-Za-z+]/.test(c)){for(n+=2;;){switch(t[n]){case" ":case"\t":n++;continue}break}if("+"==c){if(!u){syntax(1,"+: without previous info field");continue}y=" ",c=u}switch(d=g(t.slice(n,i),c),c){case"X":if(0!=parse.state){syntax(1,errs.ignored,c);continue}if(parse.select&&!A()){(i=t.indexOf("\nX:",parse.eol))<0&&(i=r),parse.eol=i;continue}sav.cfmt=clone(cfmt),sav.info=clone(info,2),sav.char_tb=clone(char_tb),sav.glovar=clone(glovar),sav.maps=clone(maps,1),sav.mac=clone(mac),sav.maci=clone(maci),info.X=d,parse.state=1,user.page_format&&blkdiv<1&&(blkdiv=1),parse.tune_opts&&b();continue;case"T":switch(parse.state){case 0:continue;case 1:case 2:null==info.T?info.T=d:info.T+="\n"+d;continue}new_block("title").text=d;continue;case"K":switch(parse.state){case 0:continue;case 1:info.K=d}do_info(c,d);continue;case"W":if(0==parse.state||cfmt.writefields.indexOf(c)<0)break;null==info.W?info.W=d:info.W+=y+d;break;case"m":if(parse.state>=2){syntax(1,errs.ignored,c);continue}if(!(p=d.match(/(.*?)[= ]+(.*)/))||!p[2]){syntax(1,errs.bad_val,"m:");continue}mac[p[1]]=p[2],maci[p[1][0]]=!0;break;case"s":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;get_sym(d," "==y);break;case"w":if(3!=parse.state||cfmt.writefields.indexOf(c)<0)break;get_lyrics(d," "==y);break;case"|":if(parse.state<2)continue;parse.line.buffer=d,parse_music_line();continue;default:if("ABCDFGHNOSZ".indexOf(c)>=0){if(parse.state>=2){syntax(1,errs.ignored,c);continue}info[c]?info[c]+=y+d:info[c]=d;break}do_info(c,d);continue}y="\n",u=c}else{if(u=void 0,parse.state<2)continue;parse.line.buffer=g(t.slice(n,i)),parse.line.buffer&&parse_music_line()}}else 1==parse.state?(parse.istart=n,syntax(1,"Empty line in tune header - ignored")):parse.state>=2&&(v(),parse.state=0,parse.select&&((i=t.indexOf("\nX:",parse.eol))<0&&(i=r),parse.eol=i))}include||(parse.state>=2&&v(),parse.state=0)}Abc.prototype.tosvg=tosvg;var dx_tb=new Float32Array([10,10,11,13,15]),hw_tb=new Float32Array([4.7,5,6,7.2,7.5]),w_note=new Float32Array([3.5,3.7,5,6,7]);function identify_note(e,t){var n,r,s=0,i=t;for(i%12!=0&&error(1,e,"Invalid note duration $1",i),(i/=12)||error(1,e,"Note too short"),r=5;i&&!(1&i);i>>=1,r--);for((i>>=1)+1&i&&(e.type==C.REST&&t==e.p_v.wmeasure||error(0,e,"Non standard note duration $1",t));i>>s>0;)s++;if((r-=s)>=0)n=C.FULL;else switch(r){default:error(1,e,"Note too long"),r=-4;case-4:n=C.SQUARE;break;case-3:n=e.fmt.squarebreve?C.SQUARE:C.OVALBARS;break;case-2:n=C.OVAL;break;case-1:n=C.EMPTY}return[n,s,r]}function set_head_shift(e){var t,n,r,s,i,o,a=dx_tb[e.head],c=e.stem,l=e.nhd;if(l){o=.74*a,e.grace&&(o*=.6),c>=0?(n=1,r=l+1,i=e.notes[0].pit):(o=-o,n=l-1,r=-1,i=e.notes[l].pit);var u=!1,f=0;for(t=n;t!=r;t+=c){if(s=e.notes[t].pit-i,i=e.notes[t].pit,!s){if(u){var d=e.notes[t].shhd=e.notes[t-c].shhd+o;f<d&&(f=d);continue}if(t+c!=r&&i+c==e.notes[t+c].pit){e.notes[t].shhd=-o,f<-o&&(f=-o);continue}}s<0&&(s=-s),s>3||s>=2&&e.head!=C.SQUARE?u=!1:(u=!u)&&(e.notes[t].shhd=o,f<o&&(f=o))}e.xmx=f}}function acc_shift(e,t){var n,r,s,i,o,a,c,l,u,f=e.length;for(n=f-1;--n>=0;)if((i=e[n].shhd)&&!(i>0))for(i=t-i,c=e[n].pit,r=f;--r>=0;)if(e[r].acc){if((l=e[r].pit)<c-3)break;l>c+3||e[r].shac<i&&(e[r].shac=i)}for(r=f;--r>=0;)if(e[r].acc){l=e[r].pit,(o=e[r].shac)||(o=(o=e[r].shhd)<0?t-o:t);break}if(!(r<0)){for(s=0;s<r;s++)if(e[s].acc){c=e[s].pit,(a=e[s].shac)||(a=(a=e[s].shhd)<0?t-a:t);break}if(r!=s){for(l>c+4?(o>a&&(a=o),e[r].shac=e[s].shac=a):(e[r].shac=o,o+=7,e[s].shac=a=o),a+=7,n=r;--n>s;)if(u=e[n].acc){for((i=e[n].shac)<a&&(i=a),c=e[n].pit,r=f;--r>n;)e[r].acc&&((l=e[r].pit)>=c+4&&(l>c+4||u<0||e[r].acc<0)||i>e[r].shac-6&&(o=e[r].shac+7)>i&&(i=o));e[n].shac=i}}else e[r].shac=o}}function set_acc_shft(){var e,t,n,r,s,i,o,a;for(e=tsfirst;e;)if(e.type!=C.NOTE||e.invis)e=e.ts_next;else{for(s=e.st,i=e.time,r=!1,t=e;t&&(t.time==i&&t.type==C.NOTE&&t.st==s);t=t.ts_next)if(!r)for(n=0;n<=t.nhd;n++)if(t.notes[n].acc){r=!0;break}if(r){for(o=dx_tb[e.head],a=[];e!=t;e=e.ts_next)Array.prototype.push.apply(a,e.notes);a.sort(abc2svg.pitcmp),acc_shift(a,o)}else e=t}}function lkvsym(e,t){e.next=t,e.prev=t.prev,e.prev?e.prev.next=e:e.p_v.sym=e,t.prev=e}function lktsym(e,t){var n;e.ts_next=t,t?(e.ts_prev=t.ts_prev,e.ts_prev&&(e.ts_prev.ts_next=e),t.ts_prev=e):(error(2,e,"Bad linkage"),e.ts_prev=null),e.seqst=!e.ts_prev||e.time!=e.ts_prev.time||w_tb[e.ts_prev.type]!=w_tb[e.type]&&w_tb[e.ts_prev.type],t&&(t.seqst=t.time!=e.time||w_tb[e.type]!=w_tb[t.type]&&w_tb[e.type],t.seqst&&(n=t.wl,self.set_width(t),t.a_ly&&ly_set(t),t.shrink?t.shrink+=t.wl-n:(t.shrink=t.wl,t.prev&&(t.shrink+=t.prev.wr)),t.space=0))}function unlksym(e){e.next&&(e.next.prev=e.prev),e.prev?e.prev.next=e.next:e.p_v.sym=e.next,e.ts_next&&(e.seqst?e.ts_next.seqst?(e.ts_next.shrink+=e.shrink,e.ts_next.space+=e.space):(e.ts_next.seqst=!0,e.ts_next.shrink=e.shrink,e.ts_next.space=e.space):e.ts_next.seqst&&e.ts_prev&&e.ts_prev.seqst&&!w_tb[e.ts_prev.type]&&(e.ts_next.seqst=!1,e.shrink=e.ts_next.shrink,e.space=e.ts_next.space),e.ts_next.ts_prev=e.ts_prev),e.ts_prev&&(e.ts_prev.ts_next=e.ts_next),tsfirst==e&&(tsfirst=e.ts_next),tsnext==e&&(tsnext=e.ts_next)}function insert_clef(e,t,n){var r,s=e.p_v,i=e.st;for(e.type==C.BAR&&e.prev&&e.prev.type==C.BAR&&":"!=e.prev.bar_type[0]&&(e=e.prev),s.last_sym=e.prev,s.last_sym||(s.sym=null),s.time=e.time,(r=sym_add(s,C.CLEF)).next=e,e.prev=r,r.clef_type=t,r.clef_line=n,r.st=i,r.clef_small=!0,delete r.second,r.notes=[],r.notes[0]={pit:e.notes[0].pit},r.nhd=0;!e.seqst;)e=e.ts_prev;return lktsym(r,e),e.soln&&(r.soln=!0,delete e.soln),r}function set_float(){var e,t,n,r,s,i,o,a;for(r=0;r<voice_tb.length;r++)for(n=!1,t=(e=voice_tb[r]).st,s=e.sym;s;s=s.next){if(!s.floating){for(;s&&!s.floating;)s=s.next;if(!s)break;n=!1}if(s.dur)if(s.notes[0].pit>=19)n=!1;else if(s.notes[s.nhd].pit<=12)n=!0,s.st++;else{for(o=127,i=s.ts_prev;i&&(i.st==t&&i.v!=s.v);i=i.ts_prev)i.type==C.NOTE&&i.notes[0].pit<o&&(o=i.notes[0].pit);if(127!=o)if(s.notes[s.nhd].pit>o-3)n=!1;else{for(a=-127,i=s.ts_next;i&&(i.st==t+1&&i.v!=s.v);i=i.ts_next)i.type==C.NOTE&&i.notes[i.nhd].pit>a&&(a=i.notes[i.nhd].pit);if(-127!=a)if(s.notes[0].pit<a+3)n=!0,s.st++;else{if(o-=s.notes[s.nhd].pit,a=s.notes[0].pit-a,n){if(o<a-3){n=!1;continue}}else{if(o<a+3)continue;n=!0}s.st++}else n&&s.st++}else n&&s.st++}else n&&s.st++}}function set_graceoffs(e){var t,n,r,s,i=e.fmt.gracespace[0],o=e.fmt.gracespace[1],a=e.fmt.gracespace[2],c=e.extra;for(e.prev&&e.prev.type==C.BAR&&(i-=3),s=i,c.beam_st=!0;;c=c.next){for(set_head_shift(c),acc_shift(c.notes,6.5),r=0,n=c.nhd;n>=0;n--)c.notes[n].shac-2>r&&(r=c.notes[n].shac-2);if(s+=r,c.x=s,c.nflags<=0&&(c.beam_st=c.beam_end=!0),!(t=c.next)){c.beam_end=!0;break}t.nflags<=0&&(c.beam_end=!0),c.beam_end&&(t.beam_st=!0,s+=o/4),c.nflags<=0&&(s+=o/4),c.y>t.y+8&&(s-=1.5),s+=o}return(t=e.next)&&t.type==C.NOTE&&(c.y>=3*(t.notes[t.nhd].pit-18)?a-=1:c.beam_st&&c.y<3*(t.notes[t.nhd].pit-18)-4&&(a+=2)),s+=a}function set_w_chs(e){var t,n,r,s,i,o=0,a=0;for(set_font("vocal");e;e=e.ts_next)if(e.shrink&&(o+=e.shrink,a++),e.a_ly&&ly_set(e),e.a_gch)for(t=0;t<e.a_gch.length;t++)if(!("g"!=(n=e.a_gch[t]).type||n.y<0)){if(r&&r>o+n.x)for(e.prev&&e.prev.seqst&&e.prev.type==C.BAR&&a--,i=(r-o-n.x)/a;(s=s.ts_next).shrink&&(s.shrink+=i),s!=e&&s.type!=C.BAR;);s=e,r=n.text.wh[0],a=0,o=0;break}}function gchord_width(e,t,n){var r,s,i,o=0;for(i=0;i<e.a_gch.length;i++)switch((r=e.a_gch[i]).type){case"<":(s=r.text.wh[0]+t)>n&&(n=s);break;case">":(s=r.text.wh[0]+e.wr)>o&&(o=s)}return e.wr<o&&(e.wr=o),n}function time2space(e,t){var n,r,s;return smallest_duration>=C.BLEN/2?smallest_duration>=C.BLEN?t/=4:t/=2:!e.next&&t>=C.BLEN&&(t/=2),n=t>=C.BLEN/4?t<C.BLEN/2?5:t<C.BLEN?6:t<2*C.BLEN?7:t<4*C.BLEN?8:9:t>=C.BLEN/8?4:t>=C.BLEN/16?3:t>=C.BLEN/32?2:t>=C.BLEN/64?1:0,r=t-(C.BLEN/16/8<<n),s=cfmt.spatab[n],r&&(r<0?s=cfmt.spatab[0]*t/(C.BLEN/16/8):(n>=9&&(n=8),s+=(cfmt.spatab[n+1]-cfmt.spatab[n])*r/(C.BLEN/16/8<<n))),s}function set_space(e,t){var n,r,s,i;if(!(r=e.time-t))return e.type===C.MREST?e.wl:0;if(e.ts_prev.type==C.MREST)return 71;for(n=time2space(e,r);!e.dur;){switch(e.type){case C.BAR:return e.next||(n*=.9),.9*n-3;case C.CLEF:return n-e.wl-e.wr;case C.BLOCK:case C.REMARK:case C.STAVES:case C.TEMPO:if(!(e=e.ts_next))return n;continue}break}if(e.dur&&r<=C.BLEN/4)for(s=e;s;){if(!s.beam_st){n*=.9;break}if(!(s=s.ts_next)||s.seqst)break}if(e.type==C.NOTE&&e.nflags>=-1&&e.stem>0){for(i=!0,s=e.ts_prev;s&&s.time==t;s=s.ts_prev)if(s.type==C.NOTE&&(s.nflags<-1||s.stem>0)){i=!1;break}if(i){for(s=e.ts_next;s&&s.time==e.time;s=s.ts_next)if(s.type==C.NOTE&&(s.nflags<-1||s.stem<0)){i=!1;break}i&&(n*=.9)}}return n}function set_sp_tup(e,t){for(var n=e.time,r=t.time-n,s=time2space(e,r),i=e,o=0;(i=i.ts_next).seqst&&(o+=i.space,i.bar_type&&(o+=10)),i!=t;);for(s=(s+o)/2/r;(e=e.ts_next).seqst&&(e.space=s*(e.time-n),n=e.time),e!=t;);}function _bar(e){return{type:C.BAR,bar_type:"|",fname:e.fname,istart:e.istart,iend:e.iend,v:e.v,p_v:e.p_v,st:e.st,dur:0,time:e.time+(e.dur||0),nhd:0,notes:[{pit:e.notes?e.notes[0].pit:22}],seqst:!0,invis:!0,prev:e,fmt:e.fmt}}function add_end_bar(e){var t=_bar(e),n=e.ts_next;return t.wl=0,t.wr=0,t.ts_prev=e,t.next=e.next,t.ts_next=e.ts_next,t.shrink=e.wr+3,e.next&&(e.next.prev=t),e.ts_next.ts_prev=t,e.next=e.ts_next=t,t.space=.9*n.space-3,t}function set_allsymwidth(){for(var e,t,n,r,s,i=tsfirst,o=i,a=0,c=[],l=[],u=a,f=i.time;;){s=0;do{!i.a_gch&&!i.a_ly||n||(n=i),self.set_width(i),null==c[t=i.st]&&(c[t]=0),null==l[t]&&(l[t]=0),(e=c[t]+l[t]+i.wl)>u&&(u=e),i.dur&&i.dur!=i.notes[0].dur&&(s=1),i=i.ts_next}while(i&&!i.seqst);if(o.shrink=u-a,o.space=o.ts_prev?set_space(o,f):0,0==o.space&&o.ts_prev&&o.ts_prev.type==C.SPACE&&o.ts_prev.seqst&&(o.space=o.ts_prev.space/=2),s?r||(r=o):r&&r.v==o.v&&(set_sp_tup(r,o),r=null),o.shrink||(o.space||o.type!=C.CLEF?o.dur&&(o.shrink=10):(delete o.seqst,o.time=f)),f=o.time,!i)break;for(t=0;t<l.length;t++)l[t]=0;a=u;do{c[t=o.st]=a,o.wr>l[t]&&(l[t]=o.wr),o=o.ts_next}while(!o.seqst)}r&&set_sp_tup(r,o),n&&set_w_chs(n)}function to_rest(e){var t=clone(e);return t.prev.next=e.ts_prev=e.prev=t.ts_prev.ts_next=t,t.next=t.ts_next=e,e.seqst=!1,e.invis=e.play=!0,t.type=C.REST,delete t.in_tuplet,delete t.tp,delete t.sl1,delete t.a_dd,delete t.a_gch,delete t.sls,t}function set_repeat(e){var t,n,r,s,i,o=e.repeat_n,a=e.repeat_k,c=e.st,l=e.v;if(e.repeat_n=0,o<0){for(r=o=-o,n=e.prev;n;n=n.prev)if(n.dur){if(--r<=0)break}else if(n.type==C.BAR)return void error(1,n,"Bar in repeat sequence");if(!n)return void error(1,e,errs.not_enough_n);for(i=e.time-n.time,r=a*o,t=e;t;t=t.next)if(t.dur){if(--r<=0)break}else if(t.type==C.BAR)return void error(1,t,"Bar in repeat sequence");if(!t||!t.next)return void error(1,e,errs.not_enough_n);for(t=e.prev;t!=n;t=t.prev)if(t.type==C.NOTE){t.beam_end=!0;break}for(s=a;--s>=0;){for(r=o,e.dur&&r--,t=e.ts_next;r>0;)t.st==c&&(t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1),t.v==l&&t.dur&&r--),t=t.ts_next;for((e=to_rest(e)).dur=e.notes[0].dur=i,e.rep_nb=-1,e.beam_st=!0,self.set_width(e),e.head=C.SQUARE,e=t;e&&(e.st!=c||e.v!=l||!e.dur);e=e.ts_next);}}else{for(r=o,t=e.prev.prev;t&&(t.type!=C.BAR&&t.time!=tsfirst.time||!(--r<=0));t=t.prev);if(t){for(i=e.time-t.time,r=1==o?a:o,t=e;t&&!(t.type==C.BAR&&--r<=0);t=t.next);if(t){if(r=a,2==o&&r>1){if(!(t=t.next))return void error(1,e,errs.not_enough_m);t.repeat_n=o,t.repeat_k=--r}if(i/=o,2==o){for(n=e,t=e.ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;for((n=to_rest(n)).dur=n.notes[0].dur=i,n.invis=!0,t.bar_mrep=2,t=(n=t.next).ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;return(n=to_rest(n)).dur=n.notes[0].dur=i,n.invis=!0,void self.set_width(n)}for(n=e,s=a;--s>=0;){for(t=n.ts_next;;t=t.ts_next)if(t.st==c)if(t.type!=C.BAR)t.invis=t.play=!0,t.seqst&&t.ts_next.seqst&&(t.seqst=!1);else if(t.v==l)break;if((n=to_rest(n)).dur=n.notes[0].dur=i,n.beam_st=!0,1==a){n.rep_nb=1;break}n.rep_nb=a-s+1,n=t.next}}else error(1,e,errs.not_enough_m)}else error(1,e,errs.not_enough_m)}}function custos_add(e){for(var t,n,r,s=e;s.type!=C.NOTE;)if(!(s=s.next))return;for((t=e.p_v).last_sym=e.prev,t.time=e.time,(n=sym_add(t,C.CUSTOS)).next=e,e.prev=n,n.wl=0,n.wr=4,lktsym(n,e),n.shrink=e.shrink,n.shrink<12&&(n.shrink=12),n.space=s.space,n.head=C.FULL,n.stem=s.stem,n.nhd=s.nhd,n.notes=[],r=0;r<s.notes.length;r++)n.notes[r]={pit:s.notes[r].pit,shhd:0,dur:C.BLEN/4};n.stemless=!0}function set_nl(e){var t,n;function r(e){cfmt.custos&&1==voice_tb.length&&custos_add(e),e.nl=!0,(e=e.ts_prev).type!=C.BAR&&add_end_bar(e)}if(function(e){var t,n,r,s;for(n=e;n;n=n.ts_next){switch(n.type){case C.KEY:if(!e.fmt.keywarn||n.invis)continue;for(t=e.ts_prev;t&&t.type==C.METER;t=t.ts_prev);case C.METER:if(n.type==C.METER){if(!e.fmt.timewarn)continue;t=e.ts_prev}case C.CLEF:if(!n.prev)continue;if(n.type==C.CLEF)for(t=e.ts_prev;t;t=t.ts_prev){switch(t.type){case C.BAR:if(":"==t.bar_type[0])break;case C.KEY:case C.METER:continue}break}for(lktsym(r=clone(n),t.ts_next),t=r;(t=t.ts_next).v!=n.v;);if(lkvsym(r,t),r.seqst){for(self.set_width(r),r.shrink=r.wl,s=r.ts_prev;!s.seqst;)s=s.ts_prev;for(r.shrink+=s.wr,r.space=0,s=r.ts_next;!s.seqst;)s=s.ts_next;s.shrink=r.wr+s.wl}delete r.part;continue}if(w_tb[n.type])break}}(e=function(e){var t,n,r,s,i,o;function a(e){var t=e.bar_type.match(/(:*)([^:]*)(:*)/);t[3]?t[1]?(o=t[2].length/2|0,s=t[1]+"|"+t[2].slice(0,o),i=t[2].slice(o)+"|"+t[3]):(s="||",i="[|"+t[3]):(s=t[1]+t[2],i="[")}for(t=e;t.ts_prev&&t.ts_prev.time==e.time;)(t=t.ts_prev).bar_type&&("["==t.bar_type[0]&&t.text&&t.ts_next==e&&(e=t),n=t);if(!n)return e;for(t=e;;t=t.ts_next){switch(t.type){case C.KEY:case C.METER:case C.CLEF:continue}break}for(;n!=e;){if(n.bar_type&&(":"==n.bar_type.slice(-1)||n.text)&&":"!=n.bar_type){for(a(n),r=clone(n),n.bar_type=s,delete n.a_gch,"|"==s&&delete n.rbstop,r.bar_type=i,lkvsym(r,n.next);!(t.type!=C.BAR||t.v>r.v);)t=t.ts_next;lktsym(r,t),n.seqst&&(r.seqst=1),t==e&&(e=r),n.text&&(r.invis=!0,delete n.text,delete n.rbstart),delete n.part,delete r.a_dd}n=n.ts_next}return e}(e)),e.ts_prev.type!=C.STAVES)return r(e),e;for(e=e.ts_prev;e&&(!e.seqst||e.type==C.CLEF);e=e.ts_prev);for(t=0,n=e.type;;e=e.ts_next){if(!e)return e;if(e.type!=n){if(n=e.type,t<0)break;switch(e.type){case C.STAVES:if(!e.ts_prev)return;if(e.ts_prev.type==C.BAR)break;for(;e.ts_next&&(!w_tb[e.ts_next.type]||e.ts_next.type==C.CLEF);)e=e.ts_next;if(!e.ts_next||e.ts_next.type!=C.BAR)continue;e=e.ts_next;case C.BAR:if(t)break;t=1;continue;case C.STBRK:e.stbrk_forced?t=-1:unlksym(e);continue;case C.CLEF:if(t)break;continue;default:if(!t||e.prev&&e.prev.type==C.GRACE)continue}break}}return r(e),e}function get_ck_width(){var e=voice_tb[0];return self.set_width(e.clef),self.set_width(e.ckey),self.set_width(e.meter),[e.clef.wl+e.clef.wr+e.ckey.wl+e.ckey.wr,e.meter.wl+e.meter.wr]}function get_width(e,t){for(var n,r,s=0,i=0,o=1-e.fmt.maxshrink;e!=t;)e.seqst&&(i+=n=e.shrink,(r=e.space)<n?s+=n:s+=n*e.fmt.maxshrink+r*o,e.x=s),e=e.ts_next;return t&&(i+=t.wr),[s,i]}function set_lines(e,t,n,r){var s,i,o,a,c,l,u,f,d,p,h,m=t?t.ts_prev:null,y=get_width(e,t);if(e.fmt.keywarn&&t&&t.type==C.KEY&&!m.dur&&(y[0]+=t.wr,y[1]+=t.wr),y[0]+r<n)return t&&(t=set_nl(t)),t||m;for(p=y[0]+r;;){if((h=Math.ceil(p/n))<=1)return t&&(t=set_nl(t)),t||m;for(i=s=e,d=(u=e.x-e.shrink-r)+n,f=u+p/h,u+=p/h*e.fmt.breaklimit,e=e.ts_next;e!=t&&!(e.x&&(e.type==C.BAR&&(i=e),e.x>=u));e=e.ts_next);if(a=e,e==t)return e&&(e=set_nl(e)),e;for(o=null;e!=t;e=e.ts_next)if(l=e.x){if(l>d)break;if(e.type==C.BAR){if(!(l<f)){(!o||l-f<f-o.x)&&(o=e);break}o=e}}if(!o){e=a;var A=0,g=i.time;for(d-=8,c=null;e!=t;e=e.ts_next)if(e.dur&&(e.beam_end?A&=~(1<<e.v):A|=1<<e.v),e.seqst){if((l=e.x)+e.wr>=d)break;A||e.in_tuplet||(c&&(f-c.x>l-f||e.dur&&(e.time+e.dur-g)%(C.BLEN/4)==0)&&(o=c),c=e)}}if(!o)for(o=e=a;e!=t;e=e.ts_next)if(l=e.x){if(l+e.wr>=d)break;if(o&&l>=f){f-o.x>l-f&&(o=e);break}o=e}for(e=o;e.ts_next&&!(e=e.ts_next).seqst;);if(e.nl)for(error(0,e,"Line split problem - adjust maxshrink and/or breaklimit"),h=2,e=e.ts_next;e!=t&&!(e.x&&--h<=0);e=e.ts_next);if(!(e=set_nl(e))||t&&e.time>=t.time)break;p-=e.x-s.x,r=0}return e}function cut_tune(e,t){var n,r,s={leftmargin:cfmt.leftmargin,rightmargin:cfmt.rightmargin,pagewidth:cfmt.pagewidth,scale:cfmt.scale},i=t[0]-t[1],o=get_ck_width(),a=tsfirst;if(e-=t[1],cfmt.indent&&cfmt.indent>t[0]&&(i+=cfmt.indent),e-=o[0],i+=o[1],cfmt.custos&&1==voice_tb.length&&(e-=12),r=a.fmt.barsperstaff)for(n=a;n;n=n.ts_next)if(n.type==C.BAR&&n.bar_num&&!(--r>0)){for(;n.ts_next&&n.ts_next.type==C.BAR;)n=n.ts_next;n.ts_next&&(n.ts_next.soln=!0),r=a.fmt.barsperstaff}for(n=a;a;a=a.ts_next){if(a.type==C.BLOCK)switch(a.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":self.set_format(a.subtype,a.param)}if(a.ts_next){if(!a.soln)continue;if(a.soln=!1,a.time==n.time)continue;for(;!a.seqst;)a=a.ts_prev}else a=null;if(!(n=set_lines(n,a,e,i)))break;a=n,i=0,set_page(),e=get_lwidth()-t[1]-o[0]}cfmt.leftmargin=s.leftmargin,cfmt.rightmargin=s.rightmargin,cfmt.pagewidth=s.pagewidth,cfmt.scale=s.scale,img.chg=1,set_page()}function set_yval(e){switch(e.type){case C.CLEF:if(e.second||e.invis){e.ymx=e.ymn=12;break}switch(e.y=6*(e.clef_line-1),e.clef_type){default:e.ymx=e.y+28,e.ymn=e.y-14;break;case"c":e.ymx=e.y+13,e.ymn=e.y-11;break;case"b":e.ymx=e.y+7,e.ymn=e.y-12}e.clef_small&&(e.ymx-=2,e.ymn+=2),e.ymx<26&&(e.ymx=26),e.ymn>-1&&(e.ymn=-1),e.clef_octave&&(e.clef_octave>0?e.ymx+=12:e.ymn-=12);break;case C.KEY:e.k_sf>2?e.ymx=34:e.k_sf>0?e.ymx=30:e.ymx=26,e.ymn=-2;break;default:e.ymx=24,e.ymn=0}}function set_ottava(){var e,t,n,r,s,i,o=nstaff+1,a=new Int16Array(new Array(2*o)),c=new Int8Array(new Array(o));function l(e,t,n){a_dcn.push((n?["15mb(","8vb(",null,"8va(","15ma("]:["15mb)","8vb)",null,"8va)","15ma)"])[2+t]),deco_cnv(e)}for(t=0;t<=nstaff;t++)a[t]=0,c[t]=0;for(e=tsfirst;e;e=e.ts_next){if(t=e.st,null!=e.ottava)for(;e.ottava.length;)(i=e.ottava.shift())?0==c[t]++&&(l(e,i,!0),a[t]=7*-i):0==--c[t]&&(l(e,-a[t]/7),a[t]=0);switch(e.type){case C.REST:if(1==voice_tb.length)break;case C.NOTE:if((n=a[t])&&!e.p_v.ckey.k_drum)for(o=e.nhd;o>=0;o--)(r=e.notes[o]).opit||(r.opit=r.pit),r.pit+=n;break;case C.GRACE:for(s=e.extra;s;s=s.next)if((n=a[t])&&!e.p_v.ckey.k_drum)for(o=0;o<=s.nhd;o++)(r=s.notes[o]).opit||(r.opit=r.pit),r.pit+=n}}}function mrest_expand(){var e,t;function n(e){for(var t,n,r,s,i,o=e.nmes,a=e.dur/o,c=e.next;!c.bar_type;)c=c.next;for(t=c;!c.bar_num;)c=c.ts_prev;for(i=c.bar_num-e.nmes,e.type=C.REST,e.notes[0].dur=e.dur=e.dur_orig=a,e.nflags=-2,e.head=C.FULL,e.fmr=1,s=e.time+a,n=c=e;--o>0;){for(delete(c=clone(t)).soln,delete c.a_gch,delete c.a_dd,delete c.text,delete c.rbstart,delete c.rbstop,lkvsym(c,t),c.time=s;n.time<s;)n=n.ts_next;for(;n&&n.v<e.v&&n.type==C.BAR;)n=n.ts_next;if(n)lktsym(c,n),n.type==C.BAR&&delete n.bar_num;else{for(n=e;n.ts_next;)n=n.ts_next;n.ts_next=c,c.ts_prev=n,c.ts_next=null}for(i++,c.seqst?(c.bar_num=i,r=c.ts_next):(delete c.bar_num,r=c.ts_prev),c.bar_type=r.bar_type||"|",r.bar_num&&!r.seqst&&delete r.bar_num,delete(r=clone(e)).a_dd,delete r.soln,delete r.a_gch,delete r.part,c.next?(r.next=c.next,r.next.prev=r):r.next=null,c.next=r,r.prev=c,r.time=s;n&&!n.dur&&n.time==s;)n=n.ts_next;for(;n&&n.v<e.v&&(!(n=n.ts_next)||!n.seqst););if(n)lktsym(r,n);else{for(n=e;n.ts_next;)n=n.ts_next;n.ts_next=r,r.ts_prev=n,r.ts_next=null}s+=a,e=n=r}}for(e=tsfirst;e;e=e.ts_next)if(e.type==C.MREST){if(!e.seqst&&w_tb[e.ts_prev.type])t=e;else for(t=e.ts_next;!t.seqst&&t.type==C.MREST&&t.nmes==e.nmes;)t=t.ts_next;if(t.seqst)e=t.ts_prev;else for(;e.type==C.MREST;)n(e),e=e.ts_next}}function set_auto_clef(e,t,n){var r,s,i,o,a=12,c=20;for(r=t;r&&(r.type!=C.STAVES||r==t);r=r.ts_next)if(r.st==e)if(r.type==C.NOTE)r.notes[0].pit<c&&(c=r.notes[0].pit),r.notes[r.nhd].pit>a&&(a=r.notes[r.nhd].pit);else if(r.type==C.CLEF){if("a"!=r.clef_type)break;unlksym(r)}if(c>=19||c>=13&&"b"!=n)return"t";if(a<=13||a<=19&&"t"!=n)return"b";"a"==n&&(n=(a+c)/2>=16?"t":"b");var l=n,u=r,f=null;for(r=t;r!=u&&(r.type!=C.STAVES||r==t);r=r.ts_next)if(r.st==e&&r.type==C.NOTE){if(s=r.time,"t"==l){if(r.notes[0].pit>12||r.notes[r.nhd].pit>20){r.notes[0].pit>20&&(f=r);continue}if((i=r.ts_prev)&&i.time==s&&i.st==e&&i.type==C.NOTE&&i.notes[0].pit>=19)continue;if((i=r.ts_next)&&i.st==e&&i.time==s&&i.type==C.NOTE&&i.notes[0].pit>=19)continue}else{if(r.notes[0].pit<=12||r.notes[r.nhd].pit<20){r.notes[r.nhd].pit<=12&&(f=r);continue}if((i=r.ts_prev)&&i.time==s&&i.st==e&&i.type==C.NOTE&&i.notes[0].pit<=13)continue;if((i=r.ts_next)&&i.st==e&&i.time==s&&i.type==C.NOTE&&i.notes[0].pit<=13)continue}if(f){for(o=r,i=r.ts_prev;i!=f;i=i.ts_prev)if(i.st==e){if(i.type==C.BAR&&i.v==r.v){o=":"!=i.bar_type[0]?i:i.next;break}i.type==C.NOTE&&i.beam_st&&!i.p_v.second&&(o=i)}o.time!=f.time?(f=r,(i=insert_clef(o,l="t"==l?"b":"t","t"==l?2:4)).clef_auto=!0):f=r}else l=n="t"==l?"b":"t",f=r}return n}function set_clefs(){var e,t,n,r,s,i,o,a,c,l=new Array(nstaff+1),u=cur_sy,f=[];for(staff_tb=new Array(nstaff+1),n=0;n<=nstaff;n++)l[n]={autoclef:!0},staff_tb[n]={output:"",sc_out:""};for(n=0;n<=u.nstaff;n++)f[n]=3*(u.staves[n].stafflines.length-1);for(e=tsfirst;e;e=e.ts_next){switch(e.repeat_n&&set_repeat(e),e.type){case C.STAVES:for(u=e.sy,n=0;n<=nstaff;n++)l[n].autoclef=!0;for(r=0;r<voice_tb.length;r++)u.voices[r]&&(s=voice_tb[r],n=u.voices[r].st,u.voices[r].second||(u.staves[n].staffnonote=s.staffnonote,s.staffscale&&(u.staves[n].staffscale=s.staffscale),u.voices[r].sep&&(u.staves[n].sep=u.voices[r].sep),u.voices[r].maxsep&&(u.staves[n].maxsep=u.voices[r].maxsep)),(t=s.clef).clef_auto||(l[n].autoclef=!1));for(n=0;n<=u.nstaff;n++)f[n]=3*(u.staves[n].stafflines.length-1);for(r=0;r<voice_tb.length;r++)if(u.voices[r]&&!u.voices[r].second)if(s=voice_tb[r],n=u.voices[r].st,(t=s.clef).clef_auto?a="t"==(o=set_auto_clef(n,e,l[n].clef?l[n].clef.clef_type:"a"))?2:4:(o=t.clef_type,a=t.clef_line),l[n].clef){if(o!=l[n].clef.clef_type||a!=l[n].clef.clef_line){for(i=e.ts_prev;i&&i.time==e.time&&(i.v!=r||i.st!=n);)i=i.ts_prev;if(!i||i.time!=e.time){for(i=e.ts_next;i&&(i.v!=r||i.st!=n);)i=i.ts_next;i&&i.time==e.time||(i=e)}i.type!=C.CLEF&&(i=insert_clef(i,o,a),t.clef_auto&&(i.clef_auto=!0)),l[n].clef=s.clef=i}}else t.clef_auto&&("a"!=t.clef_type&&(s.clef=clone(s.clef)),s.clef.clef_type=o,s.clef.clef_line=a),staff_tb[n].clef=l[n].clef=s.clef;continue;default:e.mid=f[e.st];continue;case C.CLEF:}if("a"==e.clef_type&&(e.clef_type=set_auto_clef(e.st,e.ts_next,l[e.st].clef.clef_type),e.clef_line="t"==e.clef_type?2:4),(s=e.p_v).clef=e,e.second)unlksym(e);else{if(l[n=e.st].clef){if(e.clef_type==l[n].clef.clef_type&&e.clef_line==l[n].clef.clef_line)continue}else staff_tb[n].clef=e;l[n].clef=e}}for(u=cur_sy,r=0;r<voice_tb.length;r++)if(u.voices[r]&&(t=voice_tb[r].sym)&&127==t.notes[0].pit){switch(n=u.voices[r].st,staff_tb[n].clef.clef_type){default:c=22;break;case"c":c=16;break;case"b":c=10}for(e=t;e;e=e.next)e.notes[0].pit=c}}Abc.prototype.set_width=function(e){var t,n,r,s,i,o,a,c,l,u,f,d,p,h,m,y;if(e.play)e.wl=e.wr=0;else{switch(e.type){case C.NOTE:case C.REST:for(e.wr=o=hw_tb[e.head],e.xmx>0&&(e.wr+=e.xmx+4),t=e.prev;t&&!w_tb[t.type];t=t.prev);if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:o+=3;break;case C.STBRK:o+=8}for(r=0;r<=e.nhd;r++)(s=(l=e.notes[r]).shhd)<0&&o<5-s&&(o=5-s),(c=l.acc)&&o<(y=l.shac+("object"==typeof c?5.5:3.5))&&(o=y),l.a_dd&&(o+=deco_wch(l));if(t)switch(t.type){case C.BAR:case C.CLEF:case C.KEY:case C.METER:o-=3}if(e.a_dd&&(o+=deco_width(e)),e.beam_st&&e.beam_end&&e.stem>0&&e.nflags>0&&e.wr<e.xmx+9&&(e.wr=e.xmx+9),e.dots){if(null==e.wl)switch(e.head){case C.SQUARE:case C.OVALBARS:e.xmx+=3;break;case C.OVAL:e.xmx+=1}e.wr<e.xmx+8&&(e.wr=e.xmx+8),e.dots>=2&&(e.wr+=3.5*(e.dots-1))}if(e.trem2&&e.beam_end&&o<20&&(o=20),a=o,t)switch(t.type){case C.NOTE:t.stem>0&&e.stem<0&&a<7&&(a=7),(e.y>27&&t.y>27||e.y<-3&&t.y<-3)&&a<6&&(a=6),t.tie&&a<14&&(a=14);break;case C.CLEF:if(t.second||t.clef_small)break;a+=8;break;case C.KEY:a+=4}return e.a_gch&&(a=gchord_width(e,o,a)),void(e.prev&&e.prev.type==C.GRACE?(e.prev.wl+=o-4.5,e.wl=e.prev.wl):e.wl=a);case C.SPACE:return s=e.width/2,e.wr=s,e.a_gch&&(s=gchord_width(e,s,s)),e.a_dd&&(s+=deco_width(e)),void(e.wl=s);case C.BAR:switch(u=e.bar_type){case"|":i=5;break;case"[":i=0;break;default:for(i=2+2.8*u.length,n=0;n<u.length;n++)switch(u[n]){case"[":case"]":i+=1;case":":i+=2}}for(e.wl=i,e.next&&e.next.type!=C.METER?e.wr=7:e.wr=5,(t=e.prev)&&t.type==C.GRACE&&(e.wl-=6);t;t=t.prev)if(w_tb[t.type]){t.type==C.STBRK&&(e.wl-=12);break}return e.a_dd&&(e.wl+=deco_width(e)),void(e.text&&e.text.length<4&&e.next&&e.next.a_gch&&(set_font("repeat"),e.wr+=strwh(e.text)[0]+2,cfmt.measurenb>0&e.bar_num&&e.bar_num%cfmt.measurenb&&(e.wr+=4)));case C.CLEF:return e.invis?void(e.wl=e.wr=1):(e.wl=e.clef_small?11:12,e.wr=e.clef_small?10:12,e.prev&&e.prev.type==C.STBRK&&(e.wl-=6,delete e.next.clef_small),void(e.next&&e.next.type==C.BAR&&(e.wr-=4)));case C.KEY:if(e.invis)return void(e.wl=e.wr=0);if(e.wl=3,m=4,e.k_a_acc)for(p=h=e.k_a_acc.length,h&&(d=e.k_a_acc[0].acc),n=1;n<h;n++)(c=e.k_a_acc[n]).pit>e.k_a_acc[n-1].pit+6||c.pit<e.k_a_acc[n-1].pit-6?p--:c.acc!=d&&(m+=3),d=c.acc;else(p=e.k_sf)*(h=e.k_old_sf&&(e.fmt.cancelkey||0==p)?e.k_old_sf:0)>=0?(p<0&&(p=-p),h<0&&(h=-h),h>p&&(p=h)):((p-=h)<0&&(p=-p),m+=3);return void(e.wr=5.5*p+m);case C.METER:for(a=0,e.x_meter=[],n=0;n<e.a_meter.length;n++)switch((f=e.a_meter[n]).top[0]){case"C":case"c":case"o":e.x_meter[n]=a+6,a+=12;break;case".":case"|":e.x_meter[n]=e.x_meter[n-1];break;default:for(i=0,f=!f.bot||f.top.length>f.bot.length?f.top:f.bot,r=0;r<f.length;r++)switch(f[r]){case"(":a+=4;case")":case"1":i+=4;break;default:i+=12}e.x_meter[n]=a+i/2,a+=i}return e.wl=0,void(e.wr=a+6);case C.MREST:return e.wl=6,void(e.wr=66);case C.GRACE:if(e.invis)break;return e.wl=set_graceoffs(e),e.wr=0,void(e.a_ly&&ly_set(e));case C.STBRK:return e.wl=e.xmx,void(e.wr=8);case C.CUSTOS:return void(e.wl=e.wr=4);case C.TEMPO:tempo_build(e);break;case C.BLOCK:case C.REMARK:case C.STAVES:break;default:error(2,e,"set_width - Cannot set width for symbol $1",e.type)}e.wl=e.wr=0}};var delta_tb={t:-4,c:0,b:4,p:-6},rest_sp=[[18,18],[12,18],[12,12],[0,12],[6,8],[10,10],[6,4],[10,0],[10,4],[10,10]];function set_rest_offset(){var e,t,n,r,s,i,o,a,c,l,u,f=[],d=cur_sy;for(e=tsfirst;e;e=e.ts_next)if(!e.invis&&(e.type==C.STAVES&&(d=e.sy),e.dur&&((i=f[e.v])||(i={},f[e.v]=i),i.s=e,i.st=e.st,i.end_time=e.time+e.dur,e.type==C.REST))){for(a=-127,o=127,s=l=!1,n=0;n<=f.length;n++)(i=f[n])&&i.s&&i.st==e.st&&n!=e.v&&(i.end_time<=e.time||(s=!0,t=i.s,d.voices[n].range<d.voices[e.v].range?t.time==e.time?t.ymn<o&&(o=t.ymn,t.dots&&(l=!0)):t.y<o&&(o=t.y):t.time==e.time?t.ymx>a&&(a=t.ymx,t.dots&&(l=!0)):t.y>a&&(a=t.y)));for(r=e.time+e.dur,t=e.ts_next;t&&!(t.time>=r);t=t.ts_next)t.st==e.st&&t.dur&&!t.invis&&(s=!0,d.voices[t.v].range<d.voices[e.v].range?t.time==e.time?t.ymn<o&&(o=t.ymn,t.dots&&(l=!0)):t.y<o&&(o=t.y):t.time==e.time?t.ymx>a&&(a=t.ymx,t.dots&&(l=!0)):t.y>a&&(a=t.y));if(s)if(127==o&&e.y<12&&(c=12-e.y,e.y+=c,e.ymx+=c,e.ymn+=c),-127==a&&e.y>12&&(c=e.y-12,e.y-=c,e.ymx-=c,e.ymn-=c),(c=o-e.ymx)<0){if(c=6*Math.ceil(-c/6),e.ymn-c>=a){e.y-=c,e.ymx-=c,e.ymn-=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else if((c=a-e.ymn)>0){if(c=6*Math.ceil(c/6),e.ymx+c<=o){e.y+=c,e.ymx+=c,e.ymn+=c;continue}u=l?15:10,e.notes[0].shhd=u,e.xmx=u}else;else e.y=12,e.ymx=24,e.ymn=0}}function new_sym(e,t,n){e.p_v=t,e.v=t.v,e.st=t.st,e.time=n.time,t.last_sym&&(e.next=t.last_sym.next,e.next&&(e.next.prev=e),t.last_sym.next=e,e.prev=t.last_sym),t.last_sym=e,lktsym(e,n)}function init_music_line(){var e,t,n,r,s,i,o,a,c,l,u,f=voice_tb.length;for(s=0;s<f;s++)cur_sy.voices[s]&&((e=voice_tb[s]).st=cur_sy.voices[s].st,e.second=cur_sy.voices[s].second,e.last_sym=e.sym);for(l=(t=tsfirst).fmt;t;){switch(t.type){case C.CLEF:case C.KEY:case C.METER:switch(t.type){case C.CLEF:staff_tb[t.st].clef=t;break;case C.KEY:t.p_v.ckey=t;break;case C.METER:t.p_v.meter=t,!(insert_meter=cfmt.writefields.indexOf("M")>=0&&t.a_meter.length)&&t.part&&(t.next.part=t.part)}unlksym(t);case C.TEMPO:case C.BLOCK:case C.REMARK:t=t.ts_next;continue}break}for(r=tsfirst,s=0;s<f;s++)e=voice_tb[s],!cur_sy.voices[s]||cur_sy.voices[s].second&&!e.bar_start||(i=cur_sy.voices[s].st,staff_tb[i]&&staff_tb[i].clef&&((t=clone(staff_tb[i].clef)).v=s,t.p_v=e,t.st=i,t.time=tsfirst.time,t.prev=null,t.next=e.sym,t.next&&(t.next.prev=t),e.sym=e.last_sym=t,t.ts_next=r,t.ts_prev=r?r.ts_prev:null,t.ts_prev?(t.ts_prev.ts_next=t,delete t.seqst):tsfirst=t,r&&(r.ts_prev=t,r.type==C.CLEF&&delete r.seqst),delete t.clef_small,delete t.part,t.second=cur_sy.voices[s].second,cur_sy.st_print[i]||(t.invis=!0),t.fmt=l));for(s=0;s<f;s++)cur_sy.voices[s]&&!cur_sy.voices[s].second&&cur_sy.st_print[cur_sy.voices[s].st]&&((n=(e=voice_tb[s]).ckey).k_sf||n.k_a_acc)&&(new_sym(t=clone(n),e,r),delete t.invis,delete t.part,t.k_old_sf=n.k_sf,t.fmt=l);if(insert_meter){for(s=0;s<f;s++)n=(e=voice_tb[s]).meter,cur_sy.voices[s]&&!cur_sy.voices[s].second&&cur_sy.st_print[cur_sy.voices[s].st]&&(new_sym(t=clone(n),e,r),delete t.part,t.fmt=l);insert_meter=!1}for(s=0;s<f;s++)(e=voice_tb[s]).sls.length&&(new_sym(t={type:C.BAR,fname:r.fname,bar_type:"|",dur:0,multi:0,invis:!0,sls:e.sls,fmt:l},e,r),e.sls=[]);for(s=0;s<f;s++){for(n=(e=voice_tb[s]).bar_start,e.bar_start=null,t=r;t&&t.time==r.time;t=t.ts_next)if(t.rbstop){n=null;break}n&&(cur_sy.voices[s]&&cur_sy.st_print[cur_sy.voices[s].st]&&(e.last_sym.type==C.BAR?e.last_sym.rbstop||(e.last_sym.rbstart=1):(new_sym(n,e,r),n.fmt=l)))}for(self.set_pitch(r),(t=tsfirst).seqst=!0,u=0;;){n=t,c=a=0;do{self.set_width(t),(o=t.wl+u)>a&&(a=o),t.wr>c&&(c=t.wr),t=t.ts_next}while(t!=r&&!t.seqst);if(n.shrink=a,n.space=0,t==r)break;u=c}o=0,r.type==C.BAR&&n.type==C.CLEF&&(c+=4);do{self.set_width(t),t.a_ly&&ly_set(t),o<t.wl&&(o=t.wl),t=t.ts_next}while(t&&!t.seqst);r.shrink=c+o,r.space=0}function check_end_bar(){for(var e,t=tsfirst;t.ts_next;)t=t.ts_next;t.type!=C.BAR&&((e=_bar(t)).ts_prev=t,t.next=t.ts_next=e)}function set_words(e){var t,n,r,s,i,o=!0,a=127;function c(e){e.prev.trem2=!0,e.prev.head=++e.head,--e.nflags>0?e.nflags+=e.ntrem:(e.nflags<=-2&&(e.stemless=!0,e.prev.stemless=!0),e.nflags=e.ntrem),e.prev.nflags=e.nflags}for(t=e.sym;t;t=t.next)if(t.type==C.NOTE){a=t.notes[0].pit;break}for(t=e.sym;t;t=t.next){switch(t.a_gch&&self.gch_build(t),t.type){case C.MREST:o=!0;break;case C.BAR:(i=t.fmt.bardef[t.bar_type])&&(t.bar_type=i),t.beam_on||(o=!0),t.next||!t.prev||t.invis||t.prev.head!=C.OVALBARS||(t.prev.head=C.SQUARE);break;case C.GRACE:for(n=t.extra;n;n=n.next)n.notes.sort(abc2svg.pitcmp),i=identify_note(n,n.dur_orig),n.head=i[0],n.dots=i[1],n.nflags=i[2],!n.trem2||n.next&&!n.next.trem2||c(n);break;case C.NOTE:case C.REST:if(i=identify_note(t,t.dur_orig),t.head=i[0],t.dots=i[1],t.nflags=i[2],t.nflags<=-2&&(t.stemless=!0),t.xstem&&(t.nflags=0),t.trem1&&(t.nflags>0?t.nflags+=t.ntrem:t.nflags=t.ntrem),t.next&&t.next.trem2)break;if(t.trem2){c(t);break}r=t.nflags,t.ntrem&&(r+=t.ntrem),t.type==C.REST&&t.beam_end&&!t.beam_on&&(o=!0),(o||r<=0)&&(s&&(s.beam_end=!0,s=null),r<=0?t.beam_st=t.beam_end=!0:(t.type==C.NOTE||t.beam_on)&&(t.beam_st=!0,o=!1)),t.beam_end&&(o=!0),(t.type==C.NOTE||t.beam_on)&&(s=t)}if(t.type==C.NOTE)for(t.nhd&&t.notes.sort(abc2svg.pitcmp),a=t.notes[0].pit,n=t.prev;n&&n.type==C.REST;n=n.prev)n.notes[0].pit=a;else t.notes||(t.notes=[],t.notes[0]={},t.nhd=0),t.notes[0].pit=a}s&&(s.beam_end=!0)}function set_rb(e){for(var t,n,r=e.sym;r;)if(r.type==C.BAR&&r.rbstart&&!r.norepbra){for(n=0,t=null,r=r.next;r;r=r.next)if(r.type==C.BAR){if(r.rbstop)break;if(!r.next){r.rbstop=2;break}if(++n==r.fmt.rbmin&&(t=r),n==r.fmt.rbmax){t&&(r=t),r.rbstop=1;break}}}else r=r.next}Abc.prototype.set_pitch=function(e){var t,n,r,s,i,o=C.BLEN,a=nstaff+1,c=new Int16Array(new Array(2*a));for(r=0;r<=nstaff;r++)t=staff_tb[r].clef,c[r]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[r]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[r]+=t.clef_octave):t.clef_oct_transp&&(c[r]-=t.clef_octave);for(t=tsfirst;t!=e;t=t.ts_next)switch(r=t.st,t.type){case C.CLEF:c[r]=delta_tb[t.clef_type]+2*t.clef_line,t.clefpit&&(c[r]+=t.clefpit),cfmt.sound?t.clef_octave&&!t.clef_oct_transp&&(c[r]+=t.clef_octave):t.clef_oct_transp&&(c[r]-=t.clef_octave),set_yval(t);break;case C.GRACE:for(n=t.extra;n;n=n.next){if((s=c[n.st])&&!t.p_v.ckey.k_drum)for(a=0;a<=n.nhd;a++)(i=n.notes[a]).opit=i.pit,i.pit+=s;n.ymn=3*(n.notes[0].pit-18)-2,n.ymx=3*(n.notes[n.nhd].pit-18)+2}set_yval(t);break;case C.KEY:t.k_y_clef=c[r];default:set_yval(t);break;case C.MREST:if(t.invis)break;t.y=12,t.ymx=39,t.ymn=-2;break;case C.REST:if(1==voice_tb.length){t.y=12,t.ymx=24,t.ymn=0;break}case C.NOTE:if((s=c[r])&&!t.p_v.ckey.k_drum)for(a=t.nhd;a>=0;a--)(i=t.notes[a]).opit=i.pit,i.pit+=s;t.type==C.REST&&(t.y=6*((t.notes[0].pit-18)/2|0),t.ymx=t.y+rest_sp[5-t.nflags][0],t.ymn=t.y-rest_sp[5-t.nflags][1]),t.dur<o&&(o=t.dur)}e||(smallest_duration=o)},Abc.prototype.set_stem_dir=function(){for(var e,t,n,r,s,i,o,a,c,l,u=[],f=tsfirst,d=cur_sy,p=d.nstaff;f;){for(r=0;r<=p;r++)u[r]=[];for(l=[],t=f;t&&t.type!=C.BAR;t=t.ts_next)if(t.type!=C.STAVES){if(!(t.type!=C.NOTE&&t.type!=C.REST||t.invis)){if((r=t.st)>p){var h="*** fatal set_stem_dir(): bad staff number "+r+" max "+p;throw error(2,null,h),new Error(h)}for((o=l[i=t.v])||(o={st1:-1,st2:-1},l[i]=o),o.st1<0?o.st1=r:o.st1!=r&&(r>o.st1?r>o.st2&&(o.st2=r):(o.st1>o.st2&&(o.st2=o.st1),o.st1=r)),a=u[r],s=d.voices[i].range,n=a.length;--n>=0&&(c=a[n]).v!=s;);if(n<0){for(c={v:s,ymx:0,ymn:24},n=0;n<a.length;n++)if(s<a[n].v){a.splice(n,0,c);break}n==a.length&&a.push(c)}t.type==C.NOTE&&(t.ymx>c.ymx&&(c.ymx=t.ymx),t.ymn<c.ymn&&(c.ymn=t.ymn),t.xstem&&(t.ts_prev.st!=r-1||t.ts_prev.type!=C.NOTE?(error(1,f,"Bad !xstem!"),t.xstem=!1):(t.ts_prev.multi=1,t.multi=1,t.stemless=!0)))}}else{if(t!=f)break;for(d=f.sy,r=p;r<=d.nstaff;r++)u[r]=[];p=d.nstaff}for(;f!=t;f=f.ts_next)if(!f.multi){switch(f.type){default:continue;case C.REST:if(null!=f.combine&&f.combine<0||!f.ts_next||f.ts_next.type!=C.REST||f.ts_next.st!=f.st||f.time!=f.ts_next.time||f.dur!=f.ts_next.dur||f.a_dd&&f.ts_next.a_dd||f.a_gch&&f.ts_next.a_gch||f.invis)break;f.ts_next.a_dd&&(f.a_dd=f.ts_next.a_dd),f.ts_next.a_gch&&(f.a_gch=f.ts_next.a_gch),unlksym(f.ts_next);case C.NOTE:case C.GRACE:}if(r=f.st,o=l[i=f.v],a=u[r],o&&o.st2>=0)r==o.st1?f.multi=-1:r==o.st2&&(f.multi=1);else if(a.length<=1)f.floating&&(f.multi=r==voice_tb[i].st?-1:1);else{for(s=d.voices[i].range,n=a.length;--n>=0&&a[n].v!=s;);n<0||(n==a.length-1?f.multi=-1:(f.multi=1,n&&n+2==a.length&&(a[n].ymn-f.fmt.stemheight>=a[n+1].ymx&&(f.multi=-1),e=f.ts_next,f.ts_prev&&f.ts_prev.time==f.time&&f.ts_prev.st==f.st&&f.notes[f.nhd].pit==f.ts_prev.notes[0].pit&&f.beam_st&&f.beam_end&&(!e||e.st!=f.st||e.time!=f.time)&&(f.multi=-1))))}}for(;f&&f.type==C.BAR;)f=f.ts_next}};var delpit=[0,-7,-14,0];function set_global(){var e,t,n=voice_tb.length,r=cur_sy,s=r.nstaff;for(insert_meter=cfmt.writefields.indexOf("M")>=0;r=r.next;)r.nstaff>s&&(s=r.nstaff);for(nstaff=s,check_end_bar(),t=0;t<n;t++)set_words(e=voice_tb[t]),e.ckey=e.key,set_rb(e);n>1&&(set_float(),glovar.mrest_p&&mrest_expand()),glovar.ottava&&"play"!=cfmt.sound&&set_ottava(),set_clefs(),self.set_pitch(null)}function get_lshift(){var e,t,n,r,s,i,o,a=0,c=0,l=voice_tb.length;function u(e,t){var n,r,s=0;for(e+="\n";!((r=e.indexOf("\n",s))<0||((n=strwh(e.slice(s,r))[0]+12)>t&&(t=n),r<0));)s=r+1;return t}for(t=0;t<l;t++)r=(n=voice_tb[t]).nm,s=n.snm,!r&&!s||i||(set_font("voice"),i=gene.deffont),r&&(o=u(r,a))>a&&(a=o),s&&(o=u(s,c))>c&&(c=o);for(o=0,e=0;e<=cur_sy.nstaff;e++){if(cur_sy.staves[e].flags&(OPEN_BRACE2|OPEN_BRACKET2)){o=12;break}cur_sy.staves[e].flags&(OPEN_BRACE|OPEN_BRACKET)&&(o=6)}return[a+=o,c+=o]}function set_indent(e){var t,n,r=0,s=voice_tb.length;for(t=0;t<s;t++)if(n=voice_tb[t],cur_sy.voices[t]&&gene.st_print[n.st]){if(n.new_name){r=2;break}n.snm&&(r=1)}return gene.vnt=r,2==r?e[0]:e[1]}function set_beams(e){var t,n,r,s,i,o,a,c,l,u=-1;for(t=e;t;t=t.next)if(t.type==C.NOTE){if(!t.stem&&t.multi&&(t.stem=t.multi),t.stem)t.beam_st&&!t.beam_end&&(r=!0);else if(a=t.mid/3+18,r)t.stem=u;else if(t.beam_st&&!t.beam_end){for(r=!0,c=t.notes[t.nhd].pit,l=t.notes[0].pit,n=t.next;n&&(n.type!=C.NOTE||((n.stem||n.multi)&&(t.stem=n.stem||n.multi),n.notes[n.nhd].pit>c&&(c=n.notes[n.nhd].pit),n.notes[0].pit<l&&(l=n.notes[0].pit),!n.beam_end));n=n.next);!t.stem&&n.beam_end&&(c+l<2*a?t.stem=1:(c+l>2*a||t.fmt.bstemdown)&&(t.stem=-1)),t.stem||(t.stem=u)}else{if((i=(t.notes[t.nhd].pit+t.notes[0].pit)/2)==a&&t.nhd>1){for(o=0;o<t.nhd&&!(t.notes[o].pit>=a);o++);i=2*o<t.nhd?a-1:a+1}i<a?t.stem=1:i>a||t.fmt.bstemdown?t.stem=-1:t.stem=u}if(t.beam_end&&(r=!1),u=t.stem,s){for(n=s.extra;n;n=n.next)n.stem=-u;s.stem=-u,s=null}}else{if(t.type!=C.GRACE)continue;if(2==(n=t.extra).stem){s=t;continue}for(t.stem||(t.stem=t.multi||1);n;n=n.next)n.stem=t.stem,n.multi=t.multi}}function same_head(e,t){var n,r,s,i,o,a,c,l,u,f,d,p=e.fmt.shiftunison||0;if(p>=3)return!1;if((s=e.dur)>=C.BLEN)return!1;if((i=t.dur)>=C.BLEN)return!1;if(e.stemless&&t.stemless)return!1;if(e.dots!=t.dots&&(1&p||e.dots*t.dots!=0))return!1;if(e.stem*t.stem>0)return!1;if(n=r=0,e.notes[0].pit>t.notes[0].pit){if(e.stem<0)return!1;for(;t.notes[r].pit!=e.notes[0].pit;)if(++r>t.nhd)return!1}else if(e.notes[0].pit<t.notes[0].pit){if(t.stem<0)return!1;for(;t.notes[0].pit!=e.notes[n].pit;)if(++n>e.nhd)return!1}if(t.notes[r].acc!=e.notes[n].acc)return!1;a=n,l=r,f=e.notes[n].shhd,d=t.notes[r].shhd;do{if(r++,++n>e.nhd)break;if(r>t.nhd)break;if(t.notes[r].acc!=e.notes[n].acc)return!1;f<e.notes[n].shhd&&(f=e.notes[n].shhd),d<t.notes[r].shhd&&(d=t.notes[r].shhd)}while(t.notes[r].pit==e.notes[n].pit);if(n<=e.nhd){if(r<=t.nhd)return!1;if(t.stem>0)return!1}else if(r<=t.nhd&&e.stem>0)return!1;if(c=n,u=r,o=0,s!=i)if(s<i&&(s=i,i=e.dur),s<C.BLEN/2)t.dots?o=2:e.dots&&(o=1);else{if(!(i<C.BLEN/4))return!1;if(2&p)return!1;o=t.dur>=C.BLEN/2?2:1}if(o||(o=e.p_v.scale<t.p_v.scale?2:1),1==o){for(r=l;r<u;r++)t.notes[r].invis=!0,delete t.notes[r].acc;for(r=0;r<=t.nhd;r++)t.notes[r].shhd+=f}else{for(n=a;n<c;n++)e.notes[n].invis=!0,delete e.notes[n].acc;for(n=0;n<=e.nhd;n++)e.notes[n].shhd+=d}return!0}function unison_acc(e,t,n,r){var s,i,o;if(o=t.notes[r].acc){for(i=2*w_note[e.head]+e.xmx+t.notes[r].shac+2,"object"==typeof o&&(i+=2),e.dots&&(i+=6),s=0;s<=t.nhd;s++)t.notes[s].shhd+=i,t.notes[s].shac-=i;t.xmx+=i}else{for(i=2*w_note[t.head]+t.xmx+e.notes[n].shac+2,"object"==typeof(o=e.notes[n].acc)&&(i+=2),t.dots&&(i+=6),s=0;s<=e.nhd;s++)e.notes[s].shhd+=i,e.notes[s].shac-=i;e.xmx+=i}}var MAXPIT=96;function set_left(e){var t,n,r,s,i=w_note[e.head],o=i,a=[];for(n=0;n<MAXPIT;n++)a.push(-100);if(e.nflags>-2)for(e.stem>0?(o=-o,n=2*e.notes[0].pit,r=2*(Math.ceil((e.ymx-2)/3)+18)):(n=2*(Math.ceil((e.ymn+2)/3)+18),r=2*e.notes[e.nhd].pit),n<0&&(n=0),r>=MAXPIT&&(r=MAXPIT-1);n<=r;)a[n++]=o;for(s=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)o=-e.notes[t].shhd+i+s,(n=2*e.notes[t].pit)<0?n=0:n>=MAXPIT-1&&(n=MAXPIT-2),o>a[n]&&(a[n]=o),e.head!=C.SQUARE&&(o-=1),o>a[n-1]&&(a[n-1]=o),o>a[n+1]&&(a[n+1]=o);return a}function set_right(e){var t,n,r,s,i,o=w_note[e.head],a=o,c=e.nflags>0&&e.beam_st&&e.beam_end,l=[];for(n=0;n<MAXPIT;n++)l.push(-100);if(e.nflags>-2)for(e.stem<0?(a=-a,n=2*(Math.ceil((e.ymn+2)/3)+18),r=2*e.notes[e.nhd].pit,s=n+4):(n=2*e.notes[0].pit,r=2*(Math.ceil((e.ymx-2)/3)+18)),n<0&&(n=0),r>MAXPIT&&(r=MAXPIT);n<r;)l[n++]=a;if(c)if(e.stem>0)for(n=0==e.xmx?2*e.notes[e.nhd].pit:2*e.notes[0].pit,(n+=4)<0&&(n=0);n<MAXPIT&&n<=r-4;n++)l[n]=11;else for((n=s)<0&&(n=0);n<MAXPIT&&n<=2*e.notes[0].pit-4;n++)l[n]=3.5;for(i=e.notes[e.stem>0?0:e.nhd].shhd,t=0;t<=e.nhd;t++)a=e.notes[t].shhd+o-i,(n=2*e.notes[t].pit)<0?n=0:n>=MAXPIT-1&&(n=MAXPIT-2),a>l[n]&&(l[n]=a),e.head!=C.SQUARE&&(a-=1),a>l[n-1]&&(l[n-1]=a),a>l[n+1]&&(l[n+1]=a);return l}function set_overlap(){var e,t,n,r,s,i,o,a,c,l,u,f,d,p,h,m,y,A,g,v,_,b,w,x=cur_sy;function k(){t=n,n=e,f=d,b=y,w=A,h=p}for(e=tsfirst;e;e=e.ts_next)if(e.type!=C.NOTE||e.invis)e.type==C.STAVES&&(x=e.sy);else{if(e.xstem&&e.ts_prev.stem<0)for(a=0;a<=e.nhd;a++)e.notes[a].shhd-=7,e.notes[a].shac+=16;for(n=e;n=n.ts_next;){if(n.time!=e.time){n=null;break}if(n.type==C.NOTE&&!n.invis&&n.st==e.st)break}if(n&&(t=e,x.voices[t.v].range<x.voices[n.v].range?n.dot_low=!0:t.dot_low=!0,!(t.ymn>n.ymx||t.ymx<n.ymn||same_head(t,n))))if(t.dots||n.dots||!(t.stem>0&&n.stem<0&&t.notes[0].pit==n.notes[n.nhd].pit+1||t.stem<0&&n.stem>0&&t.notes[t.nhd].pit+1==n.notes[0].pit)){if(A=set_right(t),g=set_left(n),(r=t.ts_prev)&&r.time==t.time&&r.st==t.st&&r.type==C.NOTE&&!r.invis)for(_=set_right(r),s=0;s<MAXPIT;s++)_[s]>A[s]&&(A[s]=_[s]);else r=null;for(f=-10,s=0;s<MAXPIT;s++)g[s]+A[s]>f&&(f=g[s]+A[s]);if(!(f<-3)||!(1&n.notes[0].pit||!t.dots&&!n.dots)&&(t.notes[t.nhd].pit==n.notes[0].pit+2&&t.dot_low||t.notes[t.nhd].pit+2==n.notes[0].pit&&n.dot_low)){if(v=set_right(n),y=set_left(t),r)for(_=set_left(r),s=0;s<MAXPIT;s++)_[s]>y[s]&&(y[s]=_[s]);for(d=p=h=-100,s=0;s<MAXPIT;s++)y[s]+v[s]>d&&(d=y[s]+v[s]),v[s]>h&&(h=v[s]),A[s]>p&&(p=A[s]);for(l=0,i=t.nhd,o=n.nhd;;){switch(u=t.notes[i].pit-n.notes[o].pit){case 2:1&t.notes[i].pit||(t.dot_low=!1);break;case 1:1&t.notes[i].pit?n.dot_low=!0:t.dot_low=!1;break;case 0:if(t.notes[i].acc!=n.notes[o].acc){l=-1;break}n.notes[o].acc&&(t.notes[i].acc||(t.notes[i].acc=n.notes[o].acc),n.notes[o].acc=0),t.dots&&n.dots&&1&t.notes[i].pit&&(l=1);break;case-1:1&t.notes[i].pit?n.dot_low=!1:t.dot_low=!0;break;case-2:1&t.notes[i].pit||(n.dot_low=!1)}if(l<0)break;if(u>=0&&--i<0)break;if(u<=0&&--o<0)break}if(l<0)unison_acc(t,n,i,o);else{if(c=0,t.dots?n.dots?l||(c=1):k():n.dots&&d+p<f+h&&(c=1),b=g,w=v,!r&&d+p<f+h&&k(),(f+=3)<0&&(f=0),a=t.stem>=0?0:t.nhd,f+=t.notes[a].shhd,a=n.stem>=0?0:n.nhd,f-=n.notes[a].shhd,t.dots)if(m=7.7+t.xmx+3.5*t.dots-3.5+3,c){if(m<f+h+n.xmx){for(d=0,i=0;i<=t.nhd;i++)1&(s=t.notes[i].pit)||(t.dot_low?s--:s++),(s*=2)<1?s=1:s>=MAXPIT-1&&(s=MAXPIT-2),w[s]>d&&(d=w[s]),w[s-1]+1>d&&(d=w[s-1]=1),w[s+1]+1>d&&(d=w[s+1]+1);d>4.5&&7.7+t.xmx+2<f+d+n.xmx&&(n.xmx=d+3-7.7)}}else{for(d=-100,i=0;i<=t.nhd;i++)1&(s=t.notes[i].pit)||(t.dot_low?s--:s++),(s*=2)<1?s=1:s>=MAXPIT-1&&(s=MAXPIT-2),b[s]>d&&(d=b[s]),b[s-1]+1>d&&(d=b[s-1]+1),b[s+1]+1>d&&(d=b[s+1]+1);m+d+2>f&&(f=m+d+2)}for(a=n.nhd;a>=0;a--)n.notes[a].shhd+=f;n.xmx+=f,c&&(t.xmx=n.xmx)}}}else{for(t.stem<0&&(t=n,n=e),f=t.notes[0].shhd+7,a=0;a<=n.nhd;a++)n.notes[a].shhd+=f;n.xmx+=f,t.xmx=n.xmx}}}Abc.prototype.set_stems=function(){var e,t,n,r,s,i,o,a,c,l;for(e=tsfirst;e;e=e.ts_next)if(e.type==C.NOTE){if(set_head_shift(e),a=e.nflags,e.beam_st&&!e.beam_end){for(e.feathered_beam&&(a=++e.nflags),t=e.next;t.type!=C.NOTE||(e.feathered_beam&&t.nflags++,!t.beam_end);t=t.next);t.nflags>a&&(a=t.nflags)}else if(!e.beam_st&&e.beam_end){for(t=e.prev;!t.beam_st;t=t.prev);t.nflags>a&&(a=t.nflags)}switch(r=e.fmt.stemheight,a){case 2:r+=0;break;case 3:r+=4;break;case 4:r+=8;break;case 5:r+=12}1!=(s=e.p_v.scale)&&(r*=.5*(s+1)),i=3*(e.notes[0].pit-18),e.nhd>0?(r-=2,o=3*(e.notes[e.nhd].pit-18)):o=i,e.ntrem&&(r+=2*e.ntrem),e.stemless?(e.stem>=0?(e.y=i,e.ys=o):(e.ys=i,e.y=o),e.ymx=o+4,e.ymn=i-4):e.stem>=0?(e.notes[e.nhd].pit>26&&(a<=0||!e.beam_st||!e.beam_end)&&(r-=2,e.notes[e.nhd].pit>28&&(r-=2)),e.y=i,e.notes[0].tie&&(i-=3),e.ymn=i-4,e.ys=o+r,e.ys<e.mid&&(e.ys=e.mid),e.ymx=e.ys+2.5|0):(e.notes[0].pit<18&&(a<=0||!e.beam_st||!e.beam_end)&&(r-=2,e.notes[0].pit<16&&(r-=2)),e.ys=i-r,e.ys>e.mid&&(e.ys=e.mid),e.ymn=e.ys-2.5|0,e.y=o,e.notes[e.nhd].tie&&(o+=3),e.ymx=o+4)}else{if(e.type!=C.GRACE)continue;for(c=l=e.mid,n=e.extra;n;n=n.next)r=GSTEM,n.nflags>1&&(r+=1.2*(n.nflags-1)),i=3*(n.notes[0].pit-18),o=3*(n.notes[n.nhd].pit-18),e.stem>=0?(n.y=i,n.ys=o+r,o=Math.round(n.ys)):(n.y=o,n.ys=i-r,i=Math.round(n.ys)),o+=4,(i-=4)<c?c=i:o>l&&(l=o),n.ymx=o,n.ymn=i;e.ymx=l,e.ymn=c}};var blocks=[];function sym_staff_move(e){for(var t=tsfirst;t&&!t.nl;t=t.ts_next)t.st==e&&t.type!=C.CLEF&&(t.st++,t.type!=C.TEMPO&&(t.invis=!0))}function set_piece(){var e,t,n,r,s,i=[],o=[],a=cur_sy;function c(e){var t=staff_tb[e],n=a.staves[e];t||(t=staff_tb[e]={}),t.y=0,t.stafflines=n.stafflines,t.staffscale=n.staffscale,t.ann_top=t.ann_bot=0}function l(){var e,t,n,r=a.staves.length;for(e=0;e<r;e++)if(a.staves[e].flags&(OPEN_BRACE|OPEN_BRACE2)){for(n=0,t=e;e<r&&(n|=i[e]?1:2,!(a.staves[e].flags&(CLOSE_BRACE|CLOSE_BRACE2)));)e++;if(3==n)for(;t<=e;)i[t]=!0,o[t++]=!0}}for(tsfirst.type==C.STAVES&&(e=tsfirst,(tsfirst=tsfirst.ts_next).ts_prev=null,e.seqst&&(tsfirst.seqst=!0),e.p_v.sym=e.next,e.next&&(e.next.prev=null)),nstaff=a.nstaff,n=0;n<=nstaff;n++)c(n);for(e=tsfirst;e&&!e.nl;e=e.ts_next){switch(e.type){case C.STAVES:for(l(),a.st_print=new Uint8Array(i),a=e.sy;nstaff<a.nstaff;)c(++nstaff);i=[];continue;case C.BLOCK:e.play?e.ts_next&&e.ts_next.shrink&&(e.ts_next.shrink=0):(blocks.push(e),unlksym(e));continue}if((n=e.st)>nstaff){switch(e.type){case C.CLEF:staff_tb[n].clef=e;break;case C.KEY:e.p_v.ckey=e;break;case C.METER:e.p_v.meter=e}unlksym(e)}else if(!i[n]){switch(e.type){default:continue;case C.BAR:if(e.bar_mrep||a.staves[n].staffnonote>1)break;continue;case C.GRACE:break;case C.NOTE:case C.REST:case C.SPACE:case C.MREST:if(a.staves[n].staffnonote>1)break;if(e.invis)continue;if(a.staves[n].staffnonote||e.type==C.NOTE)break;continue}o[n]=i[n]=!0}}for(tsnext=e,l(),a.st_print=new Uint8Array(i),function(){var e,t,n,r,s;for(e=0;e<=nstaff;e++){for((t=staff_tb[e]).hlu=[],t.hld=[],s=t.stafflines.length,t.topbar=6*(s-1),n=0;n<s-1;n++){switch(t.stafflines[n]){case".":case"-":continue}break}if(t.botline=t.botbar=6*n,n>=s-2){if("."==t.stafflines[n]){t.botbar-=12,t.topbar+=12;continue}t.botbar-=6,t.topbar+=6}if(o[e])for(t.hll=17+2*n,t.hlmap=new Int8Array(new Array(2*(s-n+1))),r=1;n<s;n++,r+=2)switch(t.stafflines[n]){case"|":case"[":t.hlmap[r-1]=1,t.hlmap[r]=1,t.hlmap[r+1]=1}}}(),n=0;n<nstaff;n++)o[n]||sym_staff_move(n);if(o[nstaff]||(staff_tb[nstaff].topbar=0),init_music_line(),gene.st_print=new Uint8Array(o),tsnext)for(delete(e=tsnext).nl,e.ts_prev.ts_next=null,s=voice_tb.length,r=0;r<s;r++){if((t=voice_tb[r]).sym&&t.sym.time<=tsnext.time){for(e=tsnext.ts_prev;e;e=e.ts_prev)if(e.v==r){t.s_next=e.next,e.next=null;break}if(e)continue}t.s_next=t.sym,t.sym=null}}function set_sym_line(){for(var e,t,n=voice_tb.length;--n>=0;)(e=voice_tb[n]).sym&&e.s_prev&&(e.sym.prev=e.s_prev),t=e.s_next,e.sym=t,t?(t.prev&&(t.prev.next=t),e.s_prev=t.prev,t.prev=null):e.s_prev=null}function set_posx(){posx=img.lm/cfmt.scale}function gen_init(){for(var e=tsfirst,t=e.time;e;e=e.ts_next){if(e.time!=t)return void set_page();switch(e.type){case C.NOTE:case C.REST:case C.MREST:case C.SPACE:return void set_page();default:continue;case C.STAVES:cur_sy=e.sy;continue;case C.BLOCK:if(e.play)continue;self.block_gen(e)}unlksym(e),e.p_v.s_next==e&&(e.p_v.s_next=e.next)}tsfirst=null}Abc.prototype.block_gen=function(e){switch(e.subtype){case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"scale":case"staffwidth":self.set_format(e.subtype,e.param);break;case"mc_start":multicol={posy,maxy:posy,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"mc_new":if(!multicol){error(1,e,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=multicol.posy;break;case"mc_end":if(!multicol){error(1,e,"%%multicol new without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;case"ml":blk_flush(),user.img_out(e.text);break;case"newpage":if(!user.page_format)break;blk_flush(),blkdiv<0&&user.img_out("</div>"),blkdiv=2;break;case"sep":set_page(),vskip(e.sk1),output+='<path class="stroke"\n\td="M',out_sxsy((img.width-e.l)/2-img.lm," ",0),output+="h"+e.l.toFixed(1)+'"/>\n',vskip(e.sk2);break;case"text":set_font(e.font),use_font(e.font),write_text(e.text,e.opt);break;case"title":write_title(e.text,!0);break;case"vskip":vskip(e.sk)}},Abc.prototype.set_sym_glue=function(e){var t,n,r,s,i,o,a=0,c=0,l=0,u=0;for(t=tsfirst;t;t=t.ts_next)t.type!=C.GRACE||i||(i=t),t.seqst&&(a+=t.shrink,t.space?t.space<t.shrink?(u+=t.shrink,c+=t.shrink):c+=t.space:l+=t.shrink);if(c){if(r=!tsnext||tsnext.type==C.BLOCK&&!tsnext.play||blocks.length,t=tsfirst,a>=e){for(a>e&&error(1,t,"Line too much shrunk $1 $2 $3",a.toFixed(1),c.toFixed(1),e.toFixed(1)),s=0;t;t=t.ts_next)t.seqst&&(s+=t.shrink),t.x=s;spf_last=0}else if(r&&c+l>e*(1-t.fmt.stretchlast)||!r&&(c+l>e||t.fmt.stretchstaff)){c==u&&(c+=5);for(var f=4;--f>=0;){for(o=(e-l-u)/(c-u),c=0,u=0,s=0,t=tsfirst;t;t=t.ts_next)t.seqst&&(t.space?t.space*o<=t.shrink?(u+=t.shrink,c+=t.shrink,s+=t.shrink):(c+=t.space,s+=t.space*o):s+=t.shrink),t.x=s;if(Math.abs(s-e)<.1)break}spf_last=o}else for(o=1-t.fmt.maxshrink,spf_last&&c*spf_last+l<e&&(o=spf_last),s=0;t;t=t.ts_next)t.seqst&&(s+=t.space<=t.shrink?t.shrink:t.shrink*(1-o)+t.space*o),t.x=s;for(realwidth=s,t=i;t;t=t.ts_next)if(t.type==C.GRACE)for(s=t.gr_shift?t.prev.x+t.prev.wr:t.x-t.wl,n=t.extra;n;n=n.next)n.x+=s}else realwidth=0},Abc.prototype.output_music=function(){var e,t,n,r,s,i,o,a,c=voice_tb.length;for(set_global(),c>1&&self.set_stem_dir(),e=0;e<c;e++)set_beams(voice_tb[e].sym);if(self.set_stems(),gen_init(),tsfirst){for(set_acc_shft(),c>1&&(set_rest_offset(),set_overlap()),set_allsymwidth(),r=get_lshift(),cfmt.singleline?(e=get_ck_width(),t=r[0]+e[0]+e[1]+get_width(tsfirst,null)[0],img.width=t*cfmt.scale+img.lm+img.rm+2):cut_tune(t=get_lwidth(),r),i=tsfirst,e=c;--e>=0;)voice_tb[e].osym=voice_tb[e].sym;for(spf_last=0;;){if(set_piece(),n=set_indent(r),!s&&cfmt.indent&&n<cfmt.indent&&(n=cfmt.indent),self.set_sym_glue(t-n),realwidth)for(n&&(posx+=n),draw_sym_near(),s=set_staff(),draw_systems(n),draw_all_sym(),delayed_update(),output&&vskip(s),n&&(posx-=n);blocks.length;)self.block_gen(blocks.shift());if(blk_flush(),o&&(o.ts_next.ts_prev=o),!tsnext)break;if(tsnext.ts_prev.ts_next=tsfirst=tsnext,gen_init(),!tsfirst)break;o=tsfirst.ts_prev,tsfirst.ts_prev=null,set_sym_line(),t=get_lwidth()}for(tsfirst=i,e=c;--e>=0;)(a=voice_tb[e]).sym&&a.s_prev&&(a.sym.prev=a.s_prev),a.sym=a.osym}};var a_gch,a_dcn=[],multicol,maps={},qplet_tb=new Int8Array([0,1,3,2,3,0,2,0,3,0]),ntb="CDEFGABcdefgab";function set_ref(e){e.fname=parse.fname,e.istart=parse.istart,e.iend=parse.iend}function new_clef(e){var t={type:C.CLEF,clef_line:2,clef_type:"t",v:curvoice.v,p_v:curvoice,time:curvoice.time,dur:0},n=1;switch(set_ref(t),e[0]){case'"':n=e.indexOf('"',1),t.clef_name=e.slice(1,n),n++;break;case"a":if("u"==e[1]){t.clef_type="a",t.clef_auto=!0,n=4;break}n=4;case"C":t.clef_type="c",t.clef_line=3;break;case"b":n=4;case"F":t.clef_type="b",t.clef_line=4;break;case"n":n=4,t.invis=!0;break;case"t":if("e"==e[1]){t.clef_type="c",t.clef_line=4;break}n=6;case"G":break;case"p":n=4;case"P":t.clef_type="p",t.clef_line=3,curvoice.key.k_sf=0,curvoice.ckey.k_sf=0,curvoice.ckey.k_map=abc2svg.keys[7],curvoice.ckey.k_b40=2,curvoice.ckey.k_drum=!0;break;default:return void syntax(1,"Unknown clef '$1'",e)}if(e[n]>="1"&&e[n]<="9"&&(t.clef_line=+e[n],n++),delete curvoice.snd_oct,"8"!=e[n+1]&&"1"!=e[n+1])return t;switch(e[n]){case"^":t.clef_oct_transp=!0;case"+":t.clef_octave="8"==e[n+1]?7:14,t.clef_oct_transp||(curvoice.snd_oct=8==e[n+1]?12:24);break;case"_":t.clef_oct_transp=!0;case"-":t.clef_octave="8"==e[n+1]?-7:-14,t.clef_oct_transp||(curvoice.snd_oct=8==e[n+1]?-12:-24)}return t}function get_interval(e,t){var n,r,s,i;for((r=new scanBuf).buffer=e,i=[],n=0;n<2;n++)if(s=r.buffer[r.index]?parse_acc_pit(r):null){if("object"==typeof s.acc)return void syntax(1,errs.bad_transp);i[n]=abc2svg.pab40(s.pit,s.acc)}else{if(1!=n||!t)return void syntax(1,errs.bad_transp);i[n]=242}return i[1]-i[0]}function set_linebreak(e){var t,n;for(t=0;t<128;t++)"\n"==char_tb[t]&&(char_tb[t]=nil);for(e=e.split(/\s+/),t=0;t<e.length;t++){switch(n=e[t]){case"!":case"$":case"*":case";":case"?":case"@":break;case"<none>":continue;case"<EOL>":n="\n";break;default:syntax(1,"Bad value '$1' in %%linebreak - ignored",n);continue}char_tb[n.charCodeAt(0)]="\n"}}function set_user(e){var t,n,r,s=e.match(/(.)[=\s]*(\[I:.+\]|".+"|!.+!)$/);if(s)if(n=s[1],r=s[2],"\\"==n[0]&&("t"==n[1]?n="\t":n[1]||(n=" ")),(t=n.charCodeAt(0))>=128)syntax(1,errs.not_ascii);else{switch(char_tb[t][0]){case"0":case"d":case"i":case" ":break;case'"':case"!":case"[":if(char_tb[t].length>1)break;default:return void syntax(1,"Bad user character '$1'",n)}switch(r){case"!beambreak!":r=" ";break;case"!ignore!":r="i";break;case"!nil!":case"!none!":r="d"}char_tb[t]=r}else syntax(1,'Lack of starting [, ! or " in U: / %%user')}function get_st_lines(e){if(e){if(/^[\]\[|.-]+$/.test(e))return e.replace(/\]/g,"[");var t=+e;switch(t){case 0:return"...";case 1:return"..|";case 2:return".||";case 3:return".|||"}if(!(isNaN(t)||t<0||t>16))return"||||||||||||||||".slice(0,t)}}function new_block(e){var t={type:C.BLOCK,subtype:e,dur:0};return"midi"!=e.slice(0,4)&&(curvoice=voice_tb[0]),sym_link(t),t}function set_kv_parm(e){curvoice.init||(curvoice.init=!0,info.V&&(info.V[curvoice.id]&&(e=info.V[curvoice.id].concat(e)),info.V["*"]&&(e=info.V["*"].concat(e)))),e.length&&self.set_vp(e)}function memo_kv_parm(e,t){t.length&&(info.V||(info.V={}),info.V[e]?Array.prototype.push.apply(info.V[e],t):info.V[e]=t)}function new_key(e){var t,n,r,s,i,o="FCGDAEB".indexOf(e[0])-1,a=0,c={type:C.KEY,dur:0};if(set_ref(c),t=1,o<-1)switch(e[0]){case"H":if(n=!0,"p"!=e[1].toLowerCase()){syntax(1,"Unknown bagpipe-like key");break}c.k_bagpipe=e[1],o="P"==e[1]?0:2,t++,cfmt.temper||(cfmt.temper=new Float32Array([11.62,12.55,1.66,2.37,3.49,0,1.66,2.37,3.49,4.41,5.53,0,3.49,4.41,5.53,6.63,7.35,4.41,5.53,6.63,7.35,8.19,0,6.63,7.35,8.19,9.39,10.51,0,8.19,9.39,10.51,11.62,12.55,0,10.51,11.62,12.55,1.66,1.66]));break;case"P":syntax(1,"K:P is deprecated"),o=0,c.k_drum=!0,n=!0;break;case"n":if(0==e.indexOf("none")){o=0,c.k_none=!0,t=4;break}default:return c.k_map=[],c.k_mode=0,[c,info_split(e)]}if(!n){switch(e[t]){case"#":o+=7,t++;break;case"b":o-=7,t++}switch((e=e.slice(t).trim()).slice(0,3).toLowerCase()){default:if("m"!=e[0]||" "!=e[1]&&"\t"!=e[1]&&"\n"!=e[1]){n=!0;break}case"aeo":case"m":case"min":o-=3,a=5;break;case"dor":o-=2,a=1;break;case"ion":case"maj":break;case"loc":o-=5,a=6;break;case"lyd":o+=1,a=3;break;case"mix":o-=1,a=4;break;case"phr":o-=4,a=2}if(n||(e=e.replace(/\w+\s*/,"")),0==e.indexOf("exp ")&&((e=e.replace(/\w+\s*/,""))||syntax(1,"No accidental after 'exp'"),i=!0),"^"==(r=e[0])||"_"==r||"="==r){c.k_a_acc=[],(s=new scanBuf).buffer=e;do{var l=parse_acc_pit(s);if(!l)break;for(c.k_a_acc.push(l),r=e[s.index];" "==r;)r=e[++s.index]}while("^"==r||"_"==r||"="==r);i||function(e,t){var n,r,s,i,o,a=[],c=[];if(t>0)for(i=0;i<t;i++)a[i]=1,c[i]=[26,23,27,24,21,25,22][i];else for(i=0;i<-t;i++)a[i]=-1,c[i]=[22,25,21,24,20,23,26][i];for(s=e.k_a_acc.length,n=0;n<s;n++){for(o=e.k_a_acc[n],r=0;r<i;r++)if(c[r]==o.pit){a[r]=o.acc;break}r==i&&(a[r]=o.acc,c[r]=o.pit,i++)}for(n=0;n<i;n++)(o=e.k_a_acc[n])||(o=e.k_a_acc[n]={}),o.acc=a[n],o.pit=c[n]}(c,o),e=e.slice(s.index)}else i&&0==e.indexOf("none")&&(o=0,e=e.replace(/\w+\s*/,""))}if((o<-7||o>7)&&(syntax(1,"Key with double sharps/flats"),o>7?o-=12:o+=12),c.k_sf=o,c.k_a_acc)for(c.k_map=[],t=c.k_a_acc.length;--t>=0;)l=c.k_a_acc[t],c.k_map[(l.pit+19)%7]=l.acc;else c.k_map=c.k_bagpipe&&!o?abc2svg.keys[9]:abc2svg.keys[o+7];return c.k_mode=a,c.k_b40=[1,24,7,30,13,36,19,2,25,8,31,14,37,20,3][o+7],[c,info_split(e)]}function new_meter(e){var t,n,r,s,i,o,a,c={type:C.METER,dur:0,a_meter:[]},l={},u=0,f=0;if(set_ref(c),0==e.indexOf("none"))f=4,o=1;else for(o=0;f<e.length&&"="!=e[f];){switch(e[f]){case"C":l.top=e[f++],u||(u=4,s=4);break;case"c":case"o":if(l.top=e[f++],!u)switch("c"==e[f-1]?(u=2,s=4):(u=3,s=4),e[f]){case"|":s/=2;break;case".":u*=3,s*=2}break;case".":case"|":u=0,l.top=e[f++];break;case"(":for("("==e[f+1]&&(a=!0,l.top=e[f++],c.a_meter.push(l),l={}),i=f+1;i<e.length&&")"!=e[i]&&"/"!=e[i];)i++;if(")"==e[i]&&"/"==e[i+1]){f++;continue}case")":a="("==e[f],l.top=e[f++],c.a_meter.push(l),l={};continue;default:if(e[f]<="0"||e[f]>"9")return void syntax(1,"Bad char '$1' in M:",e[f]);for(s=2,l.top=e[f++];;){for(;e[f]>="0"&&e[f]<="9";)l.top+=e[f++];if(")"==e[f]){if("/"!=e[f+1])break;f++}if("/"==e[f]){if(e[++f]<="0"||e[f]>"9")return void syntax(1,"Bad char '$1' in M:",e[f]);for(l.bot=e[f++];e[f]>="0"&&e[f]<="9";)l.bot+=e[f++];break}if(" "!=e[f]&&"+"!=e[f])break;if(f>=e.length||"("==e[f+1])break;l.top+=e[f++]}u=+l.top}for(a||(l.bot&&(s=+l.bot),o+=u*C.BLEN/s),c.a_meter.push(l),l={};" "==e[f];)f++;"+"==e[f]&&(l.top=e[f++],c.a_meter.push(l),l={})}if("="==e[f]){if(!(n=e.substring(++f).match(/^(\d+)\/(\d+)$/)))return void syntax(1,"Bad duration '$1' in M:",e.substring(f));o=C.BLEN*n[1]/n[2]}if(o)if(c.wmeasure=o,cfmt.writefields.indexOf("M")<0&&(c.a_meter=[]),3!=parse.state){if(info.M=e,glovar.meter=c,parse.state)for(glovar.ulen||(o<=1||o>=3*C.BLEN/4?glovar.ulen=C.BLEN/8:glovar.ulen=C.BLEN/16),r=0;r<voice_tb.length;r++)voice_tb[r].meter=c,voice_tb[r].wmeasure=o}else for(curvoice.wmeasure=o,is_voice_sig()?curvoice.meter=c:sym_link(c),t=curvoice.voice_down;t;t=t.voice_down)t.wmeasure=o;else syntax(1,errs.bad_val,"M:")}function new_tempo(e){var t,n,r,s,i=e,o={type:C.TEMPO,dur:0};function a(e){var t,r,s=e.match(/(\d+)\/(\d+)/);if(s&&(r=+s[2])&&!isNaN(r)&&!(r&r-1)&&(t=+s[1],!isNaN(t)))return C.BLEN*t/r;syntax(1,"Invalid note duration $1",n)}if(set_ref(o),cfmt.writefields.indexOf("Q")<0&&(o.invis=!0),'"'==e[0]){if(!(n=e.match(/"([^"]*)"/)))return void syntax(1,"Unterminated string in Q:");o.tempo_str1=n[1],e=e.slice(n[0].length).replace(/^\s+/,"")}if('"'==e.slice(-1)&&(t=e.indexOf('"'),o.tempo_str2=e.slice(t+1,-1),e=e.slice(0,t).replace(/\s+$/,"")),(t=e.indexOf("="))>0){for(r=e.slice(0,t).split(/\s+/),e=e.slice(t+1).replace(/^\s+/,"");n=r.shift();){if(!(s=a(n)))return;o.tempo_notes||(o.tempo_notes=[]),o.tempo_notes.push(s)}if("ca. "==e.slice(0,4)&&(o.tempo_ca="ca. ",e=e.slice(4)),(t=e.indexOf("/"))>0){if(!(s=a(e)))return;o.new_beat=s}else if(o.tempo=+e,!o.tempo||isNaN(o.tempo))return void syntax(1,"Bad tempo value")}if(parse.state<2||!curvoice.time&&!glovar.tempo)return info.Q=i,void(glovar.tempo=o);var c=curvoice.time;glovar.tempo||syntax(0,"No previous tempo"),parse.ctrl||(parse.ctrl={}),parse.ctrl[c]||(parse.ctrl[c]={}),parse.ctrl[c].tempo=o,o.v=par_sy.top_voice,o.p_v=voice_tb[o.v],o.fmt=cfmt,o.st=o.p_v.st,o.time=c}function do_info(e,t){var n,r,s,i,o;if(curvoice&&curvoice.ignore)switch(e){default:return;case"P":case"Q":case"V":}switch(e){case"I":self.do_pscom(t);break;case"L":if(i=t.match(/^1\/(\d+)(=(\d+)\/(\d+))?$/)){if(!(r=+i[1])||r&r-1)break;r=C.BLEN/r,s=i[2]?(s=+i[4])?+i[3]/s*C.BLEN:0:r}else"auto"==t&&(r=s=-1);if(!s){syntax(1,"Bad L: value");break}parse.state<=1?glovar.ulen=r:(curvoice.ulen=r,curvoice.dur_fact=s/r);break;case"M":new_meter(t);break;case"U":set_user(t);break;case"P":if(!parse.state)break;if(1==parse.state){info.P=t;break}set_ref(n={text:t,time:o=curvoice.time}),cfmt.writefields.indexOf(e)<0&&(n.invis=!0),parse.ctrl||(parse.ctrl={}),parse.ctrl[o]||(parse.ctrl[o]={}),parse.ctrl[o].part=n,n.v=par_sy.top_voice,n.p_v=voice_tb[n.v],n.fmt=cfmt,n.st=n.p_v.st;break;case"Q":if(!parse.state)break;new_tempo(t);break;case"V":get_voice(t),3==parse.state&&(curvoice.ignore=!par_sy.voices[curvoice.v]);break;case"K":if(!parse.state)break;get_key(t);break;case"N":case"R":info[e]?info[e]+="\n"+t:info[e]=t;break;case"r":if(!user.keep_remark||3!=parse.state)break;sym_link(n={type:C.REMARK,text:t,dur:0});break;default:syntax(0,"'$1:' line ignored",e)}}function adjust_dur(e){var t,n,r,s,i;if((t=curvoice.last_sym)&&t.type!=C.MREST&&t.type!=C.BAR){for(;t.type!=C.BAR&&t.prev;)t=t.prev;if(n=t.time,r=curvoice.time-n,i=curvoice.wmeasure/r,!n){for(;t&&!t.dur;)t=t.next;t&&t.type==C.REST&&t.invis&&(n+=t.dur*i,t.prev?t.prev.next=t.next:curvoice.sym=t.next,t.next&&(t.next.prev=t.prev),t=t.next)}if(curvoice.wmeasure!=r){for(;t;t=t.next)if(t.time=n,t.dur&&!t.grace&&(t.dur*=i,t.dur_orig*=i,n+=t.dur,t.type==C.NOTE||t.type==C.REST))for(s=0;s<=t.nhd;s++)t.notes[s].dur*=i;curvoice.time=e.time=n}}}function new_bar(){var e,t,n,r=parse.line,s={type:C.BAR,fname:parse.fname,istart:parse.bol+r.index,dur:0,multi:0};for(vover&&vover.bar&&get_vover("|"),glovar.new_nbar&&(s.bar_num=glovar.new_nbar,glovar.new_nbar=0),n=r.char();;){switch(t=r.next_char()){case"|":case"[":case"]":case":":n+=t;continue}break}if(":"==n[0]&&(":"==n?(n="|",s.bar_dotted=!0):s.rbstop=2),a_gch&&csan_add(s),a_dcn.length&&deco_cnv(s),parse.ottava.length&&(e=s,curvoice.cst!=curvoice.st&&sym_link(e={type:C.SPACE,fname:parse.fname,istart:parse.bol+r.index,dur:0,multi:0,invis:!0,width:1}),e.ottava=parse.ottava,parse.ottava=[]),"["!=n.slice(-1)||/[0-9" ]/.test(t)||(n=n.slice(0,-1),r.index--,t="["),t>"0"&&t<="9")for(s.text=t;t=r.next_char(),!("0123456789,.-".indexOf(t)<0);)s.text+=t;else if('"'==t&&"["==n.slice(-1))for(s.text="";;){if(!(t=r.next_char()))return void syntax(1,"No end of repeat string");if('"'==t){r.index++;break}s.text+=t}if("]"==n[0]&&(s.rbstop=2,1!=n.length?n=n.slice(1):s.invis=!0),s.iend=parse.bol+r.index,s.text&&"["==n.slice(-1)&&"["!=n&&(n=n.slice(0,-1)),":"==n.slice(-1)&&(s.rbstop=2,s.text&&(syntax(1,"Variant ending on a left repeat bar"),delete s.text),curvoice.tie_s_rep=null),s.text&&(s.rbstart=s.rbstop=2,"1"==s.text[0]?(curvoice.tie_s_rep=curvoice.tie_s,curvoice.acc_tie?curvoice.acc_tie_rep=curvoice.acc_tie.slice():curvoice.acc_tie_rep&&(curvoice.acc_tie_rep=null)):(curvoice.tie_s=curvoice.tie_s_rep,curvoice.acc_tie_rep&&(curvoice.acc_tie=curvoice.acc_tie_rep.slice()))),s.rbstart&&curvoice.norepbra&&!curvoice.second&&(s.norepbra=!0),curvoice.ulen<0&&adjust_dur(s),("["==n||"|:"==n)&&(e=curvoice.last_sym)&&e.time==curvoice.time){do{if(e.type==C.BAR)break;if(w_tb[e.type])break;e=e.prev}while(e);if(e&&e.type==C.BAR){if("["==n&&!e.text&&(!curvoice.st||par_sy.staves[curvoice.st-1].flags&STOP_BAR||s.norepbra)||"|"==e.bar_type)return"["!=n&&(e.bar_type=n),s.text&&(e.text=s.text),s.a_gch&&(e.a_gch=s.a_gch),s.norepbra&&(e.norepbra=s.norepbra),s.rbstart&&(e.rbstart=s.rbstart),void(s.rbstop&&(e.rbstop=s.rbstop));if("|:"==n){if(":|"==e.bar_type)return e.bar_type="::",void(e.rbstop=2);if("||"==e.bar_type)return e.bar_type="||:",void(e.rbstop=2)}}}switch(n){case"[":case"[]":case"[|]":s.invis=!0,n=s.rbstart?"[":"[]";break;case":|:":case":||:":n="::";break;case"||":if(cfmt["abc-version"]>="2.2")break;case"[|":case"|]":s.rbstop=2}s.bar_type=n,curvoice.lyric_restart||(curvoice.lyric_restart=s),curvoice.sym_restart||(curvoice.sym_restart=s),sym_link(s),s.st=curvoice.st,s.rbstart&&"["!=n&&!curvoice.norepbra&&s.st>0&&!(par_sy.staves[s.st-1].flags&STOP_BAR)&&(sym_link(e={type:C.BAR,fname:s.fname,istart:s.istart,iend:s.iend,bar_type:"[",multi:0,invis:!0,text:s.text,rbstart:2}),e.st=s.st,delete s.text,s.rbstart=0),s.bar_dotted||s.invis||(curvoice.acc=[])}function parse_staves(e){var t,n,r={},s=[],i=!1,o=0,a=0,c=0,l=0,u=0,f=e.match(/[^[\]|{}()*+\s]+|[^\s]/g);if(f){for(;n=f.shift();)switch(n){case"[":if(l||a+c>=2){syntax(1,errs.misplaced,"["),i=!0;break}o|=a+c==0?OPEN_BRACKET:OPEN_BRACKET2,c++,u<<=8,u|=OPEN_BRACKET;break;case"{":if(l||a||c>=2){syntax(1,errs.misplaced,"{"),i=!0;break}o|=c?OPEN_BRACE2:OPEN_BRACE,a++,u<<=8,u|=OPEN_BRACE;break;case"(":if(l){syntax(1,errs.misplaced,"("),i=!0;break}o|=OPEN_PARENTH,l++,u<<=8,u|=OPEN_PARENTH;break;case"*":!a||l||o&(OPEN_BRACE|OPEN_BRACE2)||(o|=FL_VOICE);break;case"+":o|=MASTER_VOICE;break;case"]":case"}":case")":syntax(1,"Bad voice ID in %%score"),i=!0;break;default:for(t=n;n=f.shift();){switch(n){case"]":if(!(u&OPEN_BRACKET)){syntax(1,errs.misplaced,"]"),i=!0;break}o|=a+--c==0?CLOSE_BRACKET:CLOSE_BRACKET2,u>>=8;continue;case"}":if(!(u&OPEN_BRACE)){syntax(1,errs.misplaced,"}"),i=!0;break}a--,o|=c?CLOSE_BRACE2:CLOSE_BRACE,o&=~FL_VOICE,u>>=8;continue;case")":if(!(u&OPEN_PARENTH)){syntax(1,errs.misplaced,")"),i=!0;break}l--,o|=CLOSE_PARENTH,u>>=8;continue;case"|":o|=STOP_BAR;continue}break}if(r[t]?(syntax(1,"Double voice in %%score"),i=!0):(r[t]=!0,s.push([t,o])),o=0,!n)break;f.unshift(n)}if(0!=u&&(syntax(1,"'}', ')' or ']' missing in %%score"),i=!0),!i&&s.length)return s}else syntax(1,errs.bad_val,"%%score")}function info_split(e){if(!e)return[];var t=e.match(/[^\s"=]+=?|"[^"]+"/g);return t||(syntax(1,"Unterminated string"),[])}Abc.prototype.set_vp=function(e){for(var t,n,r,s,i,o;n=e.shift();){if("="==n.slice(-1)&&!e.length){syntax(1,errs.bad_val,n);break}switch(n){case"clef=":t=e.shift();break;case"clefpitch=":if((n=e.shift())&&(s=ntb.indexOf(n[0]))>=0){switch(n[1]){case"'":s+=7;break;case",":s-=7,","==n[2]&&(s-=7)}i=4-s;break}syntax(1,errs.bad_val,n);break;case"octave=":s=+e.shift(),isNaN(s)?syntax(1,errs.bad_val,n):curvoice.octave=s;break;case"cue=":curvoice.scale="on"==e.shift()?.7:1;break;case"instrument=":if((s=(n=e.shift()).indexOf("/"))<0){if(null==(s=get_interval("c"+n)))break;curvoice.sndtran=s,s=0}else{if(null==(s=get_interval("c"+n.slice(s+1))))break;if(curvoice.sndtran=s,null==(s=get_interval(n.replace("/",""))))break}curvoice.transp=cfmt.sound?curvoice.sndtran:s,o=1;break;case"map=":curvoice.map=e.shift();break;case"name=":case"nm=":curvoice.nm=e.shift(),'"'==curvoice.nm[0]&&(curvoice.nm=cnv_escape(curvoice.nm.slice(1,-1))),curvoice.new_name=!0;break;case"stem=":case"pos=":if(n="pos="==n?e.shift().slice(1,-1).split(" "):["stm",e.shift()],null==(s=posval[n[1]])){syntax(1,errs.bad_val,"%%pos");break}switch(n[2]){case"align":s|=C.SL_ALIGN;break;case"center":s|=C.SL_CENTER;break;case"close":s|=C.SL_CLOSE}r||(r={}),r[n[0]]=s;break;case"scale=":s=+e.shift(),isNaN(s)||s<.5||s>2?syntax(1,errs.bad_val,"%%voicescale"):curvoice.scale=s;break;case"score=":if(cfmt.nedo){syntax(1,errs.notransp);break}if(n=e.shift(),cfmt.sound)break;null!=(s=get_interval(n,!0))&&(curvoice.transp=s,o=1);break;case"shift=":if(cfmt.nedo){syntax(1,errs.notransp);break}null!=(s=get_interval(e.shift()))&&(curvoice.shift=curvoice.sndsh=s,o=1);break;case"sound=":if(cfmt.nedo){syntax(1,errs.notransp);break}if(null==(s=get_interval(e.shift())))break;curvoice.sndtran=s,cfmt.sound&&(curvoice.transp=s),o=1;break;case"subname=":case"sname=":case"snm=":curvoice.snm=e.shift(),'"'==curvoice.snm[0]&&(curvoice.snm=curvoice.snm.slice(1,-1));break;case"stafflines=":null==(s=get_st_lines(e.shift()))?syntax(1,"Bad %%stafflines value"):null!=curvoice.st?par_sy.staves[curvoice.st].stafflines=s:curvoice.stafflines=s;break;case"staffnonote=":s=+e.shift(),isNaN(s)?syntax(1,"Bad %%staffnonote value"):curvoice.staffnonote=s;break;case"staffscale=":s=+e.shift(),isNaN(s)||s<.3||s>2?syntax(1,"Bad %%staffscale value"):curvoice.staffscale=s;break;case"transpose=":if(cfmt.nedo){syntax(1,errs.notransp);break}null==(s=get_transp(e.shift()))?syntax(1,errs.bad_transp):(curvoice.sndtran=s,cfmt.sound&&(curvoice.transp=s),o=1);break;default:switch(n.slice(0,4)){case"treb":case"bass":case"alto":case"teno":case"perc":t=n;break;default:"GFC".indexOf(n[0])>=0?t=n:"="==n.slice(-1)&&e.shift()}}}if(r)for(n in curvoice.pos=clone(curvoice.pos),r)r.hasOwnProperty(n)&&(curvoice.pos[n]=r[n]);t&&(t=new_clef(t))&&(i&&(t.clefpit=i),get_clef(t)),o&&set_transp()};var reg_dur=/(\d*)(\/*)(\d*)/g;function parse_dur(e){var t,n,r;return reg_dur.lastIndex=e.index,(t=reg_dur.exec(e.buffer))[0]?(n=t[1]||1,r=t[3]||1,t[3]||(r*=1<<t[2].length),e.index=reg_dur.lastIndex,[n,r]):[1,1]}function parse_acc_pit(e){var t,n,r,s,i=e.char();switch(i){case"^":"^"==(i=e.next_char())?(n=2,i=e.next_char()):n=1;break;case"=":n=3,i=e.next_char();break;case"_":"_"==(i=e.next_char())?(n=-2,i=e.next_char()):n=-1}if(1!=n&&-1!=n||(i>="1"&&i<="9"||"/"==i)&&(s=parse_dur(e),n<0&&(s[0]=-s[0]),cfmt.nedo&&1==s[1]&&(s[0]*=12,s[1]*=cfmt.nedo),n=s,i=e.char()),r=ntb.indexOf(i)+16,i=e.next_char(),!(r<16)){for(;"'"==i;)r+=7,i=e.next_char();for(;","==i;)r-=7,i=e.next_char();return t={pit:r,shhd:0,shac:0},n&&(t.acc=n),t}syntax(1,"'$1' is not a note",e.buffer[e.index-1])}function set_map(e,t){var n=e.pit,r=not2abc(n,t),s=maps[curvoice.map];(s[r]||s[r="o"+r.replace(/[',]+/,"")]||s[r="k"+ntb[(n+75-11*curvoice.ckey.k_sf)%7]]||s[r="all"])&&(e.map=s=s[r],s[1]&&(e.pit=n=s[1].pit,e.acc=s[1].acc),s[2]&&(e.color=s[2]),(r=s[3])&&(e.midi=pit2mid(r.pit+19,r.acc)))}function parse_basic_note(e,t){var n,r=parse_acc_pit(e);if(r)return"0"==e.char()&&(parse.stemless=!0,e.index++),n=parse_dur(e),r.dur=t*n[0]/n[1],r}function parse_vpos(){var e=parse.line,t=0;switch(a_dcn.length&&"dot"==a_dcn[a_dcn.length-1]&&(t=C.SL_DOTTED,a_dcn.pop()),e.next_char()){case"'":return e.index++,t+C.SL_ABOVE;case",":return e.index++,t+C.SL_BELOW}return t+C.SL_AUTO}function slur_add(e,t){var n,r,s,i,o;for(n=curvoice.sls.length;--n>=0;)if(i=(s=curvoice.sls[n]).note,o=s.is_note,delete s.is_note,i.s!=e.s)return s.note=e,t&&(s.is_note=t),(r=o?i:i.s).sls||(r.sls=[]),r.sls.push(s),curvoice.sls.splice(n,1),o&&(i.s.sl1=!0),s.grace&&(s.grace.sl1=!0),void(e.s.grace&&(e.s.sl2=!0));for(r=e.s.prev;r;r=r.prev)if(r.type==C.BAR&&":"==r.bar_type[0]&&r.text)return r.sls||(r.sls=[]),r.sls.push({note:e,ty:C.SL_AUTO}),void(t&&(r.sls[r.sls.length-1].is_note=t));(r=e.s).sls||(r.sls=[]),r.sls.push({note:e,ty:C.SL_AUTO,loc:"i"})}function pit2mid(e,t){var n,r,s,i,o=[0,2,4,5,7,9,11][e%7],a=12*(e/7|0);if(curvoice.snd_oct&&(a+=curvoice.snd_oct),3==t&&(t=0),!t)return cfmt.temper?cfmt.temper[abc2svg.p_b40[e%7]]+a:o+a;if("object"==typeof t){if(s=t[0]/t[1],100==t[1])return o+a+s}else s=t;if(cfmt.nedo){if("object"!=typeof t)return i=abc2svg.p_b40[e%7]+t,cfmt.temper[i]+a;if(t[1]==cfmt.nedo)return i=abc2svg.p_b40[e%7],cfmt.temper[i]+a+s}else if(!cfmt.temper)return o+=a+s;return n=cfmt.temper[abc2svg.p_b40[e%7]],s>0?(r=cfmt.temper[(abc2svg.p_b40[e%7]+1)%40])<n&&(r+=12):((r=cfmt.temper[(abc2svg.p_b40[e%7]+39)%40])>n&&(r-=12),s=-s),n+a+(r-n)*s}function do_ties(e,t){var n,r,s,i,o,a,c=0,l=t.time+t.dur==curvoice.time;for(r=0;r<=e.nhd;r++)if(o=(i=e.notes[r]).midi,t.type!=C.GRACE){for(n=0;n<=t.nhd;n++)if((s=t.notes[n]).tie_ty&&!(s.midi!=o||l&&s.tie_e)){i.tie_s=s,i.s=e,l&&(s.tie_e=i,s.s=t),c++;break}}else for(a=t.extra;a;a=a.next)if((s=a.notes[0]).tie_ty&&s.midi==o){a.ti1=!0,i.tie_s=s,i.s=e,s.tie_e=i,s.s=a,c++;break}c?e.ti2=!0:error(1,t,"Bad tie")}function tp_adj(e,t){var n=e.time;for(curvoice.time=n+(curvoice.time-n)*t;;){if(e.in_tuplet=!0,e.grace||(e.time=n,e.dur&&(e.dur*=t,n+=e.dur)),!e.next){e.tpe?e.tpe++:e.tpe=1;break}e=e.next}}function get_deco(){for(var e,t=parse.line,n=t.index,r="";;){if(!(e=t.next_char()))return t.index=n,void syntax(1,"No end of decoration");if("!"==e)break;r+=e}null!=ottava[r]?(glovar.ottava=!0,parse.ottava.push(ottava[r])):a_dcn.push(r)}Abc.prototype.new_note=function(e,t){var n,r,s,i,o,a,c,l,u,f,d,p,h,m,y,A=[],g=parse.line,v=a_dcn;switch(a_dcn=[],parse.stemless=!1,(r={type:C.NOTE,fname:parse.fname,stem:0,multi:0,nhd:0,xmx:0}).istart=parse.bol+g.index,curvoice.color&&(r.color=curvoice.color),e?r.grace=!0:(curvoice.tie_s&&(a=curvoice.tie_s,curvoice.tie_s=null),a_gch&&csan_add(r),parse.repeat_n&&(r.repeat_n=parse.repeat_n,r.repeat_k=parse.repeat_k,parse.repeat_n=0)),i=g.char()){case"X":r.invis=!0;case"Z":if(r.type=C.MREST,i=g.next_char(),r.nmes=i>"0"&&i<="9"?g.get_int():1,1==curvoice.wmeasure)return void error(1,null,"multi-measure rest, but no measure!");if(r.dur=curvoice.wmeasure*r.nmes,curvoice.second)return delete curvoice.eoln,void(curvoice.time+=r.dur);1==r.nmes?(r.type=C.REST,r.dur_orig=r.dur,r.fmr=1,r.notes=[{pit:18,dur:r.dur}]):glovar.mrest_p=!0;break;case"y":r.type=C.SPACE,r.invis=!0,r.dur=0,i=g.next_char(),r.width=i>="0"&&i<="9"?g.get_int():10,a&&(curvoice.tie_s=a,a=null);break;case"x":r.invis=!0;case"z":r.type=C.REST,g.index++,d=parse_dur(g),r.dur_orig=(curvoice.ulen<0?C.BLEN:curvoice.ulen)*d[0]/d[1],r.dur=r.dur_orig*curvoice.dur_fact,r.dur==curvoice.wmeasure&&(r.fmr=1),r.notes=[{pit:18,dur:r.dur_orig}];break;case"[":s=!0,i=g.next_char();default:for(curvoice.acc_tie&&(c=curvoice.acc_tie,curvoice.acc_tie=null),r.notes=[];;){if(s)for(;i;){if((l=i.charCodeAt(0))>=128)return void syntax(1,errs.not_ascii);switch((o=char_tb[l])[0]){case"(":A.push(parse_vpos()),i=g.char();continue;case"!":o.length>1?a_dcn.push(o.slice(1,-1)):get_deco(),i=g.next_char();continue}break}if(!(n=parse_basic_note(g,r.grace?C.BLEN/4:curvoice.ulen<0?C.BLEN:curvoice.ulen)))return;if(curvoice.octave&&(n.pit+=7*curvoice.octave),h=n.pit+19,(l=n.acc)?curvoice.acc[h]=l:(!(l=curvoice.acc[h])&&c&&(l=c[h]),l||(l=curvoice.ckey.k_map[h%7]||0)),curvoice.map&&maps[curvoice.map]&&set_map(n,l),n.midi||(n.midi=pit2mid(h,l)),curvoice.ckey.k_sndtran&&(n.midi+=abc2svg.b40m(curvoice.ckey.k_sndtran+122)-36),A.length){for(;l=A.shift();)curvoice.sls.push({is_note:!0,note:n,ty:l});n.s=r}if(a_dcn.length&&(r.time=curvoice.time,dh_cnv(r,n)),r.notes.push(n),!s)break;for(i=g.char();;){switch(i){case")":n.s=r,slur_add(n,!0),i=g.next_char();continue;case"-":n.tie_ty=parse_vpos(),n.s=r,curvoice.tie_s=r,r.ti1=!0,(curvoice.acc[h]||c&&c[h])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[h]=curvoice.acc[h]||c[h]),i=g.char();continue;case".":switch(i=g.next_char()){case"-":case"(":a_dcn.push("dot");continue}syntax(1,"Misplaced dot")}break}if("]"==i){for(g.index++,d=parse_dur(g),r.nhd=r.notes.length-1,l=0;l<=r.nhd;l++)(n=r.notes[l]).dur=n.dur*d[0]/d[1];break}}if(t.length)for(;l=t.shift();)r.notes[0].s=r,curvoice.sls.push({note:r.notes[0],ty:l}),e&&(curvoice.sls[curvoice.sls.length-1].grace=e);r.dur_orig=r.notes[0].dur,r.dur=r.notes[0].dur*curvoice.dur_fact}if(!r.grace||r.type==C.NOTE){if(r.notes){if(e){for(m=curvoice.ckey.k_bagpipe?8:4,l=0;l<=r.nhd;l++)r.notes[l].dur/=m;r.dur/=m,r.dur_orig/=m,e.stem&&(r.stem=e.stem)}else{switch(7&curvoice.pos.stm){case C.SL_ABOVE:r.stem=1;break;case C.SL_BELOW:r.stem=-1;break;case C.SL_HIDDEN:r.stemless=!0}if(p=curvoice.brk_rhythm){if(curvoice.brk_rhythm=0,f=curvoice.last_note,p>0){for(u=2*p-1,r.dur=r.dur*u/p,r.dur_orig=r.dur_orig*u/p,l=0;l<=r.nhd;l++)r.notes[l].dur=r.notes[l].dur*u/p;for(f.dur/=p,f.dur_orig/=p,l=0;l<=f.nhd;l++)f.notes[l].dur/=p}else{for(u=2*(p=-p)-1,r.dur/=p,r.dur_orig/=p,l=0;l<=r.nhd;l++)r.notes[l].dur/=p;for(f.dur=f.dur*u/p,f.dur_orig=f.dur_orig*u/p,l=0;l<=f.nhd;l++)f.notes[l].dur=f.notes[l].dur*u/p}for(curvoice.time=f.time+f.dur,f=f.next;f;f=f.next)f.time=curvoice.time}}for(curvoice.last_note=r,i=g.char();;){switch(i){case".":if("-"!=g.buffer[g.index+1])break;a_dcn.push("dot"),g.index++;case"-":for(y=parse_vpos(),l=0;l<=r.nhd;l++)r.notes[l].tie_ty=y,r.notes[l].s=r;for(curvoice.tie_s=e||r,curvoice.tie_s.ti1=!0,l=0;l<=r.nhd;l++)h=(n=r.notes[l]).pit+19,(curvoice.acc[h]||c&&c[h])&&(curvoice.acc_tie||(curvoice.acc_tie=[]),curvoice.acc_tie[h]=curvoice.acc[h]||c[h]);i=g.char();continue}break}a&&do_ties(r,a)}return sym_link(r),e||(curvoice.lyric_restart||(curvoice.lyric_restart=r),curvoice.sym_restart||(curvoice.sym_restart=r)),v.length&&(a_dcn=v,deco_cnv(r,r.prev)),parse.ottava.length&&(e?e.ottava=parse.ottava:r.ottava=parse.ottava,parse.ottava=[]),parse.stemless&&(r.stemless=!0),r.iend=parse.bol+g.index,r}syntax(1,errs.bad_grace)};var nil="0",char_tb=[nil,nil,nil,nil,nil,nil,nil,nil,nil," ","\n",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil," ","!",'"',"i","\n",nil,"&",nil,"(",")","i",nil,nil,"-","!dot!",nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,"|","i","<","n","<","i","i","n","n","n","n","n","n","n","!fermata!","d","d","d","!emphasis!","!lowermordent!","d","!coda!","!uppermordent!","d","d","!segno!","!trill!","d","d","d","n","d","n","[","\\","|","n","n","i","n","n","n","n","n","n","n","d","d","d","d","d","d","d","d","d","d","d","d","d","!upbow!","!downbow!","d","n","n","n","{","|","}","!gmark!",nil],ottava={"8va(":1,"8va)":0,"15ma(":2,"15ma)":0,"8vb(":-1,"8vb)":0,"15mb(":-2,"15mb)":0},sheet;function parse_music_line(){var e,t,n,r,s,i=[],o=-1,a=[],c=parse.line;function l(e){var t,n,r;for(t=1,n=c.index+1;t<e.length;t++,n++)if(e[t]!=c.buffer[n]){if("n"!=e[t])return;if((r=ntb.indexOf(c.buffer[n]))<0)return;for(;"'"==c.buffer[n+1];)r+=7,n++;for(;","==c.buffer[n+1];)r-=7,n++}return c.index=n,r}function u(e){for(var t="";e<0;)e+=7,t+=",";for(;e>=14;)e-=7,t+="'";return ntb[e]+t}function f(e,t){if(null==t)return e;var n,r,s="",i=e.length;for(r=0;r<i;r++)s+=(n=e[r])>="h"&&n<="z"?u(t+n.charCodeAt(0)-"n".charCodeAt(0)):n;return s}function d(e,t,n){var r,s,i,o,a=c,l=parse.istart;if(parse.line=c=new scanBuf,parse.istart+=a.index,cfmt.writefields.indexOf("m")<0){for(c.buffer=e.replace("n",u(n)),o=curvoice.last_sym,s=curvoice.time,p(!0),o||(o=curvoice.sym),o=o.next;o;o=o.next)o.noplay=!0;for(r=curvoice.time,curvoice=clone_voice((i=curvoice).id+"-p"),par_sy.voices[curvoice.v]||(curvoice.second=!0,par_sy.voices[curvoice.v]={st:i.st,second:!0,range:curvoice.v}),curvoice.time=s,o=curvoice.last_sym,parse.line=c=new scanBuf,parse.istart+=a.index,c.buffer=f(t,n),p(!0),curvoice.time!=r&&syntax(1,"Bad length of the macro sequence"),o||(o=curvoice.sym);o;o=o.next)o.invis=o.play=!0;curvoice=i}else c.buffer=f(t,n),p(!0);parse.line=c=a,parse.istart=l}function p(u){for(var f,p,h,m,y,A,g,v;f=c.char();){if(!u&&maci[f]){for(m in g=void 0,mac)if(mac.hasOwnProperty(m)&&m[0]==f){if(m.indexOf("n")<0){if(c.buffer.indexOf(m,c.index)!=c.index)continue;c.index+=m.length}else if(null==(g=l(m)))continue;d(m,mac[m],g),g=1;break}if(g)continue}if((p=f.charCodeAt(0))>=128){syntax(1,errs.not_ascii),c.index++;break}switch((h=char_tb[p])[0]){case" ":(y=curvoice.last_note)&&(y.beam_end=!0,e&&(e.gr_shift=!0));break;case"\n":if(cfmt.barsperstaff)break;curvoice.eoln=!0;break;case"&":if(e){syntax(1,errs.bad_grace);break}if(")"==(f=c.next_char())){get_vover(f);break}get_vover("&");continue;case"(":if((f=c.next_char())>"0"&&f<="9"){if(e){syntax(1,errs.bad_grace);break}var _=c.get_int(),b=qplet_tb[_],w=_;if(":"==(f=c.char())&&((f=c.next_char())>"0"&&f<="9"&&(b=c.get_int(),f=c.char()),":"==f)){if(!((f=c.next_char())>"0"&&f<="9")){syntax(1,"Invalid 'r' in tuplet");continue}w=c.get_int(),f=c.char()}0!=b&&null!=b||(b=curvoice.wmeasure%9==0?3:2),o<0&&(o=i.length),i.push({p:_,q:b,r:w,ro:w,f:curvoice.tup||cfmt.tuplets});continue}if("&"==f){if(e){syntax(1,errs.bad_grace);break}get_vover("(");break}c.index--,a.push(parse_vpos());continue;case")":if(y=curvoice.last_sym)switch(y.type){case C.SPACE:y.notes||(y.notes=[],y.notes[0]={});case C.NOTE:case C.REST:break;case C.GRACE:for(y=y.extra;y.next;y=y.next);break;default:y=null}if(!y){syntax(1,errs.bad_char,f);break}y.notes[0].s=y,slur_add(y.notes[0]);break;case"!":h.length>1?a_dcn.push(h.slice(1,-1)):get_deco();break;case'"':if(e){syntax(1,errs.bad_grace);break}parse_gchord(h);break;case"[":if(h.length>1){self.do_pscom(h.slice(3,-1));break}var x=c.buffer[c.index+1];if('|[]: "'.indexOf(x)>=0||x>="1"&&x<="9"){if(e){syntax(1,errs.bar_grace);break}new_bar();continue}if(":"==c.buffer[c.index+2]){if(e){syntax(1,errs.bad_grace);break}if((A=c.buffer.indexOf("]",c.index+1))<0){syntax(1,"Lack of ']'");break}v=c.buffer.slice(c.index+3,A).trim(),parse.istart=parse.bol+c.index,parse.iend=parse.bol+ ++A,c.index=0,do_info(x,v),c.index=A;continue}case"n":if(!(y=self.new_note(e,a)))continue;if(e||!y.notes)continue;if(o>=0)y.tp=i.slice(o),o=-1,s&&(y.tp[0].s=s),s=y;else if(!s)continue;if(--(m=i[i.length-1]).r>0)continue;for(;;){if(tp_adj(s,m.q/m.p),A=m.ro,m.s&&(s=m.s),i.pop(),!i.length){s=null;break}if((m=i[i.length-1]).r-=A,m.r>0)break}continue;case"<":if(!curvoice.last_note){syntax(1,"No note before '<'");break}if(e){syntax(1,"Cannot have a broken rhythm in grace notes");break}for(g="<"==f?1:-1;"<"==f||">"==f;)g*=2,f=c.next_char();curvoice.brk_rhythm=g;continue;case"i":break;case"{":if(e){syntax(1,"'{' in grace note");break}switch(t=curvoice.last_note,curvoice.last_note=null,n=a_dcn,a_dcn=[],e={type:C.GRACE,fname:parse.fname,istart:parse.bol+c.index,dur:0,multi:0},curvoice.color&&(e.color=curvoice.color),7&curvoice.pos.gst){case C.SL_ABOVE:e.stem=1;break;case C.SL_BELOW:e.stem=-1;break;case C.SL_HIDDEN:e.stem=2}if(sym_link(e),"/"==(f=c.next_char())){e.sappo=!0;break}continue;case"|":if(e){syntax(1,errs.bar_grace);break}new_bar();continue;case"}":if(curvoice.ignore){e=null;break}if(y=curvoice.last_note,!e||!y){syntax(1,errs.bad_char,f);break}if(a_dcn.length&&syntax(1,"Decoration ignored"),e.extra=e.next,e.extra.prev=null,e.next=null,curvoice.last_sym=e,e=null,!y.prev&&!curvoice.ckey.k_bagpipe){for(A=0;A<=y.nhd;A++)y.notes[A].dur*=2;y.dur*=2,y.dur_orig*=2}curvoice.last_note=t,a_dcn=n;break;case"\\":if(!c.buffer[c.index+1]){r=!0;break}default:syntax(1,errs.bad_char,f)}c.index++}}3==parse.state&&(parse.tp&&(i=parse.tp,o=parse.tpn,s=parse.tps,parse.tp=null),p(),i.length&&(parse.tp=i,parse.tps=s,parse.tpn=o),a.length&&syntax(1,"Start of slur without note"),e&&(syntax(1,"No end of grace note sequence"),curvoice.last_sym=e.prev,curvoice.last_note=t,e.prev&&(e.prev.next=null)),r||cfmt.barsperstaff||vover||"\n"!=char_tb["\n".charCodeAt(0)]||(curvoice.eoln=!0),curvoice.eoln&&cfmt.breakoneoln&&curvoice.last_note&&(curvoice.last_note.beam_end=!0))}var add_fstyle="undefined"!=typeof document?function(e){var t;if(cfmt.fullsvg&&(font_style+="\n"+e),!sheet)if(abc2svg.sheet)for(t=(sheet=abc2svg.sheet).cssRules.length;--t>=0;)sheet.deleteRule(t);else t=document.createElement("style"),document.head.appendChild(t),abc2svg.sheet=sheet=t.sheet;for(e=e.match(/[^{]+{[^}]+}/g);t=e.shift();)sheet.insertRule(t,sheet.cssRules.length)}:function(e){font_style+="\n"+e},sw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.25,.333,.408,.5,.5,.833,.778,.333,.333,.333,.5,.564,.25,.564,.25,.278,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.278,.278,.564,.564,.564,.444,.921,.722,.667,.667,.722,.611,.556,.722,.722,.333,.389,.722,.611,.889,.722,.722,.556,.722,.667,.556,.611,.722,.722,.944,.722,.722,.611,.333,.278,.333,.469,.5,.333,.444,.5,.444,.5,.444,.333,.5,.5,.278,.278,.5,.278,.778,.5,.5,.5,.5,.333,.389,.278,.5,.5,.722,.5,.5,.444,.48,.2,.48,.541,.5]),ssw_tb=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.278,.278,.355,.556,.556,.889,.667,.191,.333,.333,.389,.584,.278,.333,.278,.278,.556,.556,.556,.556,.556,.556,.556,.556,.556,.556,.278,.278,.584,.584,.584,.556,1.015,.667,.667,.722,.722,.667,.611,.778,.722,.278,.5,.667,.556,.833,.722,.778,.667,.778,.722,.667,.611,.722,.667,.944,.667,.667,.611,.278,.278,.278,.469,.556,.333,.556,.556,.5,.556,.556,.278,.556,.556,.222,.222,.5,.222,.833,.556,.556,.556,.556,.333,.5,.278,.556,.5,.722,.5,.5,.5,.334,.26,.334,.584,.512]),cw_tb=sw_tb;function cwid(e){var t=e.charCodeAt(0);if(t>=128){if(t>=768&&t<880)return 0;t=97}return cw_tb[t]}function cwidf(e){return cwid(e)*gene.curfont.swfac}var strwh="undefined"!=typeof document?(el=document.createElement("text"),el.style.position="absolute",el.style.top="-1000px",el.style.padding="0",document.body.appendChild(el),function(e){if(e.wh)return e.wh;var t,n=gene.curfont,r=n.size,s=0,i=(e.length,0),o=0;if(el.className=font_class(n),el.style.lineHeight=1,"object"==typeof e)return el.innerHTML=e,e.wh=[el.clientWidth,el.clientHeight],e.wh;for(e=e.replace(/<|>|&[^&\s]*?;|&/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;"}return e}));!((o=e.indexOf("$",o))<0);){if("0"==(t=e[o+1]))n=gene.deffont;else{if(!(t>="1"&&t<="9")){o++;continue}n=get_font("u"+t)}el.innerHTML=e.slice(i,o),s+=el.clientWidth,n.size>r&&(r=n.size),el.style.font=style_font(n).slice(5),i=o+=2}return el.innerHTML=e.slice(i),[s+=el.clientWidth,r]}):function(e){var t,n,r,s=gene.curfont,i=s.swfac,o=s.size,a=0,c=e.length;for(t=0;t<c;t++){switch(r=e[t]){case"$":if("0"==(r=e[t+1]))s=gene.deffont;else{if(!(r>="1"&&r<="9")){r="$";break}s=get_font("u"+r)}t++,i=s.swfac,s.size>o&&(o=s.size);continue;case"&":if(" "==e[t+1])break;(n=e.indexOf(";",t))>0&&n-t<10&&(t=n,r="a")}a+=cwid(r)*i}return[a,o]},el;function str2svg(e){if("object"==typeof e)return e;var t,n=gene.deffont,r=gene.curfont,s="";function i(e,t){return'<tspan\n\tclass="'+(e.class&&e.name==t.name&&e.size==t.size&&e.weight==t.weight&&e.style==t.style?e.class:font_class(e))+'">'}return r!=n&&(s=i(r,n)),s+=e.replace(/<|>|&[^&\s]*?;|&|\$./g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:if("$"!=e[0])break;if("0"==e[1])t=gene.deffont;else{if(!(e[1]>="1"&&e[1]<="9"))break;t=get_font("u"+e[1])}return e="",t==r?e:(r!=n&&(e="</tspan>"),(r=t)==n?e:e+i(r,n))}return e})),r!=n&&(s+="</tspan>"),s=new String(s),"undefined"!=typeof document?strwh(s):s.wh=strwh(e),gene.curfont=r,s}function set_font(e){"string"==typeof e&&(e=get_font(e)),cw_tb="sans"==e.name.slice(0,4)?ssw_tb:sw_tb,gene.curfont=gene.deffont=e}function out_str(e){output+=str2svg(e)}function xy_str(e,t,n,r,s,i){switch(i||(i=n.wh||strwh(n)),output+='<text class="'+font_class(gene.deffont),"j"!=r&&n.length>5&&gene.deffont.wadj&&(output+='" lengthAdjust="'+gene.deffont.wadj+'" textLength="'+i[0].toFixed(1)),output+='" x="',out_sxsy(e,'" y="',t+.2*i[1]),r){case"c":e-=i[0]/2,output+='" text-anchor="middle">';break;case"j":output+='" textLength="'+s.toFixed(1)+'">';break;case"r":e-=i[0],output+='" text-anchor="end">';break;default:output+='">'}out_str(n),output+="</text>\n"}function trim_title(e,t){var n;return cfmt.titletrim&&((n=e.lastIndexOf(", "))<0||e[n+2]<"A"||e[n+2]>"Z"?n=0:1==cfmt.titletrim?(n<e.length-7||e.indexOf(" ",n+3)>=0)&&(n=0):n<e.length-cfmt.titletrim-2&&(n=0),n&&(e=e.slice(n+2).trim()+" "+e.slice(0,n))),!t&&cfmt.writefields.indexOf("X")>=0&&(e=info.X+".  "+e),cfmt.titlecaps?e.toUpperCase():e}function get_lwidth(){return(img.width-img.lm-img.rm-2)/cfmt.scale}function write_title(e,t){var n,r;e&&(set_page(),e=trim_title(e,t),t?(set_font("subtitle"),n=cfmt.subtitlespace):(set_font("title"),n=cfmt.titlespace),(r=strwh(e))[1]+=2*gene.curfont.pad,vskip(r[1]+n+gene.curfont.pad),n=gene.curfont.pad,cfmt.titleleft?xy_str(0,n,e,null,null,r):xy_str(get_lwidth()/2,n,e,"c",null,r))}function put_inf2r(e,t,n,r,s){if(!n){if(!r)return;n=r,r=null}xy_str(e,t,r?n+" ("+r+")":n,s)}function write_text(e,t){if("s"!=t){set_page();var n,r,s,i,o,a,c,l,u,f,d=get_lwidth(),p=gene.curfont.size,h=p*cfmt.lineskipfac,m=p*cfmt.parskipfac;switch(t){default:switch(r=gene.curfont,t){case"c":o=d/2;break;case"r":o=d-r.pad;break;default:o=r.pad}for(i=0;;){if((s=e.indexOf("\n",i))==i){for(vskip(m),blk_flush(),use_font(gene.curfont);"\n"==e[s+1];)vskip(h),s++;if(s==e.length)break}else if(f=s<0?e.slice(i):e.slice(i,s),vskip(strwh(f)[1]*cfmt.lineskipfac+2*r.pad),xy_str(o,r.pad,f,t),s<0)break;i=s+1}vskip(m),blk_flush();break;case"f":case"j":for(i=0;;){for(a=(a=(s=e.indexOf("\n\n",i))<0?e.slice(i):e.slice(i,s)).split(/\s+/),c=l=n=0,i=0;i<a.length;i++)(c+=(u=strwh(a[i]+"&#x00a0;"))[0])>=d&&(vskip(n*cfmt.lineskipfac),xy_str(0,0,a.slice(l,i).join(" "),t,d),l=i,c=u[0],n=0),u[1]>n&&(n=u[1]);if(0!=c&&(vskip(n*cfmt.lineskipfac),xy_str(0,0,a.slice(l).join(" "))),vskip(m),blk_flush(),s<0)break;for(;"\n"==e[s+2];)vskip(h),s++;if(s==e.length)break;use_font(gene.curfont),i=s+2}}}}function put_words(e){var t,n,r,s,i,o,a,c,l,u,f,d=0,p=1;function h(e,t){var n=0,r=0;if("$"==e[0]&&e[1]>="0"&&e[1]<="9"&&(gene.curfont="0"==e[1]?gene.deffont:get_font("u"+e[1]),e=e.slice(2)),e[n]>="0"&&e[n]<="9"||"."==e[n+1]){for(;n<e.length&&" "!=e[++n]&&":"!=e[n-1]&&"."!=e[n-1];);for(r=n;" "==e[n];)n++}0!=r&&xy_str(t,0,e.slice(0,r),"r"),n<e.length&&xy_str(t+5,0,e.slice(n),"l")}for(set_font("words"),vskip(cfmt.wordsspace),svg_flush(),s=(e=e.split("\n")).length,n=0;n<s;n++)if(t=e[n])t.length>d&&(d=t.length,l=n);else{for(;n+1<s&&!e[n+1];)n++;p++}if(i=get_lwidth()/2,o=strwh(e[l])[0],l=u=0,o<i){for(r=p>>1,n=0;n<s;n++)if(!(t=e[n])){for(--r<=0&&(l=n);n+1<s&&!e[n+1];)n++;if(r<=0){u=n+1;break}}p>>=1}for(c=u?(a=(i-o)/2+10)+i:i-o/2+10,f=!0,n=0;n<l||u<s;n++,u++)vskip(cfmt.lineskipfac*gene.curfont.size),n<l&&((t=e[n])?h(t,a):use_font(gene.curfont)),u<s&&((t=e[u])?h(t,c):0==--p&&(n<l?p++:u<s-1&&(c=i-o/2+10,svg_flush()))),e[n+1]||e[u+1]?f=!0:f&&(svg_flush(),f=!1)}function put_history(){var e,t,n,r,s,i,o,a,c,l=cfmt.infoname.split("\n"),u=l.length;for(e=0;e<u;e++)if(n=l[e][0],!(cfmt.writefields.indexOf(n)<0)&&(r=info[n])){for(s||(s=!0,set_font("history"),vskip(cfmt.textspace),i=gene.curfont.size*cfmt.lineskipfac),'"'==(c=l[e].slice(2))[0]&&(c=c.slice(1,-1)),vskip(i),xy_str(0,0,c,null,null,a=strwh(c)),xy_str(o=a[0],0,(r=r.split("\n"))[0]),t=1;t<r.length;t++)vskip(i),xy_str(o,0,r[t]);vskip(.3*i),use_font(gene.curfont)}}var info_font_init={A:"info",C:"composer",O:"composer",P:"parts",Q:"tempo",R:"info",T:"title",X:"title"};function write_headform(e){for(var t,n,r,s,i,o,a,c,l={},u=Object.create(info_font_init),f={A:cfmt.infospace,C:cfmt.composerspace,O:cfmt.composerspace,R:cfmt.infospace},d={},p="",h=cfmt.titleformat,m=0,y=0;;){for(;" "==h[y];)y++;if(!(t=h[y++]))break;if(t<"A"||t>"Z")switch(t){case"+":s="+",t=h[y++];break;case",":p+="\n";default:continue;case"<":s="l",t=h[y++];break;case">":s="r",t=h[y++]}else switch(h[y]){case"-":s="l",y++;break;case"1":s="r",y++;break;case"0":y++;default:s="c"}if(l[t])d[t]++;else{if(!info[t])continue;l[t]=info[t].split("\n"),d[t]=1}p+=s+t}p+="\n";var A,g={l:cfmt.titlespace,c:cfmt.titlespace,r:cfmt.titlespace},v={l:0,c:.5*e,r:e},_={};for(h=p,y=0;;){for(_.l=_.c=_.r=o=0,m=y;"\n"!=(s=h[m++]);)t=h[m++],"+"==s||_[s]||(A=l[t])&&((r=u[t])||(r="history"),a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),o<a&&(o=a),_[s]=a);for(g.l+=o-_.l,g.c+=o-_.c,g.r+=o-_.r;"\n"!=(s=h[y++]);)if(l[t=h[y++]].length){if(A=l[t].shift(),"+"==h[y]&&(d[t]--,y++,l[t=h[y++]].length&&(A?A+=" "+l[t].shift():A=" "+l[t].shift())),(r=u[t])||(r="history"),a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),set_font(n),i=v[s],o=g[s]+a,"Q"==t?(self.set_width(glovar.tempo),glovar.tempo.invis||("l"!=s&&(tempo_build(glovar.tempo),c=glovar.tempo.tempo_wh[0],"c"==s&&(c*=.5),i-=c),writempo(glovar.tempo,i,-o))):A&&("T"==t&&(A=trim_title(A,"s"==u.T[0])),xy_str(i,-o,A,s)),"T"==t&&(r=u.T="subtitle",f.T=cfmt.subtitlespace),d[t]<=1)for("T"==t&&(a=1.1*(n=get_font(r)).size,f[t]&&(a+=f[t]),set_font(n));l[t].length>0;)xy_str(i,-(o+=a),A=l[t].shift(),s);d[t]--,g[s]=o}if(g.c>g.l&&(g.l=g.c),g.r>g.l&&(g.l=g.r),y>=h.length)break;g.c=g.r=g.l}vskip(g.l)}function write_heading(){var e,t,n,r,s,i,o,a,c=get_lwidth();if(vskip(cfmt.topspace),cfmt.titleformat)return write_headform(c),void vskip(cfmt.musicspace);if(info.T&&cfmt.writefields.indexOf("T")>=0)for(e=0;;){if((t=info.T.indexOf("\n",e))<0){write_title(info.T.substring(e),0!=e);break}write_title(info.T.slice(e,t),0!=e),e=t+1}if(o=a=0,parse.ckey.k_bagpipe&&!cfmt.infoline&&cfmt.writefields.indexOf("R")>=0&&(i=info.R),i&&(set_font("composer"),xy_str(0,-cfmt.composerspace,i),o=cfmt.composerspace),n=info.A,cfmt.writefields.indexOf("C")>=0&&(r=info.C),cfmt.writefields.indexOf("O")>=0&&(s=info.O),r||s||cfmt.infoline){var l,u;if(set_font("composer"),vskip(cfmt.composerspace),cfmt.aligncomposer<0?(l=0,u=" "):0==cfmt.aligncomposer?(l=.5*c,u="c"):(l=c,u="r"),a=o,r||s){for(cfmt.aligncomposer>=0&&o!=a&&vskip(o-a),e=0;;){if(vskip(gene.curfont.size),(t=r?r.indexOf("\n",e):-1)<0){put_inf2r(l,0,r?r.substring(e):null,s,u);break}xy_str(l,0,r.slice(e,t),u),o+=gene.curfont.size,e=t+1}a>o&&vskip(a-o)}((i=i?null:info.R)||n)&&cfmt.infoline&&(set_font("info"),vskip(gene.curfont.size+cfmt.infospace),put_inf2r(c,0,i,n,"r"),o+=gene.curfont.size+cfmt.infospace)}else a=cfmt.composerspace;info.P&&cfmt.writefields.indexOf("P")>=0&&(set_font("parts"),(o=cfmt.partsspace+gene.curfont.size-o)>0&&(a+=o),a>.01&&vskip(a),xy_str(0,0,info.P),a=0),vskip(a+cfmt.musicspace)}var output="",style="\n.stroke{stroke:currentColor;fill:none}\n.bW{stroke:currentColor;fill:none;stroke-width:1}\n.bthW{stroke:currentColor;fill:none;stroke-width:3}\n.slW{stroke:currentColor;fill:none;stroke-width:.7}\n.slthW{stroke:currentColor;fill:none;stroke-width:1.5}\n.sW{stroke:currentColor;fill:none;stroke-width:.7}\n.box{outline:1px solid black;outline-offset:1px}",font_style="",posx=cfmt.leftmargin/cfmt.scale,posy=0,img={width:cfmt.pagewidth,lm:cfmt.leftmargin,rm:cfmt.rightmargin},defined_glyph={},defs="",fulldefs="",stv_g={scale:1,dy:0,st:-1,v:-1,g:0},blkdiv=0,tgls={"mtr ":{x:0,y:0,c:" "},brace:{x:0,y:0,c:""},lphr:{x:0,y:23,c:""},mphr:{x:0,y:23,c:""},sphr:{x:0,y:26,c:""},short:{x:0,y:32,c:""},tick:{x:0,y:29,c:""},rdots:{x:-1,y:0,c:""},dsgn:{x:-4,y:-4,c:""},dcap:{x:-4,y:-4,c:""},sgno:{x:-6,y:0,c:""},coda:{x:-12,y:-6,c:""},tclef:{x:-8,y:0,c:""},cclef:{x:-8,y:0,c:""},bclef:{x:-8,y:0,c:""},pclef:{x:-6,y:0,c:""},spclef:{x:-6,y:0,c:""},stclef:{x:-8,y:0,c:""},scclef:{x:-8,y:0,c:""},sbclef:{x:-7,y:0,c:""},oct:{x:0,y:2,c:""},oct2:{x:0,y:2,c:""},mtr0:{x:0,y:0,c:""},mtr1:{x:0,y:0,c:""},mtr2:{x:0,y:0,c:""},mtr3:{x:0,y:0,c:""},mtr4:{x:0,y:0,c:""},mtr5:{x:0,y:0,c:""},mtr6:{x:0,y:0,c:""},mtr7:{x:0,y:0,c:""},mtr8:{x:0,y:0,c:""},mtr9:{x:0,y:0,c:""},mtrC:{x:0,y:0,c:""},"mtr+":{x:0,y:0,c:""},"mtr(":{x:0,y:0,c:""},"mtr)":{x:0,y:0,c:""},HDD:{x:-7,y:0,c:""},breve:{x:-7,y:0,c:""},HD:{x:-5.2,y:0,c:""},Hd:{x:-3.8,y:0,c:""},hd:{x:-3.7,y:0,c:""},ghd:{x:2,y:0,c:"",sc:.66},pshhd:{x:-3.7,y:0,c:""},pfthd:{x:-3.7,y:0,c:""},x:{x:-3.7,y:0,c:""},"circle-x":{x:-3.7,y:0,c:""},srep:{x:-5,y:0,c:""},"dot+":{x:-5,y:0,sc:.7,c:""},diamond:{x:-4,y:0,c:""},triangle:{x:-4,y:0,c:""},dot:{x:-1,y:0,c:""},flu1:{x:-.3,y:0,c:""},fld1:{x:-.3,y:0,c:""},flu2:{x:-.3,y:0,c:""},fld2:{x:-.3,y:0,c:""},flu3:{x:-.3,y:3.5,c:""},fld3:{x:-.3,y:-4,c:""},flu4:{x:-.3,y:8,c:""},fld4:{x:-.3,y:-9,c:""},flu5:{x:-.3,y:12.5,c:""},fld5:{x:-.3,y:-14,c:""},"acc-1":{x:-1,y:0,c:""},"cacc-1":{x:-18,y:0,c:""},"sacc-1":{x:-1,y:0,sc:.7,c:""},acc3:{x:-1,y:0,c:""},cacc3:{x:-18,y:0,c:""},sacc3:{x:-1,y:0,sc:.7,c:""},acc1:{x:-2,y:0,c:""},cacc1:{x:-18,y:0,c:""},sacc1:{x:-2,y:0,sc:.7,c:""},acc2:{x:-3,y:0,c:""},"acc-2":{x:-3,y:0,c:""},"acc-1_2":{x:-2,y:0,c:""},"acc-3_2":{x:-3,y:0,c:""},acc1_2:{x:-1,y:0,c:""},acc3_2:{x:-3,y:0,c:""},accent:{x:-3,y:2.5,c:""},stc:{x:-1,y:-2,c:""},emb:{x:-4,y:-2,c:""},wedge:{x:-1,y:0,c:""},marcato:{x:-3,y:-2,c:""},hld:{x:-7,y:-2,c:""},brth:{x:0,y:0,c:""},caes:{x:0,y:8,c:""},r00:{x:-1.5,y:0,c:""},r0:{x:-1.5,y:0,c:""},r1:{x:-3.5,y:-6,c:""},r2:{x:-3.2,y:0,c:""},r4:{x:-3,y:0,c:""},r8:{x:-3,y:0,c:""},r16:{x:-4,y:0,c:""},r32:{x:-4,y:0,c:""},r64:{x:-4,y:0,c:""},r128:{x:-4,y:0,c:""},mrep:{x:-6,y:0,c:""},mrep2:{x:-9,y:0,c:""},p:{x:-4,y:-6,c:""},f:{x:-2.5,y:-6,c:""},pppp:{x:-15,y:-6,c:""},ppp:{x:-11,y:-6,c:""},pp:{x:-8,y:-6,c:""},mp:{x:-8.5,y:-6,c:""},mf:{x:-8,y:-6,c:""},ff:{x:-6,y:-6,c:""},fff:{x:-9,y:-6,c:""},ffff:{x:-12,y:-6,c:""},sfz:{x:-9,y:-6,c:""},trl:{x:-4,y:-2,c:""},turn:{x:-5,y:3,c:""},turnx:{x:-5,y:3,c:""},umrd:{x:-7,y:2,c:""},lmrd:{x:-7,y:2,c:""},dplus:{x:-4,y:0,c:""},sld:{x:-8,y:12,c:""},grm:{x:-2,y:0,c:""},dnb:{x:-4,y:0,c:""},upb:{x:-3,y:0,c:""},opend:{x:-2,y:0,c:""},roll:{x:0,y:2,c:""},thumb:{x:0,y:0,c:""},snap:{x:-2,y:0,c:""},ped:{x:-10,y:0,c:""},pedoff:{x:-5,y:0,c:""},mtro:{x:0,y:0,c:""},mtrc:{x:0,y:0,c:""},"mtr.":{x:0,y:0,c:""},"mtr|":{x:0,y:0,c:""},longa:{x:-4.7,y:0,c:""},custos:{x:-4,y:3,c:""},ltr:{x:2,y:6,c:""}},glyphs={};function m_gl(e){return e.replace(/[Cco]\||[co]\.|./g,(function(e){var t=tgls["mtr"+e];return t?t.c:0}))}function def_use(e){var t,n,r;if(!defined_glyph[e])if(defined_glyph[e]=!0,r=glyphs[e]){for(n=0;!((t=r.indexOf('xlink:href="#',n))<0);)t+=13,n=r.indexOf('"',t),def_use(r.slice(t,n));defs+="\n"+r}else error(1,null,"Unknown glyph: '$1'",e)}function defs_add(e){var t,n,r,s,i,o=0;for(e=e.replace(/<!--.*?-->/g,"");!((i=e.indexOf("<",o))<0||(t=e.indexOf('id="',i))<0||(t+=4,(n=e.indexOf('"',t))<0)||(r=e.slice(t,n),(o=e.indexOf(">",n))<0));){if("/"==e[o-1])o++;else{if((t=e.indexOf(" ",i))<0)break;if(s=e.slice(i+1,t),(o=e.indexOf("</"+s+">",o))<0)break;o+=3+s.length}"<filter"==e.substr(i,7)?fulldefs+=e.slice(i,o)+"\n":glyphs[r]=e.slice(i,o)}}function set_g(){stv_g.started&&(stv_g.started=!1,glout(),output+="</g>\n"),(1!=stv_g.scale||stv_g.color)&&(glout(),output+="<g ",1!=stv_g.scale&&(stv_g.st<0?output+=voice_tb[stv_g.v].scale_str:stv_g.v<0?output+=staff_tb[stv_g.st].scale_str:output+='transform="translate(0,'+(posy-stv_g.dy).toFixed(1)+") scale("+stv_g.scale.toFixed(2)+')"'),stv_g.color&&(1!=stv_g.scale&&(output+=" "),output+='color="'+stv_g.color+'"'),output+=">\n",stv_g.started=!0)}function set_color(e){if(e!=stv_g.color){var t=stv_g.color;return stv_g.color=e,set_g(),t}}function set_sscale(e){var t,n;e!=stv_g.st&&1!=stv_g.scale&&(stv_g.scale=0),t=e>=0?staff_tb[e].staffscale:1,n=e>=0&&1!=t?staff_tb[e].y:posy,t==stv_g.scale&&n==stv_g.dy||(stv_g.scale=t,stv_g.dy=n,stv_g.st=e,stv_g.v=-1,set_g())}function set_scale(e){var t,n=e.p_v.scale;1!=n?(t=posy,1!=staff_tb[e.st].staffscale&&(n*=staff_tb[e.st].staffscale,t=staff_tb[e.st].y),n==stv_g.scale&&stv_g.dy==posy||(stv_g.scale=n,stv_g.dy=t,stv_g.st=1==staff_tb[e.st].staffscale?-1:e.st,stv_g.v=e.v,set_g())):set_sscale(e.st)}function set_dscale(e,t){output&&(stv_g.started&&(stv_g.started=!1,glout(),output+="</g>\n"),stv_g.st<0?staff_tb[0].output+=output:1==stv_g.scale?staff_tb[stv_g.st].output+=output:staff_tb[stv_g.st].sc_out+=output,output=""),stv_g.scale=e<0||t?1:staff_tb[e].staffscale,stv_g.st=e,stv_g.dy=0}function delayed_update(){var e;for(e=0;e<=nstaff;e++)staff_tb[e].sc_out&&(output+="<g "+staff_tb[e].scale_str+">\n"+staff_tb[e].sc_out+"</g>\n",staff_tb[e].sc_out=""),staff_tb[e].output&&(output+='<g transform="translate(0,'+(-staff_tb[e].y).toFixed(1)+')">\n'+staff_tb[e].output+"</g>\n",staff_tb[e].output="")}function anno_out(e,t,n){if(null!=e.istart){var r=e.type,s=e.ymx-e.ymn+4,i=e.wl||2,o=e.wr||2;e.grace&&(r=C.GRACE),n(t||abc2svg.sym_name[r],e.istart,e.iend,e.x-i-2,staff_tb[e.st].y+e.ymn+s-2,i+o+4,s,e)}}function a_start(e,t){anno_out(e,t,user.anno_start)}function a_stop(e,t){anno_out(e,t,user.anno_stop)}function empty_function(){}var anno_start=empty_function,anno_stop=empty_function;function anno_put(){for(var e;e=anno_a.shift();){switch(e.type){case C.CLEF:case C.METER:case C.KEY:case C.REST:if(e.type!=C.REST||e.rep_nb){set_sscale(e.st);break}case C.GRACE:case C.NOTE:case C.MREST:set_scale(e)}anno_stop(e)}}function out_XYAB(e,t,n,r,s){t=sx(t),n=sy(n),output+=e.replace(/X|Y|A|B|F|G/g,(function(e){switch(e){case"X":return t.toFixed(1);case"Y":return n.toFixed(1);case"A":return r;case"B":return s;case"F":return r.toFixed(1);default:return s.toFixed(1)}}))}function g_open(e,t,n,r,s){glout(),out_XYAB('<g transform="translate(X,Y',e,t),n&&(output+=") rotate("+n.toFixed(2)),r&&(output+=s?") scale("+r.toFixed(2)+", "+s.toFixed(2):") scale("+r.toFixed(2)),output+=')">\n',stv_g.g++}function g_close(){glout(),stv_g.g--,output+="</g>\n"}function sx(e){return stv_g.g?e:(e+posx)/stv_g.scale}function sy(e){return stv_g.g?-e:1==stv_g.scale?posy-e:stv_g.v>=0?(stv_g.dy-e)/voice_tb[stv_g.v].scale:stv_g.dy-e}function out_sxsy(e,t,n){e=sx(e),n=sy(n),output+=e.toFixed(1)+t+n.toFixed(1)}function xypath(e,t,n){out_XYAB(n?'<path d="mX Y':'<path class="stroke" d="mX Y',e,t)}function draw_all_hl(){var e,t;function n(e,n){var r,s,i,o,a,c,l=e.length;if(l)for(i=0;i<l;i++)if((s=e[i])&&s.length){for(o=sx(s[0][0]),output+='<path class="stroke" stroke-width="1" d="M'+o.toFixed(1)+" "+sy(t.y+n*i).toFixed(1),a=0;r=s.shift();)c=sx(r[0]),output+="m"+(c-o+r[1]-a).toFixed(2)+" 0h"+(-r[1]+r[2]).toFixed(2),o=c,a=r[2];output+='"/>\n'}}for(e=0;e<=nstaff;e++)(t=staff_tb[e]).hlu&&(set_sscale(e),n(t.hlu,6),n(t.hld,-6))}Abc.prototype.out_svg=function(e){output+=e},Abc.prototype.sx=sx,Abc.prototype.sy=sy,Abc.prototype.sh=function(e){return stv_g.st<0?e/stv_g.scale:e},Abc.prototype.ax=function(e){return e+posx},Abc.prototype.ay=function(e){return stv_g.st<0?posy-e:posy+(stv_g.dy-e)*stv_g.scale-stv_g.dy},Abc.prototype.ah=function(e){return stv_g.st<0?e:e*stv_g.scale},Abc.prototype.out_sxsy=out_sxsy,Abc.prototype.xypath=xypath;var gla=[[],[],"",[],[],[]];function glout(){var e,t=[];if(gla[0].length){for(;null!=(e=gla[0].shift());)t.push(e.toFixed(1));for(output+='<text x="'+t.join(","),t=[];null!=(e=gla[1].shift());)t.push(e.toFixed(1));output+='"\ny="'+t.join(","),output+='"\n>'+gla[2]+"</text>\n",gla[2]=""}if(gla[3].length){for(output+='<path class="sW" d="';null!=(e=gla[3].shift());)output+="M"+e.toFixed(1)+" "+gla[3].shift().toFixed(1)+"v"+gla[3].shift().toFixed(1);output+='"/>\n'}}function xygl(e,t,n){if(glyphs[n])def_use(n),out_XYAB('<use x="X" y="Y" xlink:href="#A"/>\n',e,t,n);else{var r=tgls[n];r?(e+=r.x*stv_g.scale,t-=r.y,r.sc?out_XYAB('<text transform="translate(X,Y) scale(A)">B</text>\n',e,t,r.sc,r.c):(gla[0].push(sx(e)),gla[1].push(sy(t)),gla[2]+=r.c)):error(1,null,"no definition of $1",n)}}function out_acciac(e,t,n,r,s){s?(e-=1,t+=4):(e-=5,t-=4),out_XYAB('<path class="stroke" d="mX YlF G"/>\n',e,t,n,-r)}function out_brace(e,t,n){t=posy-t,n/=24,output+='<text transform="translate('+(e+=posx-6).toFixed(1)+","+t.toFixed(1)+") scale(2.5,"+n.toFixed(2)+')">'+tgls.brace.c+"</text>\n"}function out_bracket(e,t,n){t=posy-t-3,n+=2,output+='<path d="m'+(e+=posx-5).toFixed(1)+" "+t.toFixed(1)+"\n c10.5 1 12 -4.5 12 -3.5c0 1 -3.5 5.5 -8.5 5.5\n v"+n.toFixed(1)+'\n c5 0 8.5 4.5 8.5 5.5c0 1 -1.5 -4.5 -12 -3.5"/>\n'}function out_hyph(e,t,n){var r,s=25+3*(n/20|0);out_XYAB('<path class="stroke" stroke-width="1.2"\n stroke-dasharray="5,A"\n d="mX YhB"/>\n',e+=(n-s*(r=n>15?(n-15)/s|0:0)-5)/2,t+6,Math.round((s-5)/stv_g.scale),s*r+5)}function out_stem(e,t,n,r,s,i){var o=r?GSTEM_XOFF:3.5,a=-n;if(n<0&&(o=-o),e+=o*stv_g.scale,stv_g.v>=0&&(a/=voice_tb[stv_g.v].scale),gla[3].push(sx(e)),gla[3].push(sy(t)),gla[3].push(a),s){if(t+=n,n>0)if(i)if(output+='<path d="',r)for(;--s>=0;)out_XYAB("MX Yl3 1.5 0 2 -3 -1.5z\n",e,t),t-=3;else for(;--s>=0;)out_XYAB("MX Yl7 3.2 0 3.2 -7 -3.2z\n",e,t),t-=5.4;else{if(!r)return void xygl(e,t,"flu"+s);if(output+='<path d="',1==s)out_XYAB("MX Yc0.6 3.4 5.6 3.8 3 10\n 1.2 -4.4 -1.4 -7 -3 -7\n",e,t);else for(;--s>=0;)out_XYAB("MX Yc1 3.2 5.6 2.8 3.2 8\n 1.4 -4.8 -2.4 -5.4 -3.2 -5.2\n",e,t),t-=3.5}else if(i){if(output+='<path d="',!r)for(;--s>=0;)out_XYAB("MX Yl7 -3.2 0 -3.2 -7 3.2z\n",e,t),t+=5.4}else{if(!r)return void xygl(e,t,"fld"+s);if(output+='<path d="',1==s)out_XYAB("MX Yc0.6 -3.4 5.6 -3.8 3 -10\n 1.2 4.4 -1.4 7 -3 7\n",e,t);else for(;--s>=0;)out_XYAB("MX Yc1 -3.2 5.6 -2.8 3.2 -8\n 1.4 4.8 -2.4 5.4 -3.2 5.2\n",e,t),t+=3.5}output+='"/>\n'}}function out_trem(e,t,n){for(out_XYAB('<path d="mX Y\n\t',e-4.5,t);output+="l9 -3v3l-9 3z",!(--n<=0);)output+="m0 5.4";output+='"/>\n'}function out_tubr(e,t,n,r,s){var i=s?-3:3;t+=i,n/=stv_g.scale,output+='<path class="stroke" d="m',out_sxsy(e," ",t),output+="v"+i.toFixed(1)+"l"+n.toFixed(1)+" "+(-r).toFixed(1)+"v"+(-i).toFixed(1)+'"/>\n'}function out_tubrn(e,t,n,r,s,i){var o,a=10*i.length,c=s?-3:3;set_font("tuplet"),xy_str(e+n/2,t+r/2-.5*gene.curfont.size+2,i,"c"),n/=stv_g.scale,s||(t+=6),output+='<path class="stroke" d="m',out_sxsy(e," ",t),o=n-a+1,r>0?a+=r/8:a-=r/8,output+="v"+c.toFixed(1)+"m"+n.toFixed(1)+" "+(-r).toFixed(1)+"v"+(-c).toFixed(1)+'"/>\n<path class="stroke" stroke-dasharray="'+(o/2).toFixed(1)+" "+a.toFixed(1)+'" d="m',out_sxsy(e," ",t-c),output+="l"+n.toFixed(1)+" "+(-r).toFixed(1)+'"/>\n'}function out_wln(e,t,n){out_XYAB('<path class="stroke" stroke-width="0.8" d="mX YhF"/>\n',e,t+3,n)}var deco_str_style={crdc:{dx:0,dy:5,style:"font:italic 14px text,serif"},dacs:{dx:0,dy:3,style:"font:16px text,serif",anchor:' text-anchor="middle"'},pf:{dx:0,dy:5,style:"font:italic bold 16px text,serif"},"@":{dx:0,dy:5,style:"font:12px text,sans-serif"}};function out_deco_str(e,t,n,r){if("fng"!=n){var s=deco_str_style[n];s?(e+=s.dx,t+=s.dy,s.def||(style+="\n."+n+" {"+s.style+"}",s.def=!0),out_XYAB('<text x="X" y="Y" class="A"B>',e,t,n,s.anchor||""),set_font("annotation"),out_str(r),output+="</text>\n"):xygl(e,t,n)}else out_XYAB('<text x="X" y="Y" style="font-size:14px" text-anchor="middle">A</text>\n',e,t,m_gl(r))}function out_arp(e,t,n){for(g_open(e,t,270),e=0,n=Math.ceil(n/6);--n>=0;)xygl(e,6,"ltr"),e+=6;g_close()}function out_cresc(e,t,n,r){out_XYAB('<path class="stroke"\n d="mX YlF ',e+=n*stv_g.scale,t+5,n=-n),r.nost?output+="-2.2m0 -3.6l"+(-n).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-n).toFixed(1)+' -4"/>\n'}function out_dim(e,t,n,r){out_XYAB('<path class="stroke"\n d="mX YlF ',e,t+5,n),r.noen?output+="-2.2m0 -3.6l"+(-n).toFixed(1)+' -2.2"/>\n':output+="-4l"+(-n).toFixed(1)+' -4"/>\n'}function out_ltr(e,t,n){for(t+=4,n=Math.ceil(n/6);--n>=0;)xygl(e,t,"ltr"),e+=6}function out_8va(e,t,n,r){n<18&&(n=18,e-=4),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">8<tspan dy="-4" style="font-size:10px">va</tspan></text>\n',e-8,t),e+=12,n-=12),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t+=6,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+n,t)}function out_8vb(e,t,n,r){n<18&&(n=18,e-=4),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">8<tspan dy=".5" style="font-size:10px">vb</tspan></text>\n',e-8,t),e+=10,n-=10),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+n,t)}function out_15ma(e,t,n,r){n<25&&(n=25,e-=6),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">15<tspan dy="-4" style="font-size:10px">ma</tspan></text>\n',e-10,t),e+=20,n-=20),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t+=6,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv6"/>\n',e+n,t)}function out_15mb(e,t,n,r){n<24&&(n=24,e-=5),r.nost||(out_XYAB('<text x="X" y="Y" style="font:italic bold 12px text,serif">15<tspan dy=".5" style="font-size:10px">mb</tspan></text>\n',e-10,t),e+=18,n-=18),out_XYAB('<path class="stroke" stroke-dasharray="6,6" d="mX YhF"/>\n',e,t,n),r.noen||out_XYAB('<path class="stroke" d="mX Yv-6"/>\n',e+n,t)}Abc.prototype.out_lped=function(e,t,n,r){t+=4,r.nost||xygl(e,t,"ped"),r.noen||xygl(e+n+6,t,"pedoff")};var deco_val_tb={arp:out_arp,cresc:out_cresc,dim:out_dim,ltr:out_ltr,lped:function(e,t,n,r){self.out_lped(e,t,n,r)},"8va":out_8va,"8vb":out_8vb,"15ma":out_15ma,"15mb":out_15mb};function out_deco_val(e,t,n,r,s){deco_val_tb[n]?deco_val_tb[n](e,t,r,s):error(1,null,"No function for decoration '$1'",n)}function out_glisq(e,t,n){var r=n.start,s=r.x,i=r.y+staff_tb[r.st].y,o=Math.atan2(i-t,e-s),a=o/Math.PI*180,c=(e-s)/Math.cos(o);for(g_open(s,i,a),(c=(c-(s=r.s.dots?13+r.s.xmx:8)-6)/6|0)<1&&(c=1);--c>=0;)xygl(s,0,"ltr"),s+=6;g_close()}function out_gliss(e,t,n){var r=n.start,s=r.x,i=r.y+staff_tb[r.st].y,o=-Math.atan2(t-i,e-s),a=o/Math.PI*180,c=(e-s)/Math.cos(o);g_open(s,i,a),c-=(s=r.s.dots?13+r.s.xmx:8)+8,xypath(s,0),output+="h"+c.toFixed(1)+'" stroke-width="1"/>\n',g_close()}var deco_l_tb={glisq:out_glisq,gliss:out_gliss},par_sy,cur_sy,voice_tb,curvoice,staves_found,vover,tsfirst;function out_deco_long(e,t,n){var r=n.dd.glyph;deco_l_tb[r]?deco_l_tb[r](e,t,n):error(1,null,"No function for decoration '$1'",r)}function tempo_note(e,t){var n,r=identify_note(e,t);switch(r[0]){case C.OVAL:n="";break;case C.EMPTY:n="";break;default:switch(r[2]){case 2:n="";break;case 1:n="";break;default:n=""}}return r[1]&&(n+='<tspan dx=".1em"></tspan>'),n}function tempo_build(e){var t,n,r,s=0,i=[];if(!e.tempo_str){if(cfmt.musicfont.used||get_font("music"),set_font("tempo"),e.tempo_str1&&(i.push(e.tempo_str1),s+=strwh(e.tempo_str1)[0]),e.tempo_notes){for(r=' dy="-1"',t=0;t<e.tempo_notes.length;t++)n=tempo_note(e,e.tempo_notes[t]),i.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px"'+r+">"+n+"</tspan>"),s+=(n.length>1?2:1)*gene.curfont.swfac,r="";i.push('<tspan dy="1">=</tspan>'),s+=cwidf("="),e.tempo_ca&&(i.push(e.tempo_ca),s+=strwh(e.tempo_ca)[0],e.tempo_ca.length+1),e.tempo?(i.push(e.tempo),s+=strwh(e.tempo.toString())[0]):(n=tempo_note(e,e.new_beat),i.push('<tspan\nclass="'+font_class(cfmt.musicfont)+'" style="font-size:'+(1.3*gene.curfont.size).toFixed(1)+'px" dy="-1">'+n+"</tspan>"),s+=(n.length>1?2:1)*gene.curfont.swfac,r="y")}e.tempo_str2&&(r?i.push('<tspan\n\tdy="1">'+e.tempo_str2+"</tspan>"):i.push(e.tempo_str2),s+=strwh(e.tempo_str2)[0]),e.tempo_str=i.join(" "),s+=cwidf(" ")*(i.length-1),e.tempo_wh=[s,13]}}function writempo(e,t,n){var r;set_font("tempo"),gene.curfont.box&&(gene.curfont.box=!1,r=gene.curfont.size+4),output+='<text class="'+font_class(gene.curfont)+'" x="',out_sxsy(t,'" y="',n+.2*gene.curfont.size),output+='">'+e.tempo_str+"</text>\n",r&&(gene.curfont.box=!0,output+='<rect class="stroke" x="',out_sxsy(t-2,'" y="',n+r-1),output+='" width="'+(e.tempo_wh[0]+2).toFixed(1)+'" height="'+r.toFixed(1)+'"/>\n'),e.invis=!0}function vskip(e){posy+=e}function svg_flush(){if(!multicol&&output&&user.img_out&&0!=posy){var e,t,n='<svg xmlns="http://www.w3.org/2000/svg" version="1.1"\n xmlns:xlink="http://www.w3.org/1999/xlink"\n fill="currentColor" stroke-width=".7"',r="";if(glout(),n+=' class="'+font_class(t=get_font("music"))+" tune"+tunes.length+'"\n',posy*=cfmt.scale,user.imagesize?n+=user.imagesize+' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'">\n':n+=' viewBox="0 0 '+img.width.toFixed(0)+" "+posy.toFixed(0)+'" width="'+img.width.toFixed(0)+'px" height="'+posy.toFixed(0)+'px">\n',n+=fulldefs,(style||font_style)&&(n+="<style>"+font_style,(cfmt.fgcolor||cfmt.bgcolor)&&(n+="\n.f"+t.fid+(cfmt.fullsvg||"")+"{"+(cfmt.fgcolor?"color:"+cfmt.fgcolor+";":"")+(cfmt.bgcolor?"background-color:"+cfmt.bgcolor:"")+"}"),n+=style+"\n</style>\n"),defs&&(n+="<defs>"+defs+"\n</defs>\n"),1!=cfmt.scale&&(n+='<g class="g" transform="scale('+cfmt.scale.toFixed(2)+')">\n',r="</g>\n"),psvg&&psvg.ps_flush(!0),blkdiv>0&&(user.img_out(1==blkdiv?'<div class="nobrk">':'<div class="nobrk newpage">'),blkdiv=-1),user.img_out(n+output+r+"</svg>"),output="",font_style="",cfmt.fullsvg)for(defined_glyph={},e=0;e<font_tb.length;e++)font_tb[e].used=!1;else style="",fulldefs="";defs="",posy=0}}function blk_flush(){svg_flush(),blkdiv<0&&(!parse.state||cfmt.splittune)&&(user.img_out("</div>"),blkdiv=0)}function voice_filter(){var e;function t(e,t){var n,r=new RegExp(t);if(r.test(curvoice.id)||r.test(curvoice.nm))for(n=0;n<e.length;n++)self.do_pscom(e[n])}if(parse.voice_opts)for(e in parse.voice_opts)parse.voice_opts.hasOwnProperty(e)&&t(parse.voice_opts[e],e);if(parse.tune_v_opts)for(e in parse.tune_v_opts)parse.tune_v_opts.hasOwnProperty(e)&&t(parse.tune_v_opts[e],e)}function sym_link(e){var t=curvoice.time;e.fname||set_ref(e),curvoice.ignore||(e.prev=curvoice.last_sym,curvoice.last_sym?curvoice.last_sym.next=e:curvoice.sym=e),curvoice.last_sym=e,e.v=curvoice.v,e.p_v=curvoice,e.st=curvoice.cst,e.time=t,e.dur&&!e.grace&&(curvoice.time+=e.dur),parse.ufmt=!0,e.fmt=cfmt,e.pos=curvoice.pos,curvoice.second&&(e.second=!0),curvoice.floating&&(e.floating=!0),curvoice.eoln&&(e.soln=!0,curvoice.eoln=!1)}function sym_add(e,t){var n,r={type:t,dur:0},s=curvoice;return curvoice=e,sym_link(r),curvoice=s,(n=r.prev)||(n=r.next),n&&(r.fname=n.fname,r.istart=n.istart,r.iend=n.iend),r}Abc.prototype.blk_flush=blk_flush;var w_tb=new Uint8Array([5,1,8,6,0,2,3,9,9,0,9,4,0,7,0,0,0,0]);function sort_all(){var e,t,n,r,s,i,o,a,c=voice_tb.length,l=[],u=[],f=cur_sy,d=f.top_voice,p=voice_tb[d],h={type:C.STAVES,dur:0,v:d,p_v:p,time:0,st:0,sy:f,next:p.sym,seqst:!0};if(p.sym){for(h.fmt=i=p.sym.fmt,d=0;d<c;d++)e=voice_tb[d].sym,l[d]=e,f.voices[d]&&(u[f.voices[d].range]=d);for(p.sym=tsfirst=e=h,e.next?e.next.prev=e:p.last_sym=e,(e=glovar.tempo)&&(e.v=d=p.v,e.p_v=p,e.st=0,e.time=0,e.prev=h,e.next=h.next,e.next?e.next.prev=e:p.last_sym=e,e.prev.next=e,e.fmt=i,glovar.tempo=null,l[d]=e);;){if(a)for(f=a,a=null,u=[],d=0;d<c;d++)f.voices[d]&&(u[f.voices[d].range]=d);for(r=t=1e7,s=0;null!=(d=u[s++]);)!(e=l[d])||e.time>t||(n=w_tb[e.type],e.time<t?(t=e.time,r=n):n<r&&(r=n));if(r>127)break;for(s=0;null!=(d=u[s++]);)if((e=l[d])&&e.time==t&&w_tb[e.type]==r){if(e.type==C.STAVES)a=e.sy;else if(e.type==C.SM){e.next.prev=e.prev,e.prev?e.prev.next=e.next:e.p_v.sym=e.next,l[d]=e.next;continue}o&&(o=0,e.seqst=!0),e.ts_prev=h,h.ts_next=e,h=e,l[d]=e.next}o=r}}}function voice_adj(e){var t,n,r,s,i;function o(e){var t,n,r,s,i,o,a=e.dur,c=1;for(t=e;t&&(!t.beam_end&&t.next);t=t.next)c++;if(c<=1)delete e.feathered_beam;else{if(n=t,s=a/2,o=a/(c-1),r=e.time,e.feathered_beam>0)for(t=e,i=c-1;t!=n;t=t.next,i--)a=(o*i|0)+s,t.dur=a,t.time=r,r+=a;else for(t=e,i=0;t!=n;t=t.next,i++)a=(o*i|0)+s,t.dur=a,t.time=r,r+=a;t.dur=t.time+t.dur-r,t.time=r}}for(curvoice&&curvoice.clone&&(parse.istart=parse.eol,do_cloning()),s=0;s<voice_tb.length;s++){if(t=voice_tb[s],!e)for(delete t.eoln;i=t.sls.shift();){for(r=(n=i.note.s).next;r&&(!r.bar_type||":"!=r.bar_type[0]);r=r.next);r?(n.sls||(n.sls=[]),n.sls.push({ty:i.ty,note:{s:r}})):(n.sls||(n.sls=[]),n.sls.push({ty:i.ty,note:{s:r},loc:"o"}))}for(n=t.sym;n&&!(n.time>=staves_found);n=n.next);for(;n;n=n.next)if((w_tb[n.type]||n.type==C.STAVES)&&n.type!=C.SPACE&&n.type!=C.GRACE||n.prev&&!(n.time>n.prev.time+n.prev.dur)||(r={type:C.SM,v:n.v,p_v:n.p_v,time:n.time,dur:0,next:n,prev:n.prev,fmt:n.fmt},n.prev?n.prev.next=r:voice_tb[n.v].sym=r,n.prev=r),n.type!==C.GRACE)n.feathered_beam&&o(n);else{if(!cfmt.graceword)continue;for(r=n.next;r;r=r.next){switch(r.type){case C.SPACE:continue;case C.NOTE:if(!r.a_ly)break;n.a_ly=r.a_ly,r.a_ly=null}break}}}}function new_syst(e){var t,n,r,s,i={voices:[],staves:[],top_voice:0};if(e)cur_sy=par_sy=i;else{for(n=0;n<voice_tb.length;n++)par_sy.voices[n]&&(t=par_sy.voices[n].st,r=par_sy.staves[t],s=voice_tb[n],r.staffnonote=s.staffnonote,s.staffscale&&(r.staffscale=s.staffscale));for(t=0;t<par_sy.staves.length;t++)i.staves[t]=clone(par_sy.staves[t]),i.staves[t].flags=0;par_sy.next=i,par_sy=i}}function not2abc(e,t){var n,r="";for(t&&3!=t&&("object"!=typeof t?r=["__","_","","^","^^"][t+2]:((n=t[0])>0?r+="^":(r+="_",n=-n),r+=n+"/"+t[1])),r+=ntb[(e+75)%7],n=e;n>=23;n-=7)r+="'";for(n=e;n<16;n+=7)r+=",";return r}function get_map(e){if(e){var t,n,r,s,i,o,a="",c=e.split(/\s+/);if(c.length<3)syntax(1,not_enough_p);else{if("*"==(o=c[1])[0]||0==o.indexOf("all"))o="all";else{if(0!=o.indexOf("octave,")&&0!=o.indexOf("key,")||(a=o[0],0==(o=(o=o.split(",")[1]).replace(/[,']+/,"").toUpperCase()).indexOf("key,")&&(o=o.replace(/[=^_]+/,""))),(i=new scanBuf).buffer=o,!(n=parse_acc_pit(i)))return void syntax(1,"Bad note in %%map");o=a+not2abc(n.pit,n.acc)}if((r=maps[c[0]])||(maps[c[0]]=r={}),(s=r[o])||(r[o]=s=[]),c.shift(),c.shift(),c.length){if(t=0,(c=info_split(c.join(" ")))[0].indexOf("=")<0){if("*"!=c[0][0]&&((i=new scanBuf).buffer=c[0],s[1]=parse_acc_pit(i)),!c[1])return;t++,c[1].indexOf("=")<0&&(s[0]=c[1].split(","),t++)}for(;t<c.length;t++)switch(c[t]){case"heads=":if(!c[++t]){syntax(1,not_enough_p);break}s[0]=c[t].split(",");break;case"print=":case"play=":if(!c[++t]){syntax(1,not_enough_p);break}(i=new scanBuf).buffer=c[t],n=parse_acc_pit(i),"r"==c[t-1][1]?s[1]=n:s[3]=n;break;case"color=":if(!c[++t]){syntax(1,not_enough_p);break}s[2]=c[t]}}}}}function set_transp(){var e,t,n;if(!curvoice.ckey.k_bagpipe&&!curvoice.ckey.k_drum){if(cfmt.transp&&curvoice.shift&&syntax(0,"Mix of old and new transposition syntaxes"),null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(t=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(n=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==t){if(null==n)return}else curvoice.vtransp=t;if(is_voice_sig())curvoice.okey.fmt=cfmt,curvoice.key=e=clone(curvoice.okey);else for(e=curvoice.last_sym;e.type!=C.KEY;)if(!(e=e.prev)){e=curvoice.key;break}null!=t&&(e.k_transp=t),null!=n&&(e.k_sndtran=n),curvoice.ckey=clone(e),curvoice.key.k_none&&(e.k_sf=0)}}function note_transp(e,t,n){var r,s,i,o=n.pit,a=n.acc;if("object"!=typeof a||(s=a[1],a=a[0],2==s)){if(!a&&t.k_a_acc&&(a=t.k_map[(o+19)%7]),i=abc2svg.pab40(o,a)+t.k_transp,n.pit=abc2svg.b40p(i),a||t.k_a_acc||t.k_none){if(r=abc2svg.b40a(i),a)t.k_a_acc&&t.k_map[(n.pit+19)%7]==r&&(r=0),r||(r=3);else if(t.k_none){if(acc_same_pitch(e,n.pit))return}else{if(!t.k_a_acc)return;if(acc_same_pitch(e,n.pit))return;t.k_map[(n.pit+19)%7]&&(r=3)}if(s&&r!=a)switch(Number(a)){case-3:switch(r){case-2:r=-1;break;case 3:r=-3,n.pit++;break;case 2:r=-1}break;case-1:switch(r){case-2:r=-3;break;case 3:r=1}break;case 1:switch(r){case-1:r=-3;break;case 3:r=-1;break;case 2:r=3}break;case 3:switch(r){case-1:r=1;break;case 1:r=1,n.pit++}}n.acc=s?[r,s]:r}}else error(1,e,"Microtone transposition not coded")}function pit_adj(){for(var e,t,n,r,s,i=voice_tb.length;--i>=0;)if(null!=(t=voice_tb[i]).vtransp)for(t.key.k_transp?(key_transp(r=t.key),r.k_old_sf=r.k_sf):r=null,n=t.sym;n;){if(!r)for(;n&&(n.type!=C.KEY||!n.k_transp);n=n.next);for(;n;n=n.next){switch(n.type){case C.GRACE:for(s=n.extra;s;s=s.next)for(e=0;e<=s.nhd;e++)note_transp(s,r,s.notes[e]);continue;case C.NOTE:case C.REST:for(e=0;e<=n.nhd;e++)note_transp(n,r,n.notes[e]);n.a_gch&&gch_transp(n,r);continue;case C.KEY:if(r&&(n.k_sf=r.k_sf),key_transp(n),!n.k_transp)break;r=n;default:continue}break}r=null}}function set_ctrl(){var e,t,n;for(t in parse.ctrl){for(n=parse.ctrl[t],e=tsfirst;e.next&&e.next.time<t;)e=e.next;for(;e&&e.time<t;)e=e.ts_next;if(e){for(;e.time==t&&e.ts_next&&!e.dur;)e=e.ts_next;n.part&&(e.part=n.part),n.tempo&&(lkvsym(n.tempo,e),lktsym(n.tempo,e))}else;}}function get_transp(e){if("0"==e[0])return 0;if("123456789-+".indexOf(e[0])>=0){var t=parseInt(e);return isNaN(t)||t<-36||t>36?void syntax(1,errs.bad_transp):40*(((t+=36)/12|0)-3)+("b"==e.slice(-1)?abc2svg.ifb40:abc2svg.isb40)[t%12]}}function generate(){var e;a_dcn.length&&(syntax(1,"Decoration without symbol"),a_dcn=[]),parse.tp&&(syntax(1,"No end of tuplet"),(e=parse.tps)&&delete e.tp,delete parse.tp),vover&&(syntax(1,"No end of voice overlay"),get_vover(vover.bar?"|":")")),voice_adj(),sort_all(),tsfirst&&(user.anno_start&&(anno_start=a_start),user.anno_stop&&(anno_stop=a_stop),self.set_bar_num(),pit_adj(),info.P&&(tsfirst.parts=info.P),parse.ctrl&&set_ctrl(),user.get_abcmodel&&user.get_abcmodel(tsfirst,voice_tb,abc2svg.sym_name,info),user.img_out&&self.output_music()),set_page(),info.W&&put_words(info.W),put_history(),parse.state=0,blk_flush(),tsfirst&&(tunes.push([tsfirst,voice_tb,info,cfmt]),tsfirst=null)}function key_transp(e){if(!e.k_a_acc&&!e.k_none){var t,n=(e.k_b40+200+e.k_transp)%40;(t=abc2svg.b40k[n]-n)&&(e.k_transp>0?e.k_transp+=t:e.k_transp-=t,n+=t),e.k_b40=n;var r=abc2svg.b40sf[n];e.k_old_sf=e.k_sf,e.k_sf=r,e.k_map=abc2svg.keys[r+7]}}function acc_same_pitch(e,t){var n,r,s=e.time;for(e=e.prev;e;e=e.prev)switch(e.type){case C.BAR:if(e.time<s)return;for(;;){if(!(e=e.prev))return;if(e.type==C.NOTE){if(e.time+e.dur==s)break;return}if(e.time<s)return}for(n=0;n<=e.nhd;n++)if(e.notes[n].pit==t&&e.notes[n].tie_ty)return null==(r=e.notes[n].acc)||3==r;return;case C.NOTE:for(n=0;n<=e.nhd;n++)if(e.notes[n].pit==t)return null==(r=e.notes[n].acc)||3==r}}function get_staves(e,t){var n,r,s,i,o,a,c,l,u,f=voice_tb.length,d=0;if(!t||(c=parse_staves(t))){for(a=0;a<f;a++)(r=voice_tb[a]).time>d&&(d=r.time);if(d){for(f&&voice_adj(!0),a=0;a<par_sy.voices.length;a++)if(par_sy.voices[a]){curvoice=voice_tb[a];break}if(curvoice.time=d,sym_link(n={type:C.STAVES,dur:0}),par_sy.nstaff=nstaff,!t){for(n.sy=clone(par_sy,1),par_sy.next=n.sy,par_sy=n.sy,staves_found=d,a=0;a<f;a++)voice_tb[a].time=d;return void(curvoice=voice_tb[par_sy.top_voice])}new_syst(),n.sy=par_sy}else par_sy.staves=[],par_sy.voices=[];for(staves_found=d,a=0;a<f;a++)delete(r=voice_tb[a]).second,delete r.ignore,delete r.floating;for(u=0,i=0;i<c.length;i++)for((r=new_voice(c[i][0])).time=d,a=r.v,c[i][0]=r;par_sy.voices[a]={range:u++},r=r.voice_down;)a=r.v;if(par_sy.top_voice=c[0][0].v,"t"==e[1])for(i=0;i<c.length;i++)(o=c[i][1])&(OPEN_BRACE|OPEN_BRACE2)&&(o&(OPEN_BRACE|CLOSE_BRACE))!=(OPEN_BRACE|CLOSE_BRACE)&&(o&(OPEN_BRACE2|CLOSE_BRACE2))!=(OPEN_BRACE2|CLOSE_BRACE2)&&0==c[i+1][1]&&(o&OPEN_PARENTH||c[i+2][1]&OPEN_PARENTH||(c[i+2][1]&(CLOSE_BRACE|CLOSE_BRACE2)?c[i+1][1]|=FL_VOICE:0==c[i+2][1]&&c[i+3][1]&(CLOSE_BRACE|CLOSE_BRACE2)&&(c[i][1]|=OPEN_PARENTH,c[i+1][1]|=CLOSE_PARENTH,c[i+2][1]|=OPEN_PARENTH,c[i+3][1]|=CLOSE_PARENTH)));for(l=-1,i=0;i<c.length;i++)if(((o=c[i][1])&(OPEN_PARENTH|CLOSE_PARENTH))==(OPEN_PARENTH|CLOSE_PARENTH)&&(o&=~(OPEN_PARENTH|CLOSE_PARENTH),c[i][1]=o),r=c[i][0],o&FL_VOICE?(r.floating=!0,r.second=!0):(l++,par_sy.staves[l]||(par_sy.staves[l]={stafflines:r.stafflines||"|||||",staffscale:1}),par_sy.staves[l].flags=0),a=r.v,r.st=r.cst=par_sy.voices[a].st=l,par_sy.staves[l].flags|=o,o&OPEN_PARENTH){for(s=r;i<c.length-1&&(a=(r=c[++i][0]).v,c[i][1]&MASTER_VOICE?(s.second=!0,s=r):r.second=!0,r.st=r.cst=par_sy.voices[a].st=l,!(c[i][1]&CLOSE_PARENTH)););par_sy.staves[l].flags|=c[i][1]}if(l<0&&(l=0),par_sy.nstaff=nstaff=l,"c"==e[1])for(l=0;l<nstaff;l++)par_sy.staves[l].flags^=STOP_BAR;for(f=voice_tb.length,l=0,a=0;a<f;a++){if(r=voice_tb[a],par_sy.voices[a]?l=r.st:r.st=l,!d)for(n=r.sym;n;n=n.next)n.st=l;if(par_sy.voices[a]){for(s=r.voice_down;s;)i=s.v,s.st=s.cst=par_sy.voices[i].st=l,s=s.voice_down;par_sy.voices[a].second=r.second,!((l=r.st)>0)||r.norepbra||par_sy.staves[l-1].flags&STOP_BAR||(r.norepbra=!0)}}!d&&f&&voice_adj(!0),curvoice=parse.state>=2?voice_tb[par_sy.top_voice]:null}}function clone_voice(e){var t,n;for(t=0;t<voice_tb.length;t++)if((n=voice_tb[t]).id==e)return n;return(n=clone(curvoice)).v=voice_tb.length,n.id=e,n.sym=n.last_sym=null,n.key=clone(curvoice.key),n.sls=[],delete n.nm,delete n.snm,delete n.new_name,delete n.lyric_restart,delete n.lyric_cont,delete n.sym_restart,delete n.sym_cont,delete n.have_ly,delete n.tie_s,voice_tb.push(n),n}function get_vover(e){var t,n,r,s,i,o,a;if("|"==e||")"==e){if(!curvoice.last_note)return void syntax(1,errs.nonote_vo);if(curvoice.last_note.beam_end=!0,!vover)return void syntax(1,"Erroneous end of voice overlay");if(curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time)),curvoice.acc=[],t=vover.p_voice,(r=curvoice.last_sym).type==C.SPACE&&t.last_sym.type!=C.SPACE){for(r.p_v=t,r.v=r.p_v.v;r.prev.type==C.SPACE;)(r=r.prev).p_v=t,r.v=r.p_v.v;(a=r.prev).next=null,r.prev=t.last_sym,r.prev.next=r,t.last_sym=curvoice.last_sym,curvoice.last_sym=a}return curvoice=t,void(vover=null)}if("("==e)return vover?void syntax(1,"Voice overlay already started"):void(vover={p_voice:curvoice,time:curvoice.time});if(curvoice.last_note){if(curvoice.last_note.beam_end=!0,!(t=curvoice.voice_down)){for(t=clone_voice(curvoice.id+"o"),curvoice.voice_down=t,t.time=0,t.second=!0,o=t.v,par_sy.voices[o]={st:curvoice.st,second:!0},n=par_sy.voices[curvoice.v].range,i=0;i<par_sy.voices.length;i++)par_sy.voices[i]&&par_sy.voices[i].range>n&&par_sy.voices[i].range++;par_sy.voices[o].range=n+1}if(t.ulen=curvoice.ulen,t.dur_fact=curvoice.dur_fact,t.acc=[],vover)curvoice!=vover.p_voice&&curvoice.time!=vover.p_voice.time&&(syntax(1,"Wrong duration in voice overlay"),curvoice.time>vover.p_voice.time&&(vover.p_voice.time=curvoice.time));else{for(s=t.time,r=curvoice.last_sym;!(r.type==C.BAR||r.time<=s);r=r.prev);vover={bar:r&&r.bar_type?r.bar_type:"|",p_voice:curvoice,time:r.time}}t.time=vover.time,curvoice=t}else syntax(1,errs.nonote_vo)}function is_voice_sig(){var e;if(!curvoice.last_sym)return!0;if(curvoice.time)return!1;for(e=curvoice.last_sym;e;e=e.prev)if(w_tb[e.type])return!1;return!0}function get_clef(e){if(!curvoice.time&&is_voice_sig())return curvoice.clef=e,void(e.fmt=cfmt);sym_link(e),e.clef_small=!0;var t=e.prev;t&&t.type==C.BAR&&":"!=t.bar_type[0]&&(e.next=t,e.prev=t.prev,e.prev&&(e.prev.next=e),t.prev=e,t.next=null,curvoice.last_sym=t,e.soln&&(delete e.soln,curvoice.eoln=!0))}function get_key(e){var t,n,r,s,i=new_key(e),o=i[0];if(i=i[1],1==parse.state){for(null!=o.k_sf||o.k_a_acc||(o.k_sf=0,o.k_none=!0,o.k_map=abc2svg.keys[7]),t=0;t<voice_tb.length;t++)(n=voice_tb[t]).key=clone(o),n.okey=clone(o),n.ckey=clone(o);parse.ckey=o,glovar.ulen||(glovar.ulen=C.BLEN/8),i.length&&(memo_kv_parm("*",i),i=""),goto_tune(),parse.state=3}if(set_kv_parm(i),curvoice.ckey.k_bagpipe||curvoice.ckey.k_drum||null==cfmt.transp&&null==curvoice.transp&&null==curvoice.shift||(r=(cfmt.transp||0)+(curvoice.transp||0)+(curvoice.shift||0)),null==curvoice.sndtran&&null==curvoice.sndsh||(s=(curvoice.sndtran||0)+(curvoice.sndsh||0)),null==o.k_sf){if(!o.k_a_acc&&null==r){if(null==s)return;o.invis=!0}o.k_sf=curvoice.okey.k_sf}curvoice.okey=clone(o),null!=r&&(curvoice.vtransp=r,o.k_transp=r),null!=s&&(o.k_sndtran=s),o.k_old_sf=curvoice.ckey.k_sf,o.k_a_acc&&o.k_a_acc.length||o.k_sf||o.k_old_sf||(o.invis=!0),o.k_b40||(o.k_b40=curvoice.ckey.k_b40),curvoice.ckey=o,is_voice_sig()?(o.fmt=cfmt,curvoice.key=clone(o),o.k_none&&(curvoice.key.k_sf=0)):sym_link(o)}function new_voice(e){var t,n,r=voice_tb[0],s=voice_tb.length;if(1==s&&r.default&&(delete r.default,!r.time))return r.id=e,delete r.init,cfmt.transp&&parse.state>=2&&(n=curvoice,curvoice=r,set_transp(),curvoice=n),r;for(t=0;t<s;t++)if((r=voice_tb[t]).id==e)return r;return r={v:t,id:e,time:0,new:!0,pos:{},scale:1,ulen:glovar.ulen,dur_fact:1,key:clone(parse.ckey),ckey:clone(parse.ckey),okey:clone(parse.ckey),meter:clone(glovar.meter),wmeasure:glovar.meter.wmeasure,staffnonote:1,clef:{type:C.CLEF,clef_auto:!0,clef_type:"a",time:0},acc:[],sls:[],hy_st:0},voice_tb.push(r),r}function init_tune(){nstaff=-1,voice_tb=[],curvoice=null,new_syst(!0),staves_found=-1,gene={},a_de=[],cross={}}function do_cloning(){var e,t=curvoice.clone,n=t.vs,r=t.a,s=t.bol,i=parse.istart,o=parse,a=parse.file;for(delete curvoice.clone,"["==a[i-1]&&i--,include++,e=0;e<n.length;e++)(parse=Object.create(o)).line=Object.create(o.line),get_voice(n[e],r),tosvg(parse.fname,a,s,i);include--,parse=o}function get_voice(e){var t,n,r=info_split(e),s=r.shift();if(s)if(curvoice&&curvoice.clone&&do_cloning(),n=s.indexOf(",")>0?s.split(","):[s],parse.state<2)for(;s=n.shift();)r.length&&memo_kv_parm(s,r),"*"!=s&&1==parse.state&&(curvoice=new_voice(s));else if("*"!=s){if(curvoice=new_voice(n[0]),n.length>1&&(n.shift(),curvoice.clone={vs:n,a:r,bol:parse.iend},"]"!=parse.file[curvoice.clone.bol-1]&&curvoice.clone.bol++),set_kv_parm(r),t=curvoice.v,curvoice.new){if(delete curvoice.new,staves_found<0)curvoice.st=curvoice.cst=++nstaff,par_sy.nstaff=nstaff,par_sy.voices[t]={st:nstaff,range:t},par_sy.staves[nstaff]={stafflines:curvoice.stafflines||"|||||",staffscale:1};else if(!par_sy.voices[t])return void(curvoice.ignore=1);set_transp()}!curvoice.filtered&&par_sy.voices[t]&&(parse.voice_opts||parse.tune_v_opts)&&(curvoice.filtered=!0,voice_filter())}else syntax(1,"Cannot have V:* in tune body")}function goto_tune(){var e,t;for(set_page(),write_heading(),glovar.new_nbar?(gene.nbar=glovar.new_nbar,glovar.new_nbar=0):gene.nbar=1,voice_tb.length?curvoice=voice_tb[staves_found<0?0:par_sy.top_voice]:(get_voice("1"),curvoice.clef.istart=curvoice.key.istart,curvoice.clef.iend=curvoice.key.iend,curvoice.default=!0),e=0;e<voice_tb.length;e++)(t=voice_tb[e]).ulen=glovar.ulen,t.ckey.k_bagpipe&&!t.pos.stm&&(t.pos=clone(t.pos),t.pos.stm&=-8,t.pos.stm|=C.SL_BELOW);if(staves_found<0)for(e=voice_tb.length,par_sy.nstaff=nstaff=e-1;--e>=0;)delete(t=voice_tb[e]).new,t.st=t.cst=e,par_sy.voices[e]={st:e,range:e},par_sy.staves[e]={stafflines:t.stafflines||"|||||",staffscale:1}}function get_sym(e,t){var n,r,s,i,o;if(!curvoice.ignore){if(t){if(!(n=curvoice.sym_cont))return void syntax(1,"+: symbol line without music")}else if(curvoice.sym_restart&&(curvoice.sym_start=curvoice.sym_restart,curvoice.sym_restart=null),(n=curvoice.sym_start)||(n=curvoice.sym),!n)return void syntax(1,"s: without music");for(s=0;;){for(;" "==e[s]||"\t"==e[s];)s++;if(!(r=e[s]))break;switch(r){case"|":for(;n&&n.type!=C.BAR;)n=n.next;if(!n)return void syntax(1,"Not enough measure bars for symbol line");n=n.next,s++;continue;case"!":case'"':if(i=++s,(s=e.indexOf(r,i))<0){syntax(1,"!"==r?"No end of decoration":"No end of chord symbol/annotation"),s=e.length;continue}o=e.slice(i-1,s+1);break;case"*":break;default:if((o=r.charCodeAt(0))<128&&(o=char_tb[o]).length>1&&("!"==o[0]||'"'==o[0])){r=o[0];break}syntax(1,errs.bad_char,r)}for(;n&&n.type!=C.NOTE;)n=n.next;if(!n)return void syntax(1,"Too many elements in symbol line");switch(r){default:break;case"!":a_dcn.push(o.slice(1,-1)),deco_cnv(n,n.prev);break;case'"':parse_gchord(o),a_gch&&csan_add(n)}n=n.next,s++}curvoice.sym_cont=n}}function get_lyrics(e,t){var n,r,s,i,o,a,c,l,u,f;if(!curvoice.ignore){if((7&curvoice.pos.voc)!=C.SL_HIDDEN&&(curvoice.have_ly=!0),t){if(!(n=curvoice.lyric_cont))return void syntax(1,"+: lyric without music");c=get_font("vocal"),gene.deffont!=c&&(gene.curfont==gene.deffont&&(gene.curfont=c),gene.deffont=c)}else if(set_font("vocal"),curvoice.lyric_restart?(curvoice.lyric_start=n=curvoice.lyric_restart,curvoice.lyric_restart=null,curvoice.lyric_line=0):(curvoice.lyric_line++,n=curvoice.lyric_start),n||(n=curvoice.sym),!n)return void syntax(1,"w: without music");for(s=e,i=0,f=gene.curfont;;){for(;" "==s[i]||"\t"==s[i];)i++;if(!s[i])break;switch(l=0,o=parse.istart+i+2,s[i]){case"|":for(;n&&n.type!=C.BAR;)n=n.next;if(!n)return void syntax(1,"Not enough measure bars for lyric line");n=n.next,i++;continue;case"-":case"_":r=s[i],l=2;break;case"*":r="";break;default:for(r="";s[i];){switch(s[i]){case"_":case"*":case"|":i--;case" ":case"\t":break;case"~":r+="&#x00a0;",i++;continue;case"-":l=1;break;case"\\":if(!s[++i])continue;r+=s[i++];continue;case"$":r+=s[i++],"0"==(u=s[i])?gene.curfont=gene.deffont:u>="1"&&u<="9"&&(gene.curfont=get_font("u"+u));default:r+=s[i++];continue}break}}for(;n&&n.type!=C.NOTE;)n=n.next;if(!n)return void syntax(1,"Too many words in lyric line");r&&(7&n.pos.voc)!=C.SL_HIDDEN&&(a={t:r,font:f,istart:o,iend:o+r.length},l&&(a.ln=l),n.a_ly||(n.a_ly=[]),n.a_ly[curvoice.lyric_line]=a,f=gene.curfont),n=n.next,i++}curvoice.lyric_cont=n}}function ly_set(e){var t,n,r,s,i,o,a,c,l,u,f=e,d=0,p=0,h=0,m=0,y=e.a_ly,A=0;for(i=e.ts_next;i;i=i.ts_next){if(i.shrink&&(m+=i.shrink,h++),i.bar_type){m+=3;break}if(i.a_ly){for(t=i.a_ly.length;--t>=0&&(!(r=i.a_ly[t])||2==r.ln););if(t>=0)break}}for(t=0;t<y.length;t++)(r=y[t])&&(gene.curfont=r.font,r.t=o=str2svg(r.t),2!=r.ln?(c=cwid(" ")*r.font.swfac,a=o.wh[0]+1.5*c,e.type==C.GRACE?u=e.wl:o[0]>="0"&&o[0]<="9"&&o.length>2||":"==o[1]||"("==o[0]||")"==o[0]?("("==o[0]?l=c:(n=o.indexOf("&#x00a0;"),set_font(r.font),l=n>0?strwh(o.slice(0,n))[0]:.2*a),(u=.4*(a-=l))>14&&(u=14),u+=l,o[0]>="0"&&o[0]<="9"&&u>A&&(A=u)):(u=.4*a)>14&&(u=14),r.shift=u,u>p&&(p=u),(a-=u)>d&&(d=a)):r.shift=0);for(;!f.seqst;)f=f.ts_prev;if(f.ts_prev&&f.ts_prev.bar_type&&(p-=4),f.wl<p&&(f.shrink+=p-f.wl,f.wl=p),(m-=6)<d)for(m=(d-m)/h,s=e.ts_next;s.shrink&&(s.shrink+=m,f.wr+=m,f=s),s!=i;)s=s.ts_next;if(A>0)for(t=0;t<y.length;t++)(r=y[t])&&r.t[0]>="0"&&r.t[0]<="9"&&(r.shift=A)}function draw_lyric_line(e,t,n){var r,s,i,o,a,c,l,u,f,d;for(e.hy_st&1<<t&&(l=!0,e.hy_st&=~(1<<t)),o=e.sym;o.type==C.CLEF||o.type==C.KEY||o.type==C.METER;o=o.next);for(s=o.prev?o.prev.x:tsfirst.x,f=0;o;o=o.next)if(c=o.a_ly?o.a_ly[t]:null)c.font!=gene.curfont&&(gene.curfont=c.font),i=(r=c.t).wh[0],d=c.shift,l&&(2==c.ln&&"_"==r?r="-":2!=c.ln&&(out_hyph(s,n,o.x-d-s),l=!1,s=o.x+o.wr)),!u||2==c.ln&&"_"==r||(out_wln(s+3,n,f-s+3),u=!1,s=o.x+o.wr),2!=c.ln?(f=o.x-d,c.ln&&(l=!0),(user.anno_start||user.anno_stop)&&(a={st:o.st,istart:c.istart,iend:c.iend,x:f,y:n,ymn:n,ymx:n+gene.curfont.size,wl:0,wr:i},anno_start(a,"lyrics")),xy_str(f,n,r),anno_stop(a,"lyrics"),s=f+i):(0==f&&s>o.x-18&&(s=o.x-18),"-"==r?l=!0:u=!0,f=o.x-d);else switch(o.type){case C.REST:case C.MREST:u&&(out_wln(s+3,n,f-s),u=!1,s=o.x+o.wr)}for(l&&(l=!1,(f=realwidth-10)<s+10&&(f=s+10),out_hyph(s,n,f-s),e.s_next&&e.s_next.fmt.hyphencont&&(e.hy_st|=1<<t)),e.s_next;o;o=o.next)if(o.type==C.NOTE){if(!o.a_ly)break;(c=o.a_ly[t])&&c.ln&&"_"==c.t&&(u=!0,(f=realwidth-15)<s+12&&(f=s+12));break}u&&(out_wln(s+3,n,f-s+3),u=!1)}function draw_lyrics(e,t,n,r,s){var i,o,a=staff_tb[e.st].staffscale;if(set_font("vocal"),s>0){for(r>-tsfirst.fmt.vocalspace&&(r=-tsfirst.fmt.vocalspace),r*=a,i=0;i<t;i++)draw_lyric_line(e,i,r-=1.1*n[i]);return(r-n[i-1]/6)/a}for(r<(o=staff_tb[e.st].topbar+tsfirst.fmt.vocalspace)&&(r=o),r*=a,i=t;--i>=0;)draw_lyric_line(e,i,r),r+=1.1*n[i];return r/a}function draw_all_lyrics(){var e,t,n,r,s,i,o,a,c,l,u=new Array(nstaff+1),f=voice_tb.length,d=new Array(f),p=new Array(f),h=new Array(f),m=new Array(f),y=0,A=0,g=-1;for(n=0;n<f;n++)if((e=voice_tb[n]).sym){if(e.st!=g&&(y=0,A=0,g=e.st),r=0,e.have_ly){for(d[n]||(d[n]=[]),t=e.sym;t;t=t.next)if(c=t.a_ly){for(i=t.x,a=10,s=0;s<c.length;s++)if(l=c[s]){i-=l.shift,a=l.t.wh[0];break}for(y<(o=y_get(e.st,1,i,a))&&(y=o),A>(o=y_get(e.st,0,i,a))&&(A=o);r<c.length;)d[n][r++]=0;for(s=0;s<c.length;s++)(l=c[s])&&(!d[n][s]||l.t.wh[1]>d[n][s])&&(d[n][s]=l.t.wh[1])}}else y<(o=y_get(e.st,1,0,realwidth))&&(y=o),A>(o=y_get(e.st,0,0,realwidth))&&(A=o);u[g]||(u[g]={}),u[g].top=y,u[g].bot=A,p[n]=r,0!=r&&(e.pos.voc?h[n]=(7&e.pos.voc)==C.SL_ABOVE:voice_tb[n+1]&&voice_tb[n+1].st==g&&voice_tb[n+1].have_ly?h[n]=!0:h[n]=!1,h[n]?u[g].a=!0:u[g].b=!0)}for(s=0,n=0;n<f;n++)(e=voice_tb[n]).sym&&e.have_ly&&(h[n]?m[s++]=n:(set_dscale(g=e.st,!0),p[n]>0&&(u[g].bot=draw_lyrics(e,p[n],d[n],u[g].bot,1))));for(;--s>=0;)n=m[s],set_dscale(g=(e=voice_tb[n]).st,!0),u[g].top=draw_lyrics(e,p[n],d[n],u[g].top,-1);for(n=0;n<f;n++)if((e=voice_tb[n]).sym){if(u[g=e.st].a)for(y=u[g].top+2,t=e.sym.next;t;t=t.next)t.a_ly&&y_set(g,1,t.x-2,10,y);if(u[g].b)if(A=u[g].bot-2,p[e.v]>0)for(t=e.sym.next;t;t=t.next)t.a_ly&&y_set(g,0,t.x-2,10,A);else y_set(g,0,0,realwidth,A)}}function parse_gchord(e){var t,n,r,s,i,o,a,c,l,u=get_font("annotation"),f=u.size,d=parse.line;function p(){for(var e="";;){if(t=n[o++],"1234567890.-".indexOf(t)<0)return parseFloat(e);e+=t}}if(c=parse.bol+d.index,e.length>1)n=e.slice(1,-1),l=c+1;else{for(o=++d.index;;){if((a=d.buffer.indexOf('"',o))<0)return void syntax(1,"No end of chord symbol/annotation");if("\\"!=d.buffer[a-1])break;o=a+1}n=cnv_escape(d.buffer.slice(d.index,a)),d.index=a,l=parse.bol+d.index+1}for(u.pad&&(f+=u.pad),o=0,e="g";t=n[o];){switch(r={text:"",istart:c,iend:l,font:u},t){case"@":e=t,o++,s=p(),","!=t?(syntax(1,"',' lacking in annotation '@x,y'"),i=0):(i=p()," "!=t&&o--),r.x=s,i-=.3*f,r.y=i;break;case"^":r.pos=C.SL_ABOVE;case"_":"_"==t&&(r.pos=C.SL_BELOW);case"<":case">":o++,e=t;break;default:switch(e){case"g":r.font=get_font("gchord"),r.pos=curvoice.pos.gch||C.SL_ABOVE;break;case"^":r.pos=C.SL_ABOVE;break;case"_":r.pos=C.SL_BELOW;break;case"@":r.x=s,i-=f,r.y=i}}for(r.type=e;t=n[o];){switch(t){case"\\":if(!(t=n[++o])||"n"==t)break;r.text+="\\";default:r.text+=t,o++;continue;case"&":for(;;){switch(r.text+=t,t=n[++o]){default:continue;case";":case void 0:case"\\":}break}if(";"==t){o++,r.text+=t;continue}case";":}o++;break}r.otext=r.text,a_gch||(a_gch=[]),a_gch.push(r)}}Abc.prototype.set_bar_num=function(){var e,t,n,r,s,i,o,a=gene.nbar,c=0,l=0,u=voice_tb[cur_sy.top_voice].meter.wmeasure;for(e=tsfirst;;e=e.ts_next){if(!e)return;switch(e.type){case C.METER:u=e.wmeasure;case C.CLEF:case C.KEY:case C.STBRK:continue;case C.BAR:e.bar_num&&(a=e.bar_num)}break}for(t=e.ts_next;t;t=t.ts_next)if(t.type==C.BAR&&t.time){t.time<u&&(c=(e=t).time);break}for(;e;e=e.ts_next)switch(e.type){case C.METER:if(e.time==c)break;1!=u&&(a+=(e.time-c)/u),c=e.time,u=e.wmeasure;break;case C.BAR:if(e.invis)break;if(e.time!=n&&(o=0),n=e.time,o&(s=e.text?1:2))break;if(o|=s,e.bar_num){a=e.bar_num,l=c=n;continue}if(1==u){if(e.bar_dotted)continue;e.text&&(cfmt.contbarnb||("1"==e.text[0]?r=a:a=r)),e.bar_num=++a;continue}s=(i=a+(n-c)/u)-(0|i),cfmt.checkbars&&(s&&!e.bar_dotted&&e.next||n>l+u&&e.prev.type!=C.MREST)&&error(0,e,"Bad measure duration"),n>l+u&&(s=0,c=n,a=i|=0),e.text?"1"==e.text[0]?(r=cfmt.contbarnb?c+s*u:n,s||(e.bar_num=i)):(cfmt.contbarnb?c=r:c+=n-r,(i=a+(n-c)/u)==(0|i)&&(e.bar_num=i)):(s&&(i-=s),e.bar_num=i),s||(l=n)}},Abc.prototype.do_pscom=function(e){var t,n,r,s,i,o,a,c;if(s=e.match(/[^\s]+/)){if(s=s[0],curvoice&&curvoice.ignore)switch(s){case"staves":case"score":break;default:return}if(" lock"==(i=e.replace(s,"").trim()).slice(-5))fmt_lock[s]=!0,i=i.slice(0,-5).trim();else if(fmt_lock[s])return;switch(s){case"clef":return void(parse.state>=2&&(r=new_clef(i))&&get_clef(r));case"deco":return void deco_add(i);case"linebreak":return void set_linebreak(i);case"map":return void get_map(i);case"maxsysstaffsep":case"sysstaffsep":if(3==parse.state)return n=get_unit(i),isNaN(n)?void syntax(1,errs.bad_val,"%%"+s):void(par_sy.voices[curvoice.v]["m"==s[0]?"maxsep":"sep"]=n);break;case"multicol":if(parse.state>=2){curvoice=voice_tb[0],r=new_block("mc_"+i);break}switch(i){case"start":multicol={maxy:0,lmarg:cfmt.leftmargin,rmarg:cfmt.rightmargin};break;case"new":if(!multicol){syntax(1,"%%multicol new without start");break}posy>multicol.maxy&&(multicol.maxy=posy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,img.chg=!0,set_page(),posy=0;break;case"end":if(!multicol){syntax(1,"%%multicol end without start");break}posy<multicol.maxy&&(posy=multicol.maxy),cfmt.leftmargin=multicol.lmarg,cfmt.rightmargin=multicol.rmarg,multicol=void 0,blk_flush(),img.chg=!0,set_page();break;default:syntax(1,"Unknown keyword '$1' in %%multicol",i)}return;case"ottava":if(3!=parse.state)return;return o=parseInt(i),isNaN(o)||o<-2||o>2?void syntax(1,errs.bad_val,"%%ottava"):(glovar.ottava=!0,void parse.ottava.push(o));case"repbra":return void(curvoice&&(curvoice.norepbra=!get_bool(i)));case"repeat":if(3!=parse.state)return;if(!curvoice.last_sym)return void syntax(1,"%%repeat cannot start a tune");if(i.length){if(c=i.split(/\s+/),o=parseInt(c[0]),a=parseInt(c[1]),isNaN(o)||o<1||curvoice.last_sym.type==C.BAR&&o>2)return void syntax(1,"Incorrect 1st value in %%repeat");if(isNaN(a))a=1;else if(a<1)return void syntax(1,"Incorrect 2nd value in %%repeat")}else o=1,a=1;return parse.repeat_n=curvoice.last_sym.type==C.BAR?o:-o,void(parse.repeat_k=a);case"sep":var l,u,f,d;return set_page(),d=img.width-img.lm-img.rm,t=l=u=0,i&&(t=get_unit((f=i.split(/\s+/))[0]),f[1]&&(l=get_unit(f[1]),f[2]&&(u=get_unit(f[2]))),isNaN(t)||isNaN(l)||isNaN(u))?void syntax(1,errs.bad_val,"%%sep"):(t<1&&(t=14),l<1&&(l=t),u<1&&(u=90),parse.state>=2?((r=new_block(s)).x=(d-u)/2/cfmt.scale,r.l=u/cfmt.scale,r.sk1=t,void(r.sk2=l)):(vskip(t),output+='<path class="stroke"\n\td="M',out_sxsy((d-u)/2/cfmt.scale," ",0),output+="h"+(u/cfmt.scale).toFixed(1)+'"/>\n',vskip(l),void blk_flush()));case"setbarnb":if(n=parseInt(i),isNaN(n)||n<1){syntax(1,"Bad %%setbarnb value");break}return void(glovar.new_nbar=n);case"staff":if(3!=parse.state)return;return n=parseInt(i),isNaN(n)?void syntax(1,"Bad %%staff value '$1'",i):(p="+"==i[0]||"-"==i[0]?curvoice.cst+n:n-1)<0||p>nstaff?void syntax(1,"Bad %%staff number $1 (cur $2, max $3)",p,curvoice.cst,nstaff):(delete curvoice.floating,void(curvoice.cst=p));var p;case"staffbreak":if(3!=parse.state)return;if(r={type:C.STBRK,dur:0},"f"==i.slice(-1)&&(r.stbrk_forced=!0,i=i.replace(/\sf$/,"")),i){if(n=get_unit(i),isNaN(n))return void syntax(1,errs.bad_val,"%%staffbreak");r.xmx=n}else r.xmx=14;return void sym_link(r);case"stafflines":case"staffscale":case"staffnonote":return void set_v_param(s,i);case"staves":case"score":if(!parse.state)return;return parse.scores&&parse.scores.length>0&&(i=(s=(e=parse.scores.shift()).match(/([^\s]+)\s*(.*)/))[2],s=s[1]),void get_staves(s,i);case"center":case"text":return a="c"==s[0]?"c":cfmt.textoption,set_font("text"),parse.state>=2?((r=new_block("text")).text=i,r.opt=a,void(r.font=cfmt.textfont)):void write_text(i,a);case"transpose":if(cfmt.sound)return;if(null==(n=get_transp(i))&&null==(n=get_interval(i)))return;switch(parse.state){case 0:cfmt.transp=0;case 1:return void(cfmt.transp=(cfmt.transp||0)+n)}for(r=curvoice.last_sym;r;r=r.prev){switch(r.type){case C.NOTE:(r=clone(curvoice.okey)).k_old_sf=curvoice.ckey.k_sf,sym_link(r);break;case C.KEY:break;default:continue}break}return curvoice.transp=n,void set_transp();case"tune":return;case"user":return void set_user(i);case"voicecolor":return void(curvoice&&(curvoice.color=i));case"vskip":return n=get_unit(i),isNaN(n)?void syntax(1,errs.bad_val,"%%vskip"):n<0?void syntax(1,"%%vskip cannot be negative"):parse.state>=2?void((r=new_block(s)).sk=n):void vskip(n);case"newpage":case"leftmargin":case"rightmargin":case"pagescale":case"pagewidth":case"printmargin":case"scale":case"staffwidth":if(parse.state>=2)return void((r=new_block(s)).param=i);if("newpage"==s)return blk_flush(),void(user.page_format&&(blkdiv=2))}self.set_format(s,i)}},Abc.prototype.do_begin_end=function(e,t,n){var r,s,i,o;switch(e){case"js":js_inject(n);break;case"ml":if(cfmt.pageheight){syntax(1,"Cannot have %%beginml with %%pageheight");break}parse.state>=2?(o=new_block(e)).text=n:(blk_flush(),user.img_out&&user.img_out(n));break;case"svg":for(s=0;!((r=n.indexOf("<style",s))<0);){if(r=n.indexOf(">",r),(s=n.indexOf("</style>",r))<0){syntax(1,"No </style> in %%beginsvg sequence");break}style+=n.slice(r+1,s).replace(/\s+$/,"")}for(s=0;!((r=n.indexOf("<defs>\n",s))<0);){if((s=n.indexOf("</defs>",r))<0){syntax(1,"No </defs> in %%beginsvg sequence");break}defs_add(n.slice(r+6,s))}break;case"text":if((i=get_textopt(t))||(i=cfmt.textoption),set_font("text"),n.indexOf("\\")>=0&&(n=cnv_escape(n)),parse.state>1){(o=new_block(e)).text=n,o.opt=i,o.font=cfmt.textfont;break}write_text(n,i)}};var note_names="CDEFGAB",acc_name=["bb","b","","#","##"],hook_init;function gch_tr1(e,t){var n,r,s,i,o,a,c=e.split("/");for(n=0;n<c.length;n++)if(!((r=(e=c[n]).search(/[A-G]/))<0)){for(o=r+1,i=0;"#"==e[o]||"♯"==e[o];)i++,o++;for(;"b"==e[o]||"♭"==e[o];)i--,o++;s=note_names.indexOf(e[r])+16,a=(abc2svg.pab40(s,i)+t+200)%40,a=abc2svg.b40k[a],c[n]=e.slice(0,r)+note_names[abc2svg.b40_p[a]]+acc_name[abc2svg.b40_a[a]+2]+e.slice(o)}return c.join("/")}function gch_transp(e,t){for(var n,r=e.a_gch.length;--r>=0;)"g"==(n=e.a_gch[r]).type&&(n.text=gch_tr1(n.text,t.k_transp))}function csan_add(e){var t;if(e.type==C.BAR)for(t=0;t<a_gch.length;t++)"g"==a_gch[t].type&&(syntax(1,"There cannot be chord symbols on measure bars"),a_gch.splice(t));e.a_gch?e.a_gch=e.a_gch.concat(a_gch):e.a_gch=a_gch,a_gch=null}function draw_all_chsy(){var e,t,n,r,s,i,o=0,a=new Array(nstaff+1);function c(e){var n,r,s,i,o,c;for(s=t;s;s=s.ts_next)if((n=s.a_gch)&&(n=n[r=n.length-e-1])){if(n.pos==C.SL_ABOVE)i=s.x+n.x,(c=n.text.wh[0])&&i+c>realwidth&&(i=realwidth-c),o=y_get(s.st,1,i,c),"g"==n.type&&o<a[s.st].yup&&(o=a[s.st].yup);else{if(n.pos==C.SL_BELOW||n.pos==C.SL_HIDDEN)continue;i=s.x+n.x,o=n.y}self.draw_gchord(r,s,i,o)}}function l(e){for(var n,r,s,i,o=t;o;o=o.ts_next)(n=o.a_gch)&&(n=n[e])&&n.pos==C.SL_BELOW&&(r=o.x+n.x,(i=n.text.wh[0])&&r+i>realwidth&&(r=realwidth-i),s=y_get(o.st,0,r,i),"g"==n.type&&s>a[o.st].ydn&&(s=a[o.st].ydn),self.draw_gchord(e,o,r,s))}for(r=0;r<=nstaff;r++)a[r]={ydn:staff_tb[r].botbar-3,yup:staff_tb[r].topbar+4};for(e=tsfirst;e;e=e.ts_next)if(n=e.a_gch)for(t||(t=e),(r=n.length)>o&&(o=r);--r>=0;)if("g"==n[r].type){i=(n=n[r]).text.wh[0],n.pos==C.SL_ABOVE?(s=y_get(e.st,!0,e.x,i))>a[e.st].yup&&(a[e.st].yup=s):n.pos==C.SL_BELOW&&(s=y_get(e.st,!1,e.x,i))<a[e.st].ydn&&(a[e.st].ydn=s);break}if(t)for(set_dscale(-1),r=0;r<o;r++)c(r),l(r)}function set_hooks(){var e=abc2svg.modules.hooks,t=abc2svg.modules.g_hooks;function n(e){for(var t=0;t<e.length;t++)e[t](self)}hook_init?e.length&&(n(e),t.push.apply(t,e),abc2svg.modules.hooks=[]):(e.length&&(t.push.apply(t,e),abc2svg.modules.hooks=[]),n(t),hook_init=!0)}Abc.prototype.gch_build=function(e){var t,n,r,s,i=0,o=0;for(s=0;s<e.a_gch.length;s++){if("g"==(t=e.a_gch[s]).type)t.text=t.text.replace(/##|#|=|bb|b/g,(function(e){switch(e){case"##":return"&#x1d12a;";case"#":return"♯";case"=":return"♮";case"b":return"♭"}return"&#x1d12b;"}));else if("@"==t.type&&!user.anno_start&&!user.anno_stop){set_font(t.font),t.text=str2svg(t.text),t.text.wh=[0,0];continue}switch(set_font(t.font),t.text=str2svg(t.text),(n=t.text.wh)[1]+=2*t.font.pad,t.type){case"@":break;case"^":case"_":default:(r=.4*n[0])>8&&(r=8),t.x=-r;break;case"<":t.x=-(n[0]+6),i-=n[1],t.y=i+n[1]/2;break;case">":t.x=6,o-=n[1],t.y=o+n[1]/2}}for(i/=2,o/=2,s=0;s<e.a_gch.length;s++)switch((t=e.a_gch[s]).type){case"<":t.y-=i;break;case">":t.y-=o}},Abc.prototype.draw_gchord=function(e,t,n,r){if(!t.invis||!t.play){var s,i=t.a_gch[e],o=i.text.wh[1],a=i.font.pad,c=i.text.wh[0]+2*a,l=0;switch(i.font.figb&&(o*=2.4,l=1.3*i.font.size),i.type){case"_":r-=o+a,y_set(t.st,0,n,c,r-a);break;case"^":r=y_get(t.st,1,n,c),r+=a,y_set(t.st,1,n,c,r+o+a);break;case"<":case">":"<"==i.type?(t.notes[0].acc&&(n-=t.notes[0].shac),n-=a):(t.xmx&&(n+=t.xmx),t.dots&&(n+=1.5+3.5*t.dots),n+=a),(r+=(t.type==C.NOTE?3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18):12)-o/2)>24&&y_set(t.st,1,n,c,r+o+a),r<0&&y_set(t.st,0,n,c,r-a);break;default:r>=0?(r+=a,y_set(t.st,1,n,c,r+o+a)):(r-=o+a,y_set(t.st,0,n,c,r-a));break;case"@":(r+=(t.type==C.NOTE?3*((t.notes[t.nhd].pit+t.notes[0].pit>>1)-18):12)+.2*o)>0?(s=r+.8*o)>staff_tb[t.st].ann_top&&(staff_tb[t.st].ann_top=s):(s=r)<staff_tb[t.st].ann_bot&&(staff_tb[t.st].ann_bot=s)}use_font(i.font),set_font(i.font),set_dscale(t.st),user.anno_start&&user.anno_start("annot",i.istart,i.iend,n-2,r+o+2,c+4,o+4,t),xy_str(n,r+l,i.text),user.anno_stop&&user.anno_stop("annot",i.istart,i.iend,n-2,r+o+2,c+4,o+4,t)}},init_tune(),Abc.prototype.a_de=function(){return a_de},Abc.prototype.add_style=function(e){style+=e},Abc.prototype.cfmt=function(){return cfmt},Abc.prototype.clone=clone,Abc.prototype.deco_put=function(e,t){a_dcn.push(e),deco_cnv(t)},Abc.prototype.defs_add=defs_add,Abc.prototype.dh_put=function(e,t,n){a_dcn.push(e),dh_cnv(t,n)},Abc.prototype.draw_meter=draw_meter,Abc.prototype.draw_note=draw_note,Abc.prototype.errs=errs,Abc.prototype.font_class=font_class,Abc.prototype.gch_tr1=gch_tr1,Abc.prototype.get_bool=get_bool,Abc.prototype.get_cur_sy=function(){return cur_sy},Abc.prototype.get_curvoice=function(){return curvoice},Abc.prototype.get_delta_tb=function(){return delta_tb},Abc.prototype.get_decos=function(){return decos},Abc.prototype.get_font=get_font,Abc.prototype.get_font_style=function(){return font_style},Abc.prototype.get_glyphs=function(){return glyphs},Abc.prototype.get_img=function(){return img},Abc.prototype.get_maps=function(){return maps},Abc.prototype.get_multi=function(){return multicol},Abc.prototype.get_newpage=function(){if(block.newpage)return block.newpage=!1,!0},Abc.prototype.get_posy=function(){return posy},Abc.prototype.get_staff_tb=function(){return staff_tb},Abc.prototype.get_top_v=function(){return par_sy.top_voice},Abc.prototype.get_tsfirst=function(){return tsfirst},Abc.prototype.get_unit=get_unit,Abc.prototype.get_voice_tb=function(){return voice_tb},Abc.prototype.glout=glout,Abc.prototype.info=function(){return info},Abc.prototype.new_block=new_block,Abc.prototype.out_arp=out_arp,Abc.prototype.out_deco_str=out_deco_str,Abc.prototype.out_deco_val=out_deco_val,Abc.prototype.out_ltr=out_ltr,Abc.prototype.param_set_font=param_set_font,Abc.prototype.parse=parse,Abc.prototype.psdeco=empty_function,Abc.prototype.psxygl=empty_function,Abc.prototype.set_cur_sy=function(e){cur_sy=e},Abc.prototype.set_dscale=set_dscale,Abc.prototype.set_font=set_font,Abc.prototype.set_a_gch=function(e,t){a_gch=t,csan_add(e)},Abc.prototype.set_hl=set_hl,Abc.prototype.set_pagef=function(){blkdiv=1},Abc.prototype.set_realwidth=function(e){realwidth=e},Abc.prototype.set_scale=set_scale,Abc.prototype.set_sscale=set_sscale,Abc.prototype.set_tsfirst=function(e){tsfirst=e},Abc.prototype.set_v_param=set_v_param,Abc.prototype.strwh=strwh,Abc.prototype.stv_g=function(){return stv_g},Abc.prototype.svg_flush=svg_flush,Abc.prototype.syntax=syntax,Abc.prototype.tunes=tunes,Abc.prototype.unlksym=unlksym,Abc.prototype.use_font=use_font,Abc.prototype.vskip=vskip,Abc.prototype.xy_str=xy_str,Abc.prototype.xygl=xygl};var Abc=abc2svg.Abc;__webpack_unused_export__=abc2svg,exports.l=Abc,abc2svg.loadjs||(abc2svg.loadjs=function(e,t,n){n&&n(e)}),abc2svg.modules={ambitus:{},begingrid:{fn:"grid3"},beginps:{fn:"psvg"},break:{},capo:{},chordnames:{},clip:{},clairnote:{fn:"clair"},voicecombine:{fn:"combine"},diagram:{fn:"diag"},equalbars:{},gamelan:{},grid:{},grid2:{},jazzchord:{},jianpu:{},mdnn:{},MIDI:{},nns:{},pageheight:{fn:"page"},pedline:{},percmap:{fn:"perc"},roman:{},soloffs:{},sth:{},strtab:{},temperament:{fn:"temper"},nreq:0,hooks:[],g_hooks:[],load:function(e,t,n){function r(){0==--abc2svg.modules.nreq&&abc2svg.modules.cbf()}var s,i,o,a=this.nreq,c=e.match(/(^|\n)(%%|I:).+?\b/g);if(!c)return!0;for(this.cbf=t||function(){},this.errmsg=n||("object"==typeof user&&user.errmsg?user.errmsg:"function"==typeof abc2svg.printErr?abc2svg.printErr:"function"==typeof alert?function(e){alert(e)}:"object"==typeof console?console.log:function(){}),i=0;i<c.length;i++)o=c[i].replace(/\n?(%%|I:)/,""),(s=abc2svg.modules[o])&&!s.loaded&&(s.loaded=!0,s.fn&&(o=s.fn),this.nreq++,abc2svg.loadjs(o+"-1.js",r,(function(){abc2svg.modules.errmsg("Error loading the module "+o),r()})));return this.nreq==a}},abc2svg.version="1.22.1",abc2svg.vdate="2022-09-13"},543:function(e,t,n){var r;e=n.nmd(e),function(){var s,i="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",c=16,l=32,u=64,f=128,d=256,p=1/0,h=9007199254740991,m=NaN,y=4294967295,A=[["ary",f],["bind",1],["bindKey",2],["curry",8],["curryRight",c],["flip",512],["partial",l],["partialRight",u],["rearg",d]],g="[object Arguments]",v="[object Array]",_="[object Boolean]",b="[object Date]",w="[object Error]",x="[object Function]",k="[object GeneratorFunction]",E="[object Map]",C="[object Number]",B="[object Object]",M="[object Promise]",I="[object RegExp]",N="[object Set]",T="[object String]",S="[object Symbol]",O="[object WeakMap]",F="[object ArrayBuffer]",R="[object DataView]",D="[object Float32Array]",U="[object Float64Array]",L="[object Int8Array]",$="[object Int16Array]",Q="[object Int32Array]",j="[object Uint8Array]",P="[object Uint8ClampedArray]",Y="[object Uint16Array]",z="[object Uint32Array]",V=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,G=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,J=RegExp(q.source),K=RegExp(W.source),X=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,se=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(se.source),oe=/^\s+/,ae=/\s/,ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,le=/\{\n\/\* \[wrapped with (.+)\] \*/,ue=/,? & /,fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,me=/\w*$/,ye=/^[-+]0x[0-9a-f]+$/i,Ae=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,xe=/['\n\r\u2028\u2029\\]/g,ke="\\ud800-\\udfff",Ee="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ce="\\u2700-\\u27bf",Be="a-z\\xdf-\\xf6\\xf8-\\xff",Me="A-Z\\xc0-\\xd6\\xd8-\\xde",Ie="\\ufe0e\\ufe0f",Ne="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Te="['’]",Se="["+ke+"]",Oe="["+Ne+"]",Fe="["+Ee+"]",Re="\\d+",De="["+Ce+"]",Ue="["+Be+"]",Le="[^"+ke+Ne+Re+Ce+Be+Me+"]",$e="\\ud83c[\\udffb-\\udfff]",Qe="[^"+ke+"]",je="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ye="["+Me+"]",ze="\\u200d",Ve="(?:"+Ue+"|"+Le+")",He="(?:"+Ye+"|"+Le+")",Ge="(?:['’](?:d|ll|m|re|s|t|ve))?",qe="(?:['’](?:D|LL|M|RE|S|T|VE))?",We="(?:"+Fe+"|"+$e+")"+"?",Je="["+Ie+"]?",Ke=Je+We+("(?:"+ze+"(?:"+[Qe,je,Pe].join("|")+")"+Je+We+")*"),Xe="(?:"+[De,je,Pe].join("|")+")"+Ke,Ze="(?:"+[Qe+Fe+"?",Fe,je,Pe,Se].join("|")+")",et=RegExp(Te,"g"),tt=RegExp(Fe,"g"),nt=RegExp($e+"(?="+$e+")|"+Ze+Ke,"g"),rt=RegExp([Ye+"?"+Ue+"+"+Ge+"(?="+[Oe,Ye,"$"].join("|")+")",He+"+"+qe+"(?="+[Oe,Ye+Ve,"$"].join("|")+")",Ye+"?"+Ve+"+"+Ge,Ye+"+"+qe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Re,Xe].join("|"),"g"),st=RegExp("["+ze+ke+Ee+Ie+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ot=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,ct={};ct[D]=ct[U]=ct[L]=ct[$]=ct[Q]=ct[j]=ct[P]=ct[Y]=ct[z]=!0,ct[g]=ct[v]=ct[F]=ct[_]=ct[R]=ct[b]=ct[w]=ct[x]=ct[E]=ct[C]=ct[B]=ct[I]=ct[N]=ct[T]=ct[O]=!1;var lt={};lt[g]=lt[v]=lt[F]=lt[R]=lt[_]=lt[b]=lt[D]=lt[U]=lt[L]=lt[$]=lt[Q]=lt[E]=lt[C]=lt[B]=lt[I]=lt[N]=lt[T]=lt[S]=lt[j]=lt[P]=lt[Y]=lt[z]=!0,lt[w]=lt[x]=lt[O]=!1;var ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ft=parseFloat,dt=parseInt,pt="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ht="object"==typeof self&&self&&self.Object===Object&&self,mt=pt||ht||Function("return this")(),yt=t&&!t.nodeType&&t,At=yt&&e&&!e.nodeType&&e,gt=At&&At.exports===yt,vt=gt&&pt.process,_t=function(){try{var e=At&&At.require&&At.require("util").types;return e||vt&&vt.binding&&vt.binding("util")}catch(e){}}(),bt=_t&&_t.isArrayBuffer,wt=_t&&_t.isDate,xt=_t&&_t.isMap,kt=_t&&_t.isRegExp,Et=_t&&_t.isSet,Ct=_t&&_t.isTypedArray;function Bt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Mt(e,t,n,r){for(var s=-1,i=null==e?0:e.length;++s<i;){var o=e[s];t(r,o,n(o),e)}return r}function It(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Nt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function St(e,t){for(var n=-1,r=null==e?0:e.length,s=0,i=[];++n<r;){var o=e[n];t(o,n,e)&&(i[s++]=o)}return i}function Ot(e,t){return!!(null==e?0:e.length)&&Yt(e,t,0)>-1}function Ft(e,t,n){for(var r=-1,s=null==e?0:e.length;++r<s;)if(n(t,e[r]))return!0;return!1}function Rt(e,t){for(var n=-1,r=null==e?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}function Dt(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function Ut(e,t,n,r){var s=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++s]);++s<i;)n=t(n,e[s],s,e);return n}function Lt(e,t,n,r){var s=null==e?0:e.length;for(r&&s&&(n=e[--s]);s--;)n=t(n,e[s],s,e);return n}function $t(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Qt=Gt("length");function jt(e,t,n){var r;return n(e,(function(e,n,s){if(t(e,n,s))return r=n,!1})),r}function Pt(e,t,n,r){for(var s=e.length,i=n+(r?1:-1);r?i--:++i<s;)if(t(e[i],i,e))return i;return-1}function Yt(e,t,n){return t==t?function(e,t,n){var r=n-1,s=e.length;for(;++r<s;)if(e[r]===t)return r;return-1}(e,t,n):Pt(e,Vt,n)}function zt(e,t,n,r){for(var s=n-1,i=e.length;++s<i;)if(r(e[s],t))return s;return-1}function Vt(e){return e!=e}function Ht(e,t){var n=null==e?0:e.length;return n?Jt(e,t)/n:m}function Gt(e){return function(t){return null==t?s:t[e]}}function qt(e){return function(t){return null==e?s:e[t]}}function Wt(e,t,n,r,s){return s(e,(function(e,s,i){n=r?(r=!1,e):t(n,e,s,i)})),n}function Jt(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==s&&(n=n===s?o:n+o)}return n}function Kt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Xt(e){return e?e.slice(0,yn(e)+1).replace(oe,""):e}function Zt(e){return function(t){return e(t)}}function en(e,t){return Rt(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&Yt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&Yt(t,e[n],0)>-1;);return n}var sn=qt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),on=qt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(e){return"\\"+ut[e]}function cn(e){return st.test(e)}function ln(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function un(e,t){return function(n){return e(t(n))}}function fn(e,t){for(var n=-1,r=e.length,s=0,i=[];++n<r;){var o=e[n];o!==t&&o!==a||(e[n]=a,i[s++]=n)}return i}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function pn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function hn(e){return cn(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):Qt(e)}function mn(e){return cn(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function yn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var An=qt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gn=function e(t){var n,r=(t=null==t?mt:gn.defaults(mt.Object(),t,gn.pick(mt,ot))).Array,ae=t.Date,ke=t.Error,Ee=t.Function,Ce=t.Math,Be=t.Object,Me=t.RegExp,Ie=t.String,Ne=t.TypeError,Te=r.prototype,Se=Ee.prototype,Oe=Be.prototype,Fe=t["__core-js_shared__"],Re=Se.toString,De=Oe.hasOwnProperty,Ue=0,Le=(n=/[^.]+$/.exec(Fe&&Fe.keys&&Fe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",$e=Oe.toString,Qe=Re.call(Be),je=mt._,Pe=Me("^"+Re.call(De).replace(se,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ye=gt?t.Buffer:s,ze=t.Symbol,Ve=t.Uint8Array,He=Ye?Ye.allocUnsafe:s,Ge=un(Be.getPrototypeOf,Be),qe=Be.create,We=Oe.propertyIsEnumerable,Je=Te.splice,Ke=ze?ze.isConcatSpreadable:s,Xe=ze?ze.iterator:s,Ze=ze?ze.toStringTag:s,nt=function(){try{var e=di(Be,"defineProperty");return e({},"",{}),e}catch(e){}}(),st=t.clearTimeout!==mt.clearTimeout&&t.clearTimeout,ut=ae&&ae.now!==mt.Date.now&&ae.now,pt=t.setTimeout!==mt.setTimeout&&t.setTimeout,ht=Ce.ceil,yt=Ce.floor,At=Be.getOwnPropertySymbols,vt=Ye?Ye.isBuffer:s,_t=t.isFinite,Qt=Te.join,qt=un(Be.keys,Be),vn=Ce.max,_n=Ce.min,bn=ae.now,wn=t.parseInt,xn=Ce.random,kn=Te.reverse,En=di(t,"DataView"),Cn=di(t,"Map"),Bn=di(t,"Promise"),Mn=di(t,"Set"),In=di(t,"WeakMap"),Nn=di(Be,"create"),Tn=In&&new In,Sn={},On=Li(En),Fn=Li(Cn),Rn=Li(Bn),Dn=Li(Mn),Un=Li(In),Ln=ze?ze.prototype:s,$n=Ln?Ln.valueOf:s,Qn=Ln?Ln.toString:s;function jn(e){if(na(e)&&!Vo(e)&&!(e instanceof Vn)){if(e instanceof zn)return e;if(De.call(e,"__wrapped__"))return $i(e)}return new zn(e)}var Pn=function(){function e(){}return function(t){if(!ta(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=s,n}}();function Yn(){}function zn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=s}function Vn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=y,this.__views__=[]}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new qn;++t<n;)this.add(e[t])}function Jn(e){var t=this.__data__=new Gn(e);this.size=t.size}function Kn(e,t){var n=Vo(e),r=!n&&zo(e),s=!n&&!r&&Wo(e),i=!n&&!r&&!s&&ua(e),o=n||r||s||i,a=o?Kt(e.length,Ie):[],c=a.length;for(var l in e)!t&&!De.call(e,l)||o&&("length"==l||s&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||vi(l,c))||a.push(l);return a}function Xn(e){var t=e.length;return t?e[Wr(0,t-1)]:s}function Zn(e,t){return Ri(Ns(e),cr(t,0,e.length))}function er(e){return Ri(Ns(e))}function tr(e,t,n){(n!==s&&!jo(e[t],n)||n===s&&!(t in e))&&or(e,t,n)}function nr(e,t,n){var r=e[t];De.call(e,t)&&jo(r,n)&&(n!==s||t in e)||or(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(jo(e[n][0],t))return n;return-1}function sr(e,t,n,r){return pr(e,(function(e,s,i){t(r,e,n(e),i)})),r}function ir(e,t){return e&&Ts(t,Sa(t),e)}function or(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var n=-1,i=t.length,o=r(i),a=null==e;++n<i;)o[n]=a?s:Ba(e,t[n]);return o}function cr(e,t,n){return e==e&&(n!==s&&(e=e<=n?e:n),t!==s&&(e=e>=t?e:t)),e}function lr(e,t,n,r,i,o){var a,c=1&t,l=2&t,u=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),a!==s)return a;if(!ta(e))return e;var f=Vo(e);if(f){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&De.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Ns(e,a)}else{var d=mi(e),p=d==x||d==k;if(Wo(e))return ks(e,c);if(d==B||d==g||p&&!i){if(a=l||p?{}:Ai(e),!c)return l?function(e,t){return Ts(e,hi(e),t)}(e,function(e,t){return e&&Ts(t,Oa(t),e)}(a,e)):function(e,t){return Ts(e,pi(e),t)}(e,ir(a,e))}else{if(!lt[d])return i?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case F:return Es(e);case _:case b:return new r(+e);case R:return function(e,t){var n=t?Es(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case D:case U:case L:case $:case Q:case j:case P:case Y:case z:return Cs(e,n);case E:return new r;case C:case T:return new r(e);case I:return function(e){var t=new e.constructor(e.source,me.exec(e));return t.lastIndex=e.lastIndex,t}(e);case N:return new r;case S:return s=e,$n?Be($n.call(s)):{}}var s}(e,d,c)}}o||(o=new Jn);var h=o.get(e);if(h)return h;o.set(e,a),aa(e)?e.forEach((function(r){a.add(lr(r,t,n,r,e,o))})):ra(e)&&e.forEach((function(r,s){a.set(s,lr(r,t,n,s,e,o))}));var m=f?s:(u?l?ii:si:l?Oa:Sa)(e);return It(m||e,(function(r,s){m&&(r=e[s=r]),nr(a,s,lr(r,t,n,s,e,o))})),a}function ur(e,t,n){var r=n.length;if(null==e)return!r;for(e=Be(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===s&&!(i in e)||!o(a))return!1}return!0}function fr(e,t,n){if("function"!=typeof e)throw new Ne(i);return Ti((function(){e.apply(s,n)}),t)}function dr(e,t,n,r){var s=-1,i=Ot,o=!0,a=e.length,c=[],l=t.length;if(!a)return c;n&&(t=Rt(t,Zt(n))),r?(i=Ft,o=!1):t.length>=200&&(i=tn,o=!1,t=new Wn(t));e:for(;++s<a;){var u=e[s],f=null==n?u:n(u);if(u=r||0!==u?u:0,o&&f==f){for(var d=l;d--;)if(t[d]===f)continue e;c.push(u)}else i(t,f,r)||c.push(u)}return c}jn.templateSettings={escape:X,evaluate:Z,interpolate:ee,variable:"",imports:{_:jn}},jn.prototype=Yn.prototype,jn.prototype.constructor=jn,zn.prototype=Pn(Yn.prototype),zn.prototype.constructor=zn,Vn.prototype=Pn(Yn.prototype),Vn.prototype.constructor=Vn,Hn.prototype.clear=function(){this.__data__=Nn?Nn(null):{},this.size=0},Hn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hn.prototype.get=function(e){var t=this.__data__;if(Nn){var n=t[e];return n===o?s:n}return De.call(t,e)?t[e]:s},Hn.prototype.has=function(e){var t=this.__data__;return Nn?t[e]!==s:De.call(t,e)},Hn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Nn&&t===s?o:t,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Je.call(t,n,1),--this.size,!0)},Gn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?s:t[n][1]},Gn.prototype.has=function(e){return rr(this.__data__,e)>-1},Gn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(Cn||Gn),string:new Hn}},qn.prototype.delete=function(e){var t=ui(this,e).delete(e);return this.size-=t?1:0,t},qn.prototype.get=function(e){return ui(this,e).get(e)},qn.prototype.has=function(e){return ui(this,e).has(e)},qn.prototype.set=function(e,t){var n=ui(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Wn.prototype.add=Wn.prototype.push=function(e){return this.__data__.set(e,o),this},Wn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.clear=function(){this.__data__=new Gn,this.size=0},Jn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Jn.prototype.get=function(e){return this.__data__.get(e)},Jn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!Cn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(e,t),this.size=n.size,this};var pr=Fs(br),hr=Fs(wr,!0);function mr(e,t){var n=!0;return pr(e,(function(e,r,s){return n=!!t(e,r,s)})),n}function yr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(c===s?a==a&&!la(a):n(a,c)))var c=a,l=o}return l}function Ar(e,t){var n=[];return pr(e,(function(e,r,s){t(e,r,s)&&n.push(e)})),n}function gr(e,t,n,r,s){var i=-1,o=e.length;for(n||(n=gi),s||(s=[]);++i<o;){var a=e[i];t>0&&n(a)?t>1?gr(a,t-1,n,r,s):Dt(s,a):r||(s[s.length]=a)}return s}var vr=Rs(),_r=Rs(!0);function br(e,t){return e&&vr(e,t,Sa)}function wr(e,t){return e&&_r(e,t,Sa)}function xr(e,t){return St(t,(function(t){return Xo(e[t])}))}function kr(e,t){for(var n=0,r=(t=_s(t,e)).length;null!=e&&n<r;)e=e[Ui(t[n++])];return n&&n==r?e:s}function Er(e,t,n){var r=t(e);return Vo(e)?r:Dt(r,n(e))}function Cr(e){return null==e?e===s?"[object Undefined]":"[object Null]":Ze&&Ze in Be(e)?function(e){var t=De.call(e,Ze),n=e[Ze];try{e[Ze]=s;var r=!0}catch(e){}var i=$e.call(e);r&&(t?e[Ze]=n:delete e[Ze]);return i}(e):function(e){return $e.call(e)}(e)}function Br(e,t){return e>t}function Mr(e,t){return null!=e&&De.call(e,t)}function Ir(e,t){return null!=e&&t in Be(e)}function Nr(e,t,n){for(var i=n?Ft:Ot,o=e[0].length,a=e.length,c=a,l=r(a),u=1/0,f=[];c--;){var d=e[c];c&&t&&(d=Rt(d,Zt(t))),u=_n(d.length,u),l[c]=!n&&(t||o>=120&&d.length>=120)?new Wn(c&&d):s}d=e[0];var p=-1,h=l[0];e:for(;++p<o&&f.length<u;){var m=d[p],y=t?t(m):m;if(m=n||0!==m?m:0,!(h?tn(h,y):i(f,y,n))){for(c=a;--c;){var A=l[c];if(!(A?tn(A,y):i(e[c],y,n)))continue e}h&&h.push(y),f.push(m)}}return f}function Tr(e,t,n){var r=null==(e=Mi(e,t=_s(t,e)))?e:e[Ui(Ji(t))];return null==r?s:Bt(r,e,n)}function Sr(e){return na(e)&&Cr(e)==g}function Or(e,t,n,r,i){return e===t||(null==e||null==t||!na(e)&&!na(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var a=Vo(e),c=Vo(t),l=a?v:mi(e),u=c?v:mi(t),f=(l=l==g?B:l)==B,d=(u=u==g?B:u)==B,p=l==u;if(p&&Wo(e)){if(!Wo(t))return!1;a=!0,f=!1}if(p&&!f)return o||(o=new Jn),a||ua(e)?ni(e,t,n,r,i,o):function(e,t,n,r,s,i,o){switch(n){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case F:return!(e.byteLength!=t.byteLength||!i(new Ve(e),new Ve(t)));case _:case b:case C:return jo(+e,+t);case w:return e.name==t.name&&e.message==t.message;case I:case T:return e==t+"";case E:var a=ln;case N:var c=1&r;if(a||(a=dn),e.size!=t.size&&!c)return!1;var l=o.get(e);if(l)return l==t;r|=2,o.set(e,t);var u=ni(a(e),a(t),r,s,i,o);return o.delete(e),u;case S:if($n)return $n.call(e)==$n.call(t)}return!1}(e,t,l,n,r,i,o);if(!(1&n)){var h=f&&De.call(e,"__wrapped__"),m=d&&De.call(t,"__wrapped__");if(h||m){var y=h?e.value():e,A=m?t.value():t;return o||(o=new Jn),i(y,A,n,r,o)}}if(!p)return!1;return o||(o=new Jn),function(e,t,n,r,i,o){var a=1&n,c=si(e),l=c.length,u=si(t),f=u.length;if(l!=f&&!a)return!1;var d=l;for(;d--;){var p=c[d];if(!(a?p in t:De.call(t,p)))return!1}var h=o.get(e),m=o.get(t);if(h&&m)return h==t&&m==e;var y=!0;o.set(e,t),o.set(t,e);var A=a;for(;++d<l;){var g=e[p=c[d]],v=t[p];if(r)var _=a?r(v,g,p,t,e,o):r(g,v,p,e,t,o);if(!(_===s?g===v||i(g,v,n,r,o):_)){y=!1;break}A||(A="constructor"==p)}if(y&&!A){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(y=!1)}return o.delete(e),o.delete(t),y}(e,t,n,r,i,o)}(e,t,n,r,Or,i))}function Fr(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Be(e);i--;){var c=n[i];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<o;){var l=(c=n[i])[0],u=e[l],f=c[1];if(a&&c[2]){if(u===s&&!(l in e))return!1}else{var d=new Jn;if(r)var p=r(u,f,l,e,t,d);if(!(p===s?Or(f,u,3,r,d):p))return!1}}return!0}function Rr(e){return!(!ta(e)||(t=e,Le&&Le in t))&&(Xo(e)?Pe:ge).test(Li(e));var t}function Dr(e){return"function"==typeof e?e:null==e?sc:"object"==typeof e?Vo(e)?Pr(e[0],e[1]):jr(e):pc(e)}function Ur(e){if(!ki(e))return qt(e);var t=[];for(var n in Be(e))De.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Lr(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var n in Be(e))t.push(n);return t}(e);var t=ki(e),n=[];for(var r in e)("constructor"!=r||!t&&De.call(e,r))&&n.push(r);return n}function $r(e,t){return e<t}function Qr(e,t){var n=-1,s=Go(e)?r(e.length):[];return pr(e,(function(e,r,i){s[++n]=t(e,r,i)})),s}function jr(e){var t=fi(e);return 1==t.length&&t[0][2]?Ci(t[0][0],t[0][1]):function(n){return n===e||Fr(n,e,t)}}function Pr(e,t){return bi(e)&&Ei(t)?Ci(Ui(e),t):function(n){var r=Ba(n,e);return r===s&&r===t?Ma(n,e):Or(t,r,3)}}function Yr(e,t,n,r,i){e!==t&&vr(t,(function(o,a){if(i||(i=new Jn),ta(o))!function(e,t,n,r,i,o,a){var c=Ii(e,n),l=Ii(t,n),u=a.get(l);if(u)return void tr(e,n,u);var f=o?o(c,l,n+"",e,t,a):s,d=f===s;if(d){var p=Vo(l),h=!p&&Wo(l),m=!p&&!h&&ua(l);f=l,p||h||m?Vo(c)?f=c:qo(c)?f=Ns(c):h?(d=!1,f=ks(l,!0)):m?(d=!1,f=Cs(l,!0)):f=[]:ia(l)||zo(l)?(f=c,zo(c)?f=ga(c):ta(c)&&!Xo(c)||(f=Ai(l))):d=!1}d&&(a.set(l,f),i(f,l,r,o,a),a.delete(l));tr(e,n,f)}(e,t,a,n,Yr,r,i);else{var c=r?r(Ii(e,a),o,a+"",e,t,i):s;c===s&&(c=o),tr(e,a,c)}}),Oa)}function zr(e,t){var n=e.length;if(n)return vi(t+=t<0?n:0,n)?e[t]:s}function Vr(e,t,n){t=t.length?Rt(t,(function(e){return Vo(e)?function(t){return kr(t,1===e.length?e[0]:e)}:e})):[sc];var r=-1;t=Rt(t,Zt(li()));var s=Qr(e,(function(e,n,s){var i=Rt(t,(function(t){return t(e)}));return{criteria:i,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(s,(function(e,t){return function(e,t,n){var r=-1,s=e.criteria,i=t.criteria,o=s.length,a=n.length;for(;++r<o;){var c=Bs(s[r],i[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Hr(e,t,n){for(var r=-1,s=t.length,i={};++r<s;){var o=t[r],a=kr(e,o);n(a,o)&&es(i,_s(o,e),a)}return i}function Gr(e,t,n,r){var s=r?zt:Yt,i=-1,o=t.length,a=e;for(e===t&&(t=Ns(t)),n&&(a=Rt(e,Zt(n)));++i<o;)for(var c=0,l=t[i],u=n?n(l):l;(c=s(a,u,c,r))>-1;)a!==e&&Je.call(a,c,1),Je.call(e,c,1);return e}function qr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var s=t[n];if(n==r||s!==i){var i=s;vi(s)?Je.call(e,s,1):ds(e,s)}}return e}function Wr(e,t){return e+yt(xn()*(t-e+1))}function Jr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=yt(t/2))&&(e+=e)}while(t);return n}function Kr(e,t){return Si(Bi(e,t,sc),e+"")}function Xr(e){return Xn(ja(e))}function Zr(e,t){var n=ja(e);return Ri(n,cr(t,0,n.length))}function es(e,t,n,r){if(!ta(e))return e;for(var i=-1,o=(t=_s(t,e)).length,a=o-1,c=e;null!=c&&++i<o;){var l=Ui(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var f=c[l];(u=r?r(f,l,c):s)===s&&(u=ta(f)?f:vi(t[i+1])?[]:{})}nr(c,l,u),c=c[l]}return e}var ts=Tn?function(e,t){return Tn.set(e,t),e}:sc,ns=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:tc(t),writable:!0})}:sc;function rs(e){return Ri(ja(e))}function ss(e,t,n){var s=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=r(i);++s<i;)o[s]=e[s+t];return o}function is(e,t){var n;return pr(e,(function(e,r,s){return!(n=t(e,r,s))})),!!n}function os(e,t,n){var r=0,s=null==e?r:e.length;if("number"==typeof t&&t==t&&s<=2147483647){for(;r<s;){var i=r+s>>>1,o=e[i];null!==o&&!la(o)&&(n?o<=t:o<t)?r=i+1:s=i}return s}return as(e,t,sc,n)}function as(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,c=null===t,l=la(t),u=t===s;i<o;){var f=yt((i+o)/2),d=n(e[f]),p=d!==s,h=null===d,m=d==d,y=la(d);if(a)var A=r||m;else A=u?m&&(r||p):c?m&&p&&(r||!h):l?m&&p&&!h&&(r||!y):!h&&!y&&(r?d<=t:d<t);A?i=f+1:o=f}return _n(o,4294967294)}function cs(e,t){for(var n=-1,r=e.length,s=0,i=[];++n<r;){var o=e[n],a=t?t(o):o;if(!n||!jo(a,c)){var c=a;i[s++]=0===o?0:o}}return i}function ls(e){return"number"==typeof e?e:la(e)?m:+e}function us(e){if("string"==typeof e)return e;if(Vo(e))return Rt(e,us)+"";if(la(e))return Qn?Qn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function fs(e,t,n){var r=-1,s=Ot,i=e.length,o=!0,a=[],c=a;if(n)o=!1,s=Ft;else if(i>=200){var l=t?null:Js(e);if(l)return dn(l);o=!1,s=tn,c=new Wn}else c=t?[]:a;e:for(;++r<i;){var u=e[r],f=t?t(u):u;if(u=n||0!==u?u:0,o&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;t&&c.push(f),a.push(u)}else s(c,f,n)||(c!==a&&c.push(f),a.push(u))}return a}function ds(e,t){return null==(e=Mi(e,t=_s(t,e)))||delete e[Ui(Ji(t))]}function ps(e,t,n,r){return es(e,t,n(kr(e,t)),r)}function hs(e,t,n,r){for(var s=e.length,i=r?s:-1;(r?i--:++i<s)&&t(e[i],i,e););return n?ss(e,r?0:i,r?i+1:s):ss(e,r?i+1:0,r?s:i)}function ms(e,t){var n=e;return n instanceof Vn&&(n=n.value()),Ut(t,(function(e,t){return t.func.apply(t.thisArg,Dt([e],t.args))}),n)}function ys(e,t,n){var s=e.length;if(s<2)return s?fs(e[0]):[];for(var i=-1,o=r(s);++i<s;)for(var a=e[i],c=-1;++c<s;)c!=i&&(o[i]=dr(o[i]||a,e[c],t,n));return fs(gr(o,1),t,n)}function As(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var c=r<o?t[r]:s;n(a,e[r],c)}return a}function gs(e){return qo(e)?e:[]}function vs(e){return"function"==typeof e?e:sc}function _s(e,t){return Vo(e)?e:bi(e,t)?[e]:Di(va(e))}var bs=Kr;function ws(e,t,n){var r=e.length;return n=n===s?r:n,!t&&n>=r?e:ss(e,t,n)}var xs=st||function(e){return mt.clearTimeout(e)};function ks(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function Es(e){var t=new e.constructor(e.byteLength);return new Ve(t).set(new Ve(e)),t}function Cs(e,t){var n=t?Es(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Bs(e,t){if(e!==t){var n=e!==s,r=null===e,i=e==e,o=la(e),a=t!==s,c=null===t,l=t==t,u=la(t);if(!c&&!u&&!o&&e>t||o&&a&&l&&!c&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||c&&n&&i||!a&&i||!l)return-1}return 0}function Ms(e,t,n,s){for(var i=-1,o=e.length,a=n.length,c=-1,l=t.length,u=vn(o-a,0),f=r(l+u),d=!s;++c<l;)f[c]=t[c];for(;++i<a;)(d||i<o)&&(f[n[i]]=e[i]);for(;u--;)f[c++]=e[i++];return f}function Is(e,t,n,s){for(var i=-1,o=e.length,a=-1,c=n.length,l=-1,u=t.length,f=vn(o-c,0),d=r(f+u),p=!s;++i<f;)d[i]=e[i];for(var h=i;++l<u;)d[h+l]=t[l];for(;++a<c;)(p||i<o)&&(d[h+n[a]]=e[i++]);return d}function Ns(e,t){var n=-1,s=e.length;for(t||(t=r(s));++n<s;)t[n]=e[n];return t}function Ts(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var c=t[o],l=r?r(n[c],e[c],c,n,e):s;l===s&&(l=e[c]),i?or(n,c,l):nr(n,c,l)}return n}function Ss(e,t){return function(n,r){var s=Vo(n)?Mt:sr,i=t?t():{};return s(n,e,li(r,2),i)}}function Os(e){return Kr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:s,a=i>2?n[2]:s;for(o=e.length>3&&"function"==typeof o?(i--,o):s,a&&_i(n[0],n[1],a)&&(o=i<3?s:o,i=1),t=Be(t);++r<i;){var c=n[r];c&&e(t,c,r,o)}return t}))}function Fs(e,t){return function(n,r){if(null==n)return n;if(!Go(n))return e(n,r);for(var s=n.length,i=t?s:-1,o=Be(n);(t?i--:++i<s)&&!1!==r(o[i],i,o););return n}}function Rs(e){return function(t,n,r){for(var s=-1,i=Be(t),o=r(t),a=o.length;a--;){var c=o[e?a:++s];if(!1===n(i[c],c,i))break}return t}}function Ds(e){return function(t){var n=cn(t=va(t))?mn(t):s,r=n?n[0]:t.charAt(0),i=n?ws(n,1).join(""):t.slice(1);return r[e]()+i}}function Us(e){return function(t){return Ut(Xa(za(t).replace(et,"")),e,"")}}function Ls(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Pn(e.prototype),r=e.apply(n,t);return ta(r)?r:n}}function $s(e){return function(t,n,r){var i=Be(t);if(!Go(t)){var o=li(n,3);t=Sa(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:s}}function Qs(e){return ri((function(t){var n=t.length,r=n,o=zn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Ne(i);if(o&&!c&&"wrapper"==ai(a))var c=new zn([],!0)}for(r=c?r:n;++r<n;){var l=ai(a=t[r]),u="wrapper"==l?oi(a):s;c=u&&wi(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?c[ai(u[0])].apply(c,u[3]):1==a.length&&wi(a)?c[l]():c.thru(a)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&Vo(r))return c.plant(r).value();for(var s=0,i=n?t[s].apply(this,e):r;++s<n;)i=t[s].call(this,i);return i}}))}function js(e,t,n,i,o,a,c,l,u,d){var p=t&f,h=1&t,m=2&t,y=24&t,A=512&t,g=m?s:Ls(e);return function f(){for(var v=arguments.length,_=r(v),b=v;b--;)_[b]=arguments[b];if(y)var w=ci(f),x=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(_,w);if(i&&(_=Ms(_,i,o,y)),a&&(_=Is(_,a,c,y)),v-=x,y&&v<d){var k=fn(_,w);return qs(e,t,js,f.placeholder,n,_,k,l,u,d-v)}var E=h?n:this,C=m?E[e]:e;return v=_.length,l?_=function(e,t){var n=e.length,r=_n(t.length,n),i=Ns(e);for(;r--;){var o=t[r];e[r]=vi(o,n)?i[o]:s}return e}(_,l):A&&v>1&&_.reverse(),p&&u<v&&(_.length=u),this&&this!==mt&&this instanceof f&&(C=g||Ls(C)),C.apply(E,_)}}function Ps(e,t){return function(n,r){return function(e,t,n,r){return br(e,(function(e,s,i){t(r,n(e),s,i)})),r}(n,e,t(r),{})}}function Ys(e,t){return function(n,r){var i;if(n===s&&r===s)return t;if(n!==s&&(i=n),r!==s){if(i===s)return r;"string"==typeof n||"string"==typeof r?(n=us(n),r=us(r)):(n=ls(n),r=ls(r)),i=e(n,r)}return i}}function zs(e){return ri((function(t){return t=Rt(t,Zt(li())),Kr((function(n){var r=this;return e(t,(function(e){return Bt(e,r,n)}))}))}))}function Vs(e,t){var n=(t=t===s?" ":us(t)).length;if(n<2)return n?Jr(t,e):t;var r=Jr(t,ht(e/hn(t)));return cn(t)?ws(mn(r),0,e).join(""):r.slice(0,e)}function Hs(e){return function(t,n,i){return i&&"number"!=typeof i&&_i(t,n,i)&&(n=i=s),t=ha(t),n===s?(n=t,t=0):n=ha(n),function(e,t,n,s){for(var i=-1,o=vn(ht((t-e)/(n||1)),0),a=r(o);o--;)a[s?o:++i]=e,e+=n;return a}(t,n,i=i===s?t<n?1:-1:ha(i),e)}}function Gs(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Aa(t),n=Aa(n)),e(t,n)}}function qs(e,t,n,r,i,o,a,c,f,d){var p=8&t;t|=p?l:u,4&(t&=~(p?u:l))||(t&=-4);var h=[e,t,i,p?o:s,p?a:s,p?s:o,p?s:a,c,f,d],m=n.apply(s,h);return wi(e)&&Ni(m,h),m.placeholder=r,Oi(m,e,t)}function Ws(e){var t=Ce[e];return function(e,n){if(e=Aa(e),(n=null==n?0:_n(ma(n),292))&&_t(e)){var r=(va(e)+"e").split("e");return+((r=(va(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Js=Mn&&1/dn(new Mn([,-0]))[1]==p?function(e){return new Mn(e)}:lc;function Ks(e){return function(t){var n=mi(t);return n==E?ln(t):n==N?pn(t):function(e,t){return Rt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xs(e,t,n,o,p,h,m,y){var A=2&t;if(!A&&"function"!=typeof e)throw new Ne(i);var g=o?o.length:0;if(g||(t&=-97,o=p=s),m=m===s?m:vn(ma(m),0),y=y===s?y:ma(y),g-=p?p.length:0,t&u){var v=o,_=p;o=p=s}var b=A?s:oi(e),w=[e,t,n,o,p,v,_,h,m,y];if(b&&function(e,t){var n=e[1],r=t[1],s=n|r,i=s<131,o=r==f&&8==n||r==f&&n==d&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!i&&!o)return e;1&r&&(e[2]=t[2],s|=1&n?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?Ms(l,c,t[4]):c,e[4]=l?fn(e[3],a):t[4]}(c=t[5])&&(l=e[5],e[5]=l?Is(l,c,t[6]):c,e[6]=l?fn(e[5],a):t[6]);(c=t[7])&&(e[7]=c);r&f&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=s}(w,b),e=w[0],t=w[1],n=w[2],o=w[3],p=w[4],!(y=w[9]=w[9]===s?A?0:e.length:vn(w[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)x=8==t||t==c?function(e,t,n){var i=Ls(e);return function o(){for(var a=arguments.length,c=r(a),l=a,u=ci(o);l--;)c[l]=arguments[l];var f=a<3&&c[0]!==u&&c[a-1]!==u?[]:fn(c,u);return(a-=f.length)<n?qs(e,t,js,o.placeholder,s,c,f,s,s,n-a):Bt(this&&this!==mt&&this instanceof o?i:e,this,c)}}(e,t,y):t!=l&&33!=t||p.length?js.apply(s,w):function(e,t,n,s){var i=1&t,o=Ls(e);return function t(){for(var a=-1,c=arguments.length,l=-1,u=s.length,f=r(u+c),d=this&&this!==mt&&this instanceof t?o:e;++l<u;)f[l]=s[l];for(;c--;)f[l++]=arguments[++a];return Bt(d,i?n:this,f)}}(e,t,n,o);else var x=function(e,t,n){var r=1&t,s=Ls(e);return function t(){return(this&&this!==mt&&this instanceof t?s:e).apply(r?n:this,arguments)}}(e,t,n);return Oi((b?ts:Ni)(x,w),e,t)}function Zs(e,t,n,r){return e===s||jo(e,Oe[n])&&!De.call(r,n)?t:e}function ei(e,t,n,r,i,o){return ta(e)&&ta(t)&&(o.set(t,e),Yr(e,t,s,ei,o),o.delete(t)),e}function ti(e){return ia(e)?s:e}function ni(e,t,n,r,i,o){var a=1&n,c=e.length,l=t.length;if(c!=l&&!(a&&l>c))return!1;var u=o.get(e),f=o.get(t);if(u&&f)return u==t&&f==e;var d=-1,p=!0,h=2&n?new Wn:s;for(o.set(e,t),o.set(t,e);++d<c;){var m=e[d],y=t[d];if(r)var A=a?r(y,m,d,t,e,o):r(m,y,d,e,t,o);if(A!==s){if(A)continue;p=!1;break}if(h){if(!$t(t,(function(e,t){if(!tn(h,t)&&(m===e||i(m,e,n,r,o)))return h.push(t)}))){p=!1;break}}else if(m!==y&&!i(m,y,n,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p}function ri(e){return Si(Bi(e,s,Vi),e+"")}function si(e){return Er(e,Sa,pi)}function ii(e){return Er(e,Oa,hi)}var oi=Tn?function(e){return Tn.get(e)}:lc;function ai(e){for(var t=e.name+"",n=Sn[t],r=De.call(Sn,t)?n.length:0;r--;){var s=n[r],i=s.func;if(null==i||i==e)return s.name}return t}function ci(e){return(De.call(jn,"placeholder")?jn:e).placeholder}function li(){var e=jn.iteratee||ic;return e=e===ic?Dr:e,arguments.length?e(arguments[0],arguments[1]):e}function ui(e,t){var n,r,s=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?s["string"==typeof t?"string":"hash"]:s.map}function fi(e){for(var t=Sa(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,Ei(s)]}return t}function di(e,t){var n=function(e,t){return null==e?s:e[t]}(e,t);return Rr(n)?n:s}var pi=At?function(e){return null==e?[]:(e=Be(e),St(At(e),(function(t){return We.call(e,t)})))}:yc,hi=At?function(e){for(var t=[];e;)Dt(t,pi(e)),e=Ge(e);return t}:yc,mi=Cr;function yi(e,t,n){for(var r=-1,s=(t=_s(t,e)).length,i=!1;++r<s;){var o=Ui(t[r]);if(!(i=null!=e&&n(e,o)))break;e=e[o]}return i||++r!=s?i:!!(s=null==e?0:e.length)&&ea(s)&&vi(o,s)&&(Vo(e)||zo(e))}function Ai(e){return"function"!=typeof e.constructor||ki(e)?{}:Pn(Ge(e))}function gi(e){return Vo(e)||zo(e)||!!(Ke&&e&&e[Ke])}function vi(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function _i(e,t,n){if(!ta(n))return!1;var r=typeof t;return!!("number"==r?Go(n)&&vi(t,n.length):"string"==r&&t in n)&&jo(n[t],e)}function bi(e,t){if(Vo(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!la(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Be(t))}function wi(e){var t=ai(e),n=jn[t];if("function"!=typeof n||!(t in Vn.prototype))return!1;if(e===n)return!0;var r=oi(n);return!!r&&e===r[0]}(En&&mi(new En(new ArrayBuffer(1)))!=R||Cn&&mi(new Cn)!=E||Bn&&mi(Bn.resolve())!=M||Mn&&mi(new Mn)!=N||In&&mi(new In)!=O)&&(mi=function(e){var t=Cr(e),n=t==B?e.constructor:s,r=n?Li(n):"";if(r)switch(r){case On:return R;case Fn:return E;case Rn:return M;case Dn:return N;case Un:return O}return t});var xi=Fe?Xo:Ac;function ki(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Oe)}function Ei(e){return e==e&&!ta(e)}function Ci(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==s||e in Be(n)))}}function Bi(e,t,n){return t=vn(t===s?e.length-1:t,0),function(){for(var s=arguments,i=-1,o=vn(s.length-t,0),a=r(o);++i<o;)a[i]=s[t+i];i=-1;for(var c=r(t+1);++i<t;)c[i]=s[i];return c[t]=n(a),Bt(e,this,c)}}function Mi(e,t){return t.length<2?e:kr(e,ss(t,0,-1))}function Ii(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ni=Fi(ts),Ti=pt||function(e,t){return mt.setTimeout(e,t)},Si=Fi(ns);function Oi(e,t,n){var r=t+"";return Si(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ce,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return It(A,(function(n){var r="_."+n[0];t&n[1]&&!Ot(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(le);return t?t[1].split(ue):[]}(r),n)))}function Fi(e){var t=0,n=0;return function(){var r=bn(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(s,arguments)}}function Ri(e,t){var n=-1,r=e.length,i=r-1;for(t=t===s?r:t;++n<t;){var o=Wr(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var Di=function(e){var t=Ro(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,s){t.push(r?s.replace(pe,"$1"):n||e)})),t}));function Ui(e){if("string"==typeof e||la(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Li(e){if(null!=e){try{return Re.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function $i(e){if(e instanceof Vn)return e.clone();var t=new zn(e.__wrapped__,e.__chain__);return t.__actions__=Ns(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Qi=Kr((function(e,t){return qo(e)?dr(e,gr(t,1,qo,!0)):[]})),ji=Kr((function(e,t){var n=Ji(t);return qo(n)&&(n=s),qo(e)?dr(e,gr(t,1,qo,!0),li(n,2)):[]})),Pi=Kr((function(e,t){var n=Ji(t);return qo(n)&&(n=s),qo(e)?dr(e,gr(t,1,qo,!0),s,n):[]}));function Yi(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=null==n?0:ma(n);return s<0&&(s=vn(r+s,0)),Pt(e,li(t,3),s)}function zi(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==s&&(i=ma(n),i=n<0?vn(r+i,0):_n(i,r-1)),Pt(e,li(t,3),i,!0)}function Vi(e){return(null==e?0:e.length)?gr(e,1):[]}function Hi(e){return e&&e.length?e[0]:s}var Gi=Kr((function(e){var t=Rt(e,gs);return t.length&&t[0]===e[0]?Nr(t):[]})),qi=Kr((function(e){var t=Ji(e),n=Rt(e,gs);return t===Ji(n)?t=s:n.pop(),n.length&&n[0]===e[0]?Nr(n,li(t,2)):[]})),Wi=Kr((function(e){var t=Ji(e),n=Rt(e,gs);return(t="function"==typeof t?t:s)&&n.pop(),n.length&&n[0]===e[0]?Nr(n,s,t):[]}));function Ji(e){var t=null==e?0:e.length;return t?e[t-1]:s}var Ki=Kr(Xi);function Xi(e,t){return e&&e.length&&t&&t.length?Gr(e,t):e}var Zi=ri((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return qr(e,Rt(t,(function(e){return vi(e,n)?+e:e})).sort(Bs)),r}));function eo(e){return null==e?e:kn.call(e)}var to=Kr((function(e){return fs(gr(e,1,qo,!0))})),no=Kr((function(e){var t=Ji(e);return qo(t)&&(t=s),fs(gr(e,1,qo,!0),li(t,2))})),ro=Kr((function(e){var t=Ji(e);return t="function"==typeof t?t:s,fs(gr(e,1,qo,!0),s,t)}));function so(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(qo(e))return t=vn(e.length,t),!0})),Kt(t,(function(t){return Rt(e,Gt(t))}))}function io(e,t){if(!e||!e.length)return[];var n=so(e);return null==t?n:Rt(n,(function(e){return Bt(t,s,e)}))}var oo=Kr((function(e,t){return qo(e)?dr(e,t):[]})),ao=Kr((function(e){return ys(St(e,qo))})),co=Kr((function(e){var t=Ji(e);return qo(t)&&(t=s),ys(St(e,qo),li(t,2))})),lo=Kr((function(e){var t=Ji(e);return t="function"==typeof t?t:s,ys(St(e,qo),s,t)})),uo=Kr(so);var fo=Kr((function(e){var t=e.length,n=t>1?e[t-1]:s;return n="function"==typeof n?(e.pop(),n):s,io(e,n)}));function po(e){var t=jn(e);return t.__chain__=!0,t}function ho(e,t){return t(e)}var mo=ri((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Vn&&vi(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ho,args:[i],thisArg:s}),new zn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(s),e}))):this.thru(i)}));var yo=Ss((function(e,t,n){De.call(e,n)?++e[n]:or(e,n,1)}));var Ao=$s(Yi),go=$s(zi);function vo(e,t){return(Vo(e)?It:pr)(e,li(t,3))}function _o(e,t){return(Vo(e)?Nt:hr)(e,li(t,3))}var bo=Ss((function(e,t,n){De.call(e,n)?e[n].push(t):or(e,n,[t])}));var wo=Kr((function(e,t,n){var s=-1,i="function"==typeof t,o=Go(e)?r(e.length):[];return pr(e,(function(e){o[++s]=i?Bt(t,e,n):Tr(e,t,n)})),o})),xo=Ss((function(e,t,n){or(e,n,t)}));function ko(e,t){return(Vo(e)?Rt:Qr)(e,li(t,3))}var Eo=Ss((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Co=Kr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_i(e,t[0],t[1])?t=[]:n>2&&_i(t[0],t[1],t[2])&&(t=[t[0]]),Vr(e,gr(t,1),[])})),Bo=ut||function(){return mt.Date.now()};function Mo(e,t,n){return t=n?s:t,t=e&&null==t?e.length:t,Xs(e,f,s,s,s,s,t)}function Io(e,t){var n;if("function"!=typeof t)throw new Ne(i);return e=ma(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=s),n}}var No=Kr((function(e,t,n){var r=1;if(n.length){var s=fn(n,ci(No));r|=l}return Xs(e,r,t,n,s)})),To=Kr((function(e,t,n){var r=3;if(n.length){var s=fn(n,ci(To));r|=l}return Xs(t,r,e,n,s)}));function So(e,t,n){var r,o,a,c,l,u,f=0,d=!1,p=!1,h=!0;if("function"!=typeof e)throw new Ne(i);function m(t){var n=r,i=o;return r=o=s,f=t,c=e.apply(i,n)}function y(e){var n=e-u;return u===s||n>=t||n<0||p&&e-f>=a}function A(){var e=Bo();if(y(e))return g(e);l=Ti(A,function(e){var n=t-(e-u);return p?_n(n,a-(e-f)):n}(e))}function g(e){return l=s,h&&r?m(e):(r=o=s,c)}function v(){var e=Bo(),n=y(e);if(r=arguments,o=this,u=e,n){if(l===s)return function(e){return f=e,l=Ti(A,t),d?m(e):c}(u);if(p)return xs(l),l=Ti(A,t),m(u)}return l===s&&(l=Ti(A,t)),c}return t=Aa(t)||0,ta(n)&&(d=!!n.leading,a=(p="maxWait"in n)?vn(Aa(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),v.cancel=function(){l!==s&&xs(l),f=0,r=u=o=l=s},v.flush=function(){return l===s?c:g(Bo())},v}var Oo=Kr((function(e,t){return fr(e,1,t)})),Fo=Kr((function(e,t,n){return fr(e,Aa(t)||0,n)}));function Ro(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ne(i);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o)||i,o};return n.cache=new(Ro.Cache||qn),n}function Do(e){if("function"!=typeof e)throw new Ne(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ro.Cache=qn;var Uo=bs((function(e,t){var n=(t=1==t.length&&Vo(t[0])?Rt(t[0],Zt(li())):Rt(gr(t,1),Zt(li()))).length;return Kr((function(r){for(var s=-1,i=_n(r.length,n);++s<i;)r[s]=t[s].call(this,r[s]);return Bt(e,this,r)}))})),Lo=Kr((function(e,t){var n=fn(t,ci(Lo));return Xs(e,l,s,t,n)})),$o=Kr((function(e,t){var n=fn(t,ci($o));return Xs(e,u,s,t,n)})),Qo=ri((function(e,t){return Xs(e,d,s,s,s,t)}));function jo(e,t){return e===t||e!=e&&t!=t}var Po=Gs(Br),Yo=Gs((function(e,t){return e>=t})),zo=Sr(function(){return arguments}())?Sr:function(e){return na(e)&&De.call(e,"callee")&&!We.call(e,"callee")},Vo=r.isArray,Ho=bt?Zt(bt):function(e){return na(e)&&Cr(e)==F};function Go(e){return null!=e&&ea(e.length)&&!Xo(e)}function qo(e){return na(e)&&Go(e)}var Wo=vt||Ac,Jo=wt?Zt(wt):function(e){return na(e)&&Cr(e)==b};function Ko(e){if(!na(e))return!1;var t=Cr(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ia(e)}function Xo(e){if(!ta(e))return!1;var t=Cr(e);return t==x||t==k||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Zo(e){return"number"==typeof e&&e==ma(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function na(e){return null!=e&&"object"==typeof e}var ra=xt?Zt(xt):function(e){return na(e)&&mi(e)==E};function sa(e){return"number"==typeof e||na(e)&&Cr(e)==C}function ia(e){if(!na(e)||Cr(e)!=B)return!1;var t=Ge(e);if(null===t)return!0;var n=De.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Re.call(n)==Qe}var oa=kt?Zt(kt):function(e){return na(e)&&Cr(e)==I};var aa=Et?Zt(Et):function(e){return na(e)&&mi(e)==N};function ca(e){return"string"==typeof e||!Vo(e)&&na(e)&&Cr(e)==T}function la(e){return"symbol"==typeof e||na(e)&&Cr(e)==S}var ua=Ct?Zt(Ct):function(e){return na(e)&&ea(e.length)&&!!ct[Cr(e)]};var fa=Gs($r),da=Gs((function(e,t){return e<=t}));function pa(e){if(!e)return[];if(Go(e))return ca(e)?mn(e):Ns(e);if(Xe&&e[Xe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=mi(e);return(t==E?ln:t==N?dn:ja)(e)}function ha(e){return e?(e=Aa(e))===p||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ma(e){var t=ha(e),n=t%1;return t==t?n?t-n:t:0}function ya(e){return e?cr(ma(e),0,y):0}function Aa(e){if("number"==typeof e)return e;if(la(e))return m;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=Ae.test(e);return n||ve.test(e)?dt(e.slice(2),n?2:8):ye.test(e)?m:+e}function ga(e){return Ts(e,Oa(e))}function va(e){return null==e?"":us(e)}var _a=Os((function(e,t){if(ki(t)||Go(t))Ts(t,Sa(t),e);else for(var n in t)De.call(t,n)&&nr(e,n,t[n])})),ba=Os((function(e,t){Ts(t,Oa(t),e)})),wa=Os((function(e,t,n,r){Ts(t,Oa(t),e,r)})),xa=Os((function(e,t,n,r){Ts(t,Sa(t),e,r)})),ka=ri(ar);var Ea=Kr((function(e,t){e=Be(e);var n=-1,r=t.length,i=r>2?t[2]:s;for(i&&_i(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=Oa(o),c=-1,l=a.length;++c<l;){var u=a[c],f=e[u];(f===s||jo(f,Oe[u])&&!De.call(e,u))&&(e[u]=o[u])}return e})),Ca=Kr((function(e){return e.push(s,ei),Bt(Ra,s,e)}));function Ba(e,t,n){var r=null==e?s:kr(e,t);return r===s?n:r}function Ma(e,t){return null!=e&&yi(e,t,Ir)}var Ia=Ps((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=$e.call(t)),e[t]=n}),tc(sc)),Na=Ps((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=$e.call(t)),De.call(e,t)?e[t].push(n):e[t]=[n]}),li),Ta=Kr(Tr);function Sa(e){return Go(e)?Kn(e):Ur(e)}function Oa(e){return Go(e)?Kn(e,!0):Lr(e)}var Fa=Os((function(e,t,n){Yr(e,t,n)})),Ra=Os((function(e,t,n,r){Yr(e,t,n,r)})),Da=ri((function(e,t){var n={};if(null==e)return n;var r=!1;t=Rt(t,(function(t){return t=_s(t,e),r||(r=t.length>1),t})),Ts(e,ii(e),n),r&&(n=lr(n,7,ti));for(var s=t.length;s--;)ds(n,t[s]);return n}));var Ua=ri((function(e,t){return null==e?{}:function(e,t){return Hr(e,t,(function(t,n){return Ma(e,n)}))}(e,t)}));function La(e,t){if(null==e)return{};var n=Rt(ii(e),(function(e){return[e]}));return t=li(t),Hr(e,n,(function(e,n){return t(e,n[0])}))}var $a=Ks(Sa),Qa=Ks(Oa);function ja(e){return null==e?[]:en(e,Sa(e))}var Pa=Us((function(e,t,n){return t=t.toLowerCase(),e+(n?Ya(t):t)}));function Ya(e){return Ka(va(e).toLowerCase())}function za(e){return(e=va(e))&&e.replace(be,sn).replace(tt,"")}var Va=Us((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ha=Us((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ga=Ds("toLowerCase");var qa=Us((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Wa=Us((function(e,t,n){return e+(n?" ":"")+Ka(t)}));var Ja=Us((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Ds("toUpperCase");function Xa(e,t,n){return e=va(e),(t=n?s:t)===s?function(e){return it.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(fe)||[]}(e):e.match(t)||[]}var Za=Kr((function(e,t){try{return Bt(e,s,t)}catch(e){return Ko(e)?e:new ke(e)}})),ec=ri((function(e,t){return It(t,(function(t){t=Ui(t),or(e,t,No(e[t],e))})),e}));function tc(e){return function(){return e}}var nc=Qs(),rc=Qs(!0);function sc(e){return e}function ic(e){return Dr("function"==typeof e?e:lr(e,1))}var oc=Kr((function(e,t){return function(n){return Tr(n,e,t)}})),ac=Kr((function(e,t){return function(n){return Tr(e,n,t)}}));function cc(e,t,n){var r=Sa(t),s=xr(t,r);null!=n||ta(t)&&(s.length||!r.length)||(n=t,t=e,e=this,s=xr(t,Sa(t)));var i=!(ta(n)&&"chain"in n&&!n.chain),o=Xo(e);return It(s,(function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__);return(n.__actions__=Ns(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Dt([this.value()],arguments))})})),e}function lc(){}var uc=zs(Rt),fc=zs(Tt),dc=zs($t);function pc(e){return bi(e)?Gt(Ui(e)):function(e){return function(t){return kr(t,e)}}(e)}var hc=Hs(),mc=Hs(!0);function yc(){return[]}function Ac(){return!1}var gc=Ys((function(e,t){return e+t}),0),vc=Ws("ceil"),_c=Ys((function(e,t){return e/t}),1),bc=Ws("floor");var wc=Ys((function(e,t){return e*t}),1),xc=Ws("round"),kc=Ys((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new Ne(i);return e=ma(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=Mo,jn.assign=_a,jn.assignIn=ba,jn.assignInWith=wa,jn.assignWith=xa,jn.at=ka,jn.before=Io,jn.bind=No,jn.bindAll=ec,jn.bindKey=To,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Vo(e)?e:[e]},jn.chain=po,jn.chunk=function(e,t,n){t=(n?_i(e,t,n):t===s)?1:vn(ma(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,a=0,c=r(ht(i/t));o<i;)c[a++]=ss(e,o,o+=t);return c},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,s=[];++t<n;){var i=e[t];i&&(s[r++]=i)}return s},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],s=e;s--;)t[s-1]=arguments[s];return Dt(Vo(n)?Ns(n):[n],gr(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=li();return e=t?Rt(e,(function(e){if("function"!=typeof e[1])throw new Ne(i);return[n(e[0]),e[1]]})):[],Kr((function(n){for(var r=-1;++r<t;){var s=e[r];if(Bt(s[0],this,n))return Bt(s[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=Sa(e);return function(n){return ur(n,e,t)}}(lr(e,1))},jn.constant=tc,jn.countBy=yo,jn.create=function(e,t){var n=Pn(e);return null==t?n:ir(n,t)},jn.curry=function e(t,n,r){var i=Xs(t,8,s,s,s,s,s,n=r?s:n);return i.placeholder=e.placeholder,i},jn.curryRight=function e(t,n,r){var i=Xs(t,c,s,s,s,s,s,n=r?s:n);return i.placeholder=e.placeholder,i},jn.debounce=So,jn.defaults=Ea,jn.defaultsDeep=Ca,jn.defer=Oo,jn.delay=Fo,jn.difference=Qi,jn.differenceBy=ji,jn.differenceWith=Pi,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,(t=n||t===s?1:ma(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,0,(t=r-(t=n||t===s?1:ma(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?hs(e,li(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?hs(e,li(t,3),!0):[]},jn.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&_i(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=ma(n))<0&&(n=-n>i?0:i+n),(r=r===s||r>i?i:ma(r))<0&&(r+=i),r=n>r?0:ya(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(Vo(e)?St:Ar)(e,li(t,3))},jn.flatMap=function(e,t){return gr(ko(e,t),1)},jn.flatMapDeep=function(e,t){return gr(ko(e,t),p)},jn.flatMapDepth=function(e,t,n){return n=n===s?1:ma(n),gr(ko(e,t),n)},jn.flatten=Vi,jn.flattenDeep=function(e){return(null==e?0:e.length)?gr(e,p):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?gr(e,t=t===s?1:ma(t)):[]},jn.flip=function(e){return Xs(e,512)},jn.flow=nc,jn.flowRight=rc,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var s=e[t];r[s[0]]=s[1]}return r},jn.functions=function(e){return null==e?[]:xr(e,Sa(e))},jn.functionsIn=function(e){return null==e?[]:xr(e,Oa(e))},jn.groupBy=bo,jn.initial=function(e){return(null==e?0:e.length)?ss(e,0,-1):[]},jn.intersection=Gi,jn.intersectionBy=qi,jn.intersectionWith=Wi,jn.invert=Ia,jn.invertBy=Na,jn.invokeMap=wo,jn.iteratee=ic,jn.keyBy=xo,jn.keys=Sa,jn.keysIn=Oa,jn.map=ko,jn.mapKeys=function(e,t){var n={};return t=li(t,3),br(e,(function(e,r,s){or(n,t(e,r,s),e)})),n},jn.mapValues=function(e,t){var n={};return t=li(t,3),br(e,(function(e,r,s){or(n,r,t(e,r,s))})),n},jn.matches=function(e){return jr(lr(e,1))},jn.matchesProperty=function(e,t){return Pr(e,lr(t,1))},jn.memoize=Ro,jn.merge=Fa,jn.mergeWith=Ra,jn.method=oc,jn.methodOf=ac,jn.mixin=cc,jn.negate=Do,jn.nthArg=function(e){return e=ma(e),Kr((function(t){return zr(t,e)}))},jn.omit=Da,jn.omitBy=function(e,t){return La(e,Do(li(t)))},jn.once=function(e){return Io(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(Vo(t)||(t=null==t?[]:[t]),Vo(n=r?s:n)||(n=null==n?[]:[n]),Vr(e,t,n))},jn.over=uc,jn.overArgs=Uo,jn.overEvery=fc,jn.overSome=dc,jn.partial=Lo,jn.partialRight=$o,jn.partition=Eo,jn.pick=Ua,jn.pickBy=La,jn.property=pc,jn.propertyOf=function(e){return function(t){return null==e?s:kr(e,t)}},jn.pull=Ki,jn.pullAll=Xi,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,li(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,s,n):e},jn.pullAt=Zi,jn.range=hc,jn.rangeRight=mc,jn.rearg=Qo,jn.reject=function(e,t){return(Vo(e)?St:Ar)(e,Do(li(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,s=[],i=e.length;for(t=li(t,3);++r<i;){var o=e[r];t(o,r,e)&&(n.push(o),s.push(r))}return qr(e,s),n},jn.rest=function(e,t){if("function"!=typeof e)throw new Ne(i);return Kr(e,t=t===s?t:ma(t))},jn.reverse=eo,jn.sampleSize=function(e,t,n){return t=(n?_i(e,t,n):t===s)?1:ma(t),(Vo(e)?Zn:Zr)(e,t)},jn.set=function(e,t,n){return null==e?e:es(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:es(e,t,n,r)},jn.shuffle=function(e){return(Vo(e)?er:rs)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&_i(e,t,n)?(t=0,n=r):(t=null==t?0:ma(t),n=n===s?r:ma(n)),ss(e,t,n)):[]},jn.sortBy=Co,jn.sortedUniq=function(e){return e&&e.length?cs(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?cs(e,li(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&_i(e,t,n)&&(t=n=s),(n=n===s?y:n>>>0)?(e=va(e))&&("string"==typeof t||null!=t&&!oa(t))&&!(t=us(t))&&cn(e)?ws(mn(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new Ne(i);return t=null==t?0:vn(ma(t),0),Kr((function(n){var r=n[t],s=ws(n,0,t);return r&&Dt(s,r),Bt(e,this,s)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?ss(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?ss(e,0,(t=n||t===s?1:ma(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ss(e,(t=r-(t=n||t===s?1:ma(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?hs(e,li(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?hs(e,li(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new Ne(i);return ta(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),So(e,t,{leading:r,maxWait:t,trailing:s})},jn.thru=ho,jn.toArray=pa,jn.toPairs=$a,jn.toPairsIn=Qa,jn.toPath=function(e){return Vo(e)?Rt(e,Ui):la(e)?[e]:Ns(Di(va(e)))},jn.toPlainObject=ga,jn.transform=function(e,t,n){var r=Vo(e),s=r||Wo(e)||ua(e);if(t=li(t,4),null==n){var i=e&&e.constructor;n=s?r?new i:[]:ta(e)&&Xo(i)?Pn(Ge(e)):{}}return(s?It:br)(e,(function(e,r,s){return t(n,e,r,s)})),n},jn.unary=function(e){return Mo(e,1)},jn.union=to,jn.unionBy=no,jn.unionWith=ro,jn.uniq=function(e){return e&&e.length?fs(e):[]},jn.uniqBy=function(e,t){return e&&e.length?fs(e,li(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:s,e&&e.length?fs(e,s,t):[]},jn.unset=function(e,t){return null==e||ds(e,t)},jn.unzip=so,jn.unzipWith=io,jn.update=function(e,t,n){return null==e?e:ps(e,t,vs(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:s,null==e?e:ps(e,t,vs(n),r)},jn.values=ja,jn.valuesIn=function(e){return null==e?[]:en(e,Oa(e))},jn.without=oo,jn.words=Xa,jn.wrap=function(e,t){return Lo(vs(t),e)},jn.xor=ao,jn.xorBy=co,jn.xorWith=lo,jn.zip=uo,jn.zipObject=function(e,t){return As(e||[],t||[],nr)},jn.zipObjectDeep=function(e,t){return As(e||[],t||[],es)},jn.zipWith=fo,jn.entries=$a,jn.entriesIn=Qa,jn.extend=ba,jn.extendWith=wa,cc(jn,jn),jn.add=gc,jn.attempt=Za,jn.camelCase=Pa,jn.capitalize=Ya,jn.ceil=vc,jn.clamp=function(e,t,n){return n===s&&(n=t,t=s),n!==s&&(n=(n=Aa(n))==n?n:0),t!==s&&(t=(t=Aa(t))==t?t:0),cr(Aa(e),t,n)},jn.clone=function(e){return lr(e,4)},jn.cloneDeep=function(e){return lr(e,5)},jn.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:s)},jn.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:s)},jn.conformsTo=function(e,t){return null==t||ur(e,t,Sa(t))},jn.deburr=za,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=_c,jn.endsWith=function(e,t,n){e=va(e),t=us(t);var r=e.length,i=n=n===s?r:cr(ma(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},jn.eq=jo,jn.escape=function(e){return(e=va(e))&&K.test(e)?e.replace(W,on):e},jn.escapeRegExp=function(e){return(e=va(e))&&ie.test(e)?e.replace(se,"\\$&"):e},jn.every=function(e,t,n){var r=Vo(e)?Tt:mr;return n&&_i(e,t,n)&&(t=s),r(e,li(t,3))},jn.find=Ao,jn.findIndex=Yi,jn.findKey=function(e,t){return jt(e,li(t,3),br)},jn.findLast=go,jn.findLastIndex=zi,jn.findLastKey=function(e,t){return jt(e,li(t,3),wr)},jn.floor=bc,jn.forEach=vo,jn.forEachRight=_o,jn.forIn=function(e,t){return null==e?e:vr(e,li(t,3),Oa)},jn.forInRight=function(e,t){return null==e?e:_r(e,li(t,3),Oa)},jn.forOwn=function(e,t){return e&&br(e,li(t,3))},jn.forOwnRight=function(e,t){return e&&wr(e,li(t,3))},jn.get=Ba,jn.gt=Po,jn.gte=Yo,jn.has=function(e,t){return null!=e&&yi(e,t,Mr)},jn.hasIn=Ma,jn.head=Hi,jn.identity=sc,jn.includes=function(e,t,n,r){e=Go(e)?e:ja(e),n=n&&!r?ma(n):0;var s=e.length;return n<0&&(n=vn(s+n,0)),ca(e)?n<=s&&e.indexOf(t,n)>-1:!!s&&Yt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var s=null==n?0:ma(n);return s<0&&(s=vn(r+s,0)),Yt(e,t,s)},jn.inRange=function(e,t,n){return t=ha(t),n===s?(n=t,t=0):n=ha(n),function(e,t,n){return e>=_n(t,n)&&e<vn(t,n)}(e=Aa(e),t,n)},jn.invoke=Ta,jn.isArguments=zo,jn.isArray=Vo,jn.isArrayBuffer=Ho,jn.isArrayLike=Go,jn.isArrayLikeObject=qo,jn.isBoolean=function(e){return!0===e||!1===e||na(e)&&Cr(e)==_},jn.isBuffer=Wo,jn.isDate=Jo,jn.isElement=function(e){return na(e)&&1===e.nodeType&&!ia(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Go(e)&&(Vo(e)||"string"==typeof e||"function"==typeof e.splice||Wo(e)||ua(e)||zo(e)))return!e.length;var t=mi(e);if(t==E||t==N)return!e.size;if(ki(e))return!Ur(e).length;for(var n in e)if(De.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return Or(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:s)?n(e,t):s;return r===s?Or(e,t,s,n):!!r},jn.isError=Ko,jn.isFinite=function(e){return"number"==typeof e&&_t(e)},jn.isFunction=Xo,jn.isInteger=Zo,jn.isLength=ea,jn.isMap=ra,jn.isMatch=function(e,t){return e===t||Fr(e,t,fi(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:s,Fr(e,t,fi(t),n)},jn.isNaN=function(e){return sa(e)&&e!=+e},jn.isNative=function(e){if(xi(e))throw new ke("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Rr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=sa,jn.isObject=ta,jn.isObjectLike=na,jn.isPlainObject=ia,jn.isRegExp=oa,jn.isSafeInteger=function(e){return Zo(e)&&e>=-9007199254740991&&e<=h},jn.isSet=aa,jn.isString=ca,jn.isSymbol=la,jn.isTypedArray=ua,jn.isUndefined=function(e){return e===s},jn.isWeakMap=function(e){return na(e)&&mi(e)==O},jn.isWeakSet=function(e){return na(e)&&"[object WeakSet]"==Cr(e)},jn.join=function(e,t){return null==e?"":Qt.call(e,t)},jn.kebabCase=Va,jn.last=Ji,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==s&&(i=(i=ma(n))<0?vn(r+i,0):_n(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):Pt(e,Vt,i,!0)},jn.lowerCase=Ha,jn.lowerFirst=Ga,jn.lt=fa,jn.lte=da,jn.max=function(e){return e&&e.length?yr(e,sc,Br):s},jn.maxBy=function(e,t){return e&&e.length?yr(e,li(t,2),Br):s},jn.mean=function(e){return Ht(e,sc)},jn.meanBy=function(e,t){return Ht(e,li(t,2))},jn.min=function(e){return e&&e.length?yr(e,sc,$r):s},jn.minBy=function(e,t){return e&&e.length?yr(e,li(t,2),$r):s},jn.stubArray=yc,jn.stubFalse=Ac,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=wc,jn.nth=function(e,t){return e&&e.length?zr(e,ma(t)):s},jn.noConflict=function(){return mt._===this&&(mt._=je),this},jn.noop=lc,jn.now=Bo,jn.pad=function(e,t,n){e=va(e);var r=(t=ma(t))?hn(e):0;if(!t||r>=t)return e;var s=(t-r)/2;return Vs(yt(s),n)+e+Vs(ht(s),n)},jn.padEnd=function(e,t,n){e=va(e);var r=(t=ma(t))?hn(e):0;return t&&r<t?e+Vs(t-r,n):e},jn.padStart=function(e,t,n){e=va(e);var r=(t=ma(t))?hn(e):0;return t&&r<t?Vs(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(va(e).replace(oe,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&_i(e,t,n)&&(t=n=s),n===s&&("boolean"==typeof t?(n=t,t=s):"boolean"==typeof e&&(n=e,e=s)),e===s&&t===s?(e=0,t=1):(e=ha(e),t===s?(t=e,e=0):t=ha(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=xn();return _n(e+i*(t-e+ft("1e-"+((i+"").length-1))),t)}return Wr(e,t)},jn.reduce=function(e,t,n){var r=Vo(e)?Ut:Wt,s=arguments.length<3;return r(e,li(t,4),n,s,pr)},jn.reduceRight=function(e,t,n){var r=Vo(e)?Lt:Wt,s=arguments.length<3;return r(e,li(t,4),n,s,hr)},jn.repeat=function(e,t,n){return t=(n?_i(e,t,n):t===s)?1:ma(t),Jr(va(e),t)},jn.replace=function(){var e=arguments,t=va(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,i=(t=_s(t,e)).length;for(i||(i=1,e=s);++r<i;){var o=null==e?s:e[Ui(t[r])];o===s&&(r=i,o=n),e=Xo(o)?o.call(e):o}return e},jn.round=xc,jn.runInContext=e,jn.sample=function(e){return(Vo(e)?Xn:Xr)(e)},jn.size=function(e){if(null==e)return 0;if(Go(e))return ca(e)?hn(e):e.length;var t=mi(e);return t==E||t==N?e.size:Ur(e).length},jn.snakeCase=qa,jn.some=function(e,t,n){var r=Vo(e)?$t:is;return n&&_i(e,t,n)&&(t=s),r(e,li(t,3))},jn.sortedIndex=function(e,t){return os(e,t)},jn.sortedIndexBy=function(e,t,n){return as(e,t,li(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=os(e,t);if(r<n&&jo(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return os(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return as(e,t,li(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=os(e,t,!0)-1;if(jo(e[n],t))return n}return-1},jn.startCase=Wa,jn.startsWith=function(e,t,n){return e=va(e),n=null==n?0:cr(ma(n),0,e.length),t=us(t),e.slice(n,n+t.length)==t},jn.subtract=kc,jn.sum=function(e){return e&&e.length?Jt(e,sc):0},jn.sumBy=function(e,t){return e&&e.length?Jt(e,li(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&_i(e,t,n)&&(t=s),e=va(e),t=wa({},t,r,Zs);var i,o,a=wa({},t.imports,r.imports,Zs),c=Sa(a),l=en(a,c),u=0,f=t.interpolate||we,d="__p += '",p=Me((t.escape||we).source+"|"+f.source+"|"+(f===ee?he:we).source+"|"+(t.evaluate||we).source+"|$","g"),h="//# sourceURL="+(De.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(p,(function(t,n,r,s,a,c){return r||(r=s),d+=e.slice(u,c).replace(xe,an),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),d+="';\n";var m=De.call(t,"variable")&&t.variable;if(m){if(de.test(m))throw new ke("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(V,""):d).replace(H,"$1").replace(G,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var y=Za((function(){return Ee(c,h+"return "+d).apply(s,l)}));if(y.source=d,Ko(y))throw y;return y},jn.times=function(e,t){if((e=ma(e))<1||e>h)return[];var n=y,r=_n(e,y);t=li(t),e-=y;for(var s=Kt(r,t);++n<e;)t(n);return s},jn.toFinite=ha,jn.toInteger=ma,jn.toLength=ya,jn.toLower=function(e){return va(e).toLowerCase()},jn.toNumber=Aa,jn.toSafeInteger=function(e){return e?cr(ma(e),-9007199254740991,h):0===e?e:0},jn.toString=va,jn.toUpper=function(e){return va(e).toUpperCase()},jn.trim=function(e,t,n){if((e=va(e))&&(n||t===s))return Xt(e);if(!e||!(t=us(t)))return e;var r=mn(e),i=mn(t);return ws(r,nn(r,i),rn(r,i)+1).join("")},jn.trimEnd=function(e,t,n){if((e=va(e))&&(n||t===s))return e.slice(0,yn(e)+1);if(!e||!(t=us(t)))return e;var r=mn(e);return ws(r,0,rn(r,mn(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=va(e))&&(n||t===s))return e.replace(oe,"");if(!e||!(t=us(t)))return e;var r=mn(e);return ws(r,nn(r,mn(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(ta(t)){var i="separator"in t?t.separator:i;n="length"in t?ma(t.length):n,r="omission"in t?us(t.omission):r}var o=(e=va(e)).length;if(cn(e)){var a=mn(e);o=a.length}if(n>=o)return e;var c=n-hn(r);if(c<1)return r;var l=a?ws(a,0,c).join(""):e.slice(0,c);if(i===s)return l+r;if(a&&(c+=l.length-c),oa(i)){if(e.slice(c).search(i)){var u,f=l;for(i.global||(i=Me(i.source,va(me.exec(i))+"g")),i.lastIndex=0;u=i.exec(f);)var d=u.index;l=l.slice(0,d===s?c:d)}}else if(e.indexOf(us(i),c)!=c){var p=l.lastIndexOf(i);p>-1&&(l=l.slice(0,p))}return l+r},jn.unescape=function(e){return(e=va(e))&&J.test(e)?e.replace(q,An):e},jn.uniqueId=function(e){var t=++Ue;return va(e)+t},jn.upperCase=Ja,jn.upperFirst=Ka,jn.each=vo,jn.eachRight=_o,jn.first=Hi,cc(jn,function(){var e={};return br(jn,(function(t,n){De.call(jn.prototype,n)||(e[n]=t)})),e}(),{chain:!1}),jn.VERSION="4.17.21",It(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),It(["drop","take"],(function(e,t){Vn.prototype[e]=function(n){n=n===s?1:vn(ma(n),0);var r=this.__filtered__&&!t?new Vn(this):this.clone();return r.__filtered__?r.__takeCount__=_n(n,r.__takeCount__):r.__views__.push({size:_n(n,y),type:e+(r.__dir__<0?"Right":"")}),r},Vn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),It(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Vn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:li(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),It(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Vn.prototype[e]=function(){return this[n](1).value()[0]}})),It(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Vn.prototype[e]=function(){return this.__filtered__?new Vn(this):this[n](1)}})),Vn.prototype.compact=function(){return this.filter(sc)},Vn.prototype.find=function(e){return this.filter(e).head()},Vn.prototype.findLast=function(e){return this.reverse().find(e)},Vn.prototype.invokeMap=Kr((function(e,t){return"function"==typeof e?new Vn(this):this.map((function(n){return Tr(n,e,t)}))})),Vn.prototype.reject=function(e){return this.filter(Do(li(e)))},Vn.prototype.slice=function(e,t){e=ma(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Vn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==s&&(n=(t=ma(t))<0?n.dropRight(-t):n.take(t-e)),n)},Vn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Vn.prototype.toArray=function(){return this.take(y)},br(Vn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=jn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(jn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,c=t instanceof Vn,l=a[0],u=c||Vo(t),f=function(e){var t=i.apply(jn,Dt([e],a));return r&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var d=this.__chain__,p=!!this.__actions__.length,h=o&&!d,m=c&&!p;if(!o&&u){t=m?t:new Vn(this);var y=e.apply(t,a);return y.__actions__.push({func:ho,args:[f],thisArg:s}),new zn(y,d)}return h&&m?e.apply(this,a):(y=this.thru(f),h?r?y.value()[0]:y.value():y)})})),It(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Te[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var s=this.value();return t.apply(Vo(s)?s:[],e)}return this[n]((function(n){return t.apply(Vo(n)?n:[],e)}))}})),br(Vn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";De.call(Sn,r)||(Sn[r]=[]),Sn[r].push({name:t,func:n})}})),Sn[js(s,2).name]=[{name:"wrapper",func:s}],Vn.prototype.clone=function(){var e=new Vn(this.__wrapped__);return e.__actions__=Ns(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ns(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ns(this.__views__),e},Vn.prototype.reverse=function(){if(this.__filtered__){var e=new Vn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Vn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Vo(e),r=t<0,s=n?e.length:0,i=function(e,t,n){var r=-1,s=n.length;for(;++r<s;){var i=n[r],o=i.size;switch(i.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=_n(t,e+o);break;case"takeRight":e=vn(e,t-o)}}return{start:e,end:t}}(0,s,this.__views__),o=i.start,a=i.end,c=a-o,l=r?a:o-1,u=this.__iteratees__,f=u.length,d=0,p=_n(c,this.__takeCount__);if(!n||!r&&s==c&&p==c)return ms(e,this.__actions__);var h=[];e:for(;c--&&d<p;){for(var m=-1,y=e[l+=t];++m<f;){var A=u[m],g=A.iteratee,v=A.type,_=g(y);if(2==v)y=_;else if(!_){if(1==v)continue e;break e}}h[d++]=y}return h},jn.prototype.at=mo,jn.prototype.chain=function(){return po(this)},jn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===s&&(this.__values__=pa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?s:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Yn;){var r=$i(n);r.__index__=0,r.__values__=s,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Vn){var t=e;return this.__actions__.length&&(t=new Vn(this)),(t=t.reverse()).__actions__.push({func:ho,args:[eo],thisArg:s}),new zn(t,this.__chain__)}return this.thru(eo)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return ms(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Xe&&(jn.prototype[Xe]=function(){return this}),jn}();mt._=gn,(r=function(){return gn}.call(t,n,t,e))===s||(e.exports=r)}.call(this)},65:function(e,t,n){var r,s;!function(){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},i=null;function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function c(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?a:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}function l(){for(var n=this.getLevel(),s=0;s<r.length;s++){var i=r[s];this[i]=s<n?e:this.methodFactory(i,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function f(e,t,n){return c(e)||u.apply(this,arguments)}function d(e,n){var o,a,c,u=this,d="loglevel";function p(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&d){try{return void(window.localStorage[d]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"="+n+";"}catch(e){}}}function h(){var e;if(typeof window!==t&&d){try{e=window.localStorage[d]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(d),s=n.indexOf(r+"=");-1!==s&&(e=/^([^;]+)/.exec(n.slice(s+r.length+1))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}function m(){if(typeof window!==t&&d){try{window.localStorage.removeItem(d)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function y(e){var t=e;if("string"==typeof t&&void 0!==u.levels[t.toUpperCase()]&&(t=u.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=u.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?d+=":"+e:"symbol"==typeof e&&(d=void 0),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=n||f,u.getLevel=function(){return null!=c?c:null!=a?a:o},u.setLevel=function(e,t){return c=y(e),!1!==t&&p(c),l.call(u)},u.setDefaultLevel=function(e){a=y(e),h()||u.setLevel(e,!1)},u.resetLevel=function(){c=null,m(),l.call(u)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)},u.rebuild=function(){if(i!==u&&(o=y(i.getLevel())),l.call(u),i===u)for(var e in s)s[e].rebuild()},o=y(i?i.getLevel():"WARN");var A=h();null!=A&&(c=y(A)),l.call(u)}(i=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=s[e];return t||(t=s[e]=new d(e,i.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=p),i},i.getLoggers=function(){return s},i.default=i,i},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()},316:(e,t,n)=>{const r=n(347),s={id:"TB",desc:"Choose Treble or Bass clef",choices:[{id:"T",desc:"Treble"},{id:"B",desc:"Bass"}]},i={id:"SP",desc:"Show Keyboard",choices:[{id:"S",desc:"No"},{id:"P",desc:"Yes"}]};function o(e){let t="<ul>";for(let n of e)t+=`<li>${n} </li>`;return t+="</ul>",t}const a="Clap the Pulse",c="Sing Echoes",l="Describe the Change in Pitch or Rhythm",u="Answer Questions about a Piece",f="Clap the Pulse & State the Metre",d="Sing or Play from Memory",p="Sing from Score",h="Clap the Rhythm",m="Identify the Cadence",y="Identify the Chords",A="Identify the Modulation",g="Identify the Modulations",v="Last Note Higher or Lower than First?",_="Identify the Interval",b="Indicate when Hear Change in Pitch or Rhythm",w="Locate and Identify the Changes in Pitch and/or Rhythm",x="Time Signature, Dynamics, and Articulation",k="Describe Two (other) Characteristics",E="Start the player and listen to the {V1}.",C="Clap louder on the strong beats.",B="Review your response with the second player",M="Review your response with the score.",I="As soon as you can, join in clapping the pulse.",N=`${B} (which includes a metronome to indicate the pulse).`,T="Afterwards, state whether it is in {V1} time.",S="Say whether the music is in {V1} time.",O="You do not need to identify the time signature.",F=`${B} (which includes a metronome to indicate the pulse,\n  and a count-in to help identify the metre).`,R="After the count-in, you will hear {V1} bar phrases, each followed by a pause.",D=`${B}, and by studying the score.`,U=E.replace("{V1}","key-chord, starting note, and two bar count-in"),L=E.replace("{V1}","key-chord, tonic note, and two bar count-in"),$="During each pause, sing back the phrase you have just heard (keep in time).",Q="Choose whether you would like to sing from treble, or bass clef.",j="Listen to the key-chord, starting note, and tempo.",P="Take a few moments to study the score and, if you like, practise singing the {V1}.",Y="When you are ready, start the second player and after\n  the key-chord, starting note, and two bar count-in, sing the notes {V1}.",z="Check your response by using the additional players,\n  which will play the piece without and with the {V1} respectively.",V="You will then hear a {V1} followed by a pause.",H="The phrase will then be repeated with {V1}.",G="Review your response by listening again, and studying the\n  scores of the phrase, and altered phrase.",q="The {V1} question will be about {V2}.",W="Review your {V1} by listening again, and studying the score.",J="Listen to the key chord, starting note, two bar count-in, then the phrase (repeated after a pause) {V1} you need either to sing or play.",K=E.replace("{V1}","{V1} (played {V2})"),X="On the {V1} playing, join in clapping the pulse.",Z=N,ee=`${B} (which includes a metronome to indicate the pulse,\n  and a count-in to help identify the time signature).`,te=`${B} (which includes a count-in and metronome\n  to help identify the time signature).`,ne="Indicate (by raising your hand), as soon as you hear the change.",re="Say whether the time signature is {V1}.",se="Describe the {V1}.",ie="Say whether the playing was {V1}.",oe="Comment on {V1} characteristics of the piece (other than time signature, dynamics, or articulation).",ae="Check your response with the scores (first without, then with the change).",ce="Check your response with the score including the changes.",le="Study the score of the {V1}.",ue="Say where each change was located, and the type of the change (rhythm or pitch).",fe="This is to help you review your response.",de="Check your response with this player.",pe="View the score to check your response.",he=o([E.replace("{V1}","piece"),I,N,M]),me=o([E.replace("{V1}","piece"),I,C,T.replace("{V1}","two time, or three time"),O,F,M]),ye=o([E.replace("{V1}","piece"),I,C,T.replace("{V1}","two time, three time, or four time"),O,F,M]),Ae=o(["If you intend to play rather than sing, check the key and starting note.",E.replace("{V1}","key chord, and starting note"),"You will then hear a count-in and a short phrase, repeated after a pause.","After hearing the phrase for the second time, either sing or play it back.",`${B}.`,M]),ge=["If you intend to play rather than sing, check the key and starting note.",E.replace("{V1}","key chord, and starting note"),"You will then hear a count-in and a two-part phrase, repeated after a pause.","After hearing the phrase for the second time, either sing or play back the upper part.",`${B}.`,M],ve=o(ge);ge[3]="After hearing the phrase for the second time, either sing or play back the lower part.";const _e=o(ge);ge[2]="You will then hear a count-in and a three-part phrase, repeated after a pause.",ge.push("Then proceed to part (ii) of the exercise.");const be=o(ge),we=o(["Listen to the piece (preceded by the key chord, and repeated).","Identify the cadence (perfect, imperfect, interrupted, or plagal).","Then proceed to part (iii)."]),xe=o(["The chords in this part of the exercise are the same chords which formed the cadence in part (ii).","Listen to the key-chord, then the three chords from the cadence.","The chords are then repeated, each followed by a pause in which you should name the chord just played, and their positions."]),ke=o([E.replace("{V1}","two bar count-in"),R.replace("{V1}","two two"),"During each pause, clap the rhythm of the phrase you have just heard, keeping in time.",D]),Ee=o([U,R.replace("{V1}","three two"),$,D]),Ce=o([Q,"Take a few moments to look through the notes on the score.",E.replace("{V1}","key chord and starting note, then sing the notes from the score slowly."),"Check your response with the final player."]),Be=o([Q,j,P.replace("{V1}","melody"),Y.replace("{V1}","against with the accompaniment."),z.replace("{V1}","accompaniment")]),Me=o([Q,j,P.replace("{V1}","upper part"),Y.replace("{V1}","of the upper part against the lower part being played."),z.replace("{V1}","lower part")]),Ie=o([Q,j,P.replace("{V1}","lower part"),Y.replace("{V1}","of the lower part against the upper part being played."),z.replace("{V1}","upper part")]),Ne=o([U,R.replace("{V1}","two one"),$,D]),Te=o([L,V.replace("{V1}","two bar phrase"),H.replace("{V1}","one of the notes having a change in pitch"),"Say whether the change happened near the beginning, or the end, of the phrase.",G]),Se=o([L,V.replace("{V1}","two bar phrase"),H.replace("{V1}","a change in either pitch, or rhythm"),"Describe the change (whether pitch or ryhthm, and location).",G]),Oe=o([L,V.replace("{V1}","phrase of up to four bars"),H.replace("{V1}","a change in either pitch, or rhythm"),"Describe the change (whether pitch or ryhthm, and location).",G]),Fe=[E.replace("{V1}","notes (taken from the piece in part (i))"),"After a pause the notes will be repeated.","Then, clap the rhythm of the notes.",S.replace("{V1}","two, three, or four"),O,D],Re=o(Fe);Fe[3]=S.replace("{V1}","two, three, four, or 6/8");const De=o(Fe),Ue=o(["Listen to the piece (preceded by the key chord, and repeated).","Say whether the cadence is perfect, or imperfect."]),Le=o(["Listen to the piece (preceded by the key chord, and repeated).","Say whether the cadence is perfect, imperfect, or interrupted.","Then proceed to part (ii)."]),$e=o(["Listen to the two chords (preceded by the key chord).","The chords in this part of the exercise are the same chords which formed the cadence in part (i).","The chords will be in the root position only.","Identify the chords.","Then proceed to part (iii)."]),Qe=o(["Listen to the passage (preceded by the key chord, and played just once).","Say whether it modulated to the dominant, subdominant, or relative minor.",M]),je=o(["Listen to the passage (in a major key, preceded by the key chord).","Say whether it modulated to dominant, subdominant, or relative minor.",M,"Then proceed to part (ii)."]),Pe=o(["Listen to the passage (in a minor key, preceded by the key chord).","Say whether it modulated to dominant, subdominant, or relative major.",M]),Ye=o(["Read which feature of the piece you will be asked about.","This will be either dynamics or articulation.","Listen to the piece, then answer the question.",W.replace("{V1}","answer")]),ze=["Read which features of the piece you will be asked about.",q.replace("{V1}","first").replace("{V2}","dynamics"),q.replace("{V1}","second").replace("{V2}","articulation"),"Listen to the piece, then answer the questions.",W.replace("{V1}","answers")],Ve=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics or articulation"),ze[2]=q.replace("{V1}","second").replace("{V2}","tempo");const He=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, or tempo"),ze[2]=q.replace("{V1}","second").replace("{V2}","tonality");const Ge=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, tempo, or tonality"),ze[2]=q.replace("{V1}","second").replace("{V2}","character"),ze.pop(),ze.push("Review your answers by listening again."),ze.push("Then go to part (ii) of the exercise.");const qe=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","dynamics, articulation, tempo, tonality, or character"),ze[2]=q.replace("{V1}","second").replace("{V2}","style/period");const We=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","texture or structure"),ze[2]=q.replace("{V1}","second").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period");const Je=o(ze);ze[1]=q.replace("{V1}","first").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period"),ze[2]=q.replace("{V1}","second").replace("{V2}","texture, structure, dynamics, articulation, tempo, tonality, character, or style/period");const Ke=o(ze),Xe=o(["Listen to the piece, then describe its features as well as you can.","Consider all of the features from earlier grades (texture, structure,    dynamics, articulation, tempo, tonality), and anything else you    think is relevant. Say as much as you can about the piece.",W.replace("{V1}","response")]),Ze=o([K.replace("{V1}","melody").replace("{V2}","three times"),X.replace("{V1}","third"),C,Z]),et=o([K.replace("{V1}","melody").replace("{V2}","twice"),X.replace("{V1}","second"),C,Z]),tt=o([K.replace("{V1}","piece").replace("{V2}","twice"),X.replace("{V1}","second"),C,Z]),nt=o([K.replace("{V1}","piece").replace("{V2}","twice"),X.replace("{V1}","second"),C,re.replace("{V1}","2/4, 3/4, 4/4, or 6/8"),ee]),rt=o([K.replace("{V1}","piece").replace("{V2}","twice"),re.replace("{V1}","2/4, 3/4, 4/4, or 6/8"),se.replace("{V1}","dynamics"),se.replace("{V1}","articulation"),te]),st=o([K.replace("{V1}","piece").replace("{V2}","once"),re.replace("{V1}","2/4, 3/4, 4/4, 6/8, or 5/8"),se.replace("{V1}","dynamics"),se.replace("{V1}","articulation"),te]),it=o([E.replace("{V1}","melody"),ie.replace("{V1}","forte, or piano")]),ot=o([E.replace("{V1}","melody"),ie.replace("{V1}","forte, or piano"),ie.replace("{V1}","legato, or staccato")]),at=o([E.replace("{V1}","melody"),"Say whether the melody started piano and ended forte, or vice-versa.",ie.replace("{V1}","legato, or staccato")]),ct=o([E.replace("{V1}","melody"),"Say whether the tonality is major, or minor."]),lt=o([K.replace("{V1}","piece").replace("{V2}","twice"),"Say whether the tonality is major, or minor.","Say whether the final cadence is perfect, or imperfect."]),ut=o([K.replace("{V1}","piece").replace("{V2}","twice"),"Say how the tonality changed.","Say whether the final cadence is perfect, plagal, imperfect, or interrupted."]),ft=o([K.replace("{V1}","piece").replace("{V2}","twice"),oe.replace("{V1}","two")]),dt=o([K.replace("{V1}","piece").replace("{V2}","twice"),oe.replace("{V1}","three")]),pt=o([E.replace("{V1}","melody"),ie.replace("{V1}","legato, or staccato")]),ht=o([E.replace("{V1}","first two bars of the melody for this exercise"),"Say whether the last note was higher, or lower, than the first.",pe]),mt=o([E.replace("{V1}","melody"),"Say whether the last note was higher, or lower, than the first.",pe]),yt=o([E.replace("{V1}","first two notes of the melody for this exercise"),"State the interval between them.","You only need to identify the interval by number (second, third, fourth, fifth, sixth).",pe]),At=o([E.replace("{V1}","first two notes of the melody for this exercise"),"State the interval between them.","The interval will be a major/minor second, major/minor third, perfect fourth/fifth, major/minor sixth.",pe]),gt=o([E.replace("{V1}","two consecutive notes from the melody for this exercise"),"State the interval between them.","The interval will be a major/minor second, major/minor third, perfect fourth/fifth, major/minor sixth, major/minor seventh, or an octave.",pe]),vt=o([E.replace("{V1}","key-chord, followed by the first four bars of the piece for this exercise"),"Say where the music modulated to (dominant, subdominant, or relative minor).",pe]),_t=o([E.replace("{V1}","key-chord, followed by the first four bars of the piece for this exercise"),"Say where the music modulated to (dominant, subdominant, or relative minor/major).",pe]),bt=o(["Check the question to see whether you will be asked to identify the highest, or the lowest, note.",E.replace("{V1}","first three notes of the melody for this exercise"),"Answer the question.","A score of the full melody for this exercise is also provided so you can    review your responses to the exercise as a whole."]),wt=o([E.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),ne,"You only need to indicate when the change occurs (there is no need to describe the change further).",ae]),xt=o([E.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),ne,"Say whether the change was in rhythm, or pitch.",ae]),kt=o([le.replace("{V1}","melody"),E.replace("{V1}","melody which, on being played for a second time, will have a single change in rhythm or pitch"),"Say in which bar the change occurred.","Say whether the change was in rhythm, or pitch.",ae]),Et=o([le.replace("{V1}","melody"),E.replace("{V1}","melody which, on being played for a second time, will have a change in rhythm and a change in pitch"),"Say in which bars the changes in rhythm and pitch occurred.",ae]),Ct=o([le.replace("{V1}","piece"),E.replace("{V1}","piece which, on being played for a second time, will have a change in rhythm and a change in pitch in the melody"),"Say in which bars the changes in rhythm and pitch occurred.",ae]),Bt=o([le.replace("{V1}","piece"),E.replace("{V1}","piece, played twice, and having two changes\n    to the melody of rhythm, or pitch"),ue,ce]),Mt=o([le.replace("{V1}","piece"),E.replace("{V1}","piece, played twice, and having three changes\n    of rhythm, or pitch"),"Changes of pitch will be in the melody only.",ue,ce]),It=o([le.replace("{V1}","piece"),E.replace("{V1}","piece, played twice, and having three changes\n    of pitch or rhythm"),ue,ce]),Nt=[{id:"p2",info:o([de])},{id:"s1",info:o([pe])}],Tt=[{id:"P1",info:o(["Plays a short piece.",I])},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:o([pe])}],St=[{id:"P1",info:o(["Plays the piece.",I,C])},{id:"Q1"},{id:"a1"},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])},{id:"s1",info:o([pe])}],Ot=[{id:"P1",info:o(["Plays two phrases","Clap the rhythm in the pause after each phrase."])},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:o([pe])}],Ft=[{id:"P1",info:o(["Plays the notes, the rhythm of which you need to clap.","The notes are repeated.","After you have heard the notes for the second time, clap the rhythm of the notes.","Finally, answer the question below."])},{id:"Q1"},{id:"a1"},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks."])},{id:"s1",info:o([pe])},{id:"s2",info:o(["Full score to review the exercise as a whole."])}],Rt=[{id:"P1",info:o(["Plays two phrases.","Sing each phrase back in the following pause."])},{id:"p2",info:o([de,"Your response should correspond with the flute."])},{id:"s1",info:o([pe])}],Dt=[{id:"P1",info:o(["Plays three phrases.","Sing each back in the following pause."])},{id:"p2",info:o([de,"Your response should correspond with the flute."])},{id:"s1",info:o([pe])}],Ut=[{id:"P1",info:o(["Listen to the key chord, tonic note, and count-in.","These are followed by a two bar phrase ...","... and then the altered phrase."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o(["Score of the two bar phrase.",fe])},{id:"s2",info:o(["Score of the altered two bar phrase.",fe])}],Lt=[{id:"P1",info:o(["Listen to the key chord, tonic note, and count-in.","These are followed by a phrase (up to four bars) ...","... and then the altered phrase."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o(["Score of the phrase.",fe])},{id:"s2",info:o(["Score of the altered phrase.",fe])}],$t=[{id:"P1",info:o(["Listen to the key chord, tonic note, and two bar count-in.","You will then hear a phrase (repeated after a pause).","Either sing or play back the phrase."])},{id:"K1:P"},...Nt],Qt=[{id:"P1",info:J.replace("{V1}","the upper part of which")},{id:"K1:P"},...Nt],jt=[{id:"P1",info:J.replace("{V1}","the lower part of which")},{id:"K1:P"},...Nt],Pt=[{id:"P1",info:J.replace("{V1}","the lower part of which")},{id:"K1:P"},...Nt],Yt=[{id:"S1:T",info:o(["Score of the notes for you to sing."])},{id:"S2:B",info:o(["Score of the notes for you to sing."])},{id:"P1:T",info:o(["Listen to the key-chord and starting note.","Then sing the notes from the above score slowly."])},{id:"P2:B",info:o(["Listen to the key-chord and starting note.","Then sing the notes from the above score slowly."])},{id:"p3:T",info:o([de])},{id:"p4:B",info:o([de])}],zt=[{id:"S1:T",info:o(["Score of the melody for you to sing."])},{id:"S2:B",info:o(["Score of the melody for you to sing."])},{id:"P1:T",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:o(["Play the accompaniment, against which you need to sing the melody."])},{id:"P4:B",info:o(["Play the accompaniment, against which you need to sing the melody."])},{id:"p5:T",info:o([de])},{id:"p6:B",info:o([de])},{id:"p7:T",info:o([de])},{id:"p8:B",info:o([de])}],Vt=[{id:"S1:T",info:o(["Score of the notes, the upper part for you to sing."])},{id:"S2:B",info:o(["Score of the notes, the upper part for you to sing."])},{id:"P1:T",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:o(["Play the lower part, against which you need to sing the upper part."])},{id:"P4:B",info:o(["Play the lower part, against which you need to sing the upper part."])},{id:"p5:T",info:o([de])},{id:"p6:B",info:o([de])},{id:"p7:T",info:o([de])},{id:"p8:B",info:o([de])}],Ht=[{id:"S1:T",info:o(["Score of the notes, the lower part for you to sing."])},{id:"S2:B",info:o(["Score of the notes, the lower part for you to sing."])},{id:"P1:T",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P2:B",info:o(["Listen to the key-chord, starting note, and tempo."])},{id:"P3:T",info:o(["Play the upper part, against which you need to sing the lower part."])},{id:"P4:B",info:o(["Play the upper part, against which you need to sing the lower part."])},{id:"p5:T",info:o([de])},{id:"p6:B",info:o([de])},{id:"p7:T",info:o([de])},{id:"p8:B",info:o([de])}],Gt=[{id:"P1",info:o(["Listen to the key-chord and cadence (played twice)."])},{id:"Q1"},{id:"a1"}],qt=[...Gt,{id:"s1",info:o([pe])}],Wt=[{id:"P1",info:o(["Listen first to the key-chord, then the two chords from the cadence in part (i)."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],Jt=[{id:"P1",info:o(["Listen first to the key-chord, then the three chords from the cadence in part (ii).","The chords are then repeated with a pause after each, during which you should name the chord just played."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],Kt=[{id:"P1",info:o(["Listen first to the key-chord, then a piece which modulates."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],Xt=[{id:"IQ",info:o(["The feature of the piece you will be asked about."])},{id:"P1#Q1",info:o(["Plays the piece.","Listen, then answer the question below."])},{id:"q1"},{id:"a1"},{id:"s1",info:o([pe])}],Zt=[{id:"IQ",info:o(["Features of the piece you will be asked about."])},{id:"P1#Q1",info:o(["Plays the piece.","Listen, then answer the questions below."])},{id:"q1"},{id:"a1#Q2"},{id:"q2"},{id:"a2"}],en=[...Zt,{id:"s1",info:o([pe])}],tn=[{id:"P1#Q1",info:o(["Plays the piece.","Listen, then answer the question below."])},{id:"q1"},{id:"a1"},{id:"s1",info:o([pe])}],nn=[{id:"P1",info:o(["Plays the melody three times.","When you hear the melody for the third time, join in clapping the pulse.",C])},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],rn=[{id:"P1",info:o(["Plays the melody twice.","When you hear the melody for the second time, join in clapping the pulse.",C])},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],sn=[{id:"P1",info:o(["Plays the piece twice.","When you hear the piece for the second time, join in clapping the pulse.",C])},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}],on=[{id:"P1",info:o(["Plays the piece twice.","When you hear the piece for the second time, join in clapping the pulse.",C,"Answer the question below (state the time signature)."])},{id:"Q1"},{id:"a1"},{id:"p2",info:o([de,"Your claps should coincide with the metronome ticks.","Louder claps should coincide with the metronome up-ticks."])}];function an(e){return[{id:"P1",info:o([`Plays the piece ${e}.`,"After listening, answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"Q3"},{id:"a3"},{id:"p2",info:o([de,"A metronome is included to help you identify the time signature."])}]}const cn=an("twice"),ln=an("once"),un=[{id:"P1",info:o(["Plays the melody.","Listen, then answer the question."])},{id:"Q1"},{id:"a1"}],fn=[{id:"P1",info:o(["Plays the melody.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"}],dn=[{id:"P1",info:o(["Plays the piece twice.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"}],pn=[{id:"P1",info:o(["Plays the piece twice.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"}],hn=[{id:"P1",info:o(["Plays the first two bars of the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],mn=[{id:"P1",info:o(["Plays the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],yn=[{id:"P1",info:o(["Plays the first two notes of the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],An=[{id:"P1",info:o(["Plays two consecutive notes from the melody.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],gn=[{id:"P1",info:o(["Plays the key-chord, then the first four bars of the piece.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])}],vn=[{id:"P1",info:o(["Plays the first three notes.","Listen, then answer the question below."])},{id:"Q1"},{id:"a1"},{id:"s1",info:o([pe])},{id:"s2",info:o(["Complete score of the music for this exercise.","View this to review your responses to the exercise as a whole."])}],_n=[{id:"s1",info:o(["Score of the melody <i>without</i> the change.",fe])},{id:"s2",info:o(["Score of the melody <i>with</i> the change.",fe])}],bn="Plays the melody, then repeats it with a change of <i>rhythm</i> or <i>pitch</i>.",wn=[{id:"P1",info:o([bn,"Indicate (by raising your hand), as soon as you hear the change."])},{id:"a1",info:o(["The bar of the change.",fe,"Did you indicate correctly?"])}].concat(_n),xn=[{id:"P1",info:o([bn,"Indicate (by raising your hand), as soon as you hear the change.","Then answer the question below (say whether the change was in <i>rhythm</i> or <i>pitch</i>)."])},{id:"a1",info:o(["The bar of the change.",fe,"Did you indicate correctly?"])},{id:"Q2"},{id:"a2"}].concat(_n),kn=[{id:"S1",info:o(["Score of the melody.","Study this, then listen to the melody/variation below."])},{id:"P1",info:o(["Plays the melody first as written, then with a change in\n       either <i>rhythm</i> or <i>pitch</i>.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"s2",info:o(["Score of the melody <i>with</i> the change.",pe])}],En=kn.concat([{id:"s3",info:o(["Complete score of the piece for this exercise.","This is to help you review the exercise as a whole."])}]),Cn=[{id:"S1",info:o(["Score of the piece.","Study this, then listen to the piece/variation with the player below."])},{id:"P1",info:o(["Plays the piece first as written, then with a change of\n      <i>rhythm</i> and a change of <i>pitch</i> in the melody.","Listen, then answer the questions below."])},{id:"Q1"},{id:"a1"},{id:"Q2"},{id:"a2"},{id:"s2",info:o(["Score of the piece <i>with</i> the changes.",pe])}];function Bn(e,t){let n=["Plays the piece twice.",`The piece as played will have ${e} changes compared with the score.`,"The changes will be of rhythm and/or pitch.","Changes in pitch will occur only in the melody.","Listen, then answer the question below."];return"8"==t&&n.splice(3,1),[{id:"S1",info:o(["Score of the piece.","Study this, then listen to the variation with the player below."])},{id:"P1",info:o(n)},{id:"Q1"},{id:"a1"},{id:"s2",info:o(["Score of the piece <i>with</i> the changes.",pe])}]}const Mn=Bn("two"),In=Bn("three"),Nn=Bn("three","8");var Tn={[r.ID_ABRSM]:{0:{A:{i:{title:a,instruction:he,layout:Tt}},B:{i:{title:"Clap Echoes",instruction:ke,layout:Ot}},C:{i:{title:c,instruction:Ne,layout:Rt}},D:{i:{title:"Answer a Question about a Piece",instruction:Ye,qkeys:{1:["dynamics","articulation"]},layout:Xt}}},1:{A:{i:{title:f,instruction:me,qkeys:{1:["twothreetime"]},layout:St}},B:{i:{title:c,instruction:Ee,layout:Dt}},C:{i:{title:"Locate the Change in Pitch",instruction:Te,qkeys:{1:["beginorend"]},layout:Ut}},D:{i:{title:u,instruction:Ve,qkeys:{1:["dynamics"],2:["articulation"]},layout:en}}},2:{A:{i:{title:f,instruction:me,qkeys:{1:["twothreetime"]},layout:St}},B:{i:{title:c,instruction:Ee,layout:Dt}},C:{i:{title:l,instruction:Se,qkeys:{1:["different"]},layout:Ut}},D:{i:{title:u,instruction:He,qkeys:{1:["dynamics","articulation"],2:["tempo"]},layout:en}}},3:{A:{i:{title:f,instruction:ye,qkeys:{1:["twothreefourtime"]},layout:St}},B:{i:{title:c,instruction:Ee,layout:Dt}},C:{i:{title:l,instruction:Oe,qkeys:{1:["different"]},layout:Lt}},D:{i:{title:u,instruction:Ge,qkeys:{1:["dynamics","articulation","tempo"],2:["tonality"]},layout:en}}},4:{A:{i:{title:d,instruction:Ae,choices:[i],layout:$t}},B:{i:{title:p,instruction:Ce,choices:[s],layout:Yt}},C:{i:{title:u,instruction:qe,qkeys:{1:["dynamics","articulation","tempo","tonality"],2:["character"]},layout:Zt},ii:{title:h,instruction:Re,qkeys:{1:["twothreefourtime"]},layout:Ft}}},5:{A:{i:{title:d,instruction:Ae,choices:[i],layout:$t}},B:{i:{title:p,instruction:Ce,choices:[s],layout:Yt}},C:{i:{title:u,instruction:We,qkeys:{1:["dynamics","articulation","tempo","tonality","character"],2:["style"]},layout:Zt},ii:{title:h,instruction:Re,qkeys:{1:["twothreefourtime"]},layout:Ft}}},6:{A:{i:{title:d,instruction:ve,choices:[i],layout:Qt}},B:{i:{title:p,instruction:Be,choices:[s],layout:zt}},C:{i:{title:m,instruction:Ue,qkeys:{1:["cadence"]},layout:qt}},D:{i:{title:u,instruction:Je,qkeys:{1:["texture","structure"],2:["texture","structure","dynamics","articulation","tempo","tonality","character","style"]},layout:en},ii:{title:h,instruction:Re,qkeys:{1:["twothreefourtime"]},layout:Ft}}},7:{A:{i:{title:d,instruction:_e,choices:[i],layout:jt}},B:{i:{title:p,instruction:Me,choices:[s],layout:Vt}},C:{i:{title:m,instruction:Le,qkeys:{1:["cadence"]},layout:Gt},ii:{title:y,instruction:$e,qkeys:{1:["chords"]},layout:Wt},iii:{title:A,instruction:Qe,qkeys:{1:["wheremodulate"]},layout:Kt}},D:{i:{title:u,instruction:Ke,qkeys:{1:["texture","structure","dynamics","articulation","tempo","tonality","character","style"],2:["texture","structure","dynamics","articulation","tempo","tonality","character","style"]},layout:en},ii:{title:h,instruction:De,qkeys:{1:["twothreefour68time"]},layout:Ft}}},8:{A:{i:{title:d,instruction:be,choices:[i],layout:Pt},ii:{title:m,instruction:we,qkeys:{1:["cadence"]},layout:Gt},iii:{title:y,instruction:xe,qkeys:{1:["chords"]},layout:Jt}},B:{i:{title:p,instruction:Ie,choices:[s],layout:Ht}},C:{i:{title:g+" (part 1)",instruction:je,qkeys:{1:["wheremodulate"]},layout:Kt},ii:{title:g+" (part 2)",instruction:Pe,qkeys:{1:["wheremodulate"]},layout:Kt}},D:{i:{title:"Describe the Features of a Piece",instruction:Xe,qkeys:{1:["describe"]},layout:tn}}}},[r.ID_TRINITY]:{0:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Forte or Piano?",instruction:it,qkeys:{1:["fortepiano"]},layout:un},iii:{title:"Legato or Staccato?",instruction:pt,qkeys:{1:["legatostaccato"]},layout:un},iv:{title:"Identify the Highest or Lowest Note",instruction:bt,qkeys:{1:[["highest123","lowest123"]]},layout:vn}},1:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Forte or Piano? Legato or Staccato?",instruction:ot,qkeys:{1:["fortepiano"],2:["legatostaccato"]},layout:fn},iii:{title:v,instruction:ht,qkeys:{1:["higherlastfirst"]},layout:hn},iv:{title:b,instruction:wt,qkeys:{1:["wherepitchrhythm"]},layout:wn}},2:{i:{title:a,instruction:Ze,layout:nn},ii:{title:"Dynamics & Articulation",instruction:at,qkeys:{1:["dynamics"],2:["legatostaccato"]},layout:fn},iii:{title:v,instruction:mt,qkeys:{1:["higherlastfirst"]},layout:mn},iv:{title:b,instruction:xt,qkeys:{1:["where"],2:["pitchrhythm"]},layout:xn}},3:{i:{title:a,instruction:et,layout:rn},ii:{title:"Major or Minor?",instruction:ct,qkeys:{1:["tonality"]},layout:un},iii:{title:_,instruction:yt,qkeys:{1:["interval"]},layout:yn},iv:{title:"Locate the Change in Pitch or Rhythm",instruction:kt,qkeys:{1:["whichbar"],2:["pitchrhythm"]},layout:kn}},4:{i:{title:a,instruction:tt,layout:sn},ii:{title:"Major or Minor? Identify the Cadence.",instruction:lt,qkeys:{1:["tonality"],2:["cadence_pi"]},layout:dn},iii:{title:_,instruction:At,qkeys:{1:["interval"]},layout:yn},iv:{title:"Locate the Changes in Pitch and Rhythm",instruction:Et,qkeys:{1:["whichbarrhythm"],2:["whichbarpitch"]},layout:En}},5:{i:{title:"Clap the Pulse & State the Time Signature",instruction:nt,qkeys:{1:["timesig"]},layout:on},ii:{title:"Identify the Change in Tonality. Identify the Cadence.",instruction:ut,qkeys:{1:["tonalitychange"],2:["cadence_ppii"]},layout:dn},iii:{title:_,instruction:gt,qkeys:{1:["interval"]},layout:An},iv:{title:"Locate and Identify the Changes in Pitch and Rhythm",instruction:Ct,qkeys:{1:["whichbarrhythm"],2:["whichbarpitch"]},layout:Cn}},6:{i:{title:x,instruction:rt,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:cn},ii:{title:k,instruction:ft,qkeys:{1:["twootherchars"]},layout:pn},iii:{title:A,instruction:vt,qkeys:{1:["wheremodulate"]},layout:gn},iv:{title:w,instruction:Bt,qkeys:{1:["twochanges"]},layout:Mn}},7:{i:{title:x,instruction:rt,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:cn},ii:{title:k,instruction:ft,qkeys:{1:["twootherchars"]},layout:pn},iii:{title:A,instruction:_t,qkeys:{1:["wheremodulate"]},layout:gn},iv:{title:w,instruction:Mt,qkeys:{1:["threechanges"]},layout:In}},8:{i:{title:x,instruction:st,qkeys:{1:["timesig"],2:["dynamics"],3:["articulation"]},layout:ln},ii:{title:"Describe Three (other) Characteristics",instruction:dt,qkeys:{1:["threeotherchars"]},layout:pn},iii:{title:w,instruction:It,qkeys:{1:["threechanges"]},layout:Nn}}}};let Sn={SQA1:{title:"Theory Question",instruction:he,qkeys:{1:["custom"]},layout:[{id:"S1",info:"Score."},{id:"Q1"},{id:"a1"}]},T3:{title:"Theory Question",instruction:he,qkeys:{1:["custom"]},layout:[{id:"S1",info:"Score."},{id:"Q1"},{id:"a1#S2"},{id:"s2",info:"Score."}]},T2:{title:"Theory Lesson",instruction:he,layout:[{id:"P1",info:"Player."}]}};e.exports={byPath:Tn,byType:Sn}},347:e=>{const t="Section";function n(e){return`${e}`}function r(e,t,n="A, B, C, D"){return`Exercises for ${e} Grade ${t} are grouped by Section (${n}).<br/>Please choose a Section ...`}let s=[{id:"root",desc:"Home",icon:"home",cmpt:"MsgContent",msg:"Please choose a type of exercise ...",children:[{id:"T",desc:"Trinity",cmpt:"MsgContent",msg:"Please choose a Grade ...",children:[{id:"0",cmpt:"ExContent",module:!0,desc:"Initial",partDesc:"Question",partLabel:"num"},{id:"1",cmpt:"ExContent",module:!0,desc:n("1"),partDesc:"Question",partLabel:"num"},{id:"2",cmpt:"ExContent",module:!0,desc:n("2"),partDesc:"Question",partLabel:"num"},{id:"3",cmpt:"ExContent",module:!0,desc:n("3"),partDesc:"Question",partLabel:"num"},{id:"4",cmpt:"ExContent",module:!0,desc:n("4"),partDesc:"Question",partLabel:"num"},{id:"5",cmpt:"ExContent",module:!0,desc:n("5"),partDesc:"Question",partLabel:"num"}]},{id:"A",desc:"ABRSM",cmpt:"MsgContent",msg:"Please choose a Grade ...",children:[{id:"0",cmpt:"MsgContent",module:!0,allFree:!1,desc:"Initial",msg:r("ABRSM","Initial"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"1",cmpt:"MsgContent",module:!0,desc:n("1"),msg:r("ABRSM",1),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"2",cmpt:"MsgContent",module:!0,desc:n("2"),msg:r("ABRSM",2),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"3",cmpt:"MsgContent",module:!0,desc:n("3"),msg:r("ABRSM",3),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent"},{id:"D",cmpt:"ExContent"}]},{id:"4",cmpt:"MsgContent",module:!0,desc:n("4"),msg:r("ABRSM",4,"A,B,C"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent",partDesc:"Part"}]},{id:"5",cmpt:"MsgContent",module:!0,desc:n("5"),msg:r("ABRSM",5,"A,B,C"),text:t,children:[{id:"A",cmpt:"ExContent"},{id:"B",cmpt:"ExContent"},{id:"C",cmpt:"ExContent",partDesc:"Part"}]}]}]}];e.exports={ID_TRINITY:"T",ID_ABRSM:"A",exMenu:s}},84:(e,t,n)=>{e=n.nmd(e),function(t){"use strict";var n,r="function"==typeof(n=t.atob)?n:"function"==typeof Buffer?function(e){return new Buffer(e,"base64").toString("binary")}:"object"==typeof t.base64js?function(e){var n=t.base64js.b64ToByteArray(e);return Array.prototype.map.call(n,(function(e){return String.fromCharCode(e)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};t.atob=r,e&&e.exports&&(e.exports=r)}(window)},631:function(e,t,n){var r,s;!function(){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function o(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}function a(t,n){for(var s=0;s<r.length;s++){var i=r[s];this[i]=s<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return o(e)||c.apply(this,arguments)}function u(e,n,s){var i,o=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===o.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),o.name=e,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=s||l,o.getLevel=function(){return i},o.setLevel=function(n,r){if("string"==typeof n&&void 0!==o.levels[n.toUpperCase()]&&(n=o.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==r&&u(n),a.call(o,n,e),typeof console===t&&n<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(e){n=e,f()||o.setLevel(e,!1)},o.resetLevel=function(){o.setLevel(n,!1),d()},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var p=f();null==p&&(p=n),o.setLevel(p,!1)}var f=new u,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()},250:function(e,t,n){var r,s;!function(){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments])),console.trace}function o(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}function a(t,n){for(var s=0;s<r.length;s++){var i=r[s];this[i]=s<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function c(e,n,r){return function(){typeof console!==t&&(a.call(this,n,r),this[e].apply(this,arguments))}}function l(e,t,n){return o(e)||c.apply(this,arguments)}function u(e,n,s){var i,o=this;n=null==n?"WARN":n;var c="loglevel";function u(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}function f(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===o.levels[e]&&(e=void 0),e}}function d(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),o.name=e,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=s||l,o.getLevel=function(){return i},o.setLevel=function(n,r){if("string"==typeof n&&void 0!==o.levels[n.toUpperCase()]&&(n=o.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==r&&u(n),a.call(o,n,e),typeof console===t&&n<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(e){n=e,f()||o.setLevel(e,!1)},o.resetLevel=function(){o.setLevel(n,!1),d()},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var p=f();null==p&&(p=n),o.setLevel(p,!1)}var f=new u,d={};f.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,f.getLevel(),f.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return f.noConflict=function(){return typeof window!==t&&window.log===f&&(window.log=p),f},f.getLoggers=function(){return d},f.default=f,f},void 0===(s="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=s)}()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{hasBrowserEnv:()=>zl,hasStandardBrowserEnv:()=>Hl,hasStandardBrowserWebWorkerEnv:()=>Gl,navigator:()=>Vl,origin:()=>ql});"undefined"!=typeof window&&(window.__svelte||={v:new Set}).v.add("5");const t="[!",n={},r=Symbol();Symbol("filename"),Symbol("hmr");new Map;const s=!1;function i(e){s}var o=Array.isArray,a=Array.from,c=Object.keys,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyDescriptors,d=Object.prototype,p=Array.prototype,h=Object.getPrototypeOf;function m(e){return"function"==typeof e}const y=()=>{};function A(e){return e()}function g(e){for(var t=0;t<e.length;t++)e[t]()}const v=32,_=128,b=256,w=512,x=1024,k=2048,E=4096,C=8192,B=32768,M=1<<18,I=1<<19,N=Symbol("$state"),T=(Symbol("$state metadata"),Symbol("legacy props")),O=Symbol("");function F(e){return e===this.v}function R(e,t){return e!=e?t==t:e!==t||null!==e&&"object"==typeof e||"function"==typeof e}function D(e,t){return e!==t}function U(e){return!R(e,this.v)}function L(){throw new Error("effect_update_depth_exceeded")}function $(e){throw new Error("lifecycle_legacy_only")}let Q=!1;new Set;function j(e){return{f:0,v:e,reactions:null,equals:F,version:0}}function P(e,t=!1){const n=j(e);return t||(n.equals=U),Q&&null!==Ke&&null!==Ke.l&&(Ke.l.s??=[]).push(n),n}function Y(e,t=!1){return z(P(e,t))}function z(e){return null!==Qe&&2&Qe.f&&(null===ze?ze=[e]:ze.push(e)),e}function V(e,t){return H(e,pt((()=>dt(e)))),t}function H(e,t){return null!==Qe&&Ze()&&18&Qe.f&&(null===ze||!ze.includes(e))&&function(){throw new Error("state_unsafe_mutation")}(),G(e,t)}function G(e,t){e.equals(t)||(e.v=t,e.version=Xe(),q(e,x),Ze()&&null!==Pe&&Pe.f&w&&!(Pe.f&v)&&(null!==Ve&&Ve.includes(e)?(mt(Pe,x),lt(Pe)):null===Ge?function(e){Ge=e}([e]):Ge.push(e)));return t}function q(e,t){var n=e.reactions;if(null!==n)for(var r=Ze(),s=n.length,i=0;i<s;i++){var o=n[i],a=o.f;a&x||(r||o!==Pe)&&(mt(o,t),640&a&&(2&a?q(o,k):lt(o)))}}function W(e){var t=1026;null===Pe?t|=_:Pe.f|=I;const n={children:null,ctx:Ke,deps:null,equals:F,f:t,fn:e,reactions:null,v:null,version:0,parent:Pe};if(null!==Qe&&2&Qe.f){var r=Qe;(r.children??=[]).push(n)}return n}function J(e){const t=W(e);return t.equals=U,t}function K(e){var t=e.children;if(null!==t){e.children=null;for(var n=0;n<t.length;n+=1){var r=t[n];2&r.f?ee(r):ye(r)}}}function X(e){var t,n=Pe;Ye(e.parent);try{K(e),t=tt(e)}finally{Ye(n)}return t}function Z(e){var t=X(e);mt(e,(We||e.f&_)&&null!==e.deps?k:w),e.equals(t)||(e.v=t,e.version=Xe())}function ee(e){K(e),rt(e,0),mt(e,C),e.v=e.children=e.deps=e.ctx=e.reactions=null}function te(e){null===Pe&&null===Qe&&function(){throw new Error("effect_orphan")}(),null!==Qe&&Qe.f&_&&function(){throw new Error("effect_in_unowned_derived")}(),Re&&function(){throw new Error("effect_in_teardown")}()}function ne(e,t,n,r=!0){var s=!!(64&e),i=Pe;var o={ctx:Ke,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:e|x,first:null,fn:t,last:null,next:null,parent:s?null:i,prev:null,teardown:null,transitions:null,version:0};if(n){var a=Fe;try{De(!0),st(o),o.f|=16384}catch(e){throw ye(o),e}finally{De(a)}}else null!==t&&lt(o);if(!(n&&null===o.deps&&null===o.first&&null===o.nodes_start&&null===o.teardown&&!(o.f&I))&&!s&&r&&(null!==i&&function(e,t){var n=t.last;null===n?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}(o,i),null!==Qe&&2&Qe.f)){var c=Qe;(c.children??=[]).push(o)}return o}function re(e){const t=ne(8,null,!1);return mt(t,w),t.teardown=e,t}function se(e){if(te(),!(null!==Pe&&!!(Pe.f&v)&&null!==Ke&&!Ke.m))return oe(e);var t=Ke;(t.e??=[]).push({fn:e,effect:Pe,reaction:Qe})}function ie(e){const t=ne(64,e,!0);return()=>{ye(t)}}function oe(e){return ne(4,e,!1)}function ae(e,t){var n=Ke,r={effect:null,ran:!1};n.l.r1.push(r),r.effect=le((()=>{e(),r.ran||(r.ran=!0,H(n.l.r2,!0),pt(t))}))}function ce(){var e=Ke;le((()=>{if(dt(e.l.r2)){for(var t of e.l.r1){var n=t.effect;n.f&w&&mt(n,k),et(n)&&st(n),t.ran=!1}e.l.r2.v=!1}}))}function le(e){return ne(8,e,!0)}function ue(e){return fe(e)}function fe(e,t=0){return ne(24|t,e,!0)}function de(e,t=!0){return ne(40,e,!0,t)}function pe(e){var t=e.teardown;if(null!==t){const e=Re,n=Qe;Ue(!0),je(null);try{t.call(null)}finally{Ue(e),je(n)}}}function he(e){var t=e.deriveds;if(null!==t){e.deriveds=null;for(var n=0;n<t.length;n+=1)ee(t[n])}}function me(e,t=!1){var n=e.first;for(e.first=e.last=null;null!==n;){var r=n.next;ye(n,t),n=r}}function ye(e,t=!0){var n=!1;if((t||e.f&M)&&null!==e.nodes_start){for(var r=e.nodes_start,s=e.nodes_end;null!==r;){var i=r===s?null:St(r);r.remove(),r=i}n=!0}me(e,t&&!n),he(e),rt(e,0),mt(e,C);var o=e.transitions;if(null!==o)for(const e of o)e.stop();pe(e);var a=e.parent;null!==a&&null!==a.first&&Ae(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.parent=e.fn=e.nodes_start=e.nodes_end=null}function Ae(e){var t=e.parent,n=e.prev,r=e.next;null!==n&&(n.next=r),null!==r&&(r.prev=n),null!==t&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function ge(e,t){var n=[];_e(e,n,!0),ve(n,(()=>{ye(e),t&&t()}))}function ve(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function _e(e,t,n){if(!(e.f&E)){if(e.f^=E,null!==e.transitions)for(const r of e.transitions)(r.is_global||n)&&t.push(r);for(var r=e.first;null!==r;){var s=r.next;_e(r,t,!!(!!(r.f&B)||!!(r.f&v))&&n),r=s}}}function be(e){we(e,!0)}function we(e,t){if(e.f&E){et(e)&&st(e),e.f^=E;for(var n=e.first;null!==n;){var r=n.next;we(n,!!(!!(n.f&B)||!!(n.f&v))&&t),n=r}if(null!==e.transitions)for(const n of e.transitions)(n.is_global||t)&&n.in()}}"undefined"==typeof requestIdleCallback||requestIdleCallback;let xe=!1,ke=!1,Ee=[],Ce=[];function Be(){xe=!1;const e=Ee.slice();Ee=[],g(e)}function Me(){ke=!1;const e=Ce.slice();Ce=[],g(e)}function Ie(e){xe||(xe=!0,queueMicrotask(Be)),Ee.push(e)}Symbol("ADD_OWNER");function Ne(e){throw new Error("lifecycle_outside_component")}const Te=0;new WeakSet;let Se=Te,Oe=!1,Fe=!1,Re=!1;function De(e){Fe=e}function Ue(e){Re=e}let Le=[],$e=0,Qe=null;function je(e){Qe=e}let Pe=null;function Ye(e){Pe=e}let ze=null;let Ve=null,He=0,Ge=null;let qe=0,We=!1,Je=null,Ke=null;function Xe(){return++qe}function Ze(){return!Q||null!==Ke&&null===Ke.l}function et(e){var t=e.f;if(t&x)return!0;if(t&k){var n=e.deps,r=!!(t&_);if(null!==n){var s;if(t&b){for(s=0;s<n.length;s++)(n[s].reactions??=[]).push(e);e.f^=b}for(s=0;s<n.length;s++){var i=n[s];if(et(i)&&Z(i),!r||null===Pe||We||i?.reactions?.includes(e)||(i.reactions??=[]).push(e),i.version>e.version)return!0}}r||mt(e,w)}return!1}function tt(e){var t=Ve,n=He,r=Ge,s=Qe,i=We,o=ze,a=Ke,c=e.f;Ve=null,He=0,Ge=null,Qe=96&c?null:e,We=!Fe&&!!(c&_),ze=null,Ke=e.ctx;try{var l=(0,e.fn)(),u=e.deps;if(null!==Ve){var f;if(rt(e,He),null!==u&&He>0)for(u.length=He+Ve.length,f=0;f<Ve.length;f++)u[He+f]=Ve[f];else e.deps=u=Ve;if(!We)for(f=He;f<u.length;f++)(u[f].reactions??=[]).push(e)}else null!==u&&He<u.length&&(rt(e,He),u.length=He);return l}finally{Ve=t,He=n,Ge=r,Qe=s,We=i,ze=o,Ke=a}}function nt(e,t){let n=t.reactions;if(null!==n){var r=n.indexOf(e);if(-1!==r){var s=n.length-1;0===s?n=t.reactions=null:(n[r]=n[s],n.pop())}}null===n&&2&t.f&&(null===Ve||!Ve.includes(t))&&(mt(t,k),384&t.f||(t.f^=b),rt(t,0))}function rt(e,t){var n=e.deps;if(null!==n)for(var r=t;r<n.length;r++)nt(e,n[r])}function st(e){var t=e.f;if(!(t&C)){mt(e,w);var n=Pe;Pe=e;try{16&t?function(e){for(var t=e.first;null!==t;){var n=t.next;t.f&v||ye(t),t=n}}(e):me(e),he(e),pe(e);var r=tt(e);e.teardown="function"==typeof r?r:null,e.version=qe}catch(e){!function(e){throw e}(e)}finally{Pe=n}}}function it(){$e>1e3&&($e=0,L()),$e++}function ot(e){var t=e.length;if(0!==t){it();var n=Fe;Fe=!0;try{for(var r=0;r<t;r++){var s=e[r];s.f&w||(s.f^=w);var i=[];ut(s,i),at(i)}}finally{Fe=n}}}function at(e){var t=e.length;if(0!==t)for(var n=0;n<t;n++){var r=e[n];12288&r.f||!et(r)||(st(r),null===r.deps&&null===r.first&&null===r.nodes_start&&(null===r.teardown?Ae(r):r.fn=null))}}function ct(){if(Oe=!1,$e>1001)return;const e=Le;Le=[],ot(e),Oe||($e=0)}function lt(e){Se===Te&&(Oe||(Oe=!0,queueMicrotask(ct)));for(var t=e;null!==t.parent;){var n=(t=t.parent).f;if(96&n){if(!(n&w))return;t.f^=w}}Le.push(t)}function ut(e,t){var n=e.first,r=[];e:for(;null!==n;){var s=n.f,i=!!(s&v);if(!(i&&!!(s&w)||s&E))if(8&s){i?n.f^=w:et(n)&&st(n);var o=n.first;if(null!==o){n=o;continue}}else 4&s&&r.push(n);var a=n.next;if(null===a){let t=n.parent;for(;null!==t;){if(e===t)break e;var c=t.next;if(null!==c){n=c;continue e}t=t.parent}}n=a}for(var l=0;l<r.length;l++)o=r[l],t.push(o),ut(o,t)}function ft(e){var t=Se,n=Le;try{it();const t=[];Se=1,Le=t,Oe=!1,ot(n);var r=e?.();return xe&&Be(),ke&&Me(),(Le.length>0||t.length>0)&&ft(),$e=0,r}finally{Se=t,Le=n}}function dt(e){var t=e.f,n=!!(2&t);if(n&&t&C){var r=X(e);return ee(e),r}if(null!==Je&&Je.add(e),null!==Qe){null!==ze&&ze.includes(e)&&function(){throw new Error("state_unsafe_local_read")}();var s=Qe.deps;null===Ve&&null!==s&&s[He]===e?He++:null===Ve?Ve=[e]:Ve.push(e),null!==Ge&&null!==Pe&&Pe.f&w&&!(Pe.f&v)&&Ge.includes(e)&&(mt(Pe,x),lt(Pe))}else if(n&&null===e.deps){var i=e,o=i.parent;null===o||o.deriveds?.includes(i)||(o.deriveds??=[]).push(i)}return n&&et(i=e)&&Z(i),e.v}function pt(e){const t=Qe;try{return Qe=null,e()}finally{Qe=t}}const ht=-3585;function mt(e,t){e.f=e.f&ht|t}function yt(e){const t=At("getContext").get(e);return t}function At(e){return null===Ke&&Ne(),Ke.c??=new Map(function(e){let t=e.p;for(;null!==t;){const e=t.c;if(null!==e)return e;t=t.p}return null}(Ke)||void 0)}function gt(e,t=1){var n=+dt(e);return H(e,n+t),n}function vt(e,t=!1,n){Ke={p:Ke,c:null,e:null,m:!1,s:e,x:null,l:null},Q&&!t&&(Ke.l={s:null,u:null,r1:[],r2:j(!1)})}function _t(e){const t=Ke;if(null!==t){void 0!==e&&(t.x=e);const o=t.e;if(null!==o){var n=Pe,r=Qe;t.e=null;try{for(var s=0;s<o.length;s++){var i=o[s];Ye(i.effect),je(i.reaction),oe(i.fn)}}finally{Ye(n),je(r)}}Ke=t.p,t.m=!0}return e||{}}function bt(e){if("object"==typeof e&&e&&!(e instanceof EventTarget))if(N in e)wt(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];"object"==typeof n&&n&&N in n&&wt(n)}}function wt(e,t=new Set){if(!("object"!=typeof e||null===e||e instanceof EventTarget||t.has(e))){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{wt(e[n],t)}catch(e){}const n=h(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const t=f(n);for(let n in t){const r=t[n].get;if(r)try{r.call(e)}catch(e){}}}}}function xt(e,t=null,n){if("object"!=typeof e||null===e||N in e)return e;const s=h(e);if(s!==d&&s!==p)return e;var i,a=new Map,c=o(e),l=j(0);return c&&a.set("length",j(e.length)),new Proxy(e,{defineProperty(e,t,n){"value"in n&&!1!==n.configurable&&!1!==n.enumerable&&!1!==n.writable||function(){throw new Error("state_descriptors_fixed")}();var r=a.get(t);return void 0===r?(r=j(n.value),a.set(t,r)):H(r,xt(n.value,i)),!0},deleteProperty(e,t){var n=a.get(t);if(void 0===n)t in e&&a.set(t,j(r));else{if(c&&"string"==typeof t){var s=a.get("length"),i=Number(t);Number.isInteger(i)&&i<s.v&&H(s,i)}H(n,r),kt(l)}return!0},get(t,n,s){if(n===N)return e;var o=a.get(n),c=n in t;if(void 0!==o||c&&!u(t,n)?.writable||(o=j(xt(c?t[n]:r,i)),a.set(n,o)),void 0!==o){var l=dt(o);return l===r?void 0:l}return Reflect.get(t,n,s)},getOwnPropertyDescriptor(e,t){var n=Reflect.getOwnPropertyDescriptor(e,t);if(n&&"value"in n){var s=a.get(t);s&&(n.value=dt(s))}else if(void 0===n){var i=a.get(t),o=i?.v;if(void 0!==i&&o!==r)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return n},has(e,t){if(t===N)return!0;var n=a.get(t),s=void 0!==n&&n.v!==r||Reflect.has(e,t);if((void 0!==n||null!==Pe&&(!s||u(e,t)?.writable))&&(void 0===n&&(n=j(s?xt(e[t],i):r),a.set(t,n)),dt(n)===r))return!1;return s},set(e,t,n,s){var o=a.get(t),f=t in e;if(c&&"length"===t)for(var d=n;d<o.v;d+=1){var p=a.get(d+"");void 0!==p?H(p,r):d in e&&(p=j(r),a.set(d+"",p))}void 0===o?f&&!u(e,t)?.writable||(H(o=j(void 0),xt(n,i)),a.set(t,o)):(f=o.v!==r,H(o,xt(n,i)));var h=Reflect.getOwnPropertyDescriptor(e,t);if(h?.set&&h.set.call(s,n),!f){if(c&&"string"==typeof t){var m=a.get("length"),y=Number(t);Number.isInteger(y)&&y>=m.v&&H(m,y+1)}kt(l)}return!0},ownKeys(e){dt(l);var t=Reflect.ownKeys(e).filter((e=>{var t=a.get(e);return void 0===t||t.v!==r}));for(var[n,s]of a)s.v===r||n in e||t.push(n);return t},setPrototypeOf(){!function(){throw new Error("state_prototype_fixed")}()}})}function kt(e,t=1){H(e,e.v+t)}var Et,Ct,Bt,Mt;function It(){if(void 0===Et){Et=window,Ct=document;var e=Element.prototype,t=Node.prototype;Bt=u(t,"firstChild").get,Mt=u(t,"nextSibling").get,e.__click=void 0,e.__className="",e.__attributes=null,e.__styles=null,e.__e=void 0,Text.prototype.__t=void 0}}function Nt(e=""){return document.createTextNode(e)}function Tt(e){return Bt.call(e)}function St(e){return Mt.call(e)}function Ot(e,t){if(!Lt)return Tt(e);var n=Tt(Ut);if(null===n)n=Ut.appendChild(Nt());else if(t&&3!==n.nodeType){var r=Nt();return n?.before(r),Qt(r),r}return Qt(n),n}function Ft(e,t){if(!Lt){var n=Tt(e);return n instanceof Comment&&""===n.data?St(n):n}if(t&&3!==Ut?.nodeType){var r=Nt();return Ut?.before(r),Qt(r),r}return Ut}function Rt(e,t=1,n=!1){let r=Lt?Ut:e;for(;t--;)r=St(r);if(!Lt)return r;var s=r.nodeType;if(n&&3!==s){var i=Nt();return r?.before(i),Qt(i),i}return Qt(r),r}function Dt(e){e.textContent=""}let Ut,Lt=!1;function $t(e){Lt=e}function Qt(e){if(null===e)throw i(),n;return Ut=e}function jt(){return Qt(St(Ut))}function Pt(e){if(Lt){if(null!==St(Ut))throw i(),n;Ut=e}}function Yt(e=1){if(Lt){for(var t=e,n=Ut;t--;)n=St(n);Ut=n}}function zt(){for(var e=0,n=Ut;;){if(8===n.nodeType){var r=n.data;if("]"===r){if(0===e)return n;e-=1}else"["!==r&&r!==t||(e+=1)}var s=St(n);n.remove(),n=s}}function Vt(e,t){if(t){const t=document.body;e.autofocus=!0,Ie((()=>{document.activeElement===t&&e.focus()}))}}function Ht(e){var t=Qe,n=Pe;je(null),Ye(null);try{return e()}finally{je(t),Ye(n)}}const Gt=new Set,qt=new Set;function Wt(e,t,n,r){function s(e){if(r.capture||Xt.call(t,e),!e.cancelBubble)return Ht((()=>n.call(this,e)))}return e.startsWith("pointer")||e.startsWith("touch")||"wheel"===e?Ie((()=>{t.addEventListener(e,s,r)})):t.addEventListener(e,s,r),s}function Jt(e,t,n,r,s){var i={capture:r,passive:s},o=Wt(e,t,n,i);t!==document.body&&t!==window&&t!==document||re((()=>{t.removeEventListener(e,o,i)}))}function Kt(e){for(var t=0;t<e.length;t++)Gt.add(e[t]);for(var n of qt)n(e)}function Xt(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],i=s[0]||e.target,a=0,c=e.__root;if(c){var u=s.indexOf(c);if(-1!==u&&(t===document||t===window))return void(e.__root=t);var f=s.indexOf(t);if(-1===f)return;u<=f&&(a=u)}if((i=s[a]||e.target)!==t){l(e,"currentTarget",{configurable:!0,get:()=>i||n});var d=Qe,p=Pe;je(null),Ye(null);try{for(var h,m=[];null!==i;){var y=i.assignedSlot||i.parentNode||i.host||null;try{var A=i["__"+r];if(void 0!==A&&!i.disabled)if(o(A)){var[g,...v]=A;g.apply(i,[e,...v])}else A.call(i,e)}catch(e){h?m.push(e):h=e}if(e.cancelBubble||y===t||null===y)break;i=y}if(h){for(let e of m)queueMicrotask((()=>{throw e}));throw h}}finally{e.__root=t,delete e.currentTarget,je(d),Ye(p)}}}let Zt;function en(e){var t=document.createElement("template");return t.innerHTML=e,t.content}function tn(e,t){var n=Pe;null===n.nodes_start&&(n.nodes_start=e,n.nodes_end=t)}function nn(e,t){var n,r=!!(1&t),s=!!(2&t),i=!e.startsWith("<!>");return()=>{if(Lt)return tn(Ut,null),Ut;void 0===n&&(n=en(i?e:"<!>"+e),r||(n=Tt(n)));var t=s?document.importNode(n,!0):n.cloneNode(!0);r?tn(Tt(t),t.lastChild):tn(t,t);return t}}function rn(e,t,n="svg"){var r,s=!e.startsWith("<!>"),i=!!(1&t),o=`<${n}>${s?e:"<!>"+e}</${n}>`;return()=>{if(Lt)return tn(Ut,null),Ut;if(!r){var e=Tt(en(o));if(i)for(r=document.createDocumentFragment();Tt(e);)r.appendChild(Tt(e));else r=Tt(e)}var t=r.cloneNode(!0);i?tn(Tt(t),t.lastChild):tn(t,t);return t}}function sn(e=""){if(!Lt){var t=Nt(e+"");return tn(t,t),t}var n=Ut;return 3!==n.nodeType&&(n.before(n=Nt()),Qt(n)),tn(n,n),n}function on(){if(Lt)return tn(Ut,null),Ut;var e=document.createDocumentFragment(),t=document.createComment(""),n=Nt();return e.append(t,n),tn(t,n),e}function an(e,t){if(Lt)return Pe.nodes_end=Ut,void jt();null!==e&&e.before(t)}function cn(e){return e.endsWith("capture")&&"gotpointercapture"!==e&&"lostpointercapture"!==e}const ln=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function un(e){return ln.includes(e)}const fn=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","webkitdirectory"];const dn={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"};function pn(e){return e=e.toLowerCase(),dn[e]??e}const hn=["touchstart","touchmove"];let mn=!0;function yn(e,t){var n=null==t?"":"object"==typeof t?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=null==n?"":n+"")}function An(e,t){return _n(e,t)}function gn(e,t){It(),t.intro=t.intro??!1;const r=t.target,s=Lt,o=Ut;try{for(var a=Tt(r);a&&(8!==a.nodeType||"["!==a.data);)a=St(a);if(!a)throw n;$t(!0),Qt(a),jt();const s=_n(e,{...t,anchor:a});if(null===Ut||8!==Ut.nodeType||"]"!==Ut.data)throw i(),n;return $t(!1),s}catch(s){if(s===n)return!1===t.recover&&function(){throw new Error("hydration_failed")}(),It(),Dt(r),$t(!1),An(e,t);throw s}finally{$t(s),Qt(o),Zt=void 0}}const vn=new Map;function _n(e,{target:t,anchor:n,props:r={},events:s,context:i,intro:o=!0}){It();var c=new Set,l=e=>{for(var n=0;n<e.length;n++){var r=e[n];if(!c.has(r)){c.add(r);var s=(o=r,hn.includes(o));t.addEventListener(r,Xt,{passive:s});var i=vn.get(r);void 0===i?(document.addEventListener(r,Xt,{passive:s}),vn.set(r,1)):vn.set(r,i+1)}}var o};l(a(Gt)),qt.add(l);var u=void 0,f=ie((()=>{var a=n??t.appendChild(Nt());return de((()=>{i&&(vt({}),Ke.c=i);s&&(r.$$events=s),Lt&&tn(a,null),mn=o,u=e(a,r)||{},mn=!0,Lt&&(Pe.nodes_end=Ut),i&&_t()})),()=>{for(var e of c){t.removeEventListener(e,Xt);var r=vn.get(e);0==--r?(document.removeEventListener(e,Xt),vn.delete(e)):vn.set(e,r)}qt.delete(l),bn.delete(u),a!==n&&a.parentNode?.removeChild(a)}}));return bn.set(u,f),u}let bn=new WeakMap;function wn(e){const t=bn.get(e);t&&t()}function xn(e,n,r,s=null,i=!1){Lt&&jt();var o=e,a=null,c=null,l=null;fe((()=>{if(l===(l=!!n()))return;let e=!1;if(Lt){const n=o.data===t;l===n&&(Qt(o=zt()),$t(!1),e=!0)}l?(a?be(a):a=de((()=>r(o))),c&&ge(c,(()=>{c=null}))):(c?be(c):s&&(c=de((()=>s(o)))),a&&ge(a,(()=>{a=null}))),e&&$t(!0)}),i?B:0),Lt&&(o=Ut)}let kn=null;function En(e,t){return t}function Cn(e,n,r,s,i,c=null){var l=e,u={flags:n,items:new Map,first:null};if(!!(4&n)){var f=e;l=Lt?Qt(Tt(f)):f.appendChild(Nt())}Lt&&jt();var d=null,p=!1;fe((()=>{var e=r(),f=o(e)?e:null==e?[]:a(e),h=f.length;if(p&&0===h)return;p=0===h;let m=!1;Lt&&(l.data===t!==(0===h)&&(Qt(l=zt()),$t(!1),m=!0));if(Lt){for(var y,A=null,g=0;g<h;g++){if(8===Ut.nodeType&&"]"===Ut.data){l=Ut,m=!0,$t(!1);break}var v=f[g],_=s(v,g);y=Mn(Ut,u,A,null,v,_,g,i,n),u.items.set(_,y),A=y}h>0&&Qt(zt())}Lt||function(e,t,n,r,s,i,o){var c,l,u,f,d,p,h=!!(8&s),m=!!(3&s),y=e.length,A=t.items,g=t.first,v=g,_=null,b=[],w=[];if(h)for(p=0;p<y;p+=1)f=o(u=e[p],p),void 0!==(d=A.get(f))&&(d.a?.measure(),(l??=new Set).add(d));for(p=0;p<y;p+=1)if(f=o(u=e[p],p),void 0!==(d=A.get(f))){if(m&&Bn(d,u,p,s),d.e.f&E&&(be(d.e),h&&(d.a?.unfix(),(l??=new Set).delete(d))),d!==v){if(void 0!==c&&c.has(d)){if(b.length<w.length){var x,k=w[0];_=k.prev;var C=b[0],B=b[b.length-1];for(x=0;x<b.length;x+=1)In(b[x],k,n);for(x=0;x<w.length;x+=1)c.delete(w[x]);Nn(t,C.prev,B.next),Nn(t,_,C),Nn(t,B,k),v=k,_=B,p-=1,b=[],w=[]}else c.delete(d),In(d,v,n),Nn(t,d.prev,d.next),Nn(t,d,null===_?t.first:_.next),Nn(t,_,d),_=d;continue}for(b=[],w=[];null!==v&&v.k!==f;)!i&&v.e.f&E||(c??=new Set).add(v),w.push(v),v=v.next;if(null===v)continue;d=v}b.push(d),_=d,v=d.next}else{_=Mn(v?v.e.nodes_start:n,t,_,null===_?t.first:_.next,u,f,p,r,s),A.set(f,_),b=[],w=[],v=_.next}if(null!==v||void 0!==c){for(var M=void 0===c?[]:a(c);null!==v;)!i&&v.e.f&E||M.push(v),v=v.next;var I=M.length;if(I>0){var N=4&s&&0===y?n:null;if(h){for(p=0;p<I;p+=1)M[p].a?.measure();for(p=0;p<I;p+=1)M[p].a?.fix()}!function(e,t,n,r){for(var s=[],i=t.length,o=0;o<i;o++)_e(t[o].e,s,!0);var a=i>0&&0===s.length&&null!==n;if(a){var c=n.parentNode;Dt(c),c.append(n),r.clear(),Nn(e,t[0].prev,t[i-1].next)}ve(s,(()=>{for(var n=0;n<i;n++){var s=t[n];a||(r.delete(s.k),Nn(e,s.prev,s.next)),ye(s.e,!a)}}))}(t,M,N,A)}}h&&Ie((()=>{if(void 0!==l)for(d of l)d.a?.apply()}));Pe.first=t.first&&t.first.e,Pe.last=_&&_.e}(f,u,l,i,n,!!(Qe.f&E),s);null!==c&&(0===h?d?be(d):d=de((()=>c(l))):null!==d&&ge(d,(()=>{d=null}))),m&&$t(!0),r()})),Lt&&(l=Ut)}function Bn(e,t,n,r){1&r&&G(e.v,t),2&r?G(e.i,n):e.i=n}function Mn(e,t,n,r,s,i,o,a,c){var l=kn,u=!!(1&c)?!(16&c)?P(s):j(s):s,f=2&c?j(o):o,d={i:f,v:u,k:i,a:null,e:null,prev:n,next:r};kn=d;try{return d.e=de((()=>a(e,u,f)),Lt),d.e.prev=n&&n.e,d.e.next=r&&r.e,null===n?t.first=d:(n.next=d,n.e.next=d.e),null!==r&&(r.prev=d,r.e.prev=d.e),d}finally{kn=l}}function In(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,s=t?t.e.nodes_start:n,i=e.e.nodes_start;i!==r;){var o=St(i);s.before(i),i=o}}function Nn(e,t,n){null===t?e.first=n:(t.next=n,t.e.next=n&&n.e),null!==n&&(n.prev=t,n.e.prev=t&&t.e)}function Tn(e,t,r,s,o){var a,c=e,l="";fe((()=>{l!==(l=t()??"")?(void 0!==a&&(ye(a),a=void 0),""!==l&&(a=de((()=>{if(Lt){Ut.data;for(var e=jt(),t=e;null!==e&&(8!==e.nodeType||""!==e.data);)t=e,e=St(e);if(null===e)throw i(),n;return tn(Ut,t),void(c=Qt(e))}var o=l+"";r?o=`<svg>${o}</svg>`:s&&(o=`<math>${o}</math>`);var a=en(o);if((r||s)&&(a=Tt(a)),tn(Tt(a),a.lastChild),r||s)for(;Tt(a);)c.before(Tt(a));else c.before(a)})))):Lt&&jt()}))}function Sn(e,t,n,r,s){Lt&&jt();var i=t.$$slots?.[n],o=!1;!0===i&&(i=t["default"===n?"children":n],o=!0),void 0===i?null!==s&&s(e):i(e,o?()=>r:r)}function On(e){const t={};e.children&&(t.default=!0);for(const n in e.$$slots)t[n]=!0;return t}function Fn(e,t,n){Lt&&jt();var r,s,i=e;fe((()=>{r!==(r=t())&&(s&&(ge(s),s=null),r&&(s=de((()=>n(i,r)))))}),B),Lt&&(i=Ut)}function Rn(e,t,n,r){var s=e.__attributes??={};Lt&&(s[t]=e.getAttribute(t),"src"===t||"srcset"===t||"href"===t&&"LINK"===e.nodeName)?r||$n(e,t,n??""):s[t]!==(s[t]=n)&&("style"===t&&"__styles"in e&&(e.__styles={}),"loading"===t&&(e[O]=n),null==n?e.removeAttribute(t):"string"!=typeof n&&Ln(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Dn(e,t,n,r,s=!1,i=!1,o=!1){var a=t||{},c="OPTION"===e.tagName;for(var l in t)l in n||(n[l]=null);void 0!==r&&(n.class=n.class?n.class+" "+r:r);var u=Ln(e),f=e.__attributes??={},d=[];for(const A in n){let g=n[A];if(c&&"value"===A&&null==g)e.value=e.__value="",a[A]=g;else{var p=a[A];if(g!==p){a[A]=g;var h=A[0]+A[1];if("$$"!==h){if("on"===h){const v={},_="$$"+A;let b=A.slice(2);var m=un(b);if(cn(b)&&(b=b.slice(0,-7),v.capture=!0),!m&&p){if(null!=g)continue;e.removeEventListener(b,a[_],v),a[_]=null}if(null!=g)if(m)e[`__${b}`]=g,Kt([b]);else{function w(e){a[A].call(this,e)}t?a[_]=Wt(b,e,w,v):d.push([A,g,()=>a[_]=Wt(b,e,w,v)])}}else if("style"===A&&null!=g)e.style.cssText=g+"";else if("autofocus"===A)Vt(e,Boolean(g));else if("__value"===A||"value"===A&&null!=g)e.value=e[A]=e.__value=g;else{var y=A;s||(y=pn(y)),null!=g||i?u.includes(y)&&(i||"string"!=typeof g)?e[y]=g:"function"!=typeof g&&(!Lt||"src"!==y&&"href"!==y&&"srcset"!==y?Rn(e,y,g):o||$n(e,y,g??"")):(f[A]=null,e.removeAttribute(A))}"style"===A&&"__styles"in e&&(e.__styles={})}}}}return t||Ie((()=>{if(e.isConnected)for(const[e,t,n]of d)a[e]===t&&n()})),a}var Un=new Map;function Ln(e){var t,n=Un.get(e.nodeName);if(n)return n;Un.set(e.nodeName,n=[]);for(var r=h(e),s=Element.prototype;s!==r;){for(var i in t=f(r))t[i].set&&n.push(i);r=h(r)}return n}function $n(e,t,n){}function Qn(e,t){var n=e.__className,r=jn(t);Lt&&e.className===r?e.__className=r:(n!==r||Lt&&e.className!==r)&&(null==t?e.removeAttribute("class"):e.className=r,e.__className=r)}function jn(e){return null==e?"":e}function Pn(e,t,n){if(n){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}const Yn=()=>performance.now(),zn={tick:e=>requestAnimationFrame(e),now:()=>Yn(),tasks:new Set};function Vn(e){zn.tasks.forEach((t=>{t.c(e)||(zn.tasks.delete(t),t.f())})),0!==zn.tasks.size&&zn.tick(Vn)}function Hn(e,t){e.dispatchEvent(new CustomEvent(t))}function Gn(e){if("float"===e)return"cssFloat";if("offset"===e)return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return 1===t.length?t[0]:t[0]+t.slice(1).map((e=>e[0].toUpperCase()+e.slice(1))).join("")}function qn(e){const t={},n=e.split(";");for(const e of n){const[n,r]=e.split(":");if(!n||void 0===r)break;t[Gn(n.trim())]=r.trim()}return t}const Wn=e=>e;function Jn(e,t,n,r){var s,i,o,a=!!(1&e),c=!!(2&e),l=!!(4&e),u=a&&c?"both":a?"in":"out",f=t.inert;function d(){var e=Qe,i=Pe;je(null),Ye(null);try{return s??=n()(t,r?.()??{},{direction:u})}finally{je(e),Ye(i)}}var p={is_global:l,in(){if(t.inert=f,!a)return o?.abort(),void o?.reset?.();c||i?.abort(),Hn(t,"introstart"),i=Kn(t,d(),o,1,(()=>{Hn(t,"introend"),i?.abort(),i=s=void 0}))},out(e){if(!c)return e?.(),void(s=void 0);t.inert=!0,Hn(t,"outrostart"),o=Kn(t,d(),i,0,(()=>{Hn(t,"outroend"),e?.()}))},stop:()=>{i?.abort(),o?.abort()}},h=Pe;if((h.transitions??=[]).push(p),a&&mn){var m=l;if(!m){for(var y=h.parent;y&&y.f&B;)for(;(y=y.parent)&&!(16&y.f););m=!y||!!(16384&y.f)}m&&oe((()=>{pt((()=>p.in()))}))}}function Kn(e,t,n,r,s){var i=1===r;if(m(t)){var o,a=!1;return Ie((()=>{if(!a){var c=t({direction:i?"in":"out"});o=Kn(e,c,n,r,s)}})),{abort:()=>{a=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(n?.deactivate(),!t?.duration)return s(),{abort:y,deactivate:y,reset:y,t:()=>r};const{delay:c=0,css:l,tick:u,easing:f=Wn}=t;var d=[];if(i&&void 0===n&&(u&&u(0,1),l)){var p=qn(l(0,1));d.push(p,p)}var h=()=>1-r,A=e.animate(d,{duration:c});return A.onfinish=()=>{var i=n?.t()??1-r;n?.abort();var o=r-i,a=t.duration*Math.abs(o),c=[];if(a>0){if(l)for(var d=Math.ceil(a/(1e3/60)),p=0;p<=d;p+=1){var m=i+o*f(p/d),y=l(m,1-m);c.push(qn(y))}h=()=>{var e=A.currentTime;return i+o*f(e/a)},u&&function(e){let t;0===zn.tasks.size&&zn.tick(Vn),new Promise((n=>{zn.tasks.add(t={c:e,f:n})}))}((()=>{if("running"!==A.playState)return!1;var e=h();return u(e,1-e),!0}))}(A=e.animate(c,{duration:a,fill:"forwards"})).onfinish=()=>{h=()=>r,u?.(r,1-r),s()}},{abort:()=>{A&&(A.cancel(),A.effect=null,A.onfinish=y)},deactivate:()=>{s=y},reset:()=>{0===r&&u?.(1,0)},t:()=>h()}}new Set;function Xn(e,t,n){var r=u(e,t);r&&r.set&&(e[t]=n,re((()=>{e[t]=null})))}new WeakMap;function Zn(e,t){return e===t||e?.[N]===t}function er(e={},t,n,r){return oe((()=>{var s,i;return le((()=>{s=i,i=r?.()||[],pt((()=>{e!==n(...i)&&(t(e,...i),s&&Zn(n(...s),e)&&t(null,...s))}))})),()=>{Ie((()=>{i&&Zn(n(...i),e)&&t(null,...i)}))}})),e}function tr(e,t){!function(e,t,n,r=!0){for(var s of(r&&n(),t))e.addEventListener(s,n);re((()=>{for(var r of t)e.removeEventListener(r,n)}))}(window,["resize"],(()=>Ht((()=>t(window[e])))))}function nr(e=!1){const t=Ke,n=t.l.u;if(!n)return;let r=()=>bt(t.s);if(e){let e=0,n={};const s=W((()=>{let r=!1;const s=t.s;for(const e in s)s[e]!==n[e]&&(n[e]=s[e],r=!0);return r&&e++,e}));r=()=>dt(s)}var s;n.b.length&&(s=()=>{rr(t,r),g(n.b)},te(),le(s)),se((()=>{const e=pt((()=>n.m.map(A)));return()=>{for(const t of e)"function"==typeof t&&t()}})),n.a.length&&se((()=>{rr(t,r),g(n.a)}))}function rr(e,t){if(e.l.s)for(const t of e.l.s)dt(t);t()}function sr(e,t){var n=e.$$events?.[t.type],r=o(n)?n.slice():null==n?[]:[n];for(var s of r)s.call(this,t)}function ir(e){null===Ke&&Ne(),Q&&null!==Ke.l?lr(Ke).m.push(e):se((()=>{const t=pt(e);if("function"==typeof t)return t}))}function or(e){null===Ke&&Ne(),ir((()=>()=>pt(e)))}function ar(){const e=Ke;return null===e&&Ne(),(t,n,r)=>{const s=e.s.$$events?.[t];if(s){const i=o(s)?s.slice():[s],a=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(t,n,r);for(const t of i)t.call(e.x,a);return!a.defaultPrevented}return!0}}function cr(e){null===Ke&&Ne(),null===Ke.l&&$(),lr(Ke).a.push(e)}function lr(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}let ur=!1;function fr(e,t,n){const r=n[t]??={store:null,source:P(void 0),unsubscribe:y};if(r.store!==e)if(r.unsubscribe(),r.store=e??null,null==e)r.source.v=void 0,r.unsubscribe=y;else{var s=!0;r.unsubscribe=function(e,t,n){if(null==e)return t(void 0),n&&n(void 0),y;const r=pt((()=>e.subscribe(t,n)));return r.unsubscribe?()=>r.unsubscribe():r}(e,(e=>{s?r.source.v=e:H(r.source,e)})),s=!1}return dt(r.source)}function dr(e,t){return e.set(t),t}function pr(){const e={};return re((()=>{for(var t in e){e[t].unsubscribe()}})),e}function hr(e,t,n){return e.set(n),t}const mr={get(e,t){if(!e.exclude.includes(t))return dt(e.version),t in e.special?e.special[t]():e.props[t]},set:(e,t,n)=>(t in e.special||(e.special[t]=_r({get[t](){return e.props[t]}},t,4)),e.special[t](n),gt(e.version),!0),getOwnPropertyDescriptor(e,t){if(!e.exclude.includes(t))return t in e.props?{enumerable:!0,configurable:!0,value:e.props[t]}:void 0},deleteProperty:(e,t)=>(e.exclude.includes(t)||(e.exclude.push(t),gt(e.version)),!0),has:(e,t)=>!e.exclude.includes(t)&&t in e.props,ownKeys:e=>Reflect.ownKeys(e.props).filter((t=>!e.exclude.includes(t)))};function yr(e,t){return new Proxy({props:e,exclude:t,special:{},version:j(0)},mr)}const Ar={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(m(r)&&(r=r()),"object"==typeof r&&null!==r&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];m(s)&&(s=s());const i=u(s,t);if(i&&i.set)return i.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(m(r)&&(r=r()),"object"==typeof r&&null!==r&&t in r){const e=u(r,t);return e&&!e.configurable&&(e.configurable=!0),e}}},has(e,t){if(t===N||t===T)return!1;for(let n of e.props)if(m(n)&&(n=n()),null!=n&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props){m(n)&&(n=n());for(const e in n)t.includes(e)||t.push(e)}return t}};function gr(...e){return new Proxy({props:e},Ar)}function vr(e){for(var t=Pe,n=Pe;null!==t&&!(96&t.f);)t=t.parent;try{return Ye(t),e()}finally{Ye(n)}}function _r(e,t,n,r){var s,i=!!(1&n),o=!Q||!!(2&n),a=!!(8&n),c=!!(16&n),l=!1;a?[s,l]=function(e){var t=ur;try{return ur=!1,[e(),ur]}finally{ur=t}}((()=>e[t])):s=e[t];var f,d=N in e||T in e,p=u(e,t)?.set??(d&&a&&t in e?n=>e[t]=n:void 0),h=r,m=!0,y=!1,A=()=>(y=!0,m&&(m=!1,h=c?pt(r):r),h);if(void 0===s&&void 0!==r&&(p&&o&&function(){throw new Error("props_invalid_value")}(),s=A(),p&&p(s)),o)f=()=>{var n=e[t];return void 0===n?A():(m=!0,y=!1,n)};else{var g=vr((()=>(i?W:J)((()=>e[t]))));g.f|=65536,f=()=>{var e=dt(g);return void 0!==e&&(h=void 0),void 0===e?h:e}}if(!(4&n))return f;if(p){var v=e.$$legacy;return function(e,t){return arguments.length>0?(o&&t&&!v&&!l||p(t?f():e),e):f()}}var _=!1,b=!1,w=P(s),x=vr((()=>W((()=>{var e=f(),t=dt(w);return _?(_=!1,b=!0,t):(b=!1,w.v=e)}))));return i||(x.equals=U),function(e,t){if(null!==Je&&(_=b,f(),dt(w)),arguments.length>0){const n=t?dt(x):o&&a?xt(e):e;return x.equals(n)||(_=!0,H(w,n),y&&void 0!==h&&(h=n),pt((()=>dt(x)))),e}return dt(x)}}class br{#e;#t;constructor(e){var t=new Map,n=(e,n)=>{var r=P(n);return t.set(e,r),r};const r=new Proxy({...e.props||{},$$events:{}},{get:(e,r)=>dt(t.get(r)??n(r,Reflect.get(e,r))),has:(e,r)=>r===T||(dt(t.get(r)??n(r,Reflect.get(e,r))),Reflect.has(e,r)),set:(e,r,s)=>(H(t.get(r)??n(r,s),s),Reflect.set(e,r,s))});this.#t=(e.hydrate?gn:An)(e.component,{target:e.target,anchor:e.anchor,props:r,context:e.context,intro:e.intro??!1,recover:e.recover}),e?.props?.$$host&&!1!==e.sync||ft(),this.#e=r.$$events;for(const e of Object.keys(this.#t))"$set"!==e&&"$destroy"!==e&&"$on"!==e&&l(this,e,{get(){return this.#t[e]},set(t){this.#t[e]=t},enumerable:!0});this.#t.$set=e=>{Object.assign(r,e)},this.#t.$destroy=()=>{wn(this.#t)}}$set(e){this.#t.$set(e)}$on(e,t){this.#e[e]=this.#e[e]||[];const n=(...e)=>t.call(this,...e);return this.#e[e].push(n),()=>{this.#e[e]=this.#e[e].filter((e=>e!==n))}}$destroy(){this.#t.$destroy()}}let wr;function xr(e,t,n,r){const s=n[e]?.type;if(t="Boolean"===s&&"boolean"!=typeof t?null!=t:t,!r||!n[e])return t;if("toAttribute"===r)switch(s){case"Object":case"Array":return null==t?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return null==t?null:t;default:return t}else switch(s){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":default:return t;case"Number":return null!=t?+t:t}}"function"==typeof HTMLElement&&(wr=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(e,t,n){super(),this.$$ctor=e,this.$$s=t,n&&this.attachShadow({mode:"open"})}addEventListener(e,t,n){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){const n=this.$$c.$on(e,t);this.$$l_u.set(t,n)}super.addEventListener(e,t,n)}removeEventListener(e,t,n){if(super.removeEventListener(e,t,n),this.$$c){const e=this.$$l_u.get(t);e&&(e(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(e){return t=>{const n=document.createElement("slot");"default"!==e&&(n.name=e),an(t,n)}}const n={},r=function(e){const t={};return e.childNodes.forEach((e=>{t[e.slot||"default"]=!0})),t}(this);for(const s of this.$$s)s in r&&("default"!==s||this.$$d.children?n[s]=t(s):(this.$$d.children=t(s),n.default=!0));for(const i of this.attributes){const o=this.$$g_p(i.name);o in this.$$d||(this.$$d[o]=xr(o,i.value,this.$$p_d,"toProp"))}for(const a in this.$$p_d)a in this.$$d||void 0===this[a]||(this.$$d[a]=this[a],delete this[a]);this.$$c=(e={component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:n,$$host:this}},new br(e)),this.$$me=ie((()=>{le((()=>{this.$$r=!0;for(const e of c(this.$$c)){if(!this.$$p_d[e]?.reflect)continue;this.$$d[e]=this.$$c[e];const t=xr(e,this.$$d[e],this.$$p_d,"toAttribute");null==t?this.removeAttribute(this.$$p_d[e].attribute||e):this.setAttribute(this.$$p_d[e].attribute||e,t)}this.$$r=!1}))}));for(const l in this.$$l)for(const u of this.$$l[l]){const f=this.$$c.$on(l,u);this.$$l_u.set(u,f)}this.$$l={}}var e}attributeChangedCallback(e,t,n){this.$$r||(e=this.$$g_p(e),this.$$d[e]=xr(e,n,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)}))}$$g_p(e){return c(this.$$p_d).find((t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e))||e}});new Map([[!0,"yes"],[!1,"no"]]);var kr=__webpack_require__(65),Er=__webpack_require__.n(kr),Cr=__webpack_require__(631),Br=__webpack_require__.n(Cr);function Mr(e,t){if(!e){throw new Error(t?"Assertion failure: "+t:"Assertion failure")}}function Ir(e){const t=new Array(e.length);for(let n=0;n<e.length;n++){let r,s=e.charCodeAt(n);r=s<32||s>127?s:(s+15)%94+32,t[n]=String.fromCharCode(r)}return t.join("")}function Nr(e){let t;if("string"==typeof e||e instanceof String)t=Ir(e);else if("number"==typeof e||e instanceof Number)t=e;else if(Array.isArray(e)){t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=Nr(e[n])}else{t={};for(const[n,r]of Object.entries(e))t[Ir(n)]=Nr(r)}return t}Mr.ok=Mr;const Tr={assert:Mr,cloneRot:Nr};var Sr=__webpack_require__(84),Or=__webpack_require__.n(Sr);const Fr=Br().getLogger("audiolib"),Rr=Tr.assert,Dr={META:255,F0SYSEX:240,F7SYSEX:247},Ur={};Object.keys(Dr).reduce(((e,t)=>(e[Dr[t]]=t,e)),Ur);const Lr={seqNum:0,text:1,copyright:2,trackName:3,instrumentName:4,lyric:5,mark:6,cue:7,chPrefix:32,endOfTrack:47,tempo:81,SMTPE:84,timeSig:88,keySig:89,sequencerSpecific:127},$r={};Object.keys(Lr).reduce(((e,t)=>(e[Lr[t]]=t,e)),$r);const Qr={noteOff:128,noteOn:144,keyAftertouch:160,control:176,program:192,chAftertouch:208,bend:224},jr={};Object.keys(Qr).reduce(((e,t)=>(e[Qr[t]]=t,e)),jr);const Pr={volume:7,pan:160,holdPedal:64,allSoundOff:120,resetControllers:121,localControl:122,allNotesOff:123,omniModeOff:124,omniModeOn:125,monoModeOn:126,polyModeOn:127},Yr={};Object.keys(Pr).reduce(((e,t)=>(e[Pr[t]]=t,e)),Yr);function zr(e){return("0"+e.toString(16)).slice(-2)}function Vr(e,t,n){let r="";for(let s=t;s<=n;s++)r+=zr(e[s]);return parseInt(r,16)}function Hr(e,t,n){let r="";for(let s=t;s<=n;s++)r+=String.fromCharCode(e[s]);return r}function Gr(e,t){let n=255&e,r=e>>8&255;t.push(r),t.push(n)}function qr(e,t){let n=Jr(e);for(let e=0;e<n.length;e++)t.push(n[e])}function Wr(e,t){for(let n=0;n<e.length;n++)t.push(e[n].charCodeAt(0))}function Jr(e){return arr=new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]),arr}function Kr(e){Rr(e<268435455,"too big");let t=[];return t.push(127&e),e>>7>0&&(t.unshift(e>>7&127|128),e>>14>0&&(t.unshift(e>>14&127|128),e>>21>0&&t.unshift(e>>21&127|128))),t}function Xr(e,t){let n=0,r=1,s=e[t];for(;128&s;)n<<=7,n|=127&s,s=e[t+r],r++;return n<<=7,n|=s,{val:n,len:r}}function Zr(e,t){let n=[];if(n=n.concat(Kr(e.deltaTime)),"MIDI"==e.type)if(e.subtype==S.MidiTypes.control)n.push(e.subtype|t),n.push(e.data[0]),n.push(e.data[1]);else if(e.subtype==S.MidiTypes.program)n.push(e.subtype|t),n.push(e.data);else{if(e.subtype!=S.MidiTypes.noteOff&&e.subtype!=S.MidiTypes.noteOn)throw`Unknown MIDI event ${e.subtype}`;n.push(e.subtype|t),n.push(e.data[0]),n.push(e.data[1])}else if("META"==e.type)if(e.subtype==S.MetaTypes.timeSig)n.push(255),n.push(e.subtype),n.push(4),n=n.concat(e.data);else if(e.subtype==S.MetaTypes.keySig)n.push(255),n.push(e.subtype),n.push(2),n.push(e.data[0]),n.push(e.data[1]);else if(e.subtype==S.MetaTypes.tempo){n.push(255),n.push(e.subtype),n.push(3);let t=numToBytes(e.data,3);Rr(e.data<16777215,`Tempo ${e.data} too large`),n=n.concat(t)}else{if(e.subtype!=S.MetaTypes.text&&e.subtype!=S.MetaTypes.copyright&&e.subtype!=S.MetaTypes.trackName&&e.subtype!=S.MetaTypes.endOfTrack)throw Fr.error(`Unknown Meta Event subtype ${e.subtype}`),`Unknown Meta Event subtype ${e.subtype}`;n.push(255),n.push(e.subtype),n=n.concat(Kr(e.data.length));for(let t=0;t<e.data.length;t++)n.push(e.data[t].charCodeAt(0))}return n}function es(e){let t="",n=e.header;t+="HEADER\n",t+=" ",n.pos&&(t+=` pos: ${n.pos}`),t+=` len:${n.len} format:${n.format} tracks:${n.tracks}\n`,n.ticksPerQuarterNote?t+=`  ticksPerQuarterNote:${n.ticksPerQuarterNote}\n`:(t+=`  smtpeTicksPerFrame: ${n.smtpeTicksPerFrame}`,t+=` smtpeFramesPerSec: ${n.smtpeFramesPerSec}\n`),t+="TRACKS\n";let r=e.tracks;for(let e=0;e<r.length;e++){let n=r[e];t+=` Track ${e}`,n.pos&&(t+=` pos: ${n.pos}`),n.len&&(t+=` len: ${n.len}`),t+="\n";let s=n.events;for(let e=0;e<s.length;e++){let n=s[e];t+=` ${String(n.deltaTime).padStart(5," ")} ${n.type_desc}`,n.subtype_desc&&(t+=` ${n.subtype_desc}`),n.len&&(t+=` ${n.len}`),t+=` data:${JSON.stringify(n.data,0,0)}\n`}}return t}function ts(e){let t="",n=Math.floor(e.length/16)+1;for(let r=0;r<n;r++){r>0&&(t+="\r\n");let n=16*r,s=Math.min(16*(1+r)-1,e.length-1),i="",o="";for(let t=n;t<=s;t++)i+=zr(e[t])+" ",e[t]>20&&e[t]<127?o+=String.fromCharCode(e[t]):o+="?";t+=i+" | "+o}return t}const ns={__test__:{byteToHex:zr},Symbols:{EventTypes:Dr,EventCodes:Ur,MetaTypes:Lr,MetaCodes:$r,MidiTypes:Qr,MidiCodes:jr,ControllerTypes:Pr,ControllerCodes:Yr,ControllerValues:{OFF:0,ON:127},Instruments:{ACOUSTIC_GRAND:0},NoteEventDataIdx:{CHANNEL:0,KEY:1,VELOCITY:2}},Defaults:{CHANNEL:1,PROGRAM:0},getMidiKey:function(e,t){let n=24+12*(Number(e[1])-1)+{C:0,D:2,E:4,F:5,G:7,A:9,B:11}[e[0]]+t;return Rr(n>=21&&n<=108,`Note ${e} shifted by ${t} is out of range 21-108.`),n},getNote:function(e){let t=Math.floor(e/12)-1;return["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][e%12]+t},writeArray2File:function(e,t){let n=new Uint8Array(t);fs.writeFileSync(e,n)},midi2MidiObj:function(e){let t=function(e){-1!=e.indexOf("base64,")&&(e=e.split(",")[1]);let t=Or()(e),n=t.length,r=[];for(let e=0;e<n;e++)r.push(t.charCodeAt(e));return r}(e);ts(t);let n=0,r=[],s=[];for(;n<t.length-3;)if(77==t[n]&&84==t[n+1]&&104==t[n+2]&&100==t[n+3]){r.length>0&&Fr.error("More than one header chunk.");let e=Vr(t,n+4,n+7);6==e||Fr.error(`MThd length should always be 6. It is ${e}.`);let s=Vr(t,n+8,n+9);0!==s&&1!==s&&2!==s&&Fr.error(`MThd format should be 0, 1, or 2. It is ${s}.`);let a={pos:n,len:e,format:s,tracks:Vr(t,n+10,n+11)},c=256*(i=t)[o=n+12]+i[o+1];32768&c?(a.smtpeTicksPerFrame=255&c,a.smtpeFramesPerSec=32512&c):a.ticksPerQuarterNote=c,r.push(a),n+=8+e}else if(77==t[n]&&84==t[n+1]&&114==t[n+2]&&107==t[n+3]){let e=Vr(t,n+4,n+7),r=[],i=n+8,o=0;for(;o<e;){let e=Xr(t,i+o);o+=e.len;let n=t[i+o],s={deltaTime:e.val};if(n==Dr.META){o++,s.type=Dr.META,s.type_desc=Ur[s.type];let e=t[i+o];s.subtype=e,s.subtype_desc=$r[s.subtype],o++;let n,r=Xr(t,i+o);if(s.len=r.val,o+=r.len,s.subtype==Lr.seqNum){Rr(2==s.len,`Sequence Number has wrong length ${s.len}.`);let e=i+o;n=Vr(t,e,e+s.len-1)}else if([Lr.text,Lr.copyright,Lr.trackName,Lr.instrumentName,Lr.lyric,Lr.mark,Lr.cue].indexOf(s.subtype)>-1)n=Hr(t,i+o,i+o+r.val-1);else if(e==Lr.chPrefix){Rr(1==s.len,`MIDI Channel Prefix has wrong length ${s.len}.`);let e=i+o;n=Vr(t,e,e+s.len-1)}else if(s.subtype==Lr.endOfTrack)Rr(0==s.len,`End of Track has wrong length ${s.len}.`),n=0;else if(s.subtype==Lr.tempo)n=Vr(t,i+o,i+o+s.len-1);else if(s.subtype==Lr.SMTPE){Rr(5==s.len,`SMTPE Offset has wrong length ${s.len}.`);let e=i+o;n=Array.from(t.slice(e,e+s.len))}else if(s.subtype==Lr.timeSig||s.subtype==Lr.keySig){let e=i+o;n=Array.from(t.slice(e,e+s.len))}else if(s.subtype==Lr.sequencerSpecific){let e=i+o;n=Array.from(t.slice(e,e+s.len))}else Rr(!1,`Unhandled META ${e.toString(16)}.`);s.data=n,o+=r.val}else if(n==Dr.F0SYSEX||n==Dr.F7SYSEX){s.desc=Ur[n],o++;let e=Xr(t,i+o);s.len=e.val;let r=Hr(t,i+o,i+o+e.len);s.data=r,o+=e.len}else if(jr[240&n]){s.type=240&n;let e=15&n;if(s.type_desc=jr[s.type],s.type==Qr.noteOff||s.type==Qr.noteOn)s.len=3,s.data=[e,t[i+o+1],t[i+o+2]],o+=s.len;else if(s.type==Qr.keyAftertouch)s.len=3,s.data=[e,t[i+o+1],t[i+o+2]],o+=s.len;else if(s.type==Qr.program)s.len=2,s.data=[e,t[i+o+1]],o+=s.len;else if(s.type==Qr.chAftertouch)s.len=2,s.data=[e,t[i+o+1]],o+=s.len;else if(s.type==Qr.bend)s.len=3,s.data=[e,t[i+o+1],t[i+o+2]],o+=s.len;else if(s.type==Qr.control){let n=t[i+o+1];s.subtype=n,s.subtype_desc=Yr[n],s.len=3,s.data=[e,t[i+o+1],t[i+o+2]],o+=s.len}}else Fr.warn(`UNKNOWN EVENT_TYPE ${n.toString(16)}.`);r.push(s)}let a={pos:n,len:e,events:r};s.push(a),n+=8+e}else n++;var i,o;Rr(1==r.length,`A MIDI file should have 1 header chunk. Have ${r.length}.`),Rr(r[0].tracks==s.length,`Header tracks (${r[0].tracks}) does not match number of track chunks (${s.length}).`),Rr(s.length>0,"No track chunks present!"),Rr(0!=r[0].format||1==s.length,`Format 0 files should have only one track. Have ${s.length}`);let a={header:r[0],tracks:s};return es(a),a},midiObj2MidiArray:function(e){let t=[];Wr(e.header.type,t),qr(e.header.length,t),Gr(e.header.format,t),Gr(e.header.tracks,t),Gr(e.header.ticksPerQuarterNote,t);let n=0;for(let r of e.tracks){let e=[];for(let t=0;t<r.events.length;t++){let s=Zr(r.events[t],n);e=e.concat(s)}let s=[];Wr(r.type,s),qr(e.length,s),t=t.concat(s),t=t.concat(e),n++}return ts(t),t},dumpMidiObj:es,dumpHex:ts},rs=Br().getLogger("audiolib"),ss=Tr.assert,is="CDEFGABcdefgab",os=[".","~","H","L","M","O","P","S","T","u","v"],as={NOTE:{groups:["NCR"]},CHORD:{groups:["NCR"]},REST:{groups:["NCR"]},PPP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},PP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},P:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},MP:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},MF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},F:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},FF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},FFF:{groups:["DYNAMICS","DYNAMIC_LEVELS"]},START_CRESC:{groups:["DYNAMICS","START_CRESC_DECRESCS"]},END_CRESC:{groups:["DYNAMICS","END_CRESC_DECRESCS"]},START_DECRESC:{groups:["DYNAMICS","START_CRESC_DECRESCS"]},END_DECRESC:{groups:["DYNAMICS","END_CRESC_DECRESCS"]},PED:{groups:["DYNAMICS"],data:[ns.Symbols.ControllerTypes.holdPedal,127]},PED_UP:{groups:["DYNAMICS"],data:[ns.Symbols.ControllerTypes.holdPedal,0]}},cs={};for(let e of Object.keys(as))for(let t of as[e].groups)cs[t]=cs[t]||[],cs[t].push(e);const ls={"!ppp!":"PPP","!pp!":"PP","!p!":"P","!mp!":"MP","!mf!":"MF","!f!":"F","!ff!":"FF","!fff!":"FFF","!<(!":"START_CRESC","!crescendo(!":"START_CRESC","!<)!":"END_CRESC","!crescendo)!":"END_CRESC","!>(!":"START_DECRESC","!diminuendo(!":"START_DECRESC","!>)!":"END_DECRESC","!diminuendo)!":"END_DECRESC","!ped!":"PED","!ped-up!":"PED_UP"},us=["!>!","!accent!","!emphasis!","!^!","!marcato!","!sfz!"],ds={PPP:[30,20,10,1],PP:[45,35,20,1],P:[60,50,35,1],MP:[75,65,50,1],MF:[90,80,65,1],F:[105,95,80,1],FF:[120,110,95,1],FFF:[127,125,110,1]};let ps={};function hs(e,t){return Math.abs(e-t)<.001}function ms(e){return e.replace(/".*?"/g,"")}function ys(e){let t={},n=e.indexOf("/");if(n<0){let n=`No / in ${e}`;return rs.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}let r="";for(let t=n+1;t<e.length;t++)"0123456789".indexOf(e[t])>-1&&(r+=e[t]);if(!r){let n=`No denominator in ${e}`;return rs.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}t.denominator=Number(r);let s="";for(let t=n-1;t>-1;t--)"0123456789".indexOf(e[t])>-1&&(s=e[t]+s);if(!s){let n=`No numerator in ${e}`;return rs.error("audiolib.abc-utils.parseFraction()",n),t.error=n,t}return t.numerator=Number(s),t}function As(e){rs.log("audiolib.abc-utils.parseQ()",e);let t={},n=e.indexOf("="),r=e.indexOf("/");if(n<0||r<0)return rs.log(`audiolib.abc-utils.parseQ() No numbers: "${e}"`),t;let s="";for(let t=n+1;t<e.length;t++)"0123456789".indexOf(e[t])>-1&&(s+=e[t]);s||rs.error("audiolib.abc-utils.parseQ() Bad Q (bpm): "+e),t.bpm=Number(s);let i,o=e.substr(0,n),a=/\d*\/.\d*/g,c={numerator:0,denominator:1};for(;null!==(i=a.exec(o));){let e=ys(i[0]);u=e,c={numerator:(l=c).numerator*u.denominator+u.numerator*l.denominator,denominator:l.denominator*u.denominator}}var l,u;return t.numerator=c.numerator,t.denominator=c.denominator,t}function gs(e){if(rs.log(`audiolib.abc-utils.parseM('${e}')`),(e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),"none"==e.toLowerCase()||""==e)return{value:"none",numerator:0,denominator:0};"C"==e?e="4/4":"C|"==e&&(e="2/2");let t=ys(e);return t.value=e,t}function vs(e){return rs.log(`audiolib.abc-utils.parseL('${e}')`),(e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),ys(e)}function _s(e){rs.log(`audiolib.abc-utils.parseK('${e}')`);let t={};return(e=e.trim().replace("[","").replace("]","")).indexOf(":")>-1&&(e=e.split(":")[1]),t.value=e,t}function bs(e){let t;rs.log(`audiolib.abc-utils.parseMIDIbeat('${e}')`);let n=e.split("beat ");if(n.length<2)rs.error(`Bad MIDI beat: ${e}`),t=ds.MF;else{t=[];let r=n[1].split(" ");for(let e of r)t.push(Number(e));t.length<4&&(rs.error(`Bad MIDI beat: ${e}`),t=ds.MF)}return t}function ws(e){rs.log(`audiolib.abc-utils.parseMIDIbeatstring('${e}')`);let t=(e=e.trim()).split("beatstring");return t.length<2?"":t[1].trim()}function xs(e){rs.log(`audiolib.abc-utils.parseMidiChannel('${e}')`);let t=(e=e.trim()).split("channel");return t.length<2?(rs.error(`Bad MIDI channel: ${e}`),1):Number(t[1].trim())}function ks(e,t){rs.log(`audiolib.abc-utils.parseMidiProgram('${e}', ${t})`);let n,r,s=(e=e.trim()).split("program")[1].trim().split(" ");return s.length<2?(ss(t,`Only one param for MIDI program, but current Channel not specified ${e}`),n=Number(t),r=Number(s[0])):(n=Number(s[0]),r=Number(s[1])),[n,r]}function Es(e){rs.log(`audiolib.abc-utils.parseI('${e}')`),ss("string"==typeof e||e instanceof String,`${e} is not a string`);let t={};(e=e.trim().replace("[","").replace("]","")).startsWith("I:")&&(e=e.substr(2));let n=e.split(" ");if(1==n.length)t.type=(n[0]?n[0]:"TODObad_I").toUpperCase();else{let r=n[0].toUpperCase();"MIDI"==r?(t.type=r+n[1].toUpperCase(),"MIDIBEAT"==t.type?t.value=bs(e):"MIDIBEATSTRING"==t.type?t.value=ws(e):"MIDICHANNEL"==t.type?t.value=xs(e):"MIDIPROGRAM"==t.type?t.value=ks(e):"MIDICONTROL"==t.type&&(t.value=function(e){rs.log(`audiolib.abc-utils.parseMidiControl('${e}')`);let t,n,r=(e=e.trim()).split("control")[1].trim().split(" ");return r.length<2?(rs.error(`Bad MIDI control: '${e}'`),t=0,n=0):(t=Number(r[0]),n=Number(r[1])),[t,n]}(e))):(t.type=r,t.value=n.slice(1))}return t}function Cs(e){rs.log(`audiolib.abc-utils.parseLenMod('${e}')`);let t={};t.sLenMod=e;let n=0,r="";for(;n<t.sLenMod.length&&!isNaN(parseInt(t.sLenMod[n],10));)r+=t.sLenMod[n],n++;t.numerator=r?parseInt(r,10):1;let s=1;for(;n<t.sLenMod.length&&"/"==t.sLenMod[n];){let e="",r=n+1;for(;r<t.sLenMod.length&&!isNaN(parseInt(t.sLenMod[r],10));)e+=t.sLenMod[r],r++;n=r,s=e?s*parseInt(e,10):2*s}return t.denominator=s,t}function Bs(e){let t=!0;for(let n=0;n<e.length;n++)if("0123456789".indexOf(e[n])<0){t=!1;break}return t}function Ms(e,t){let n=t,r="";for(;t<e.length&&"0123456789".indexOf(e[t])>-1;)r+=e[t],t++;return{num:r?Number(r):NaN,len:t-n}}function Is(e,t){rs.log(`audiolib.abc-utils.getTuplet('${e}', ${t})`);let n={},r=t;ss.ok("("==e[t],`Tuplet ${e} does not begin with (`);let s=Ms(e,++t);ss.ok(!isNaN(s.num),`Tuplet ${e} does not have number after (`),n.p=s.num,t+=s.len;let i=!1;if(3==n.p?(n.q=2,n.r=3):2==n.p?(n.q=3,n.r=2):i=!0,":"==e[t]){if(t++,!isNaN(e[t])){let r=Ms(e,t);n.q=r.num,t+=r.len}if(":"==e[t]&&(t++,!isNaN(e[t]))){let r=Ms(e,t);n.r=r.num,t+=r.len}}return n.len=t-r,!i||n.q&&n.r||(rs.error(`No default tuplet q/r values for ${n.p}`),n.q||rs.error("No q specified"),n.r||rs.error("No r specified"),rs.error(JSON.stringify(n))),n}function Ns(e,t,n){let r;return rs.log("abc-utils.getNoteLengthInQuarterNotes()",e,t,n),"Z"==e.letter||"X"==e.letter?(ss.ok(n,"Cannot evaluate X or Z without Metre."),r=e.postfix.lenMod.numerator*n.numerator*4/n.denominator):r=t.numerator/t.denominator*4*(e.postfix.lenMod.numerator/e.postfix.lenMod.denominator),r}function Ts(e,t,n){rs.log(`abc-utils.getQuarterNotesPerBar(${JSON.stringify(e)},{voiceTokens},${n})`);let r=e;if(t){let e=0;for(let s of t)if("M"==s.type){if(r=s.obj,e==n)break}else if(("BAR"==s.type||"END"==s.type)&&(e++,e>n))break}return ss(r,"Could not find M"),ss("none"!=r.value&&r.denominator>0,"Cannot work out quarter notes per bar if there is no metre."),r.numerator/r.denominator*4}function Ss(e,t,n,r){rs.log("abc-utils.getQuarterNotesInBar({voiceTokens})",t,n,r);let s=0,i=n,o=r,a=0;for(let n of e)if(cs.NCR.indexOf(n.type)>-1)a==t&&(s+=Ns(n,i,o));else if("L"==n.type)i=n.obj;else if("M"==n.type)o=n.obj;else if("BAR"==n.type&&(a++,a>t))break;return s}function Os(e,t,n,r){let s;if(rs.log("abc-utils.getFracCompleteBar()",e,t,n,r),0==r.numerator||0==r.denominator)s=1;else{s=Ss(e,t,n,r)/Ts(r,e,r)}return s}function Fs(e,t,n){rs.log("audiolib.abc-utils.getFirstLastComplements2()",`"${e}", M=${t}, L=${n}`);const r={"1/1":1/16,"1/2":1/8,"2/2":1/16,"3/2":1/24,"2/4":1/8,"3/4":1/12,"4/4":1/16,"5/4":.05,"3/8":1/6,"5/8":.1,"6/8":1/12,"9/8":1/18},s={"1/1":1,"1/2":1,"2/2":2,"3/2":3,"2/4":2,"3/4":3,"4/4":4,"5/4":5,"3/8":3,"5/8":5,"6/8":2,"9/8":3},i="L.=c",o=".=C",a={"1/1":`${i}4`,"1/2":`${i}2`,"2/2":`${i}2`,"3/2":`${i}2`,"2/4":`${i}`,"3/4":`${i}`,"4/4":`${i}`,"5/4":`${i}`,"3/8":`${i}/`,"5/8":`${i}/`,"6/8":`${i}3/`,"9/8":`${i}3/`},c={"1/1":`${o}4`,"1/2":`${o}2`,"2/2":`${o}2`,"3/2":`${o}2`,"2/4":`${o}`,"3/4":`${o}`,"4/4":`${o}`,"5/4":`${o}`,"3/8":`${o}/`,"5/8":`${o}/`,"6/8":`${o}3/`,"9/8":`${o}3/`},l={"1/1":`${i}4|`,"1/2":`${i}2|`,"2/2":`${i}2${o}2|`,"3/2":`${i}2${o}2${o}2|`,"2/4":`${i}${o}|`,"3/4":`${i}${o}${o}|`,"4/4":`${i}${o}${o}${o}|`,"3/8":`${i}/${o}/${o}/|`,"5/8":`${i}/${o}/${o}/${o}/${o}/|`,"6/8":`${i}3/${o}3/|`,"9/8":`${i}3/${o}3/${o}3/|`},u={"1/1":["=D4"],"1/2":["=D2"],"2/2":["=D2","=E2"],"3/2":["=D2","=E2","=F2"],"2/4":["=D","=E"],"3/4":["=D","=E","=F"],"4/4":["=D","=E","=F","=G"],"5/4":["=D","=E","=F","=G","=A"],"3/8":["=D/","=E/","=F/"],"5/8":["=D/","=E/","=F/","=G/","=A/"],"6/8":["=D3/","=E3/"],"9/8":["=D3/","=E3/","=F3/"]},f={"1/1":u["1/1"].join("")+"|","1/2":u["1/2"].join("")+"|","2/2":u["2/2"].join("")+"|","3/2":u["3/2"].join("")+"|","2/4":u["2/4"].join("")+"|","3/4":u["3/4"].join("")+"|","4/4":u["4/4"].join("")+"|","5/4":u["5/4"].join("")+"|","3/8":u["3/8"].join("")+"|","5/8":u["5/8"].join("")+"|","6/8":u["6/8"].join("")+"|","9/8":u["9/8"].join("")+"|"};let d=gs(t);if(0==d.numerator)return["","","","",""];ss.ok(c[d.value],`Could not look up Metro Note for M=${t}`),ss.ok(a[d.value],`Could not look up Metro Note for M=${t}`),ss.ok(l[d.value],`Could not look up Metro Full Bar for M=${t}`),ss.ok(u[d.value],`Could not look up Count Notes for M=${t}`),ss.ok(f[d.value],`Could not look up Count Full Bar for M=${t}`);let p=r[d.value];ss.ok(p,`Could not look up delta for M=${d.value}`);let h=Ys(e);ss(h>0,`Bar count is zero. || at end? ${e}`);let m,y=Ps({raw:e},null),A=vs(n),g=Os(y,0,A,d);ss(!(g>1),`fracBarComplete ${g} > 1.`),m=h>1?Os(y,h-1,A,d):0;let v="",_=0,b="",w=1-g;if(hs(w,1))v="Z";else{for(;w>0&&!hs(w,0);)w-=p,3==_?(b+="z",v="",_=0):(_++,v+="z//");v=b+v}let x="",k=0,E="";if(w=1-m,1==h);else if(hs(w,1))x="Z";else{for(;w>0&&!hs(w,0);)w-=p,3==k?(E+="z",x="",k=0):(k++,x+="z//");x+=E}let C="",B="",M=0,I="",N="";p=r[d.value];let T=0,S=1/r[d.value]/s[d.value];for(w=g;w>0&&!hs(w,0);)C="z//"+C,M+=1,hs(M,S)&&(T++,T==s[d.value]?(I=a[d.value]+I,N=u[d.value][0]+N):(I=c[d.value]+I,N=u[d.value][s[d.value]-T]+N),M=0,C="",B=""),M>0&&M%4==0&&(B+="z",C=""),w-=p;let O=`${B}${C}${I}|`,F=`${B}${C}${N}|`,R="",D="";if(1==h);else{let e=1;for(p=1/s[d.value],w=m;w>0&&!hs(w,0);)1==e?(R+=a[d.value],D+=u[d.value][0]):(R+=c[d.value],D+=u[d.value][e-1]),e+=1,w-=p}let U="",L="",$=1;for(p=1/s[d.value],w=1-g;w>0&&!hs(w,0);)1==$?(U+=a[d.value],L+=u[d.value][0]):(U+=c[d.value],L+=u[d.value][$-1]),$+=1,w-=p;rs.log(`getFirstLastComplements() => firstBarComplement '${v}'`),rs.log(`getFirstLastComplements() => lastBarComplement '${x}'`),rs.log(`getFirstLastComplements() => metroFirstBar '${O}'`),rs.log(`getFirstLastComplements() => metroLastBar '${R}'`),rs.log(`getFirstLastComplements() => metroInLastBar '${U}'`),rs.log(`getFirstLastComplements() => countFirstBar '${F}'`),rs.log(`getFirstLastComplements() => countLastBar '${D}'`),rs.log(`getFirstLastComplements() => countInLastBar '${L}'`),rs.log(`METRO_FULL_BAR[parsedM.value] => METRO_FULL_BAR '${l[d.value]}'`),rs.log(`COUNT_FULL_BAR[parsedM.value] => COUNT_FULL_BAR '${f[d.value]}'`);let Q=[v,x,O,R,U,F,D,L,l[d.value],f[d.value]];return rs.log(`==> getFirstLastComplements() ${Q}`),Q}function Rs(e,t,n){let r=e[0],s=e[1],i=`[L:${n}][Q:${t}]`,o="[L:1/4]";return o+="Z"==r&&"Z"==s?`Z|Z|${i}`:""==r?""==s?`Z|Z|${i}`:`${s}|Z|${i}`:""==s?`Z|${r}${i}`:s+"|Z|"+r+i,o}function Ds(e,t,n,r){ss(is.indexOf(e)>-1,`Invalid note ${e}`);let s=e,i=4,o=0;s==s.toLowerCase()&&(s=s.toUpperCase(),i++);for(let e=0;e<t.length;e++){let n=t[e];ss("',".indexOf(n)>-1),i+={"'":1,",":-1}[n]}if(n){for(let e=0;e<n.length;e++){let t=n[e];ss("^=_".indexOf(t)>-1),"="==t?o=0:o+={"^":1,_:-1}[t]}Math.abs(o)>2&&(o=2*Math.sign(o))}else o=ps[r]&&ps[r][s]||0;return{name:s+i,semitones:o}}function Us(e,t=1,n=0){ss(2==e.length,`Bad absNote ${e}`);const r="CDEFGAB";n+=Math.floor(Math.abs(t)/7)*Math.sign(t),t%=7;let s=r.indexOf(e[0])+t;s<0?(n--,s+=7):s>6&&(n++,s-=7);let i=Number(e[1]);return r[s]+(i+n)}function Ls(e){let t=e[0];ss("CDEFGAB".indexOf(t)>-1,`Invalid absNote ${e}`),ss("0123456789".indexOf(e[1])>-1,`Invalid octave ${e}`);let n=Number(e[1]),r=t;n>4&&(r=t.toLowerCase());let s="";return n<4?s=",".repeat(4-n):n>5&&(s="'".repeat(n-5)),{abcLetter:r,octaveModifier:s}}function $s(e,t,n,r){let s=Ds(e,t,n,r);return ns.getMidiKey(s.name,s.semitones)}function Qs(e,t,n){let r={raw:""},s="",i=t-1;for(;i>n&&"^_=".indexOf(e[i])>-1;)r.raw=e[i]+r.raw,s=e[i]+s,i--;s=s.slice(-2);s&&["__","_","=","^","^^"].indexOf(s)<0&&(s=s.charAt(s.length-1));let o=[],a=!1;const c=os;for(;i>n;){if(a){let t=i;for(;t>-1&&"!"!=e[t];)t--;if("!"!=e[t])break;{let n=e.slice(t,i+2);r.raw=n+r.raw,o.unshift(n),a=!1,i=t}}else if("!"==e[i])a=!0;else{if(c.indexOf(e[i])<0)break;r.raw=e[i]+r.raw,o.unshift(e[i])}i--}return r.sAcc=s,r.decArray=o,r}function js(e,t,n){rs.log(`audiolib.abc-utils.getNotePostfix('${e}', ${t}, ${n})`);let r={raw:""};if(r.raw=e.slice(t,n),"["==e[t]){let r=-1;for(let s=t;s<n;s++)if("]"==e[s]){r=s;break}if(r<0)throw Error(`Could not find ] in ${e}`);t=r}let s=t,i="";for(let o=t+1;o<n;o++){let t=e[o];if("ABCDEFGabcdefgZzXx[!".indexOf(t)>-1)break;"-"==t?(r.tied=!0,s=o):"<"!=t&&">"!=t||(i+=t,s=o)}["<","<<","<<<",">",">>",">>>"].indexOf(i)>-1&&(r.brokenRhythm=i);let o=t+1,a="";for(;o<n&&"-><',".indexOf(e[o])>-1;){let t=e[o];if("ABCDEFGabcdefgZzXx[!".indexOf(t)>-1)break;"',".indexOf(e[o])>-1&&(a+=e[o],o>s&&(s=o)),o++}r.sOctMod=a;let c="";for(;o<n&&("-></".indexOf(e[o])>-1||!isNaN(parseInt(e[o],10)));)"-><".indexOf(e[o])>-1||(c+=e[o],o>s&&(s=o)),o++;return r.lenMod=Cs(c),r.raw=e.slice(t+1,s+1),r}function Ps(e,t){rs.log("audiolib.abc-utils.parseVoice()",e);let n=ms(e.raw);rs.log(n);let r=[{type:"START",idx:-1,endIdx:-1},{type:"END",idx:n.length,endIdx:n.length}],s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1];for(let e=t.endIdx+1;e<o.idx;e++){if("{"==n[e]){let t=n.indexOf("}",e+1);if(t<0)rs.error("Unterminated {");else{let s={type:"GRACE",idx:e,endIdx:t,str:n.slice(e,t+1)};r.splice(i,0,s),i++,e=t}}}i++}s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1];for(let e=t.endIdx+1;e<o.idx;e++){if("["==n[e]&&e<o.idx-1){let t=n[e+1];if("MLQKI".indexOf(t)>-1){let s=n.indexOf("]",e),o=n.slice(e,s+1);if(s>-1){let a,c=t;"M"==t?a=gs(o):"L"==t?a=vs(o):"Q"==t?a=As(o):"K"==t?a=_s(o):(a=Es(o),c=a.type),r.splice(i,0,{type:c,raw:n.slice(e,s+1),idx:e,endIdx:s,obj:a}),i++,e=s}}}}i++}s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1];for(let e=t.endIdx+1;e<o.idx;e++){let t=n[e],s=e<n.length-1?n[e+1]:"";if("("==t&&Bs(s)){let t=Is(n,e),s=e+t.len-1,o={type:"TUPLET",raw:n.slice(e,s+1),idx:e,endIdx:s,obj:t};r.splice(i,0,o),i++,e=s}}i++}s=r.slice(),i=1;let o=cs.DYNAMICS;for(let e=0;e<s.length-1;e++){let t=s[e],a=s[e+1];for(let e=t.endIdx+1;e<a.idx;e++){if("!"==n[e]){let t=n.indexOf("!",e+1);if(t<0)rs.error("Unterminated !");else{let s=n.slice(e,t+1),a=ls[s];if(o.indexOf(a)>-1){let n={type:a,idx:e,endIdx:t};r.splice(i,0,n),i++}e=t}}}i++}s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1],a=0;for(let e=t.endIdx+1;e<o.idx;e++){let t=n[e];if("("==t||")"==t){a="("==t?a++:a--;let n={type:"("==t?"SLUR":"END_SLUR",nestLevel:a,idx:e,endIdx:e};r.splice(i,0,n),i++}}i++}const a=["|","|]","||","[|","|:",":|","::","[|]"];s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1];for(let e=t.endIdx+1;e<o.idx;e++){let t=n[e],s="";if("|"==t){s=t;let r="";e<o.idx-1&&(r=n[e+1]),"]"!=r&&"|"!=r&&":"!=r||(s+=r)}else if("["==t){let r="";e<o.idx-1&&(r=n[e+1],"|"==r&&(s=t+r,r=n[e+2],"]"==r&&(s+=r)))}else if(":"==t){let r="";e<o.idx-1&&(r=n[e+1]),"|"!=r&&":"!=r||(s=t+r)}if(a.indexOf(s)>-1){let t={type:"BAR",idx:e,endIdx:e+s.length-1,sBar:s};r.splice(i,0,t),i++,e+=s.length-1}}i++}s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1];for(let e=t.endIdx+1;e<o.idx;e++){if("["==n[e]){let s=n.indexOf("]",e);if(s>-1){let a=n.slice(e,s+1),c=Qs(n,e,t.endIdx),l=js(n,e,o.idx),u={type:"CHORD",raw:c.raw+a+l.raw,idx:e-c.raw.length,endIdx:e+a.length-1+l.raw.length,sChord:a,prefix:c,postfix:l};r.splice(i,0,u),u.notes=[];let f=0,d=!0;for(let e=0;e<a.length;e++)if(is.indexOf(a[e])>-1){let t=Qs(a,e,f),n=js(a,e,a.length-1);u.notes.push({type:"CHORD_NOTE",raw:t.raw+a[e]+n.raw,letter:a[e],prefix:t,postfix:n}),d&&(u.postfix.lenMod=Cs(n.lenMod.sLenMod+u.postfix.lenMod.sLenMod),d=!1),f=e,e+=n.raw.length}i++,e+=a.length+-1+l.raw.length}}}i++}const c=["z","Z","x","X"];s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1],a=!1;for(let e=t.endIdx+1;e<o.idx;e++){let t=n[e];if(a="!"==t?!a:a,!a&&c.indexOf(t)>-1){let s=js(n,e,o.idx);r.splice(i,0,{type:"REST",raw:t+s.raw,idx:e,endIdx:e+s.raw.length,letter:t,postfix:s}),i++,e+=s.raw.length}}i++}s=r.slice(),i=1;for(let e=0;e<s.length-1;e++){let t=s[e],o=s[e+1],a=!1;for(let e=t.endIdx+1;e<o.idx;e++){let s=n[e];if(a="!"==s?!a:a,!a&&is.indexOf(s)>-1){let a=Qs(n,e,t.endIdx),c=js(n,e,o.idx);r.splice(i,0,{type:"NOTE",raw:a.raw+s+c.raw,idx:e-a.raw.length,endIdx:e+c.raw.length,letter:s,prefix:a,postfix:c}),i++,e+=c.raw.length}}i++}const l={">":[[3,2],[1,2]],">>":[[7,4],[1,4]],">>>":[[15,8],[1,8]],"<":[[1,2],[3,2]],"<<":[[1,4],[7,4]],"<<<":[[1,8],[15,8]]};for(let e=0;e<r.length;e++){let t=r[e];if(("NOTE"==t.type||"CHORD"==t.type)&&t.postfix.brokenRhythm){let n=t,s=l[n.postfix.brokenRhythm];n.postfix.lenMod.numerator*=s[0][0],n.postfix.lenMod.denominator*=s[0][1];let i=null;for(let t=e+1;t<r.length;t++)if("NOTE"==r[t].type||"CHORD"==r[t].type){i=r[t];break}i&&(i.postfix.lenMod.numerator*=s[1][0],i.postfix.lenMod.denominator*=s[1][1])}}e:for(let e=0;e<r.length;e++){let t=r[e];if("TUPLET"==t.type){let n=0;for(let s=e+1;s<r.length;s++){let e=r[s];if(!(cs.NCR.indexOf(e.type)<0)&&(n++,e.postfix.lenMod.numerator*=t.obj.q,e.postfix.lenMod.denominator*=t.obj.p,n==t.obj.r))continue e}rs.warn("Too few notes/chords/rests follow tuplet.")}}let u=0,f=null,d=null;for(let e=0;e<r.length;e++){let t=r[e];if("SLUR"==t.type)u++;else if("END_SLUR"==t.type){if(u--,f){f.inSlur=!1;for(let e=d+1;e<r.length;e++){let n=r[e];if("REST"==n.type)break;if("NOTE"==n.type||"CHORD"==t.type){f.lastInSlur=!0;break}}}}else u>0&&("NOTE"==t.type||"CHORD"==t.type)&&(t.inSlur=!0,f=t,d=e)}return r}function Ys(e,t=!1){rs.log("audiolib.abc-utils.countBars()",e);let n=Ps({raw:e});return t?n.filter((e=>"BAR"==e.type&&"[|]"!=e.sBar)).length:n.filter((e=>"BAR"==e.type)).length}function zs(e,t){rs.log("audiolib.abc-utils.getNoteName()",e,t),ss("ABCDEFG".indexOf(e)>-1,`Bad note letter ${e}`),ss(ps[t],`Bad key ${t}`);let n=ps[t][e]||0;return n++,e+{0:"b",1:"",2:"#"}[n]}function Vs(e){rs.log("audiolib.abc-utils.getFirstNoteToken()",e),ss("string"==typeof e||e instanceof String,"notes parameter should be a string");let t=Ps({id:"null",raw:e}),n=null;for(let e=0;e<t.length;e++){let r=t[e];if("NOTE"==r.type){n=r;break}}return n}function Hs(e,t,n=2){rs.log(`audiolib.abc-utils.getAvgMidiKey('${e}',${t},${n})`);let r=0,s=0,i=0,o=Ps({id:"null",raw:e});for(let e=0;e<o.length;e++){let a=o[e],c=0;if("BAR"==a.type){if(r++,r>n-1)break}else if("NOTE"==a.type)c=$s(a.letter,a.postfix.sOctMod,a.prefix.sAcc,t),s+=c,i++;else if("CHORD"==a.type)for(let e=0;e<a.notes.length;e++){let n=a.notes[e];c=$s(n.letter,n.postfix.sOctMod,n.prefix.sAcc,t),s+=c,i++}}ss(i>0,"Cannot work out average MidiKey value key if no notes.");let a=s/i;return rs.log(`getAvgMidiKey() ==> ${a}`),a}ps.C={},ps.G=Object.assign({F:1},ps.C),ps.D=Object.assign({C:1},ps.G),ps.A=Object.assign({G:1},ps.D),ps.E=Object.assign({D:1},ps.A),ps.B=Object.assign({A:1},ps.E),ps["F#"]=Object.assign({E:1},ps.B),ps["C#"]=Object.assign({B:1},ps["F#"]),ps.F=Object.assign({B:-1},ps.C),ps.Bb=Object.assign({E:-1},ps.F),ps.Eb=Object.assign({A:-1},ps.Bb),ps.Ab=Object.assign({D:-1},ps.Eb),ps.Db=Object.assign({G:-1},ps.Ab),ps.Gb=Object.assign({C:-1},ps.Db),ps.Cb=Object.assign({F:-1},ps.Gb),ps.Am={},ps.Dm=Object.assign({B:-1},ps.Am),ps.Gm=Object.assign({E:-1},ps.Dm),ps.Cm=Object.assign({A:-1},ps.Gm),ps.Fm=Object.assign({D:-1},ps.Cm),ps.Bbm=Object.assign({G:-1},ps.Fm),ps.Ebm=Object.assign({C:-1},ps.Bbm),ps.Abm=Object.assign({F:-1},ps.Ebm),ps.Em=Object.assign({F:1},ps.Am),ps.Bm=Object.assign({C:1},ps.Em),ps["F#m"]=Object.assign({G:1},ps.Bm),ps["C#m"]=Object.assign({D:1},ps["F#m"]),ps["G#m"]=Object.assign({A:1},ps["C#m"]),ps["D#m"]=Object.assign({E:1},ps["G#m"]);const Gs={treble:{A:["A,","C","E","A"],B:["B,","D","F","B"],C:["C","E","G","c"],D:["D","F","A","d"],E:["E","G","B","e"],F:["F","A","c","f"],G:["G","B","d","g"]},bass:{A:["A,,","C,","E,","A,"],B:["B,,","D,","F,","B,"],C:["C,","E,","G,","C"],D:["D,","F,","A,","D"],E:["E,","G,","B,","E"],F:["F,","A,","C","F"],G:["G,","B,","D","G"]}},qs={"A,,":[],"B,,":[],"C,":["C,,"],"D,":["D,,"],"E,":["E,,"],"F,":["F,,"],"G,":["G,,"],"A,":["A,,"],"B,":["B,,"],C:["C,"],D:["D,"],E:["E,"],F:["F,"],G:["G,"]};function Ws(e,t,n=""){rs.log(`audiolib.abc-utils.getKeyChordNoteArray("${e}", "${t}", "${n}")`);let r=e[0];ss("ABCDEFG".indexOf(r)>-1,`Bad key ${e}`),ss(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let s=Gs[t][r];if(n){let i=s[0],o=i.substr(1),a=$s(i[0],o,"",e),c=s[s.length-1];o=c.substr(1);let l=$s(c[0],o,"",e),u=Hs(n,e,2);"treble"==t&&u<a?(t="bass",s=Gs.bass[r]):"bass"==t&&u>l&&(t="treble",s=Gs.treble[r])}return rs.log(`getKeyChordNoteArray() ==> ${JSON.stringify(s)}`),[s.slice(),t]}const Js={__test__:{getTuplet:Is,getNumFromStr:Ms,getAvgMidiKey:Hs},Defaults:{M:{numerator:0,denominator:0,value:"none"},Q:{numerator:1,denominator:4,bpm:120}},Tokens:ls,TokenTypes:as,TokenTypeGroups:cs,NOTE_LETTERS:is,DECORATION_SHORTHANDS:os,CONTROL:["!ped!","!ped-up!"],MIDI_BEATS:ds,MIDI_BEATSTRING_DFLT:{none:"m","1/1":"f","2/2":"fm","2/4":"fm","3/4":"fpp","4/4":"fpmp","5/4":"f","3/8":"fpp","5/8":"f","6/8":"fppmpp","9/8":"fppmppmpp","12/8":"fppmppmppmpp"},getAbsNote:Ds,incAbsNote:Us,getAbcNote:Ls,incAbcNote:function(e,t=1){ss(e,"abc-utils.incAbcNote() called with empty input.");let n="",r=0;for(;r<e.length&&"^_=".indexOf(e[r])>-1;)n+=e[r],r++;let s=e[r],i=is.indexOf(s);ss(i>-1,`Bad note ${s}`),r++;let o="";for(;r<e.length&&",'".indexOf(e[r])>-1;)o+=e[r],r++;let a=Ls(Us(Ds(s,o,"","C").name,t));return n+a.abcLetter+a.octaveModifier},getMidiKey:$s,getDegreesBetweenAbcNotes:function(e,t){function n(t){let n=t[0],r={C:0,D:1,E:2,F:3,G:4,A:5,B:6}[n.toUpperCase()];n==n.toUpperCase()||(r+=7);let s=1;for(;s<t.length;)"'"==t[s]?r+=7:","==e[s]&&(r-=7),s++;return r}return n(t)-n(e)},getArticulatedDuration:function(e){let t=!1,n=!1,r=!1;e.prefix.decArray.indexOf(".")>-1&&(t=!0),e.prefix.decArray.indexOf("!wedge!")>-1&&(r=!0),e.prefix.decArray.indexOf("!tenuto!")>-1&&(n=!0);let s=e.durationInTicks;return t||r?n||e.inSlur?Math.floor(.75*s):Math.floor(.5*s):e.lastInSlur?Math.floor(.7*s):n||e.inSlur?s-1:Math.floor(.95*s)},getPlayedAcc:function(e,t,n,r){let s=e.prefix.sAcc;if(e.prefix.sAcc)s=e.prefix.sAcc;else if(t.accidentals[e.noteName])s=t.accidentals[e.noteName];else if(n)n.postfix.tied&&n.playedAcc&&e.noteName==n.noteName&&(s=n.playedAcc);else if(r)for(let t of r.notes)(r.postfix.tied||t.postfix.tied)&&t.playedAcc&&e.noteName==t.noteName&&(s=t.playedAcc);return s},getVelocity:function(e,t,n,r){const s=1/1024;for(let e of r)if(us.indexOf(e)>-1){return Math.min(Math.floor(1.2*n[0]),127)}for(let r of t.f)if(Math.abs(e-r)<s)return n[0];for(let r of t.m)if(Math.abs(e-r)<s)return n[1];return n[2]},getStressedBeats:function(e){let t={f:[],m:[]};for(let n=0;n<e.length;n++)"f"==e[n]?t.f.push(n):"m"==e[n]&&t.m.push(n);return t},parseLenMod:Cs,removeAnnotations:ms,parseFraction:ys,parseQ:As,removeTextFromQ:function(e){let t=e.lastIndexOf('"');return t<0?e:e.slice(t+1).trim()},extractTextFromQ:function(e){let t=e.lastIndexOf('"');return t<0?"":e.slice(0,t+1).trim()},parseM:gs,parseL:vs,parseK:_s,getKeyName:function(e){let t;return rs.log(`audiolib.abc-utils.getKeyName('${e}')`),t="m"==e.slice(-1)?e.slice(0,-1)+" minor":e+" major",t},parseMIDIbeat:bs,parseMIDIbeatstring:ws,parseMidiChannel:xs,parseMidiProgram:ks,parseI:Es,parseVoice:Ps,getNoteLengthInQuarterNotes:Ns,getQuarterNotesPerBar:Ts,getQuarterNotesInBar:Ss,getFracCompleteBar:Os,getFirstLastComplements:Fs,repeatNotes:function(e,t,n,r,s=1){rs.log("audiolib.abc-utils.repeatNotes()",`"${e}", Q=${t}, M=${n}, L=${r}`),ss(t,"Missing parameter Q"),ss(n,"Missing parameter M"),ss(r,"Missing parameter L");let i=Rs(Fs(e,n,r),t,r),o=e;for(let t=0;t<s;t++)o+=i+e;return rs.log(`repeatNotes() => "${o}"`),o},appendNotes:function(e,t,n,r,s){rs.log("audiolib.abc-utils.appendNotes()",`"${e}", "${t}", M=${r}, L=${s}`),ss(r,"Missing parameter M"),ss(s,"Missing parameter L");let i=e+Rs(Fs(e,r,s),n,s)+t;return rs.log(`appendNotes() => "${i}"`),i},getRhythm:function(e){rs.log("audiolib.abc-utils.getRhythm()",e);let t=Ps({raw:e},null),n="";for(let e of t)if(["NOTE","CHORD"].indexOf(e.type)>-1){let t=`.=C${e.postfix.lenMod.sLenMod}`;t=`${t}${e.postfix.tied?"-":""}`,t=`${t}${e.postfix.brokenRhythm||""}`,n+=t}else["TUPLET"].indexOf(e.type)>-1||["REST","Q","M","L"].indexOf(e.type)>-1?n+=e.raw:["BAR"].indexOf(e.type)>-1&&(n+=e.sBar);return n="!ff![I:MIDI program 0 115]"+n,rs.log(" ==> audiolib.abc-utils.getRhythm()",n),n},getQuarterNotesBetween:function(e,t,n,r,s){let i=0;for(let o=r;o<s+1;o++){let r=n[o];cs.NCR.indexOf(r.type)>-1&&(i+=Ns(r,e,t))}return i},getEndDynChangeTokenIdx:function(e,t){for(let n=t;n<e.length;n++){let t=e[n];if(cs.END_CRESC_DECRESCS.indexOf(t.type)>-1)return n}return e.length-1},getCrescMIDIbeat:function(e,t){rs.log("abc-utils.crescMIDIbeat()",e,t),ss.ok(Array.isArray(e.startMIDIbeat)),ss.ok(Array.isArray(e.endMIDIbeat)),ss.ok(!Boolean(e.startCumQN>t)),ss.ok(!Boolean(t-1/1024>e.endCumQN));let n=[...e.startMIDIbeat],r=(t-e.startCumQN)/(e.endCumQN-e.startCumQN);for(let t=0;t<3;t++)n[t]=n[t]+Math.trunc((e.endMIDIbeat[t]-e.startMIDIbeat[t])*r);rs.log("RESULT crescMIDIbeat()",n);for(let e=0;e<3;e++)ss.ok(!(n[e]>127||n[e]<0),`getCrescMIDIbeat value out of range (0-127) ${JSON.stringify(n)}`);return n},getEndMIDIbeat:function(e,t,n,r){ss.ok(Array.isArray(n)),ss.ok(n.length>=3);let s=null,i=!1;for(let o=t;o<e.length;o++){let t=e[o];if(cs.END_CRESC_DECRESCS.indexOf(t.type)>-1)i=!0;else{if("MIDIBEAT"==t.type){s=[...t.obj.value];break}if(cs.DYNAMIC_LEVELS.indexOf(t.type)>-1){s=[...ds[t.type]];break}if(i&&cs.NCR.indexOf(t.type)>-1){let e=[...n];for(let t=0;t<3;t++)e[t]=Math.max(Math.min(e[t]+r,127),0);throw"CRESC/DECRESC DOES NOT HAVE DYNAMIC MARKER IMMEDIATELY AFTER (OR DURING)"}}}if(!s)throw"Probably you did not end a cresc/decresc";return s},countBars:Ys,countNCR:function(e){return rs.log("audiolib.abc-utils.countNCR()",e),Ps({raw:e}).filter((e=>cs.NCR.indexOf(e.type)>-1)).length},getFirstNote:function(e,t){rs.log(`audiolib.abc-utils.getFirstNote("${e}", ${t})`),ss("string"==typeof e||e instanceof String,"notes parameter should be a string");let n=Vs(e);ss(n,"No first note"),ss(""==n.prefix.sAcc,`First note should not have an accidental ${n.raw}`);let r=zs(n.letter.toUpperCase(),t);ss(r,`Could not look up note name for ${n.letter} for key ${t}`);let s=n.postfix.sOctMod;return[r,n.letter+s]},getFirstNoteToken:Vs,getNoteName:zs,octaveDown:function(e){rs.log("audiolib.abc-utils.octaveDown()",e),ss("string"==typeof e||e instanceof String,"notes parameter should be a string");let t="";for(let n=0;n<e.length;n++){let r=e[n];"CDEFGAB".indexOf(r.toUpperCase())>-1?r==r.toUpperCase()?t+=r+",":t+=r.toUpperCase():t+=r}return t},getKeyChordNoteArray:Ws,getSkcNotes:function(e,t,n=""){rs.log(`audiolib.abc-utils.getSkcNotes('${t}','${e}',"${n}")`);let r=t[0];ss.ok("ABCDEFG".indexOf(r)>-1,`Bad key ${r}`);let s=Ws(t,e,n);rs.log(`skn = ${JSON.stringify(s)}`);let i=s[0];return rs.log(`getSkcNotes() ==> ${JSON.stringify(i)}`),i},getBassNotes:function(e){rs.log(`audiolib.abc-utils.getBassNotes("${e}")`),ss(e,"Must supply lowestSkcNote");let t=qs[e];ss(t,`Could not look up BASS_NOTES from "${e}"`);let n=[];for(let e=0;e<t.length;e++)n.push(t[e]);return rs.log(`getBassNotes() ==> ${n}`),n},getKeyChord:function(e,t,n,r=""){rs.log(`audiolib.abc-utils.getKeyChord(${e}, ${t}, ${n})`);let s=e[0];ss("ABCDEFG".indexOf(s)>-1,`Bad key ${e}`),ss(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let i=Ws(e,t,r)[0],o="[";return n&&(o+=qs[i[0]].join("")),o+=i.join(""),o+="]",rs.log(`getKeyChord() ==> ${o}`),o},getKeyNote:function(e,t,n=""){rs.log(`audiolib.abc-utils.getKeyNote("${e}","${t}","${n}")`);let r=e[0];ss.ok("ABCDEFG".indexOf(r)>-1,`Bad key ${e}`),ss(["treble","bass"].indexOf(t)>-1,`Bad clef ${t}`);let s,i=Gs[t][r];if(n){let r=Hs(n,e),o=i[0],a=o.substr(1),c=$s(o[0],a,"",e),l=i[i.length-1];a=l.substr(1);let u=$s(l[0],a,"",e);s=Math.pow(c-r,2)>Math.pow(u-r,2)?l:o,ss(s,`Could not find keyNote. key:${e} clef:${t} notes:${n}`)}else s=i[0];return rs.log(`getKeyNote() => "${s}"`),s},preProcess:function(e,t,n=-1){rs.log(`audiolib.abc-utils.preProcess(abc, ${t}, ${n})`),ss("string"==typeof e||e instanceof String,"abc parameter should be a string."),ss("S"==t||"P"==t,`Bad parameter target ${t}`),ss(Number.isInteger(n),`Param abcEditMode ${n} not an integer.`);let r=e;return r="P"==t?function(e){rs.log("audiolib.abc-utils.processPrePlay(abc)"),ss("string"==typeof e||e instanceof String,"Param abc should be a string.");let t=e,n=/\[I\:ss\].*?\[I\:se\]/g;t=t.replace(n,""),n=/\[I\:ps\]/g,t=t.replace(n,""),n=/\[I\:pe\]/g,t=t.replace(n,"");let r=[/\[I:n:.*?\]/,/\[I:pos.*?\]/,/\[I:clef.*?\]/,/\[I:staff.*?\]/,/\[I:shiftunison.*?\]/,/\[I:tuplets.*?\]/,/\[I:ottava.*?\]/,/\[I:graceslurs.*?\]/,/\[I:end\]/];for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),"");n=/"_ppp"|"_pp"|"_p"|"_mp"|"_mf"|"_f"|"_ff"|"_fff"/g,t=t.replace(n,""),r=['"_D0"','"_D1"','"_D2"','"_D3"','"_D4"','"_D5"','"_D6"','"_D7"'];let s=["[I:MIDI beat 30 20 10 1]","[I:MIDI beat 45 35 20 1]","[I:MIDI beat 60 50 35 1]","[I:MIDI beat 75 65 50 1]","[I:MIDI beat 90 80 65 1]","[I:MIDI beat 105 95 80 1]","[I:MIDI beat 120 110 95 1]","[I:MIDI beat 127 125 110 1]"];ss(r.length==s.length);for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),s[e]);r=['"_cs"','"_ce"','"_ds"','"_de"'],s=["!<(!","!<)!","!>(!","!>)!"],ss(r.length==s.length);for(let e=0;e<r.length;e++)t=t.replace(new RegExp(r[e],"g"),s[e]);return n=/\[I\:Q\:.*?\]/g,t=t.replace(n,""),n=/^\s*$/gm,t=t.replace(n,""),t}(r):function(e,t){rs.log(`audiolib.abc-utils.processPreRender(abc, ${t})`),ss("string"==typeof e||e instanceof String,"abc parameter should be a string."),ss(Number.isInteger(t),`Param abcEditMode ${t} not an integer.`);let n=e;if(t>-1){if(ss([0,1,2,3].indexOf(t)>-1,`Param abcEdtMode ${t} should be 0-2.`),0==t);else if(1==t){let e=/\[I\:ps\]/g;n=n.replace(e,'"^'),e=/\[I\:pe\]/g,n=n.replace(e,'"         ')}else if(2==t){let e=/(\[I:ps\])(.*?)(\[I:pe\])/g;n=n.replace(e,(function(e,t,n,r){return"[I:ps "+"=".repeat(n.length)+" I:pe]"}))}else if(3==t){let e=/(\[I:ss\])(.*?)(\[I:se\])/g;n=n.replace(e,(function(e,t,n,r){return"[I:ss "+"=".repeat(n.length)+" I:se]"}))}else rs.error(`audiolib.abc-utils.processPreRender() Bad abcEdtMode ${t}. Should be 0,1,2.`);rs.log(n)}else{let e=/\[I\:ps\].*?\[I\:pe\]/g;n=n.replace(e,""),e=/\[I\:ss\]/g,n=n.replace(e,""),e=/\[I\:se\]/g,n=n.replace(e,"");let t=['"_ppp"','"_pp"','"_p"','"_mp"','"_mf"','"_f"','"_ff"','"_fff"'],r=["!ppp!","!pp!","!p!","!mp!","!mf!","!f!","!ff!","!fff!"];ss(t.length==r.length);for(let e=0;e<t.length;e++)n=n.replace(new RegExp(t[e],"g"),r[e]);e=/"_D0"|"_D1"|"_D2"|"_D3"|"_D4"|"_D5"|"_D6"|"_D7"/g,n=n.replace(e,""),e=/"_cs"|"_ce"|"_ds"|"_de"/g,n=n.replace(e,""),e=/\[Q\:[^\]]*\]/g,n=n.replace(e,""),e=/I\:Q/g,n=n.replace(e,"Q"),e=/\[I:MIDI.*?\]/,n=n.replace(e,"")}return n}(r,n),r}},Ks=Br().getLogger("audiolib"),Xs=Tr.assert,Zs=ns.Symbols;const ei={abc2AbcObj:function(e){Ks.log("audiolib.abc.abc2AbcObj(abc)");let t={header:{},voices:[]},n={},r={id:"DFLT",raw:""};n.DFLT=r,t.voices.push(r);let s=n.DFLT,i=e.split("\n"),o=!0;for(let e=0;e<i.length;e++){let r=i[e].trim();if(!r)break;if(r.startsWith("%")&&!r.startsWith("%%MIDI"))continue;let a=r.indexOf("%",2);if(a>-1&&(r=r.slice(0,a)),o)if(r.startsWith("X:"))t.header.X=r.substr(2).trim();else if(r.startsWith("%%MIDI")){let e=r.split(" ")[1];"beat"==e?t.header.MIDIbeat=Js.parseMIDIbeat(r):"beatstring"==e?t.header.MIDIbeatstring=Js.parseMIDIbeatstring(r):"channel"==e||"program"==e||"control"==e?s.raw+="[I:"+r.slice(2)+"]":Ks.info(`Unhandled abc MIDI directive ${r}`)}else if(r.startsWith("T:"))t.header.T=r.substr(2).trim();else if(r.startsWith("Q:"))t.header.Q=Js.parseQ(r.split(":")[1]);else if(r.startsWith("M:"))t.header.M=Js.parseM(r);else if(r.startsWith("L:"))t.header.L=Js.parseL(r);else if(r.startsWith("V:")){let e=r.split(":")[1],i=e.indexOf(" ");i>-1&&(e=e.slice(0,i));let o={id:e,raw:""};n[e]=o,t.voices.push(o),s=o}else r.startsWith("K:")?(t.header.K=Js.parseK(r),o=!1,s=n.DFLT):Ks.warn(`Unhandled line in header: ${r}`);else if(r.startsWith("V:")){let e=r.split(":")[1].split(" ")[0];if(s=n[e],!s){let r={id:e,raw:""};n[e]=r,t.voices.push(r),s=r}}else if(r.startsWith("L:"))s.raw+="["+r+"]";else if(r.startsWith("Q:"))s.raw+="["+r+"]";else if(r.startsWith("K:"))s.raw+="["+r+"]";else if(r.startsWith("M:"))s.raw+="["+r+"]";else if(r.startsWith("I:"))s.raw+="["+r+"]";else if(r.startsWith("%%MIDI")){let e=r.split(" ")[1];["beat","beatstring","channel","program","control"].indexOf(e)>-1?s.raw+=`[I:${r.slice(2)}]`:Ks.warn(`Unhandled MIDI command: ${r}`)}else for(let e=0;e<r.length;e++)if(e<r.length-4&&"["==r[e]&&"V"==r[e+1]&&":"==r[e+2]){let i=r.slice(e+3,r.indexOf("]",e+3));if(s=n[i],!s){let e={id:i,raw:""};n[i]=e,t.voices.push(e),s=e}e=r.indexOf("]",e+3)}else s.raw+=r[e]}if(o&&Ks.error("No K:"),t.header.M=t.header.M||Js.Defaults.M,t.header.Q=t.header.Q||Js.Defaults.Q,!t.header.L)if("none"==t.header.M.value)t.header.L={numerator:1,denominator:8};else{let e=t.header.M.numerator/t.header.M.denominator;t.header.L=e<.75?{numerator:1,denominator:16}:{numerator:1,denominator:8}}t.header.MIDIbeat=t.header.MIDIbeat||Js.MIDI_BEATS.MF,t.header.MIDIbeatstring=t.header.MIDIbeatstring||Js.MIDI_BEATSTRING_DFLT[t.header.M.value];for(let e=0;e<t.voices.length;e++){let n=t.voices[e];n.tokens=Js.parseVoice(n)}return t},abcObj2MidiObj:function(e){Ks.log("audiolib.abc.abcObj2MidiObj()",e);let t={},n=[],r=480;for(let t=0;t<e.voices.length;t++){let n=e.voices[t],s=null,i=null,o=e.header.M,a=e.header.L,c=e.header.K,l=[],u={accidentals:{},cumQuarterNotes:0};if("none"!=o.value){let e=Js.getQuarterNotesPerBar(o);u.cumQuarterNotes=(e-Js.getQuarterNotesInBar(n.tokens,0,a,o))%e}l.push(u);let f=u.cumQuarterNotes,d=e.header.MIDIbeat,p=e.header.MIDIbeatstring,h=Js.getStressedBeats(p),m=null;for(let e=0;e<n.tokens.length;e++){let t=n.tokens[e];if("BAR"==t.type)u={accidentals:{},cumQuarterNotes:0},l.push(u);else if("Q"==t.type)t.durationInTicks=0;else if("M"==t.type)o=t.obj,t.durationInTicks=0;else if("L"==t.type)a=t.obj,t.durationInTicks=0;else if("K"==t.type)c=t.obj,t.durationInTicks=0;else if("MIDIBEAT"==t.type)d=t.obj.value,t.durationInTicks=0;else if("MIDIBEATSTRING"==t.type)p=t.obj.value,h=Js.getStressedBeats(p),t.durationInTicks=0;else if(Js.TokenTypeGroups.DYNAMIC_LEVELS.indexOf(t.type)>-1)d=Js.MIDI_BEATS[t.type],t.durationInTicks=0;else if(Js.TokenTypeGroups.START_CRESC_DECRESCS.indexOf(t.type)>-1)if(t.durationInTicks=0,m)Xs.ok(!1,"Already in a cresc/decresc");else{m={startCumQN:f};let r=Js.getEndDynChangeTokenIdx(n.tokens,e+1);m.endCumQN=f+Js.getQuarterNotesBetween(a,o,n.tokens,e,r),m.startMIDIbeat=[...d];let s=15;"START_DECRESC"==t.type&&(s=-s),m.endMIDIbeat=Js.getEndMIDIbeat(n.tokens,e+1,d,s)}else if(Js.TokenTypeGroups.END_CRESC_DECRESCS.indexOf(t.type)>-1)t.durationInTicks=0,d=Js.getCrescMIDIbeat(m,f),m=null;else if("REST"==t.type){let e=Js.getNoteLengthInQuarterNotes(t,a,o);t.durationInTicks=e*r,u.cumQuarterNotes+=e,f+=e,i=null,s=null}else if("NOTE"==t.type){let e=t;if(e.noteName=Js.getAbsNote(e.letter,e.postfix.sOctMod,"","C").name,e.prefix.sAcc&&(u.accidentals[e.noteName]=e.prefix.sAcc),e.playedAcc=Js.getPlayedAcc(e,u,s,i),e.midiKeyNum=Js.getMidiKey(e.letter,e.postfix.sOctMod,e.playedAcc,c.value),s)e.noteName==s.noteName&&e.playedAcc==s.playedAcc&&s.postfix.tied&&(s.holdToNext=!0,e.heldFromPrev=!0);else if(i)for(let t of i.notes)t.noteName==e.noteName&&t.playedAcc==e.playedAcc&&(i.postfix.tied||t.postfix.tied)&&(t.holdToNext=!0,e.heldFromPrev=!0);let n=Js.getNoteLengthInQuarterNotes(t,a);e.durationInTicks=n*r;let l=u.cumQuarterNotes*o.denominator/4;if(m&&(d=Js.getCrescMIDIbeat(m,f)),e.velocity=Js.getVelocity(l,h,d,e.prefix.decArray),e.velocity>127||e.velocity<0)throw`Velocity out of range 0-127 ${e.velocity}`;u.cumQuarterNotes+=n,f+=n,i=null,s=e}else if("CHORD"==t.type){let e=Js.getNoteLengthInQuarterNotes(t,a);t.durationInTicks=e*r;let n=u.cumQuarterNotes*o.denominator/4;if(m&&(d=Js.getCrescMIDIbeat(m,f)),t.velocity=Js.getVelocity(n,h,d,t.prefix.decArray),t.velocity>127||t.velocity<0)throw`Velocity out of range 0-127 ${t.velocity}`;u.cumQuarterNotes+=e,f+=e;for(let e=0;e<t.notes.length;e++){let n=t.notes[e];if(n.noteName=Js.getAbsNote(n.letter,n.postfix.sOctMod,"","C").name,n.prefix.sAcc&&(u.accidentals[n.noteName]=n.prefix.sAcc),n.playedAcc=Js.getPlayedAcc(n,u,s,i),n.midiKeyNum=Js.getMidiKey(n.letter,n.postfix.sOctMod,n.playedAcc,c.value),s)n.noteName==s.noteName&&n.playedAcc==s.playedAcc&&s.postfix.tied&&(s.holdToNext=!0,n.heldFromPrev=!0);else if(i)for(let e of i.notes)e.noteName==n.noteName&&e.playedAcc==n.playedAcc&&(i.postfix.tied||e.postfix.tied)&&(e.holdToNext=!0,n.heldFromPrev=!0);let o=Js.getNoteLengthInQuarterNotes(t,a);n.durationInTicks=o*r}i=t,s=null}}}for(let t=0;t<e.voices.length;t++){let r=e.voices[t],s={type:"MTrk",events:[]};s.voice=r,s.events.push({deltaTime:0,type:Zs.EventTypes.META,subtype:Zs.MetaTypes.text,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.text],data:"note track"}),e.header.Q&&0==t&&s.events.push({deltaTime:0,type:Zs.EventTypes.META,subtype:Zs.MetaTypes.tempo,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.tempo],data:Math.floor(60*e.header.Q.denominator*1e6/(4*e.header.Q.numerator*e.header.Q.bpm))}),!e.header.T||0!=t&&1!=t||s.events.push({deltaTime:0,type:Zs.EventTypes.META,subtype:Zs.MetaTypes.text,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.text],data:e.header.T}),n.push(s)}function s(e,t,n){let r=0,s=0;for(let i=0;i<n.length;i++){if(s+=n[i].deltaTime,s>t){let s=t-r;e.deltaTime=s,n[i].deltaTime-=s,n.splice(i,0,e);break}if(i==n.length-1){let r=t-s;e.deltaTime=r,n.push(e);break}r=s}}for(let e=0;e<n.length;e++){let t=n[e],r=0,i=0,o=ns.Defaults.CHANNEL-1;for(let e=0;e<t.voice.tokens.length;e++){let a=t.voice.tokens[e];if("Q"==a.type){let e=Math.floor(60*a.obj.denominator*1e6/(4*a.obj.numerator*a.obj.bpm));s({type:Zs.EventTypes.META,subtype:Zs.MetaTypes.tempo,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.tempo],data:e},i,n[0].events)}else if("MIDICHANNEL"==a.type)o=a.obj.value-1;else if("MIDIPROGRAM"==a.type){let e=o;a.obj.value[0]&&(e=a.obj.value[0]-1),t.events.push({deltaTime:r,type:Zs.MidiTypes.program,type_desc:Zs.MidiCodes[Zs.MidiTypes.program],data:[e,a.obj.value[1]]}),r=0}else if("MIDICONTROL"==a.type)t.events.push({deltaTime:r,type:Zs.MidiTypes.control,type_desc:Zs.MidiCodes[Zs.MidiTypes.control],data:[o,a.obj.value[0],a.obj.value[1]]}),r=0;else if(["PED","PED_UP"].indexOf(a.type)>-1){let e=Js.TokenTypes[a.type].data;t.events.push({deltaTime:r,type:Zs.MidiTypes.control,type_desc:Zs.MidiCodes[Zs.MidiTypes.control],data:[o,e[0],e[1]]}),r=0}else if("REST"==a.type)r+=a.durationInTicks;else if("NOTE"==a.type){let e;e=a.holdToNext?0:a.heldFromPrev?r+Js.getArticulatedDuration(a):Js.getArticulatedDuration(a),a.heldFromPrev||(t.events.push({deltaTime:r,type:Zs.MidiTypes.noteOn,type_desc:Zs.MidiCodes[Zs.MidiTypes.noteOn],data:[o,a.midiKeyNum,a.velocity]}),r=0),a.holdToNext||t.events.push({deltaTime:e,type:Zs.MidiTypes.noteOff,type_desc:Zs.MidiCodes[Zs.MidiTypes.noteOff],data:[o,a.midiKeyNum,0]}),a.holdToNext?r+=a.durationInTicks:r=a.heldFromPrev?a.durationInTicks-(e-r):a.durationInTicks-e}else if("CHORD"==a.type){for(let e=0;e<a.notes.length;e++){let n=a.notes[e];n.heldFromPrev||(t.events.push({deltaTime:r,type:Zs.MidiTypes.noteOn,type_desc:Zs.MidiCodes[Zs.MidiTypes.noteOn],data:[o,n.midiKeyNum,a.velocity]}),r=0)}let e;e=r+Js.getArticulatedDuration(a),r+=a.durationInTicks;for(let n=0;n<a.notes.length;n++){let s=a.notes[n];s.holdToNext||(t.events.push({deltaTime:e,type:Zs.MidiTypes.noteOff,type_desc:Zs.MidiCodes[Zs.MidiTypes.noteOff],data:[o,s.midiKeyNum,0]}),r-=e,e=0)}}a.hasOwnProperty("durationInTicks")&&(i+=a.durationInTicks)}e>0&&t.events.push({deltaTime:r,type:Zs.EventTypes.META,subtype:Zs.MetaTypes.endOfTrack,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.endOfTrack],data:""})}return n[0].events.push({deltaTime:0,type:Zs.EventTypes.META,subtype:Zs.MetaTypes.endOfTrack,type_desc:Zs.EventCodes[Zs.EventTypes.META],subtype_desc:Zs.MetaCodes[Zs.MetaTypes.endOfTrack],data:""}),t.tracks=n,t.header={type:"MThd",len:6,format:1,tracks:t.tracks.length,ticksPerQuarterNote:480},Ks.log(ns.dumpMidiObj(t)),t},__test__:{}};for(var ti=__webpack_require__(250),ni=__webpack_require__.n(ti),ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",si="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ii=0;ii<64;ii++)si[ri.charCodeAt(ii)]=ii;var oi=function(e){var t,n,r,s,i,o=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l=new ArrayBuffer(o),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=si[e.charCodeAt(t)],r=si[e.charCodeAt(t+1)],s=si[e.charCodeAt(t+2)],i=si[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|s>>2,u[c++]=(3&s)<<6|63&i;return l};function ai(e,t){return function(){return e.apply(t,arguments)}}const{toString:ci}=Object.prototype,{getPrototypeOf:li}=Object,ui=(fi=Object.create(null),e=>{const t=ci.call(e);return fi[t]||(fi[t]=t.slice(8,-1).toLowerCase())});var fi;const di=e=>(e=e.toLowerCase(),t=>ui(t)===e),pi=e=>t=>typeof t===e,{isArray:hi}=Array,mi=pi("undefined");const yi=di("ArrayBuffer");const Ai=pi("string"),gi=pi("function"),vi=pi("number"),_i=e=>null!==e&&"object"==typeof e,bi=e=>{if("object"!==ui(e))return!1;const t=li(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},wi=di("Date"),xi=di("File"),ki=di("Blob"),Ei=di("FileList"),Ci=di("URLSearchParams");function Bi(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,s;if("object"!=typeof e&&(e=[e]),hi(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(r=0;r<i;r++)o=s[r],t.call(null,e[o],o,e)}}function Mi(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,s=n.length;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const Ii="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Ni=e=>!mi(e)&&e!==Ii;const Ti=(Si="undefined"!=typeof Uint8Array&&li(Uint8Array),e=>Si&&e instanceof Si);var Si;const Oi=di("HTMLFormElement"),Fi=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Ri=di("RegExp"),Di=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Bi(n,((n,s)=>{let i;!1!==(i=t(n,s,e))&&(r[s]=i||n)})),Object.defineProperties(e,r)},Ui="abcdefghijklmnopqrstuvwxyz",Li="0123456789",$i={DIGIT:Li,ALPHA:Ui,ALPHA_DIGIT:Ui+Ui.toUpperCase()+Li};const Qi=di("AsyncFunction"),ji={isArray:hi,isArrayBuffer:yi,isBuffer:function(e){return null!==e&&!mi(e)&&null!==e.constructor&&!mi(e.constructor)&&gi(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||gi(e.append)&&("formdata"===(t=ui(e))||"object"===t&&gi(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&yi(e.buffer),t},isString:Ai,isNumber:vi,isBoolean:e=>!0===e||!1===e,isObject:_i,isPlainObject:bi,isUndefined:mi,isDate:wi,isFile:xi,isBlob:ki,isRegExp:Ri,isFunction:gi,isStream:e=>_i(e)&&gi(e.pipe),isURLSearchParams:Ci,isTypedArray:Ti,isFileList:Ei,forEach:Bi,merge:function e(){const{caseless:t}=Ni(this)&&this||{},n={},r=(r,s)=>{const i=t&&Mi(n,s)||s;bi(n[i])&&bi(r)?n[i]=e(n[i],r):bi(r)?n[i]=e({},r):hi(r)?n[i]=r.slice():n[i]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&Bi(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(Bi(t,((t,r)=>{n&&gi(t)?e[r]=ai(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let s,i,o;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],r&&!r(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&li(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:ui,kindOfTest:di,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(hi(e))return e;let t=e.length;if(!vi(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Oi,hasOwnProperty:Fi,hasOwnProp:Fi,reduceDescriptors:Di,freezeMethods:e=>{Di(e,((t,n)=>{if(gi(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];gi(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return hi(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:Mi,global:Ii,isContextDefined:Ni,ALPHABET:$i,generateString:(e=16,t=$i.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&gi(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(_i(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const s=hi(e)?[]:{};return Bi(e,((e,t)=>{const i=n(e,r+1);!mi(i)&&(s[t]=i)})),t[r]=void 0,s}}return e};return n(e,0)},isAsyncFn:Qi,isThenable:e=>e&&(_i(e)||gi(e))&&gi(e.then)&&gi(e.catch)};function Pi(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}ji.inherits(Pi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ji.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Yi=Pi.prototype,zi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{zi[e]={value:e}})),Object.defineProperties(Pi,zi),Object.defineProperty(Yi,"isAxiosError",{value:!0}),Pi.from=(e,t,n,r,s,i)=>{const o=Object.create(Yi);return ji.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Pi.call(o,e.message,t,n,r,s),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const Vi=Pi;function Hi(e){return ji.isPlainObject(e)||ji.isArray(e)}function Gi(e){return ji.endsWith(e,"[]")?e.slice(0,-2):e}function qi(e,t,n){return e?e.concat(t).map((function(e,t){return e=Gi(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const Wi=ji.toFlatObject(ji,{},null,(function(e){return/^is[A-Z]/.test(e)}));const Ji=function(e,t,n){if(!ji.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=ji.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!ji.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,i=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&ji.isSpecCompliantForm(t);if(!ji.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(ji.isDate(e))return e.toISOString();if(!a&&ji.isBlob(e))throw new Vi("Blob is not supported. Use a Buffer instead.");return ji.isArrayBuffer(e)||ji.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(ji.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(ji.isArray(e)&&function(e){return ji.isArray(e)&&!e.some(Hi)}(e)||(ji.isFileList(e)||ji.endsWith(n,"[]"))&&(a=ji.toArray(e)))return n=Gi(n),a.forEach((function(e,r){!ji.isUndefined(e)&&null!==e&&t.append(!0===o?qi([n],r,i):null===o?n:n+"[]",c(e))})),!1;return!!Hi(e)||(t.append(qi(s,n,i),c(e)),!1)}const u=[],f=Object.assign(Wi,{defaultVisitor:l,convertValue:c,isVisitable:Hi});if(!ji.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!ji.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),ji.forEach(n,(function(n,i){!0===(!(ji.isUndefined(n)||null===n)&&s.call(t,n,ji.isString(i)?i.trim():i,r,f))&&e(n,r?r.concat(i):[i])})),u.pop()}}(e),t};function Ki(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Xi(e,t){this._pairs=[],e&&Ji(e,this,t)}const Zi=Xi.prototype;Zi.append=function(e,t){this._pairs.push([e,t])},Zi.toString=function(e){const t=e?function(t){return e.call(this,t,Ki)}:Ki;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const eo=Xi;function to(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function no(e,t,n){if(!t)return e;const r=n&&n.encode||to,s=n&&n.serialize;let i;if(i=s?s(t,n):ji.isURLSearchParams(t)?t.toString():new eo(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const ro=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ji.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},so={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},io={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:eo,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:(()=>{let e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)})(),isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};const oo=function(e){function t(e,n,r,s){let i=e[s++];const o=Number.isFinite(+i),a=s>=e.length;if(i=!i&&ji.isArray(r)?r.length:i,a)return ji.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o;r[i]&&ji.isObject(r[i])||(r[i]=[]);return t(e,n,r[i],s)&&ji.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}(r[i])),!o}if(ji.isFormData(e)&&ji.isFunction(e.entries)){const n={};return ji.forEachEntry(e,((e,r)=>{t(function(e){return ji.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const ao={transitional:so,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=ji.isObject(e);s&&ji.isHTMLForm(e)&&(e=new FormData(e));if(ji.isFormData(e))return r&&r?JSON.stringify(oo(e)):e;if(ji.isArrayBuffer(e)||ji.isBuffer(e)||ji.isStream(e)||ji.isFile(e)||ji.isBlob(e))return e;if(ji.isArrayBufferView(e))return e.buffer;if(ji.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ji(e,new io.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return io.isNode&&ji.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=ji.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ji(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),function(e,t,n){if(ji.isString(e))try{return(t||JSON.parse)(e),ji.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ao.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&ji.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw Vi.from(e,Vi.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:io.classes.FormData,Blob:io.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ji.forEach(["delete","get","head","post","put","patch"],(e=>{ao.headers[e]={}}));const co=ao,lo=ji.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),uo=Symbol("internals");function fo(e){return e&&String(e).trim().toLowerCase()}function po(e){return!1===e||null==e?e:ji.isArray(e)?e.map(po):String(e)}function ho(e,t,n,r,s){return ji.isFunction(r)?r.call(this,t,n):(s&&(t=n),ji.isString(t)?ji.isString(r)?-1!==t.indexOf(r):ji.isRegExp(r)?r.test(t):void 0:void 0)}class mo{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function s(e,t,n){const s=fo(t);if(!s)throw new Error("header name must be a non-empty string");const i=ji.findKey(r,s);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=po(e))}const i=(e,t)=>ji.forEach(e,((e,n)=>s(e,n,t)));return ji.isPlainObject(e)||e instanceof this.constructor?i(e,t):ji.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?i((e=>{const t={};let n,r,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!n||t[n]&&lo[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&s(t,e,n),this}get(e,t){if(e=fo(e)){const n=ji.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(ji.isFunction(t))return t.call(this,e,n);if(ji.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=fo(e)){const n=ji.findKey(this,e);return!(!n||void 0===this[n]||t&&!ho(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function s(e){if(e=fo(e)){const s=ji.findKey(n,e);!s||t&&!ho(0,n[s],s,t)||(delete n[s],r=!0)}}return ji.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const s=t[n];e&&!ho(0,this[s],s,e,!0)||(delete this[s],r=!0)}return r}normalize(e){const t=this,n={};return ji.forEach(this,((r,s)=>{const i=ji.findKey(n,s);if(i)return t[i]=po(r),void delete t[s];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();o!==s&&delete t[s],t[o]=po(r),n[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ji.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&ji.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[uo]=this[uo]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=fo(e);t[r]||(!function(e,t){const n=ji.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,s){return this[r].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[r]=!0)}return ji.isArray(e)?e.forEach(r):r(e),this}}mo.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ji.reduceDescriptors(mo.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),ji.freezeMethods(mo);const yo=mo;function Ao(e,t){const n=this||co,r=t||n,s=yo.from(r.headers);let i=r.data;return ji.forEach(e,(function(e){i=e.call(n,i,s.normalize(),t?t.status:void 0)})),s.normalize(),i}function go(e){return!(!e||!e.__CANCEL__)}function vo(e,t,n){Vi.call(this,null==e?"canceled":e,Vi.ERR_CANCELED,t,n),this.name="CanceledError"}ji.inherits(vo,Vi,{__CANCEL__:!0});const _o=vo;const bo=io.isStandardBrowserEnv?{write:function(e,t,n,r,s,i){const o=[];o.push(e+"="+encodeURIComponent(t)),ji.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ji.isString(r)&&o.push("path="+r),ji.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function wo(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const xo=io.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=ji.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0};const ko=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,i=0,o=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=r[o];s||(s=c),n[i]=a,r[i]=c;let u=o,f=0;for(;u!==i;)f+=n[u++],u%=e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),c-s<t)return;const d=l&&c-l;return d?Math.round(1e3*f/d):void 0}};function Eo(e,t){let n=0;const r=ko(50,250);return s=>{const i=s.loaded,o=s.lengthComputable?s.total:void 0,a=i-n,c=r(a);n=i;const l={loaded:i,total:o,progress:o?i/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&i<=o?(o-i)/c:void 0,event:s};l[t?"download":"upload"]=!0,e(l)}}const Co="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){let r=e.data;const s=yo.from(e.headers).normalize(),i=e.responseType;let o,a;function c(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}ji.isFormData(r)&&(io.isStandardBrowserEnv||io.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?ji.isString(a=s.getContentType())&&s.setContentType(a.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let l=new XMLHttpRequest;if(e.auth){const t=e.auth.username||"",n=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.set("Authorization","Basic "+btoa(t+":"+n))}const u=wo(e.baseURL,e.url);function f(){if(!l)return;const r=yo.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders());!function(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Vi("Request failed with status code "+n.status,[Vi.ERR_BAD_REQUEST,Vi.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),c()}),(function(e){n(e),c()}),{data:i&&"text"!==i&&"json"!==i?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:r,config:e,request:l}),l=null}if(l.open(e.method.toUpperCase(),no(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=f:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(f)},l.onabort=function(){l&&(n(new Vi("Request aborted",Vi.ECONNABORTED,e,l)),l=null)},l.onerror=function(){n(new Vi("Network Error",Vi.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const r=e.transitional||so;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new Vi(t,r.clarifyTimeoutError?Vi.ETIMEDOUT:Vi.ECONNABORTED,e,l)),l=null},io.isStandardBrowserEnv){const t=(e.withCredentials||xo(u))&&e.xsrfCookieName&&bo.read(e.xsrfCookieName);t&&s.set(e.xsrfHeaderName,t)}void 0===r&&s.setContentType(null),"setRequestHeader"in l&&ji.forEach(s.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),ji.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),i&&"json"!==i&&(l.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",Eo(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Eo(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=t=>{l&&(n(!t||t.type?new _o(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)));const d=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(u);d&&-1===io.protocols.indexOf(d)?n(new Vi("Unsupported protocol "+d+":",Vi.ERR_BAD_REQUEST,e)):l.send(r||null)}))},Bo={http:null,xhr:Co};ji.forEach(Bo,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const Mo=e=>`- ${e}`,Io=e=>ji.isFunction(e)||null===e||!1===e,No=e=>{e=ji.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let i=0;i<t;i++){let t;if(n=e[i],r=n,!Io(n)&&(r=Bo[(t=String(n)).toLowerCase()],void 0===r))throw new Vi(`Unknown adapter '${t}'`);if(r)break;s[t||"#"+i]=r}if(!r){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(Mo).join("\n"):" "+Mo(e[0]):"as no adapter specified";throw new Vi("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function To(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new _o(null,e)}function So(e){To(e),e.headers=yo.from(e.headers),e.data=Ao.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return No(e.adapter||co.adapter)(e).then((function(t){return To(e),t.data=Ao.call(e,e.transformResponse,t),t.headers=yo.from(t.headers),t}),(function(t){return go(t)||(To(e),t&&t.response&&(t.response.data=Ao.call(e,e.transformResponse,t.response),t.response.headers=yo.from(t.response.headers))),Promise.reject(t)}))}const Oo=e=>e instanceof yo?e.toJSON():e;function Fo(e,t){t=t||{};const n={};function r(e,t,n){return ji.isPlainObject(e)&&ji.isPlainObject(t)?ji.merge.call({caseless:n},e,t):ji.isPlainObject(t)?ji.merge({},t):ji.isArray(t)?t.slice():t}function s(e,t,n){return ji.isUndefined(t)?ji.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function i(e,t){if(!ji.isUndefined(t))return r(void 0,t)}function o(e,t){return ji.isUndefined(t)?ji.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,s,i){return i in t?r(n,s):i in e?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t)=>s(Oo(e),Oo(t),!0)};return ji.forEach(Object.keys(Object.assign({},e,t)),(function(r){const i=c[r]||s,o=i(e[r],t[r],r);ji.isUndefined(o)&&i!==a||(n[r]=o)})),n}const Ro="1.5.1",Do={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Do[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Uo={};Do.transitional=function(e,t,n){return(r,s,i)=>{if(!1===e)throw new Vi(function(e,t){return"[Axios v1.5.1] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")),Vi.ERR_DEPRECATED);return t&&!Uo[s]&&(Uo[s]=!0),!e||e(r,s,i)}};const Lo={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Vi("options must be an object",Vi.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=t[i];if(o){const t=e[i],n=void 0===t||o(t,i,e);if(!0!==n)throw new Vi("option "+i+" must be "+n,Vi.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Vi("Unknown option "+i,Vi.ERR_BAD_OPTION)}},validators:Do},$o=Lo.validators;class Qo{constructor(e){this.defaults=e,this.interceptors={request:new ro,response:new ro}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Fo(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:s}=t;void 0!==n&&Lo.assertOptions(n,{silentJSONParsing:$o.transitional($o.boolean),forcedJSONParsing:$o.transitional($o.boolean),clarifyTimeoutError:$o.transitional($o.boolean)},!1),null!=r&&(ji.isFunction(r)?t.paramsSerializer={serialize:r}:Lo.assertOptions(r,{encode:$o.function,serialize:$o.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&ji.merge(s.common,s[t.method]);s&&ji.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=yo.concat(i,s);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,f=0;if(!a){const e=[So.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);f<u;)l=l.then(e[f++],e[f++]);return l}u=o.length;let d=t;for(f=0;f<u;){const e=o[f++],t=o[f++];try{d=e(d)}catch(e){t.call(this,e);break}}try{l=So.call(this,d)}catch(e){return Promise.reject(e)}for(f=0,u=c.length;f<u;)l=l.then(c[f++],c[f++]);return l}getUri(e){return no(wo((e=Fo(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}ji.forEach(["delete","get","head","options"],(function(e){Qo.prototype[e]=function(t,n){return this.request(Fo(n||{},{method:e,url:t,data:(n||{}).data}))}})),ji.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,s){return this.request(Fo(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Qo.prototype[e]=t(),Qo.prototype[e+"Form"]=t(!0)}));const jo=Qo;class Po{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,s){n.reason||(n.reason=new _o(e,r,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new Po((function(t){e=t})),cancel:e}}}const Yo=Po;const zo={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zo).forEach((([e,t])=>{zo[t]=e}));const Vo=zo;const Ho=function e(t){const n=new jo(t),r=ai(jo.prototype.request,n);return ji.extend(r,jo.prototype,n,{allOwnKeys:!0}),ji.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Fo(t,n))},r}(co);Ho.Axios=jo,Ho.CanceledError=_o,Ho.CancelToken=Yo,Ho.isCancel=go,Ho.VERSION=Ro,Ho.toFormData=Ji,Ho.AxiosError=Vi,Ho.Cancel=Ho.CanceledError,Ho.all=function(e){return Promise.all(e)},Ho.spread=function(e){return function(t){return e.apply(null,t)}},Ho.isAxiosError=function(e){return ji.isObject(e)&&!0===e.isAxiosError},Ho.mergeConfig=Fo,Ho.AxiosHeaders=yo,Ho.formToJSON=e=>oo(ji.isHTMLForm(e)?new FormData(e):e),Ho.getAdapter=No,Ho.HttpStatusCode=Vo,Ho.default=Ho;const Go=Ho;function qo(e){var t=e.createGain(),n=t._voltage=function(e){var t=e.createBufferSource(),n=e.createBuffer(1,2,e.sampleRate);return n.getChannelData(0).set(Jo),t.buffer=n,t.loop=!0,t}(e),r=Ko(n),s=Ko(n),i=Ko(n);return t._startAmount=Ko(s),t._endAmount=Ko(i),t._multiplier=Ko(r),t._multiplier.connect(t),t._startAmount.connect(t),t._endAmount.connect(t),t.value=r.gain,t.startValue=s.gain,t.endValue=i.gain,t.startValue.value=0,t.endValue.value=0,Object.defineProperties(t,Wo),t}var Wo={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var s=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(s,this._decayFrom,Xo(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,s=this._startAmount.gain,i=this._endAmount.gain;r.cancelScheduledValues(e),s.cancelScheduledValues(e),i.cancelScheduledValues(e);var o=Xo(this.release);if(this.attack&&e<this._decayFrom){var a=function(e,t,n,r,s){var i=s-n,o=e+i/(r-n)*(t-e);o<=e&&(o=e);o>=t&&(o=t);return o}(0,1,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(a,e),s.linearRampToValueAtTime(1-a,e),s.setTargetAtTime(0,e,o)}i.setTargetAtTime(1,e,o),r.setTargetAtTime(0,e,o)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},Jo=new Float32Array([1,1]);function Ko(e){var t=e.context.createGain();return e.connect(t),t}function Xo(e){return Math.log(e+1)/Math.log(100)}const Zo=ni().getLogger("instr");function ea(e){return"number"==typeof e}var ta=["attack","decay","sustain","release"];class na{constructor(e,t){Zo.log("instr.sp.constructor(ac, ...)");this.connected=!1,this.nextId=0,this.tracked={},this.opts=Object.assign({},{gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0},t),this.context=e,this.out=e.createGain(),this.out.gain.value=1}track(e){e.id=this.nextId++,this.tracked[e.id]=e;let t=this;return e.source.onended=function(){let n=t.context.currentTime;e.source.disconnect(),e.env.disconnect(),e.disconnect(),delete t.tracked[e.id],Zo.log(`onended ${e.id}`,t.tracked),t.emit("ended",n,e.id,e)},e.id}createNode(e,t){let n=this.context.createGain();var r;n.gain.value=0,n.connect(this.out),n.env=function(e,t,n){let r=qo(e),s=t.adsr||n.adsr;return ta.forEach((function(e,i){r[e]=s?s[i]:t[e]||n[e]})),r.value.value=ea(t.gain)?t.gain:ea(n.gain)?n.gain:1,r}(this.context,t,this.opts),n.env.connect(n.gain),n.source=this.context.createBufferSource(),n.source.buffer=e,n.source.connect(n),n.source.loop=t.loop||this.opts.loop,n.source.playbackRate.value=(r=t.cents||this.opts.cents)?Math.pow(2,r/1200):1,n.source.loopStart=t.loopStart||this.opts.loopStart,n.source.loopEnd=t.loopEnd||this.opts.loopEnd;let s=this;return n.stop=function(e){let t=e||s.context.currentTime;s.emit("stop",t,n);let r=n.env.stop(t);n.source.stop(r)},n}startBuffer(e,t,n){if(Zo.log("instr.sp.startBuffer()",e,t,n),!this.connected)return void Zo.error("SamplePlayer not connected to any node.");let r=n||{};this.emit("start",t,r);let s=this.createNode(e,r);return this.track(s),s.env.start(t),s.source.start(t),this.emit("started",t,s.id,s),r.duration&&s.stop(t+r.duration),s}stopNodes(e,t){Zo.log("instr.sp.stopNodes()",e,t);let n,r=this;return t.map((function(t){return n=r.tracked[t],n?(n.stop(e),n.id):null}))}stopAllNodes(e){Zo.log("instr.sp.stopAllNodes()",e),this.stopNodes(e,Object.keys(this.tracked))}connect(e){return this.connected=!0,this.out.connect(e),this}emit(e,t,n,r){Zo.log("instr.sp.emit",e),this.onevent&&this.onevent(e,t,n,r);var s=this["on"+e];s&&s(t,n,r)}}const ra=ni().getLogger("instr");let sa="WARN";try{sa="WARN"}catch(e){}ra.setLevel(sa),ra.info("instr index.js");let ia={};function oa(e,t=!0){const n={A:"G",B:"A",C:"B",D:"C",E:"D",F:"E",G:"F"},r={A:"B",B:"C",C:"D",D:"E",E:"F",F:"G",G:"A"},s={A:!0,B:!0,C:!1,D:!0,E:!0,F:!1,G:!0};let i=t?1:-1,o=t?"B":"C",a=e[0];if("b"==e[1]){let r=parseInt(e[2]);return(t?a:n[a])+r}{let c=parseInt(e[1]);if(a==o&&(c+=i,8<c||c<1))return"";let l=t?r:n;if(t){let e=l[a];return s[e]?e+"b"+c:e+c}return s[a]?a+"b"+c:l[a]+c}}class aa{constructor(e,t){ra.log(`instr.Instrument.constructor(ac, ${t})`),this.ac=e,this.audioBuffers={},this.name=t}async load(e){ra.log(`instr.Instrument.load(${e})`);let t=await Go.get(e);ia[this.name]=t.data}async decode(e){ra.log(`instr.Instrument.decode(${this.name})`);let t=this,n=0,r=0;for(const[e,s]of Object.entries(ia[this.name])){let i;ra.log(e);try{i=s.indexOf(",")}catch(e){throw ra.error(e),ra.error(`${this.name} ${JSON.stringify(s)}`),e}let o,a=s.slice(i+1);ra.log(`audioData.length = ${a.length}`);try{o=oi(a),n+=o.byteLength}catch(e){throw ra.error(`${this.name} ${JSON.stringify(s)}`,s),"Instrument decode"}await this.ac.decodeAudioData(o,(function(n){t.audioBuffers[e]=n,ra.log(t.name+" "+e+" audioBuffer.length = "+n.length),r+=n.length}))}ra.log("Total audio data length = "+n),ra.log("Total audio buffer length = "+r);let s={};for(const[e,t]of Object.entries(this.audioBuffers)){let n=e.split("v"),r=n[0];s[r]=s[r]||{};let i=s[r],o=n[1];o?i[o]=t:i[8]=t}this.audioBuffersLayers=s,this.audioBufferCache={},this.sp=new na(this.ac,{}),e?this.sp.connect(e):this.sp.connect(this.ac.destination),ra.log(`DONE decode ${this.name}`)}start(e,t,n){ra.log(`${this.name} start(${e}, ${t}, ${JSON.stringify(n)})`);let r,s=0,i=(n=n||{}).gain||.5,o=`${Math.round(15*i)+1}`,a=`${e}${o}`;if(this.audioBufferCache[a]){ra.log(a+" from cache");let e=this.audioBufferCache[a];r=e.buffer,s=e.cents}else{let t=null;if(this.audioBuffersLayers[e])t=e,ra.log(e+" in buffers");else{let n=e,r=0,i=e,o=0;for(;i||n;){if(n&&(n=oa(n,!1),r+=100,this.audioBuffersLayers[n])){t=n,s=r;break}if(i&&(i=oa(i),o-=100,i&&this.audioBuffersLayers[i])){t=i,s=o;break}}ra.log("found "+t)}if(!t)return void ra.error("Note "+e+" not found, and no lower/higher note found either.");let n=this.audioBuffersLayers[t],i=function(e,t){let n=parseInt(e),r=-1,s=100;for(let e of t){let t=parseInt(e),i=Math.abs(t-n);i<s&&(r=t,s=i)}return r}(o,Object.keys(n));r=n[i],this.audioBufferCache[a]={buffer:r,cents:s}}return n.cents=s,this.sp.startBuffer(r,t,n)}stop(e,t){ra.log(`${this.name} stop()`,t),this.sp.stopNodes(e,t)}}const ca=Br().getLogger("audiolib"),la=Tr.assert,ua=ns.Symbols,fa=ua.NoteEventDataIdx.CHANNEL,da=ua.NoteEventDataIdx.KEY,pa=ua.NoteEventDataIdx.VELOCITY;function ha(e,t){let n;if(e.ticksPerQuarterNote){la(t,"Must supply microsecondsPerQuarterNote"),n=t/e.ticksPerQuarterNote/1e6}else la(e.smtpeTicksPerFrame&&e.smtpeFramesPerSec),n=1/(e.smtpeTicksPerFrame*e.smtpeFramesPerSec);return n}"undefined"==typeof window&&(__webpack_require__.g.window={});let ma=null,ya=null;class Aa{constructor(e){ca.log("audiolib.midi.PlayerContext.constructor()"),e?this.audioCtx=e:(this.audioCtx=function(){if(!ma){let e=window.AudioContext||window.webkitAudioContext;if(!e)return ca.error("audiolib.midi.getDefaultAudioContext. AudioContext not available."),null;ma=new e}return ma}(),this.audioCtx||ca.error("audiolib.midi.PlayerContext. No default AudioContext available."),this.audioCtx=ma),this.masterGainNode=this.audioCtx.createGain(),this.masterGainNode.gain.value=1,this.masterGainNode.connect(this.audioCtx.destination),this.instr={}}async loadInstrument(e,t,n){ca.log("audiolib.midi.PlayerContext.loadInstrument()",e,t,n);let r=new aa(this.audioCtx,e);this.instr[e]=r;let s="./sf";s=t?`${s}/${t}`:s,s=n?`${s}/${n}-mp3.json`:`${s}/${e}-mp3.json`,await r.load(s),await r.decode(this.masterGainNode)}setVolume(e){ca.log("audiolib.PlayerContext.setVolume()",e);let t=e/100*2;this.masterGainNode.gain.setValueAtTime(t,this.audioCtx.currentTime)}}function ga(e,t,n){ca.log("audiolib.midi.playerScheduleNoteOff()");let r=e.data[fa],s=e.data[da],i=null;for(let e=0;e<n.trackedNodes.length;e++){let o=n.trackedNodes[e];if(null==o.untrackAt&&o.channel==r&&o.key==s){o.untrackAt=t,i=o.node;break}}i&&e.instr.stop(t,[i.id])}const va=Aa,_a=class{constructor(e,t,n){ca.log("audiolib.midi.Player.constructor()"),e?this.context=e:(ya=ya||new Aa,this.context=ya),this.audioCtx=this.context.audioCtx,this.animationCallback=t,this.onEndCallback=n,this.status="STOPPED",this.schedulerState={trackedNodes:[],channelInfo:{}}}setContext(e){ca.log("audiolib.midi.Player.setContext()"),this.context=e}setAnimationCallback(e){ca.log("audiolib.midi.Player.setAnimationCallback()"),this.animationCallback=e}loadMidiObj(e,t=!1){ca.log("audiolib.midi.Player.loadMidiObj()",e),this.soundEvents=function(e,t){ca.info("audiolib.midi.replay()",e);const n={0:"acoustic_grand_piano",6:"harpsichord",73:"flute",115:"woodblock"};let r=[],s=e.header.tracks;for(let t=0;t<s;t++){let n=e.tracks[t].events,s=0;for(let e=0;e<n.length;e++){let i=n[e];i.midiIndex=e,s+=i.deltaTime,i.cumDeltaTime=s;let o={tick:s,track:t,midiIndex:e,type:i.type,data:i.data};i.subtype&&(o.subtype=i.subtype),r.push(o)}}r.sort((function(e,t){return e.tick<t.tick?-1:e.tick>t.tick?1:e.track<t.track?-1:e.track>t.track?1:e.midiIndex<t.midiIndex?-1:e.midiIndex>t.midiIndex?1:0}));let i=[];for(let e=0;e<16;e++)i.push({program:ns.Defaults.PROGRAM});let o=0,a=null,c=ha(e.header,5e5);for(;o<r.length;){let s=r[o];if(0==o?(a=s,a.time=0):a=r[o-1],s.time=a.time+(s.tick-a.tick)*c,s.type==ua.EventTypes.META)if(s.subtype==ua.MetaTypes.tempo){la(e.header.ticksPerQuarterNote,"Have a Set Tempo META event, but division is in SMPTE format??");let t=s.data;c=ha(e.header,t)}else ca.info(`Unhandled event ${ua.EventCodes[s.type]} ${ua.MetaCodes[s.subtype]}`,s.data);else if(s.type==ua.EventTypes.F0SYSEX||s.type==ua.EventTypes.F7SYSEX)ca.info(`Unhandled event ${ua.EventCodes[s.type]}`);else{let e=i[s.data[fa]];s.type==ua.MidiTypes.noteOn?(s.data[pa]>127?ca.warn(`noteOn velocity too high ${s.data[pa]}`,s):0==s.data[pa]&&ca.warn("noteOn with velocity 0",s),s.instr=t[n[e.program]]):s.type==ua.MidiTypes.noteOff?s.instr=t[n[e.program]]:s.type==ua.MidiTypes.program?e.program=s.data[1]:s.type==ua.MidiTypes.control&&s.data[1]==ua.ControllerTypes.holdPedal||ca.warn(`Unhandled event MIDI ${ua.MidiCodes[s.type]}`,s)}o++}return ca.log(r),r}(e,this.context.instr),this.duration=0;for(let e=this.soundEvents.length-1;e>-1;e--){let n=this.soundEvents[e];if(t&&0!=n.track&&n.subtype==ua.MetaTypes.endOfTrack){this.duration=n.time;break}if(n.subtype==ua.MetaTypes.endOfTrack){this.duration=n.time;break}this.duration=n.time;break}la(this.duration,"Duration is zero."),this.seek(0)}loadAbc(e){ca.log("audiolib.midi.Player.loadAbc()");let t=ei.abc2AbcObj(e),n=ei.abcObj2MidiObj(t);this.loadMidiObj(n)}loadMidiB64(e){ca.log("audiolib.midi.Player.loadMidiB64()");let t=ns.midi2MidiObj(e);this.loadMidiObj(t,!0)}get progressPct(){return 100*(this.audioCtx.currentTime+this.timeProgressed-this.timeLastStarted)/this.duration}schedule2(e,t){ca.log("Player.schedule2()",e,t);let n=this.soundEvents;la(n);let r=Math.max(e.timeLastEvent,this.timeProgressed)+t;for(;e.nextEventIdx<n.length&&e.timeLastEvent<r;){let t=n[e.nextEventIdx];if(t.type==ua.MidiTypes.noteOn){let n=t.data[fa];0==t.data[pa]&&ca.warn("noteOn with velocity 0");let r=t.time,i=this.timeLastStarted+(r-this.timeProgressed),o=t.data[da],a=t.data[pa],c=t.instr.start(ns.getNote(o),i,{gain:(s=a,s/127)});e.trackedNodes.push({channel:n,key:o,node:c})}else if(t.type==ua.MidiTypes.noteOff){let n=t.data[fa];if(e.channelInfo[n]&&e.channelInfo[n].holdPedal){let r=e.channelInfo[n];ca.log("delaying ",t),r.delayedNoteOffEvents=r.delayedNoteOffEvents||[],r.delayedNoteOffEvents.push(t)}else{let n=t.time;ga(t,this.timeLastStarted+(n-this.timeProgressed),e)}}else if(t.type==ua.MidiTypes.control)if(t.data[1]==ua.ControllerTypes.holdPedal){let n=t.data[fa];e.channelInfo[n]=e.channelInfo[n]||{};let r=e.channelInfo[n];if(ca.log("holdPedal",t,r),t.data[2]==ua.ControllerValues.ON)ca.log("Pedal ON",t),r.holdPedal=!0;else if(r.holdPedal){ca.log("Pedal OFF",t);let n=t.time;for(let t=0;t<r.delayedNoteOffEvents.length;t++){ga(r.delayedNoteOffEvents[t],this.timeLastStarted+(n-this.timeProgressed),e)}r.holdPedal=!1,r.delayedNoteOffEvents=[]}else ca.warn("Pedal OFF, but pedal not currently ON",t)}else{let e=t.data[1];ca.info(`Unhandled ControllerType ${e} ${ua.ControllerCodes[e]}`,t)}else t.type==ua.EventTypes.META?ca.info(`Unhandled event (type ${t.type.toString(16)}) ${ua.EventCodes[t.type]} ${ua.MetaCodes[t.subtype]}`,t):ca.info(`Unhandled event (type ${t.type.toString(16)}) ${ua.MidiCodes[t.type]}`,t);e.timeLastEvent=t.time,e.nextEventIdx++}var s;let i=[];for(let t=0;t<e.trackedNodes.length;t++){let n=this.audioCtx.currentTime,r=e.trackedNodes[t];null==r.untrackAt||r.untrackAt>n?i.push(r):ca.log(`gc ch=${r.channel} key=${r.key} node.id=${r.node.id} untrackAt=${r.untrackAt}, T=${n}`)}return e.trackedNodes=i,ca.debug("DONE Player.schedule2()"),e.nextEventIdx<n.length}start(){if(ca.log("Player.start()"),"STOPPED"!=this.status)return;this.seek(100*this.timeProgressed/this.duration),this.status="STARTED",this.timeLastStarted=this.audioCtx.currentTime;let e=this,t=this.schedulerState;!function n(r){e.schedule2(t,3)&&(t.timeoutID=setTimeout((function(){n(3)}),1e3*r))}(2.5),this.progressIntervalID=setInterval((function(){let t=100*(e.audioCtx.currentTime+e.timeProgressed-e.timeLastStarted)/e.duration;e.animationCallback&&e.animationCallback(t),t<100||(clearInterval(e.progressIntervalID),e.stop("END"))}),100)}stop(e){if(ca.log("Player.stop()"),"STARTED"!=this.status)return;this.status="STOPPED","END"==e&&this.onEndCallback&&this.onEndCallback(),clearTimeout(this.schedulerState.timeoutID),clearInterval(this.progressIntervalID),this.timeProgressed+=this.audioCtx.currentTime-this.timeLastStarted;let t=this.schedulerState;for(let e=0;e<t.trackedNodes.length;e++){t.trackedNodes[e].node.stop()}this.schedulerState.trackedNodes=[],this.schedulerState.channelInfo={}}seek(e,t=!1){ca.log(`Player.seek(${e}, ${t})`),"STARTED"==this.status&&this.stop(),this.timeProgressed=e/100*this.duration;for(let e=this.soundEvents.length-1;e>-1;e--){let t=this.soundEvents[e];if(e<1)this.schedulerState.nextEventIdx=0,this.schedulerState.timeLastEvent=0;else if(t.time<this.timeProgressed){let t=Math.min(e+1,this.soundEvents.length-1);this.schedulerState.nextEventIdx=t,this.schedulerState.timeLastEvent=this.soundEvents[t-1].time;break}}t&&this.start()}},ba=Br().getLogger("audiolib");let wa="WARN";try{wa="WARN"}catch(e){}ba.setLevel(wa),ba.info("audiolib index.js");const xa=va,ka=_a;Q=!0;const Ea=[];function Ca(e,t=y){let n=null;const r=new Set;function s(t){if(R(e,t)&&(e=t,n)){const t=!Ea.length;for(const t of r)t[1](),Ea.push(t,e);if(t){for(let e=0;e<Ea.length;e+=2)Ea[e][0](Ea[e+1]);Ea.length=0}}}function i(t){s(t(e))}return{set:s,update:i,subscribe:function(o,a=y){const c=[o,a];return r.add(c),1===r.size&&(n=t(s,i)||y),o(e),()=>{r.delete(c),0===r.size&&n&&(n(),n=null)}}}}nn("<div><!></div>");nn('<h2><button type="button"><!></button></h2>');function Ba(e){document.body.style.paddingRight=e>0?`${e}px`:null}function Ma(){const e=function(){let e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}(),t=document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top")[0],n=t?parseInt(t.style.paddingRight||0,10):0;window&&document.body.clientWidth<window.innerWidth&&Ba(n+e)}function Ia(e,t,n){return!0===n||""===n?e?"col":`col-${t}`:"auto"===n?e?"col-auto":`col-${t}-auto`:e?`col-${n}`:`col-${t}-${n}`}function Na(e){let t="";if("string"==typeof e||"number"==typeof e)t+=e;else if("object"==typeof e)if(Array.isArray(e))t=e.map(Na).filter(Boolean).join(" ");else for(let n in e)e[n]&&(t&&(t+=" "),t+=n);return t}const Ta=(...e)=>e.map(Na).filter(Boolean).join(" ");function Sa(e){if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);const r=Number.parseFloat(t),s=Number.parseFloat(n);return r||s?(t=t.split(",")[0],n=n.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(n))):0}function Oa(e){e.style.display="block";return{duration:Sa(e),tick:t=>{0===t&&e.classList.add("show")}}}function Fa(e){e.classList.remove("show");return{duration:Sa(e),tick:t=>{0===t&&(e.style.display="none")}}}function Ra(e,t){const n=t.horizontal?"width":"height";e.style[n]=`${e.getBoundingClientRect()[n]}px`,e.classList.add("collapsing"),e.classList.remove("collapse","show");return{duration:Sa(e),tick:t=>{t>0?e.style[n]="":0===t&&(e.classList.remove("collapsing"),e.classList.add("collapse"))}}}function Da(e,t){const n=t.horizontal,r=n?"width":"height";e.classList.add("collapsing"),e.classList.remove("collapse","show"),e.style[r]=0;return{duration:Sa(e),tick:t=>{t<1?n?e.style.width=`${e.scrollWidth}px`:e.style.height=`${e.scrollHeight}px`:(e.classList.remove("collapsing"),e.classList.add("collapse","show"),e.style[r]="")}}}function Ua(e){e.style.display="block";return{duration:Sa(e),tick:t=>{t>0&&e.classList.add("show")}}}function La(e){e.classList.remove("show");return{duration:Sa(e),tick:t=>{1===t&&(e.style.display="none")}}}const $a=["touchstart","click"];var Qa=nn("<div><!></div>");function ja(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["isOpen","class","horizontal","navbar","onEntering","onEntered","onExiting","onExited","expand","toggler"]);vt(t,!1);const s=Y(),i=ar();let o=_r(t,"isOpen",12,!1),a=_r(t,"class",8,""),c=_r(t,"horizontal",8,!1),l=_r(t,"navbar",8,!1),u=_r(t,"onEntering",8,(()=>i("opening"))),f=_r(t,"onEntered",8,(()=>i("open"))),d=_r(t,"onExiting",8,(()=>i("closing"))),p=_r(t,"onExited",8,(()=>i("close"))),h=_r(t,"expand",8,!1),m=_r(t,"toggler",8,null);ir((()=>((e,t)=>{let n;if("string"==typeof e&&"undefined"!=typeof window&&document&&document.createElement){let r=document.querySelectorAll(e);if(r.length||(r=document.querySelectorAll(`#${e}`)),!r.length)throw new Error(`The target '${e}' could not be identified in the dom, tip: check spelling`);$a.forEach((e=>{r.forEach((n=>{n.addEventListener(e,t)}))})),n=()=>{$a.forEach((e=>{r.forEach((n=>{n.removeEventListener(e,t)}))}))}}return()=>{"function"==typeof n&&(n(),n=void 0)}})(m(),(e=>{o(!o()),e.preventDefault()}))));let y=Y(0),A=Y(!1);const g=Y({});function v(){i("update",o())}V(g,dt(g).xs=0),V(g,dt(g).sm=576),V(g,dt(g).md=768),V(g,dt(g).lg=992),V(g,dt(g).xl=1200),ae((()=>(bt(a()),bt(c()),bt(l()))),(()=>{H(s,Ta(a(),{"collapse-horizontal":c(),"navbar-collapse":l()}))})),ae((()=>(bt(l()),bt(h()),dt(y),dt(g),bt(o()),dt(A))),(()=>{l()&&h()&&(dt(y)>=dt(g)[h()]&&!o()?(o(!0),H(A,!0),v()):dt(y)<dt(g)[h()]&&dt(A)&&(o(!1),H(A,!1),v()))})),ce(),nr();var _=on();xn(Ft(_),o,(e=>{var n=Qa();let i;Sn(Ot(n),t,"default",{},null),Pt(n),ue((()=>i=Dn(n,i,{style:l()?void 0:"overflow: hidden;",...r,class:dt(s)}))),Jn(1,n,(()=>Da),(()=>({horizontal:c()}))),Jn(2,n,(()=>Ra),(()=>({horizontal:c()}))),Jt("introstart",n,(function(e){sr.call(this,t,e)})),Jt("introend",n,(function(e){sr.call(this,t,e)})),Jt("outrostart",n,(function(e){sr.call(this,t,e)})),Jt("outroend",n,(function(e){sr.call(this,t,e)})),Jt("introstart",n,(function(...e){u()?.apply(this,e)})),Jt("introend",n,(function(...e){f()?.apply(this,e)})),Jt("outrostart",n,(function(...e){d()?.apply(this,e)})),Jt("outroend",n,(function(...e){p()?.apply(this,e)})),an(e,n)})),tr("innerWidth",(e=>H(y,e))),an(e,_),_t()}nn("<!> ",1),nn('<div class="accordion-body"><!></div>'),nn("<div><!> <!></div>");const Pa=e=>e;function Ya(e,{delay:t=0,duration:n=400,easing:r=Pa}={}){const s=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:r,css:e=>"opacity: "+e*s}}var za=nn('<h4 class="alert-heading"> <!></h4>'),Va=nn('<button type="button"></button>'),Ha=nn("<div><!> <!> <!></div>");nn('<span class="visually-hidden"> </span>'),nn("<a><!> <!></a>"),nn('<span class="visually-hidden"> </span>'),nn("<span><!> <!></span>");nn("<nav><ol><!></ol></nav>");nn("<li><!></li>");var Ga=nn("<a><!></a>"),qa=nn("<button><!></button>");function Wa(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","active","block","children","close","color","disabled","href","inner","outline","size","value"]);vt(t,!1);const s=Y(),i=Y(),o=Y();let a=_r(t,"class",8,""),c=_r(t,"active",8,!1),l=_r(t,"block",8,!1),u=_r(t,"children",8,""),f=_r(t,"close",8,!1),d=_r(t,"color",8,"secondary"),p=_r(t,"disabled",8,!1),h=_r(t,"href",8,""),m=_r(t,"inner",12,void 0),y=_r(t,"outline",8,!1),A=_r(t,"size",8,""),g=_r(t,"value",8,"");ae((()=>bt(n)),(()=>{H(s,n["aria-label"])})),ae((()=>(bt(a()),bt(f()),bt(y()),bt(d()),bt(A()),bt(l()),bt(c()))),(()=>{H(i,Ta(a(),f()?"btn-close":"btn",f()||`btn${y()?"-outline":""}-${d()}`,!!A()&&`btn-${A()}`,!!l()&&"d-block w-100",{active:c()}))})),ae((()=>bt(f())),(()=>{H(o,f()?"Close":null)})),ce(),nr();var v=on();xn(Ft(v),h,(e=>{var n=Ga();let a;xn(Ot(n),u,(e=>{var t=sn();ue((()=>yn(t,u()))),an(e,t)}),(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)})),Pt(n),er(n,(e=>m(e)),(()=>m())),ue((()=>{a=Dn(n,a,{...r,class:dt(i),href:h(),"aria-label":dt(s)||dt(o)}),Pn(n,"disabled",p())})),Jt("click",n,(function(e){sr.call(this,t,e)})),an(e,n)}),(e=>{var n=qa();let a;Sn(Ot(n),t,"default",{},(e=>{var n=on();xn(Ft(n),u,(e=>{var t=sn();ue((()=>yn(t,u()))),an(e,t)}),(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)})),an(e,n)})),Pt(n),er(n,(e=>m(e)),(()=>m())),ue((()=>a=Dn(n,a,{...r,class:dt(i),disabled:p(),value:g(),"aria-label":dt(s)||dt(o)}))),Jt("click",n,(function(e){sr.call(this,t,e)})),an(e,n)})),an(e,v),_t()}nn("<li><!></li>"),nn("<div><!></div>");var Ja=nn("<div><!></div>");function Ka(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","size","vertical"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"size",8,""),a=_r(t,"vertical",8,!1);ae((()=>(bt(i()),bt(o()),bt(a()))),(()=>{H(s,Ta(i(),!!o()&&`btn-group-${o()}`,a()?"btn-group-vertical":"btn-group"))})),ce(),nr();var c=Ja();let l;Sn(Ot(c),t,"default",{},null),Pt(c),ue((()=>l=Dn(c,l,{...r,class:dt(s)}))),an(e,c),_t()}nn("<div><!></div>");var Xa=nn("<div><!></div>");function Za(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","body","color","inverse","outline","theme"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"body",8,!1),a=_r(t,"color",8,""),c=_r(t,"inverse",8,!1),l=_r(t,"outline",8,!1),u=_r(t,"theme",8,void 0);ae((()=>(bt(i()),bt(c()),bt(o()),bt(a()),bt(l()))),(()=>{H(s,Ta(i(),"card",!!c()&&"text-white",!!o()&&"card-body",!!a()&&`${l()?"border":"bg"}-${a()}`))})),ce(),nr();var f=Xa();let d;Sn(Ot(f),t,"default",{},null),Pt(f),ue((()=>d=Dn(f,d,{...r,"data-bs-theme":u(),class:dt(s)}))),Jt("click",f,(function(e){sr.call(this,t,e)})),an(e,f),_t()}nn("<div><!></div>");nn("<div><!></div>");nn("<div><!></div>");nn("<div><!></div>");nn("<div><!></div>");nn("<h3><!></h3>"),nn("<div><!></div>");nn("<img>");nn("<div><!></div>");nn("<a><!></a>");nn("<h6><!></h6>");nn("<p><!></p>");nn("<h5><!></h5>");nn("<div><!></div>");nn("<h5> </h5>"),nn("<p> </p>"),nn("<div><!> <!> <!></div>");nn('<a><span aria-hidden="true"></span> <span class="visually-hidden"> </span></a>');nn('<button data-bs-target=""> </button>'),nn("<div></div>");nn("<div><!></div>");var ec=nn("<div><!></div>");function tc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","xs","sm","md","lg","xl","xxl"]);vt(t,!1);let s=_r(t,"class",8,""),i=_r(t,"xs",8,void 0),o=_r(t,"sm",8,void 0),a=_r(t,"md",8,void 0),c=_r(t,"lg",8,void 0),l=_r(t,"xl",8,void 0),u=_r(t,"xxl",8,void 0);const f=[],d={xs:i(),sm:o(),md:a(),lg:c(),xl:l(),xxl:u()};Object.keys(d).forEach((e=>{const t=d[e];if(!t&&""!==t)return;const n="xs"===e;if(function(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)){const r=n?"-":`-${e}-`,s=Ia(n,e,t.size);(t.size||""===t.size)&&f.push(s),t.push&&f.push(`push${r}${t.push}`),t.pull&&f.push(`pull${r}${t.pull}`),t.offset&&f.push(`offset${r}${t.offset}`),t.order&&f.push(`order${r}${t.order}`)}else f.push(Ia(n,e,t))})),f.length||f.push("col"),s()&&f.push(s()),nr();var p=ec();let h;Sn(Ot(p),t,"default",{},null),Pt(p),ue((()=>h=Dn(p,h,{...r,class:f.join(" ")}))),an(e,p),_t()}nn("<col>"),nn("<th><!> <!></th>"),nn("<th><!> <!></th>"),nn("<td><!></td>");var nc=nn("<div><!></div>");function rc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","sm","md","lg","xl","xxl","fluid"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"sm",8,void 0),a=_r(t,"md",8,void 0),c=_r(t,"lg",8,void 0),l=_r(t,"xl",8,void 0),u=_r(t,"xxl",8,void 0),f=_r(t,"fluid",8,!1);ae((()=>(bt(i()),bt(o()),bt(a()),bt(c()),bt(l()),bt(u()),bt(f()))),(()=>{H(s,Ta(i(),{"container-sm":o(),"container-md":a(),"container-lg":c(),"container-xl":l(),"container-xxl":u(),"container-fluid":f(),container:!(o()||a()||c()||l()||u()||f())}))})),ce(),nr();var d=nc();let p;Sn(Ot(d),t,"default",{},null),Pt(d),ue((()=>p=Dn(d,p,{...r,class:dt(s)}))),an(e,d),_t()}nn("<h6><!></h6>"),nn("<div><!></div>"),nn("<a><!></a>"),nn("<button><!></button>"),nn("<li><!></li>");nn("<ul><!></ul>");nn('<span class="visually-hidden"> </span>'),nn("<a><!></a>"),nn('<span class="visually-hidden"> </span>'),nn("<div><!></div>"),nn('<span class="visually-hidden"> </span>'),nn("<span><!></span>"),nn('<span class="visually-hidden"> </span>'),nn("<button><!></button>");nn("<div><!></div>");nn('<figcaption class="figure-caption"> <!></figcaption>'),nn("<img> <figure><!> <!></figure>",1);nn("<form><!></form>");nn("<input>"),nn("<input>"),nn("<input>"),nn('<label class="form-check-label"><!></label>'),nn("<div><!> <!></div>");nn("<div><!></div>");nn("<label> <!></label>"),nn("<fieldset><!> <!></fieldset>"),nn("<label> <!></label>"),nn("<div><!> <!></div>");nn("<small><!></small>");nn("<i></i>");nn("<img>");var sc=nn("<div><!></div>");function ic(e,t){var n=sc();Sn(Ot(n),t,"default",{},null),Pt(n),an(e,n)}nn("<input>"),nn("<input>"),nn("<input>"),nn("<input>"),nn("<input>"),nn("<input>"),nn("<textarea></textarea>"),nn("<select><!></select>"),nn("<!> <!>",1);nn("<div><!></div>");nn("<span><!></span>");nn("<div><!></div>");nn("<label><!></label>");nn("<ol><!></ol>"),nn("<ul><!></ul>");nn("<a><!></a>"),nn("<button><!></button>"),nn("<li><!></li>");var oc=nn("<div></div>");var ac=nn("<div><!></div>");function cc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,"");ae((()=>bt(i())),(()=>{H(s,Ta(i(),"modal-body"))})),ce(),nr();var o=ac();let a;Sn(Ot(o),t,"default",{},null),Pt(o),ue((()=>a=Dn(o,a,{...r,class:dt(s)}))),an(e,o),_t()}var lc=nn('<button type="button" class="btn-close"></button>'),uc=nn('<div><h5 class="modal-title"><!></h5> <!></div>');var fc=nn("<div><!></div>");function dc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,[]);vt(t,!1);let s,i=Y();ir((()=>{s=document.createElement("div"),document.body.appendChild(s),s.appendChild(dt(i))})),or((()=>{s&&document.body.removeChild(s)})),nr();var o=fc();let a;Sn(Ot(o),t,"default",{},null),Pt(o),er(o,(e=>H(i,e)),(()=>dt(i))),ue((()=>a=Dn(o,a,{...r}))),an(e,o),_t()}let pc=0;var hc=nn('<div role="dialog"><!> <div role="document"><div><!> <!></div></div></div>'),mc=nn("<div><!></div>"),yc=nn("<!> <!>",1);function Ac(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","static","autoFocus","body","centered","container","fullscreen","header","isOpen","keyboard","backdrop","contentClassName","fade","labelledBy","modalClassName","modalStyle","returnFocusAfterClose","scrollable","size","theme","toggle","unmountOnClose","wrapClassName"]);vt(t,!1);const s=Y(),i=Y(),o=ar();let a,c,l,u,f=_r(t,"class",8,""),d=_r(t,"static",8,!1),p=_r(t,"autoFocus",8,!0),h=_r(t,"body",8,!1),m=_r(t,"centered",8,!1),y=_r(t,"container",8,void 0),A=_r(t,"fullscreen",8,!1),g=_r(t,"header",8,void 0),v=_r(t,"isOpen",8,!1),_=_r(t,"keyboard",8,!0),b=_r(t,"backdrop",8,!0),w=_r(t,"contentClassName",8,""),x=_r(t,"fade",8,!0),k=_r(t,"labelledBy",24,(()=>g()?`modal-${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}`:void 0)),E=_r(t,"modalClassName",8,""),C=_r(t,"modalStyle",8,null),B=_r(t,"returnFocusAfterClose",8,!0),M=_r(t,"scrollable",8,!1),I=_r(t,"size",8,""),N=_r(t,"theme",8,null),T=_r(t,"toggle",8,void 0),S=_r(t,"unmountOnClose",8,!0),O=_r(t,"wrapClassName",8,""),F=!1,R=Y(!1),D=v(),U=F,L=Y();function $(){dt(L)&&dt(L).parentNode&&"function"==typeof dt(L).parentNode.focus&&dt(L).parentNode.focus()}function Q(){try{a=document.activeElement}catch(e){a=null}d()||(c=function(){const e=window?window.getComputedStyle(document.body,null):{};return parseInt(e&&e.getPropertyValue("padding-right")||0,10)}(),Ma(),0===pc&&(document.body.className=Ta(document.body.className,"modal-open")),pc+=1),H(R,!0)}function j(){a&&("function"==typeof a.focus&&B()&&a.focus(),a=null)}function P(){j()}function z(){pc<=1&&document.body.classList.remove("modal-open"),j(),pc=Math.max(0,pc-1),Ba(c)}function V(e){if(e.target===l){if(!v()||!b())return;const t=dt(L)?dt(L).parentNode:null;!0===b()&&t&&e.target===t&&T()&&(e.stopPropagation(),T()(e))}}function G(){o("open"),u=function(e,...t){return e.addEventListener(...t),()=>e.removeEventListener(...t)}(document,"keydown",(e=>{e.key&&"Escape"===e.key&&_()&&T()&&!0===b()&&(u&&u(),T()(e))}))}function q(){o("closing"),u&&u()}function W(){o("close"),S()&&P(),z(),dt(R)&&(F=!1),H(R,!1)}function K(e){l=e.target}ir((()=>{v()&&(Q(),F=!0),F&&p()&&$()})),or((()=>{P(),F&&z()})),cr((()=>{v()&&!D&&(Q(),F=!0),p()&&F&&!U&&$(),D=v(),U=F}));const X="modal-dialog";ae((()=>(bt(f()),bt(I()),bt(A()),bt(m()),bt(M()))),(()=>{H(s,Ta(X,f(),{[`modal-${I()}`]:I(),"modal-fullscreen":!0===A(),[`modal-fullscreen-${A()}-down`]:A()&&"string"==typeof A(),[`${X}-centered`]:m(),[`${X}-scrollable`]:M()}))})),ae((()=>(bt(y()),bt(d()),dc)),(()=>{H(i,"inline"===y()||d()?ic:dc)})),ce(),nr();var Z=yc(),ee=Ft(Z);xn(ee,(()=>dt(R)),(e=>{var n=on();Fn(Ft(n),(()=>dt(i)),((e,n)=>{n(e,{children:(e,n)=>{var i=mc();let a;xn(Ot(i),v,(e=>{var n=hc();const r=J((()=>Ta("modal",E(),{fade:x(),"position-static":d()})));var i=Ot(n);Sn(i,t,"external",{},null);var a=Rt(i,2),c=Ot(a);const l=J((()=>Ta("modal-content",w())));var u=Ot(c);xn(u,g,(e=>{!function(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","toggle","closeAriaLabel","id","children"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"toggle",8,void 0),a=_r(t,"closeAriaLabel",8,"Close"),c=_r(t,"id",8,void 0),l=_r(t,"children",8,void 0);ae((()=>bt(i())),(()=>{H(s,Ta(i(),"modal-header"))})),ce(),nr();var u=uc();let f;var d=Ot(u);xn(Ot(d),l,(e=>{var t=sn();ue((()=>yn(t,l()))),an(e,t)}),(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)})),Pt(d),Sn(Rt(d,2),t,"close",{},(e=>{var t=on();xn(Ft(t),(()=>"function"==typeof o()),(e=>{var t=lc();ue((()=>Rn(t,"aria-label",a()))),Jt("click",t,(function(...e){o()?.apply(this,e)})),an(e,t)})),an(e,t)})),Pt(u),ue((()=>{f=Dn(u,f,{...r,class:dt(s)}),Rn(d,"id",c())})),an(e,u),_t()}(e,{get toggle(){return T()},get id(){return k()},children:(e,t)=>{Yt();var n=sn();ue((()=>yn(n,g()))),an(e,n)},$$slots:{default:!0}})})),xn(Rt(u,2),h,(e=>{cc(e,{children:(e,n)=>{var r=on();Sn(Ft(r),t,"default",{},null),an(e,r)},$$slots:{default:!0}})}),(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)})),Pt(c),Pt(a),er(a,(e=>H(L,e)),(()=>dt(L))),Pt(n),ue((()=>{Rn(n,"style",C()),Rn(n,"aria-labelledby",k()),Qn(n,dt(r)),Qn(a,dt(s)),Qn(c,dt(l))})),Jn(5,n,(()=>Ua)),Jn(6,n,(()=>La)),Jt("introstart",n,(()=>o("opening"))),Jt("introend",n,G),Jt("outrostart",n,q),Jt("outroend",n,W),Jt("click",n,V),Jt("mousedown",n,K),an(e,n)})),Pt(i),ue((()=>a=Dn(i,a,{class:O(),tabindex:"-1",...r,"data-bs-theme":N()},"svelte-d87gpn"))),an(e,i)},$$slots:{default:!0}})})),an(e,n)})),xn(Rt(ee,2),(()=>b()&&!d()),(e=>{var t=on();Fn(Ft(t),(()=>dt(i)),((e,t)=>{t(e,{children:(e,t)=>{!function(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","isOpen","fade"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"isOpen",8,!1),a=_r(t,"fade",8,!0),c=Y(!1);ir((()=>{H(c,!0)})),ae((()=>bt(i())),(()=>{H(s,Ta(i(),"modal-backdrop"))})),ce(),nr();var l=on();xn(Ft(l),(()=>o()&&dt(c)),(e=>{var n=oc();let i;ue((()=>{i=Dn(n,i,{role:"presentation",...r,class:dt(s)}),Pn(n,"fade",a())})),Jn(1,n,(()=>Oa)),Jn(2,n,(()=>Fa)),Jt("click",n,(function(e){sr.call(this,t,e)})),an(e,n)})),an(e,l),_t()}(e,{get fade(){return x()},get isOpen(){return v()}})},$$slots:{default:!0}})})),an(e,t)})),an(e,Z),_t()}var gc=nn("<div><!></div>");function vc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,"");ae((()=>bt(i())),(()=>{H(s,Ta(i(),"modal-footer"))})),ce(),nr();var o=gc();let a;Sn(Ot(o),t,"default",{},null),Pt(o),ue((()=>a=Dn(o,a,{...r,class:dt(s)}))),an(e,o),_t()}nn("<ul><!></ul>");nn("<nav><!></nav>");nn("<li><!></li>");nn("<a><!></a>");nn("<a><!></a>");nn('<span class="navbar-toggler-icon"></span>'),nn("<button><!></button>");nn("<div></div>");nn("<div><!></div>");nn('<button class="btn-close" type="button"></button>'),nn('<div><h5 class="offcanvas-title"><!></h5> <!></div>');nn("<!> <!>",1),nn("<div><!> <!></div> <!>",1);nn("<nav><ul><!></ul></nav>");nn("<li><!></li>");nn('<span aria-hidden="true"><!></span> <span class="visually-hidden"> </span>',1),nn("<a><!></a>");nn('<div><div class="popover-arrow" data-popper-arrow=""></div> <h3 class="popover-header"><!></h3> <div class="popover-body"><!></div></div>');var _c=nn("<div><!></div>"),bc=nn('<div role="progressbar" aria-valuemin="0"><!></div>'),wc=nn("<div><!></div>");var xc=nn("<div><!></div>");function kc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","noGutters","form","cols","inner"]);vt(t,!1);const s=Y();let i=_r(t,"class",8,""),o=_r(t,"noGutters",8,!1),a=_r(t,"form",8,!1),c=_r(t,"cols",8,0),l=_r(t,"inner",12,void 0);ae((()=>(bt(i()),bt(o()),bt(a()),bt(c()))),(()=>{H(s,Ta(i(),o()?"gx-0":null,a()?"form-row":"row",...function(e){const t=parseInt(e);if(isNaN(t)){if("object"==typeof e)return["xs","sm","md","lg","xl"].map((t=>{const n="xs"===t?"-":`-${t}-`,r=e[t];return"number"==typeof r&&r>0?`row-cols${n}${r}`:null})).filter((e=>!!e))}else if(t>0)return[`row-cols-${t}`];return[]}(c())))})),ce(),nr();var u=xc();let f;Sn(Ot(u),t,"default",{},null),Pt(u),er(u,(e=>l(e)),(()=>l())),ue((()=>f=Dn(u,f,{...r,class:dt(s)}))),an(e,u),_t()}nn('<div><span class="visually-hidden"><!></span></div>');nn('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">'),nn('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"> <!>',1);nn("<colgroup><!></colgroup>");nn("<div><!></div>");nn("<tfoot><tr><!></tr></tfoot>");nn("<thead><tr><!></tr></thead>");nn("<tr><!></tr>"),nn("<!> <!> <tbody></tbody> <!>",1),nn("<table><!></table>");nn("<div><!> <!></div>");nn("<!> <!>",1),nn("<div><!></div>");const Ec=Ca(function(){const e=globalThis.document?.documentElement.getAttribute("data-bs-theme")||"light",t="function"==typeof globalThis.window?.matchMedia&&globalThis.window?.matchMedia("(prefers-color-scheme: dark)").matches;return"dark"===e||"auto"===e&&t?"dark":"light"}());Ec.subscribe((e=>function(e,t){let n=e;if(1===arguments.length){if(n=globalThis.document?.documentElement,!n)return;t=e,Ec.update((()=>t))}n.setAttribute("data-bs-theme",t)}(e)));nn('<span class="svelte-f2gsno"><!></span>');nn("<div><!></div>");nn('<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"><rect fill="currentColor" width="100%" height="100%"></rect></svg>'),nn("<div><!> <strong><!></strong> <!></div>");nn("<div><!> <!></div>");nn('<div><div class="tooltip-arrow" data-popper-arrow=""></div> <div class="tooltip-inner"><!></div></div>');var Cc=rn("<g><!></g>");function Bc(e,t){vt(t,!1);let n=870711;let r=Y(""),s=_r(t,"data",8);function i(e){if(!e||!e.raw)return"";let t=e.raw;const r={};return t=t.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,((e,t)=>{const s=(n+=1,`fa-${n.toString(16)}`);return r[t]=s,` id="${s}"`})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,((e,t,n,s)=>{const i=t||s;return i&&r[i]?`#${r[i]}`:e})),t}ae((()=>bt(s())),(()=>{H(r,i(s()))})),ce();var o=Cc();Tn(Ot(o),(()=>dt(r)),!0,!1),Pt(o),an(e,o),_t()}var Mc=rn("<svg><!></svg>");var Ic=rn("<path></path>"),Nc=rn("<polygon></polygon>"),Tc=rn("<!><!><!>",1);function Sc(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","data","scale","spin","inverse","pulse","flip","label","style"]);vt(t,!1);let s=_r(t,"class",8,""),i=_r(t,"data",8),o=Y(),a=_r(t,"scale",8,1),c=_r(t,"spin",8,!1),l=_r(t,"inverse",8,!1),u=_r(t,"pulse",8,!1),f=_r(t,"flip",8,void 0),d=_r(t,"label",8,""),p=_r(t,"style",8,""),h=Y(10),m=Y(10),y=Y(),A=Y();function g(){let e=1;return void 0!==a()&&(e=Number(a())),isNaN(e)||e<=0?1:1*e}function v(){return dt(o)?Math.max(dt(o).width,dt(o).height)/16:1}ae((()=>(bt(i()),bt(p()),bt(a()))),(()=>{H(o,function(e){let t,n;if(e&&!("definition"in e)){if("iconName"in e&&"icon"in e){t=e.iconName;const[r,s,,,i]=e.icon;n={width:r,height:s,paths:(Array.isArray(i)?i:[i]).map((e=>({d:e})))}}else t=Object.keys(e)[0],n=e[t];return n}}(i())),p(),a(),H(h,dt(o)?dt(o).width/v()*g():0),H(m,dt(o)?dt(o).height/v()*g():0),H(y,function(){let e="";null!==p()&&(e+=p());let t=g();return 1===t?0===e.length?"":e:(""===e||e.endsWith(";")||(e+="; "),`${e}font-size: ${t}em`)}()),H(A,dt(o)?`0 0 ${dt(o).width} ${dt(o).height}`:`0 0 ${dt(h)} ${dt(m)}`)})),ce(),nr(),function(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["class","width","height","box","spin","inverse","pulse","flip","style","label"]);let s=_r(t,"class",8,""),i=_r(t,"width",8),o=_r(t,"height",8),a=_r(t,"box",8,"0 0 0 0"),c=_r(t,"spin",8,!1),l=_r(t,"inverse",8,!1),u=_r(t,"pulse",8,!1),f=_r(t,"flip",8,"none"),d=_r(t,"style",8,""),p=_r(t,"label",8,"");var h=Mc();let m;Sn(Ot(h),t,"default",{},null),Pt(h),ue((()=>{m=Dn(h,m,{version:"1.1",class:`fa-icon ${s()??""}`,width:i(),height:o(),"aria-label":p(),role:p()?"img":"presentation",viewBox:a(),style:d(),...r},"svelte-1mc5hvj",!0),Pn(h,"fa-spin",c()),Pn(h,"fa-pulse",u()),Pn(h,"fa-inverse",l()),Pn(h,"fa-flip-horizontal","horizontal"===f()),Pn(h,"fa-flip-vertical","vertical"===f())})),an(e,h)}(e,gr({get label(){return d()},get width(){return dt(h)},get height(){return dt(m)},get box(){return dt(A)},get style(){return dt(y)},get spin(){return c()},get flip(){return f()},get inverse(){return l()},get pulse(){return u()},get class(){return s()}},(()=>r),{children:(e,n)=>{var r=on();Sn(Ft(r),t,"default",{},(e=>{var t=Tc(),n=Ft(t);Cn(n,1,(()=>dt(o)?.paths||[]),En,((e,t)=>{var n=Ic();let r;ue((()=>r=Dn(n,r,{...dt(t)},void 0,!0))),an(e,n)}));var r=Rt(n);Cn(r,1,(()=>dt(o)?.polygons||[]),En,((e,t)=>{var n=Nc();let r;ue((()=>r=Dn(n,r,{...dt(t)},void 0,!0))),an(e,n)})),xn(Rt(r),(()=>dt(o)?.raw),(e=>{Bc(e,{get data(){return dt(o)},set data(e){H(o,e)},$$legacy:!0})})),an(e,t)})),an(e,r)},$$slots:{default:!0}})),_t()}const Oc={spinner:{width:1792,height:1792,paths:[{d:"M526 1394q0 53-37.5 90.5t-90.5 37.5q-52 0-90-38t-38-90q0-53 37.5-90.5t90.5-37.5 90.5 37.5 37.5 90.5zM1024 1600q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM320 896q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM1522 1394q0 52-38 90t-90 38q-53 0-90.5-37.5t-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM558 398q0 66-47 113t-113 47-113-47-47-113 47-113 113-47 113 47 47 113zM1728 896q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zM1088 192q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zM1618 398q0 93-66 158.5t-158 65.5q-93 0-158.5-65.5t-65.5-158.5q0-92 65.5-158t158.5-66q92 0 158 66t66 158z"}]}};var Fc=nn('<div class="rounded-3 Overlay BackgroundOverlay svelte-xsphhw"></div> <div class="Overlay IconOverlay svelte-xsphhw"><!></div>',1);function Rc(e,t){vt(t,!1);Er().getLogger("atf");let n=_r(t,"duration_out",8,800);nr();var r=Fc(),s=Ft(r),i=Rt(s,2);Sc(Ot(i),{style:"display:flex;",data:Oc,spin:!0}),Pt(i),Jn(2,s,(()=>Ya),(()=>({duration:n()}))),Jn(2,i,(()=>Ya),(()=>({duration:n()}))),an(e,r),_t()}const Dc={home:{width:1664,height:1792,paths:[{d:"M1408 992v480q0 26-19 45t-45 19h-384v-384h-256v384h-384q-26 0-45-19t-19-45v-480q0-1 0.5-3t0.5-3l575-474 575 474q1 2 1 6zM1631 923l-62 74q-8 9-21 11h-3q-13 0-21-7l-692-577-692 577q-12 8-24 7-13-2-21-11l-62-74q-8-10-7-23.5t11-21.5l719-599q32-26 76-26t76 26l244 204v-195q0-14 9-23t23-9h192q14 0 23 9t9 23v408l219 182q10 8 11 21.5t-7 23.5z"}]}};function Uc(e,t){return function(){return e.apply(t,arguments)}}const{toString:Lc}=Object.prototype,{getPrototypeOf:$c}=Object,Qc=(e=>t=>{const n=Lc.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),jc=e=>(e=e.toLowerCase(),t=>Qc(t)===e),Pc=e=>t=>typeof t===e,{isArray:Yc}=Array,zc=Pc("undefined");const Vc=jc("ArrayBuffer");const Hc=Pc("string"),Gc=Pc("function"),qc=Pc("number"),Wc=e=>null!==e&&"object"==typeof e,Jc=e=>{if("object"!==Qc(e))return!1;const t=$c(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},Kc=jc("Date"),Xc=jc("File"),Zc=jc("Blob"),el=jc("FileList"),tl=jc("URLSearchParams"),[nl,rl,sl,il]=["ReadableStream","Request","Response","Headers"].map(jc);function ol(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,s;if("object"!=typeof e&&(e=[e]),Yc(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(r=0;r<i;r++)o=s[r],t.call(null,e[o],o,e)}}function al(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,s=n.length;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const cl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,ll=e=>!zc(e)&&e!==cl;const ul=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&$c(Uint8Array)),fl=jc("HTMLFormElement"),dl=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),pl=jc("RegExp"),hl=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};ol(n,((n,s)=>{let i;!1!==(i=t(n,s,e))&&(r[s]=i||n)})),Object.defineProperties(e,r)},ml="abcdefghijklmnopqrstuvwxyz",yl="0123456789",Al={DIGIT:yl,ALPHA:ml,ALPHA_DIGIT:ml+ml.toUpperCase()+yl};const gl=jc("AsyncFunction"),vl=(_l="function"==typeof setImmediate,bl=Gc(cl.postMessage),_l?setImmediate:bl?(wl=`axios@${Math.random()}`,xl=[],cl.addEventListener("message",(({source:e,data:t})=>{e===cl&&t===wl&&xl.length&&xl.shift()()}),!1),e=>{xl.push(e),cl.postMessage(wl,"*")}):e=>setTimeout(e));var _l,bl,wl,xl;const kl="undefined"!=typeof queueMicrotask?queueMicrotask.bind(cl):"undefined"!=typeof process&&process.nextTick||vl,El={isArray:Yc,isArrayBuffer:Vc,isBuffer:function(e){return null!==e&&!zc(e)&&null!==e.constructor&&!zc(e.constructor)&&Gc(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Gc(e.append)&&("formdata"===(t=Qc(e))||"object"===t&&Gc(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Vc(e.buffer),t},isString:Hc,isNumber:qc,isBoolean:e=>!0===e||!1===e,isObject:Wc,isPlainObject:Jc,isReadableStream:nl,isRequest:rl,isResponse:sl,isHeaders:il,isUndefined:zc,isDate:Kc,isFile:Xc,isBlob:Zc,isRegExp:pl,isFunction:Gc,isStream:e=>Wc(e)&&Gc(e.pipe),isURLSearchParams:tl,isTypedArray:ul,isFileList:el,forEach:ol,merge:function e(){const{caseless:t}=ll(this)&&this||{},n={},r=(r,s)=>{const i=t&&al(n,s)||s;Jc(n[i])&&Jc(r)?n[i]=e(n[i],r):Jc(r)?n[i]=e({},r):Yc(r)?n[i]=r.slice():n[i]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&ol(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(ol(t,((t,r)=>{n&&Gc(t)?e[r]=Uc(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let s,i,o;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],r&&!r(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&$c(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Qc,kindOfTest:jc,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Yc(e))return e;let t=e.length;if(!qc(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:fl,hasOwnProperty:dl,hasOwnProp:dl,reduceDescriptors:hl,freezeMethods:e=>{hl(e,((t,n)=>{if(Gc(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Gc(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return Yc(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:al,global:cl,isContextDefined:ll,ALPHABET:Al,generateString:(e=16,t=Al.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&Gc(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Wc(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const s=Yc(e)?[]:{};return ol(e,((e,t)=>{const i=n(e,r+1);!zc(i)&&(s[t]=i)})),t[r]=void 0,s}}return e};return n(e,0)},isAsyncFn:gl,isThenable:e=>e&&(Wc(e)||Gc(e))&&Gc(e.then)&&Gc(e.catch),setImmediate:vl,asap:kl};function Cl(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}El.inherits(Cl,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:El.toJSONObject(this.config),code:this.code,status:this.status}}});const Bl=Cl.prototype,Ml={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Ml[e]={value:e}})),Object.defineProperties(Cl,Ml),Object.defineProperty(Bl,"isAxiosError",{value:!0}),Cl.from=(e,t,n,r,s,i)=>{const o=Object.create(Bl);return El.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Cl.call(o,e.message,t,n,r,s),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const Il=Cl;function Nl(e){return El.isPlainObject(e)||El.isArray(e)}function Tl(e){return El.endsWith(e,"[]")?e.slice(0,-2):e}function Sl(e,t,n){return e?e.concat(t).map((function(e,t){return e=Tl(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const Ol=El.toFlatObject(El,{},null,(function(e){return/^is[A-Z]/.test(e)}));const Fl=function(e,t,n){if(!El.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=El.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!El.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,i=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&El.isSpecCompliantForm(t);if(!El.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(El.isDate(e))return e.toISOString();if(!a&&El.isBlob(e))throw new Il("Blob is not supported. Use a Buffer instead.");return El.isArrayBuffer(e)||El.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(El.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(El.isArray(e)&&function(e){return El.isArray(e)&&!e.some(Nl)}(e)||(El.isFileList(e)||El.endsWith(n,"[]"))&&(a=El.toArray(e)))return n=Tl(n),a.forEach((function(e,r){!El.isUndefined(e)&&null!==e&&t.append(!0===o?Sl([n],r,i):null===o?n:n+"[]",c(e))})),!1;return!!Nl(e)||(t.append(Sl(s,n,i),c(e)),!1)}const u=[],f=Object.assign(Ol,{defaultVisitor:l,convertValue:c,isVisitable:Nl});if(!El.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!El.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),El.forEach(n,(function(n,i){!0===(!(El.isUndefined(n)||null===n)&&s.call(t,n,El.isString(i)?i.trim():i,r,f))&&e(n,r?r.concat(i):[i])})),u.pop()}}(e),t};function Rl(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Dl(e,t){this._pairs=[],e&&Fl(e,this,t)}const Ul=Dl.prototype;Ul.append=function(e,t){this._pairs.push([e,t])},Ul.toString=function(e){const t=e?function(t){return e.call(this,t,Rl)}:Rl;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const Ll=Dl;function $l(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ql(e,t,n){if(!t)return e;const r=n&&n.encode||$l,s=n&&n.serialize;let i;if(i=s?s(t,n):El.isURLSearchParams(t)?t.toString():new Ll(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const jl=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){El.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Pl={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yl={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Ll,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},zl="undefined"!=typeof window&&"undefined"!=typeof document,Vl="object"==typeof navigator&&navigator||void 0,Hl=zl&&(!Vl||["ReactNative","NativeScript","NS"].indexOf(Vl.product)<0),Gl="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ql=zl&&window.location.href||"http://localhost",Wl={...e,...Yl};const Jl=function(e){function t(e,n,r,s){let i=e[s++];if("__proto__"===i)return!0;const o=Number.isFinite(+i),a=s>=e.length;if(i=!i&&El.isArray(r)?r.length:i,a)return El.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o;r[i]&&El.isObject(r[i])||(r[i]=[]);return t(e,n,r[i],s)&&El.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}(r[i])),!o}if(El.isFormData(e)&&El.isFunction(e.entries)){const n={};return El.forEachEntry(e,((e,r)=>{t(function(e){return El.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null};const Kl={transitional:Pl,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=El.isObject(e);s&&El.isHTMLForm(e)&&(e=new FormData(e));if(El.isFormData(e))return r?JSON.stringify(Jl(e)):e;if(El.isArrayBuffer(e)||El.isBuffer(e)||El.isStream(e)||El.isFile(e)||El.isBlob(e)||El.isReadableStream(e))return e;if(El.isArrayBufferView(e))return e.buffer;if(El.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Fl(e,new Wl.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return Wl.isNode&&El.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=El.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Fl(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),function(e,t,n){if(El.isString(e))try{return(t||JSON.parse)(e),El.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Kl.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(El.isResponse(e)||El.isReadableStream(e))return e;if(e&&El.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw Il.from(e,Il.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Wl.classes.FormData,Blob:Wl.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};El.forEach(["delete","get","head","post","put","patch"],(e=>{Kl.headers[e]={}}));const Xl=Kl,Zl=El.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eu=Symbol("internals");function tu(e){return e&&String(e).trim().toLowerCase()}function nu(e){return!1===e||null==e?e:El.isArray(e)?e.map(nu):String(e)}function ru(e,t,n,r,s){return El.isFunction(r)?r.call(this,t,n):(s&&(t=n),El.isString(t)?El.isString(r)?-1!==t.indexOf(r):El.isRegExp(r)?r.test(t):void 0:void 0)}class su{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function s(e,t,n){const s=tu(t);if(!s)throw new Error("header name must be a non-empty string");const i=El.findKey(r,s);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=nu(e))}const i=(e,t)=>El.forEach(e,((e,n)=>s(e,n,t)));if(El.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(El.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const t={};let n,r,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!n||t[n]&&Zl[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(El.isHeaders(e))for(const[t,r]of e.entries())s(r,t,n);else null!=e&&s(t,e,n);return this}get(e,t){if(e=tu(e)){const n=El.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(El.isFunction(t))return t.call(this,e,n);if(El.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=tu(e)){const n=El.findKey(this,e);return!(!n||void 0===this[n]||t&&!ru(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function s(e){if(e=tu(e)){const s=El.findKey(n,e);!s||t&&!ru(0,n[s],s,t)||(delete n[s],r=!0)}}return El.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const s=t[n];e&&!ru(0,this[s],s,e,!0)||(delete this[s],r=!0)}return r}normalize(e){const t=this,n={};return El.forEach(this,((r,s)=>{const i=El.findKey(n,s);if(i)return t[i]=nu(r),void delete t[s];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();o!==s&&delete t[s],t[o]=nu(r),n[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return El.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&El.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[eu]=this[eu]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=tu(e);t[r]||(!function(e,t){const n=El.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,s){return this[r].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[r]=!0)}return El.isArray(e)?e.forEach(r):r(e),this}}su.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),El.reduceDescriptors(su.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),El.freezeMethods(su);const iu=su;function ou(e,t){const n=this||Xl,r=t||n,s=iu.from(r.headers);let i=r.data;return El.forEach(e,(function(e){i=e.call(n,i,s.normalize(),t?t.status:void 0)})),s.normalize(),i}function au(e){return!(!e||!e.__CANCEL__)}function cu(e,t,n){Il.call(this,null==e?"canceled":e,Il.ERR_CANCELED,t,n),this.name="CanceledError"}El.inherits(cu,Il,{__CANCEL__:!0});const lu=cu;function uu(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Il("Request failed with status code "+n.status,[Il.ERR_BAD_REQUEST,Il.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const fu=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,i=0,o=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=r[o];s||(s=c),n[i]=a,r[i]=c;let u=o,f=0;for(;u!==i;)f+=n[u++],u%=e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),c-s<t)return;const d=l&&c-l;return d?Math.round(1e3*f/d):void 0}};const du=function(e,t){let n,r,s=0,i=1e3/t;const o=(t,i=Date.now())=>{s=i,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),a=t-s;a>=i?o(e,t):(n=e,r||(r=setTimeout((()=>{r=null,o(n)}),i-a)))},()=>n&&o(n)]},pu=(e,t,n=3)=>{let r=0;const s=fu(50,250);return du((n=>{const i=n.loaded,o=n.lengthComputable?n.total:void 0,a=i-r,c=s(a);r=i;e({loaded:i,total:o,progress:o?i/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&i<=o?(o-i)/c:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),n)},hu=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},mu=e=>(...t)=>El.asap((()=>e(...t))),yu=Wl.hasStandardBrowserEnv?function(){const e=Wl.navigator&&/(msie|trident)/i.test(Wl.navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){const t=El.isString(e)?r(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0},Au=Wl.hasStandardBrowserEnv?{write(e,t,n,r,s,i){const o=[e+"="+encodeURIComponent(t)];El.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),El.isString(r)&&o.push("path="+r),El.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function gu(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const vu=e=>e instanceof iu?{...e}:e;function _u(e,t){t=t||{};const n={};function r(e,t,n){return El.isPlainObject(e)&&El.isPlainObject(t)?El.merge.call({caseless:n},e,t):El.isPlainObject(t)?El.merge({},t):El.isArray(t)?t.slice():t}function s(e,t,n){return El.isUndefined(t)?El.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function i(e,t){if(!El.isUndefined(t))return r(void 0,t)}function o(e,t){return El.isUndefined(t)?El.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,s,i){return i in t?r(n,s):i in e?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t)=>s(vu(e),vu(t),!0)};return El.forEach(Object.keys(Object.assign({},e,t)),(function(r){const i=c[r]||s,o=i(e[r],t[r],r);El.isUndefined(o)&&i!==a||(n[r]=o)})),n}const bu=e=>{const t=_u({},e);let n,{data:r,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:o,headers:a,auth:c}=t;if(t.headers=a=iu.from(a),t.url=Ql(gu(t.baseURL,t.url),e.params,e.paramsSerializer),c&&a.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),El.isFormData(r))if(Wl.hasStandardBrowserEnv||Wl.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(Wl.hasStandardBrowserEnv&&(s&&El.isFunction(s)&&(s=s(t)),s||!1!==s&&yu(t.url))){const e=i&&o&&Au.read(o);e&&a.set(i,e)}return t},wu="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const r=bu(e);let s=r.data;const i=iu.from(r.headers).normalize();let o,a,c,l,u,{responseType:f,onUploadProgress:d,onDownloadProgress:p}=r;function h(){l&&l(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function y(){if(!m)return;const r=iu.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());uu((function(e){t(e),h()}),(function(e){n(e),h()}),{data:f&&"text"!==f&&"json"!==f?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(y)},m.onabort=function(){m&&(n(new Il("Request aborted",Il.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new Il("Network Error",Il.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const s=r.transitional||Pl;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new Il(t,s.clarifyTimeoutError?Il.ETIMEDOUT:Il.ECONNABORTED,e,m)),m=null},void 0===s&&i.setContentType(null),"setRequestHeader"in m&&El.forEach(i.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),El.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),f&&"json"!==f&&(m.responseType=r.responseType),p&&([c,u]=pu(p,!0),m.addEventListener("progress",c)),d&&m.upload&&([a,l]=pu(d),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(o=t=>{m&&(n(!t||t.type?new lu(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const A=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);A&&-1===Wl.protocols.indexOf(A)?n(new Il("Unsupported protocol "+A+":",Il.ERR_BAD_REQUEST,e)):m.send(s||null)}))},xu=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const s=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof Il?t:new lu(t instanceof Error?t.message:t))}};let i=t&&setTimeout((()=>{i=null,s(new Il(`timeout ${t} of ms exceeded`,Il.ETIMEDOUT))}),t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)})),e=null)};e.forEach((e=>e.addEventListener("abort",s)));const{signal:a}=r;return a.unsubscribe=()=>El.asap(o),a}},ku=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,s=0;for(;s<n;)r=s+t,yield e.slice(s,r),s=r},Eu=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Cu=(e,t,n,r)=>{const s=async function*(e,t){for await(const n of Eu(e))yield*ku(n,t)}(e,t);let i,o=0,a=e=>{i||(i=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await s.next();if(t)return a(),void e.close();let i=r.byteLength;if(n){let e=o+=i;n(e)}e.enqueue(new Uint8Array(r))}catch(e){throw a(e),e}},cancel:e=>(a(e),s.return())},{highWaterMark:2})},Bu="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Mu=Bu&&"function"==typeof ReadableStream,Iu=Bu&&("function"==typeof TextEncoder?(Nu=new TextEncoder,e=>Nu.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Nu;const Tu=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},Su=Mu&&Tu((()=>{let e=!1;const t=new Request(Wl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Ou=Mu&&Tu((()=>El.isReadableStream(new Response("").body))),Fu={stream:Ou&&(e=>e.body)};var Ru;Bu&&(Ru=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!Fu[e]&&(Fu[e]=El.isFunction(Ru[e])?t=>t[e]():(t,n)=>{throw new Il(`Response type '${e}' is not supported`,Il.ERR_NOT_SUPPORT,n)})})));const Du=async(e,t)=>{const n=El.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(El.isBlob(e))return e.size;if(El.isSpecCompliantForm(e)){const t=new Request(Wl.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return El.isArrayBufferView(e)||El.isArrayBuffer(e)?e.byteLength:(El.isURLSearchParams(e)&&(e+=""),El.isString(e)?(await Iu(e)).byteLength:void 0)})(t):n},Uu=Bu&&(async e=>{let{url:t,method:n,data:r,signal:s,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:u,withCredentials:f="same-origin",fetchOptions:d}=bu(e);l=l?(l+"").toLowerCase():"text";let p,h=xu([s,i&&i.toAbortSignal()],o);const m=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let y;try{if(c&&Su&&"get"!==n&&"head"!==n&&0!==(y=await Du(u,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(El.isFormData(r)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=hu(y,pu(mu(c)));r=Cu(n.body,65536,e,t)}}El.isString(f)||(f=f?"include":"omit");const s="credentials"in Request.prototype;p=new Request(t,{...d,signal:h,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:s?f:void 0});let i=await fetch(p);const o=Ou&&("stream"===l||"response"===l);if(Ou&&(a||o&&m)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=i[t]}));const t=El.toFiniteNumber(i.headers.get("content-length")),[n,r]=a&&hu(t,pu(mu(a),!0))||[];i=new Response(Cu(i.body,65536,n,(()=>{r&&r(),m&&m()})),e)}l=l||"text";let A=await Fu[El.findKey(Fu,l)||"text"](i,e);return!o&&m&&m(),await new Promise(((t,n)=>{uu(t,n,{data:A,headers:iu.from(i.headers),status:i.status,statusText:i.statusText,config:e,request:p})}))}catch(t){if(m&&m(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new Il("Network Error",Il.ERR_NETWORK,e,p),{cause:t.cause||t});throw Il.from(t,t&&t.code,e,p)}}),Lu={http:null,xhr:wu,fetch:Uu};El.forEach(Lu,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const $u=e=>`- ${e}`,Qu=e=>El.isFunction(e)||null===e||!1===e,ju=e=>{e=El.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let i=0;i<t;i++){let t;if(n=e[i],r=n,!Qu(n)&&(r=Lu[(t=String(n)).toLowerCase()],void 0===r))throw new Il(`Unknown adapter '${t}'`);if(r)break;s[t||"#"+i]=r}if(!r){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map($u).join("\n"):" "+$u(e[0]):"as no adapter specified";throw new Il("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function Pu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new lu(null,e)}function Yu(e){Pu(e),e.headers=iu.from(e.headers),e.data=ou.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ju(e.adapter||Xl.adapter)(e).then((function(t){return Pu(e),t.data=ou.call(e,e.transformResponse,t),t.headers=iu.from(t.headers),t}),(function(t){return au(t)||(Pu(e),t&&t.response&&(t.response.data=ou.call(e,e.transformResponse,t.response),t.response.headers=iu.from(t.response.headers))),Promise.reject(t)}))}const zu="1.7.7",Vu={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Vu[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Hu={};Vu.transitional=function(e,t,n){return(r,s,i)=>{if(!1===e)throw new Il(function(e,t){return"[Axios v1.7.7] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")),Il.ERR_DEPRECATED);return t&&!Hu[s]&&(Hu[s]=!0),!e||e(r,s,i)}};const Gu={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Il("options must be an object",Il.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=t[i];if(o){const t=e[i],n=void 0===t||o(t,i,e);if(!0!==n)throw new Il("option "+i+" must be "+n,Il.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Il("Unknown option "+i,Il.ERR_BAD_OPTION)}},validators:Vu},qu=Gu.validators;class Wu{constructor(e){this.defaults=e,this.interceptors={request:new jl,response:new jl}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=_u(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:s}=t;void 0!==n&&Gu.assertOptions(n,{silentJSONParsing:qu.transitional(qu.boolean),forcedJSONParsing:qu.transitional(qu.boolean),clarifyTimeoutError:qu.transitional(qu.boolean)},!1),null!=r&&(El.isFunction(r)?t.paramsSerializer={serialize:r}:Gu.assertOptions(r,{encode:qu.function,serialize:qu.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&El.merge(s.common,s[t.method]);s&&El.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=iu.concat(i,s);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,f=0;if(!a){const e=[Yu.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);f<u;)l=l.then(e[f++],e[f++]);return l}u=o.length;let d=t;for(f=0;f<u;){const e=o[f++],t=o[f++];try{d=e(d)}catch(e){t.call(this,e);break}}try{l=Yu.call(this,d)}catch(e){return Promise.reject(e)}for(f=0,u=c.length;f<u;)l=l.then(c[f++],c[f++]);return l}getUri(e){return Ql(gu((e=_u(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}El.forEach(["delete","get","head","options"],(function(e){Wu.prototype[e]=function(t,n){return this.request(_u(n||{},{method:e,url:t,data:(n||{}).data}))}})),El.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,s){return this.request(_u(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Wu.prototype[e]=t(),Wu.prototype[e+"Form"]=t(!0)}));const Ju=Wu;class Ku{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,s){n.reason||(n.reason=new lu(e,r,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Ku((function(t){e=t})),cancel:e}}}const Xu=Ku;const Zu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zu).forEach((([e,t])=>{Zu[t]=e}));const ef=Zu;const tf=function e(t){const n=new Ju(t),r=Uc(Ju.prototype.request,n);return El.extend(r,Ju.prototype,n,{allOwnKeys:!0}),El.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(_u(t,n))},r}(Xl);tf.Axios=Ju,tf.CanceledError=lu,tf.CancelToken=Xu,tf.isCancel=au,tf.VERSION=zu,tf.toFormData=Fl,tf.AxiosError=Il,tf.Cancel=tf.CanceledError,tf.all=function(e){return Promise.all(e)},tf.spread=function(e){return function(t){return e.apply(null,t)}},tf.isAxiosError=function(e){return El.isObject(e)&&!0===e.isAxiosError},tf.mergeConfig=_u,tf.AxiosHeaders=iu,tf.formToJSON=e=>Jl(El.isHTMLForm(e)?new FormData(e):e),tf.getAdapter=ju,tf.HttpStatusCode=ef,tf.default=tf;const nf=tf,rf=Er().getLogger("atf");nf.defaults.withCredentials=!0;let sf=window.location,of=sf.origin,af=of;["localhost","127.0.0.1"].indexOf(sf.hostname)>-1&&(af=sf.protocol+"//"+sf.hostname+":3333");var cf=async function(e,t={},n="API"){let r=af+e;"APP"==n&&(r=of+e),rf.log(`api.get(${r}, ${JSON.stringify(t)}, ${n})`);try{return{data:(await nf.get(r,t)).data}}catch(e){return rf.error(e.message),rf.log(e),{error:e.message}}},lf=async function(e,t){let n=af+e;rf.log(`api.post(${n}, ${JSON.stringify(t)}`);try{return{data:(await nf.post(n,t)).data}}catch(e){return rf.error(e.message),rf.log(e),{error:e.message}}},uf=__webpack_require__(347),ff=__webpack_require__(316),df=__webpack_require__.n(ff),pf=__webpack_require__(543),hf=__webpack_require__.n(pf);class mf extends Error{}class yf extends mf{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Af extends mf{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class gf extends mf{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class vf extends mf{}class _f extends mf{constructor(e){super(`Invalid unit ${e}`)}}class bf extends mf{}class wf extends mf{constructor(){super("Zone is an abstract class")}}const xf="numeric",kf="short",Ef="long",Cf={year:xf,month:xf,day:xf},Bf={year:xf,month:kf,day:xf},Mf={year:xf,month:kf,day:xf,weekday:kf},If={year:xf,month:Ef,day:xf},Nf={year:xf,month:Ef,day:xf,weekday:Ef},Tf={hour:xf,minute:xf},Sf={hour:xf,minute:xf,second:xf},Of={hour:xf,minute:xf,second:xf,timeZoneName:kf},Ff={hour:xf,minute:xf,second:xf,timeZoneName:Ef},Rf={hour:xf,minute:xf,hourCycle:"h23"},Df={hour:xf,minute:xf,second:xf,hourCycle:"h23"},Uf={hour:xf,minute:xf,second:xf,hourCycle:"h23",timeZoneName:kf},Lf={hour:xf,minute:xf,second:xf,hourCycle:"h23",timeZoneName:Ef},$f={year:xf,month:xf,day:xf,hour:xf,minute:xf},Qf={year:xf,month:xf,day:xf,hour:xf,minute:xf,second:xf},jf={year:xf,month:kf,day:xf,hour:xf,minute:xf},Pf={year:xf,month:kf,day:xf,hour:xf,minute:xf,second:xf},Yf={year:xf,month:kf,day:xf,weekday:kf,hour:xf,minute:xf},zf={year:xf,month:Ef,day:xf,hour:xf,minute:xf,timeZoneName:kf},Vf={year:xf,month:Ef,day:xf,hour:xf,minute:xf,second:xf,timeZoneName:kf},Hf={year:xf,month:Ef,day:xf,weekday:Ef,hour:xf,minute:xf,timeZoneName:Ef},Gf={year:xf,month:Ef,day:xf,weekday:Ef,hour:xf,minute:xf,second:xf,timeZoneName:Ef};class qf{get type(){throw new wf}get name(){throw new wf}get ianaName(){return this.name}get isUniversal(){throw new wf}offsetName(e,t){throw new wf}formatOffset(e,t){throw new wf}offset(e){throw new wf}equals(e){throw new wf}get isValid(){throw new wf}}let Wf=null;class Jf extends qf{static get instance(){return null===Wf&&(Wf=new Jf),Wf}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return hp(e,t,n)}formatOffset(e,t){return gp(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return"system"===e.type}get isValid(){return!0}}let Kf={};const Xf={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Zf={};class ed extends qf{static create(e){return Zf[e]||(Zf[e]=new ed(e)),Zf[e]}static resetCache(){Zf={},Kf={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}}constructor(e){super(),this.zoneName=e,this.valid=ed.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:n}){return hp(e,t,n,this.name)}formatOffset(e,t){return gp(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const n=(r=this.name,Kf[r]||(Kf[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),Kf[r]);var r;let[s,i,o,a,c,l,u]=n.formatToParts?function(e,t){const n=e.formatToParts(t),r=[];for(let e=0;e<n.length;e++){const{type:t,value:s}=n[e],i=Xf[t];"era"===t?r[i]=s:Gd(i)||(r[i]=parseInt(s,10))}return r}(n,t):function(e,t){const n=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,s,i,o,a,c,l,u]=r;return[o,s,i,a,c,l,u]}(n,t);"BC"===a&&(s=1-Math.abs(s));let f=+t;const d=f%1e3;return f-=d>=0?d:1e3+d,(up({year:s,month:i,day:o,hour:24===c?0:c,minute:l,second:u,millisecond:0})-f)/6e4}equals(e){return"iana"===e.type&&e.name===this.name}get isValid(){return this.valid}}let td={};let nd={};function rd(e,t={}){const n=JSON.stringify([e,t]);let r=nd[n];return r||(r=new Intl.DateTimeFormat(e,t),nd[n]=r),r}let sd={};let id={};let od=null;let ad={};function cd(e,t,n,r){const s=e.listingMode();return"error"===s?null:"en"===s?n(t):r(t)}class ld{constructor(e,t,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:r,floor:s,...i}=n;if(!t||Object.keys(i).length>0){const t={useGrouping:!1,...n};n.padTo>0&&(t.minimumIntegerDigits=n.padTo),this.inf=function(e,t={}){const n=JSON.stringify([e,t]);let r=sd[n];return r||(r=new Intl.NumberFormat(e,t),sd[n]=r),r}(e,t)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}return np(this.floor?Math.floor(e):op(e,3),this.padTo)}}class ud{constructor(e,t,n){let r;if(this.opts=n,this.originalZone=void 0,this.opts.timeZone)this.dt=e;else if("fixed"===e.zone.type){const t=e.offset/60*-1,n=t>=0?`Etc/GMT+${t}`:`Etc/GMT${t}`;0!==e.offset&&ed.create(n).valid?(r=n,this.dt=e):(r="UTC",this.dt=0===e.offset?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else"system"===e.zone.type?this.dt=e:"iana"===e.zone.type?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||r,this.dtf=rd(t,s)}format(){return this.originalZone?this.formatToParts().map((({value:e})=>e)).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map((e=>{if("timeZoneName"===e.type){const t=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...e,value:t}}return e})):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class fd{constructor(e,t,n){this.opts={style:"long",...n},!t&&Jd()&&(this.rtf=function(e,t={}){const{base:n,...r}=t,s=JSON.stringify([e,r]);let i=id[s];return i||(i=new Intl.RelativeTimeFormat(e,t),id[s]=i),i}(e,n))}format(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,n="always",r=!1){const s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},i=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===n&&i){const n="days"===e;switch(t){case 1:return n?"tomorrow":`next ${s[e][0]}`;case-1:return n?"yesterday":`last ${s[e][0]}`;case 0:return n?"today":`this ${s[e][0]}`}}const o=Object.is(t,-0)||t<0,a=Math.abs(t),c=1===a,l=s[e],u=r?c?l[1]:l[2]||l[1]:c?s[e][0]:e;return o?`${a} ${u} ago`:`in ${a} ${u}`}(t,e,this.opts.numeric,"long"!==this.opts.style)}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}const dd={firstDay:1,minimalDays:4,weekend:[6,7]};class pd{static fromOpts(e){return pd.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,n,r,s=!1){const i=e||Td.defaultLocale,o=i||(s?"en-US":od||(od=(new Intl.DateTimeFormat).resolvedOptions().locale,od)),a=t||Td.defaultNumberingSystem,c=n||Td.defaultOutputCalendar,l=ep(r)||Td.defaultWeekSettings;return new pd(o,a,c,l,i)}static resetCache(){od=null,nd={},sd={},id={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:n,weekSettings:r}={}){return pd.create(e,t,n,r)}constructor(e,t,n,r,s){const[i,o,a]=function(e){const t=e.indexOf("-x-");-1!==t&&(e=e.substring(0,t));const n=e.indexOf("-u-");if(-1===n)return[e];{let t,r;try{t=rd(e).resolvedOptions(),r=e}catch(s){const i=e.substring(0,n);t=rd(i).resolvedOptions(),r=i}const{numberingSystem:s,calendar:i}=t;return[r,s,i]}}(e);this.locale=i,this.numberingSystem=t||o||null,this.outputCalendar=n||a||null,this.weekSettings=r,this.intl=function(e,t,n){return n||t?(e.includes("-u-")||(e+="-u"),n&&(e+=`-ca-${n}`),t&&(e+=`-nu-${t}`),e):e}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=function(e){return(!e.numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)}(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e&&t?"en":"intl"}clone(e){return e&&0!==Object.getOwnPropertyNames(e).length?pd.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,ep(e.weekSettings)||this.weekSettings,e.defaultToEN||!1):this}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return cd(this,e,xp,(()=>{const n=t?{month:e,day:"numeric"}:{month:e},r=t?"format":"standalone";return this.monthsCache[r][e]||(this.monthsCache[r][e]=function(e){const t=[];for(let n=1;n<=12;n++){const r=Cm.utc(2009,n,1);t.push(e(r))}return t}((e=>this.extract(e,n,"month")))),this.monthsCache[r][e]}))}weekdays(e,t=!1){return cd(this,e,Bp,(()=>{const n=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=t?"format":"standalone";return this.weekdaysCache[r][e]||(this.weekdaysCache[r][e]=function(e){const t=[];for(let n=1;n<=7;n++){const r=Cm.utc(2016,11,13+n);t.push(e(r))}return t}((e=>this.extract(e,n,"weekday")))),this.weekdaysCache[r][e]}))}meridiems(){return cd(this,void 0,(()=>Mp),(()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Cm.utc(2016,11,13,9),Cm.utc(2016,11,13,19)].map((t=>this.extract(t,e,"dayperiod")))}return this.meridiemCache}))}eras(e){return cd(this,e,Sp,(()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[Cm.utc(-40,1,1),Cm.utc(2017,1,1)].map((e=>this.extract(e,t,"era")))),this.eraCache[e]}))}extract(e,t,n){const r=this.dtFormatter(e,t).formatToParts().find((e=>e.type.toLowerCase()===n));return r?r.value:null}numberFormatter(e={}){return new ld(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new ud(e,this.intl,t)}relFormatter(e={}){return new fd(this.intl,this.isEnglish(),e)}listFormatter(e={}){return function(e,t={}){const n=JSON.stringify([e,t]);let r=td[n];return r||(r=new Intl.ListFormat(e,t),td[n]=r),r}(this.intl,e)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Kd()?function(e){let t=ad[e];if(!t){const n=new Intl.Locale(e);t="getWeekInfo"in n?n.getWeekInfo():n.weekInfo,ad[e]=t}return t}(this.locale):dd}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let hd=null;class md extends qf{static get utcInstance(){return null===hd&&(hd=new md(0)),hd}static instance(e){return 0===e?md.utcInstance:new md(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new md(mp(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${gp(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${gp(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return gp(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return"fixed"===e.type&&e.fixed===this.fixed}get isValid(){return!0}}class yd extends qf{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ad(e,t){if(Gd(e)||null===e)return t;if(e instanceof qf)return e;if("string"==typeof e){const n=e.toLowerCase();return"default"===n?t:"local"===n||"system"===n?Jf.instance:"utc"===n||"gmt"===n?md.utcInstance:md.parseSpecifier(n)||ed.create(e)}return qd(e)?md.instance(e):"object"==typeof e&&"offset"in e&&"function"==typeof e.offset?e:new yd(e)}const gd={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},vd={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},_d=gd.hanidec.replace(/[\[|\]]/g,"").split("");let bd={};function wd({numberingSystem:e},t=""){const n=e||"latn";return bd[n]||(bd[n]={}),bd[n][t]||(bd[n][t]=new RegExp(`${gd[n]}${t}`)),bd[n][t]}let xd,kd=()=>Date.now(),Ed="system",Cd=null,Bd=null,Md=null,Id=60,Nd=null;class Td{static get now(){return kd}static set now(e){kd=e}static set defaultZone(e){Ed=e}static get defaultZone(){return Ad(Ed,Jf.instance)}static get defaultLocale(){return Cd}static set defaultLocale(e){Cd=e}static get defaultNumberingSystem(){return Bd}static set defaultNumberingSystem(e){Bd=e}static get defaultOutputCalendar(){return Md}static set defaultOutputCalendar(e){Md=e}static get defaultWeekSettings(){return Nd}static set defaultWeekSettings(e){Nd=ep(e)}static get twoDigitCutoffYear(){return Id}static set twoDigitCutoffYear(e){Id=e%100}static get throwOnInvalid(){return xd}static set throwOnInvalid(e){xd=e}static resetCaches(){pd.resetCache(),ed.resetCache(),Cm.resetCache(),bd={}}}class Sd{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Od=[0,31,59,90,120,151,181,212,243,273,304,334],Fd=[0,31,60,91,121,152,182,213,244,274,305,335];function Rd(e,t){return new Sd("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function Dd(e,t,n){const r=new Date(Date.UTC(e,t-1,n));e<100&&e>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const s=r.getUTCDay();return 0===s?7:s}function Ud(e,t,n){return n+(ap(e)?Fd:Od)[t-1]}function Ld(e,t){const n=ap(e)?Fd:Od,r=n.findIndex((e=>e<t));return{month:r+1,day:t-n[r]}}function $d(e,t){return(e-t+7)%7+1}function Qd(e,t=4,n=1){const{year:r,month:s,day:i}=e,o=Ud(r,s,i),a=$d(Dd(r,s,i),n);let c,l=Math.floor((o-a+14-t)/7);return l<1?(c=r-1,l=dp(c,t,n)):l>dp(r,t,n)?(c=r+1,l=1):c=r,{weekYear:c,weekNumber:l,weekday:a,...vp(e)}}function jd(e,t=4,n=1){const{weekYear:r,weekNumber:s,weekday:i}=e,o=$d(Dd(r,1,t),n),a=cp(r);let c,l=7*s+i-o-7+t;l<1?(c=r-1,l+=cp(c)):l>a?(c=r+1,l-=cp(r)):c=r;const{month:u,day:f}=Ld(c,l);return{year:c,month:u,day:f,...vp(e)}}function Pd(e){const{year:t,month:n,day:r}=e;return{year:t,ordinal:Ud(t,n,r),...vp(e)}}function Yd(e){const{year:t,ordinal:n}=e,{month:r,day:s}=Ld(t,n);return{year:t,month:r,day:s,...vp(e)}}function zd(e,t){if(!Gd(e.localWeekday)||!Gd(e.localWeekNumber)||!Gd(e.localWeekYear)){if(!Gd(e.weekday)||!Gd(e.weekNumber)||!Gd(e.weekYear))throw new vf("Cannot mix locale-based week fields with ISO-based week fields");return Gd(e.localWeekday)||(e.weekday=e.localWeekday),Gd(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),Gd(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}return{minDaysInFirstWeek:4,startOfWeek:1}}function Vd(e){const t=Wd(e.year),n=tp(e.month,1,12),r=tp(e.day,1,lp(e.year,e.month));return t?n?!r&&Rd("day",e.day):Rd("month",e.month):Rd("year",e.year)}function Hd(e){const{hour:t,minute:n,second:r,millisecond:s}=e,i=tp(t,0,23)||24===t&&0===n&&0===r&&0===s,o=tp(n,0,59),a=tp(r,0,59),c=tp(s,0,999);return i?o?a?!c&&Rd("millisecond",s):Rd("second",r):Rd("minute",n):Rd("hour",t)}function Gd(e){return void 0===e}function qd(e){return"number"==typeof e}function Wd(e){return"number"==typeof e&&e%1==0}function Jd(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function Kd(){try{return"undefined"!=typeof Intl&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(e){return!1}}function Xd(e,t,n){if(0!==e.length)return e.reduce(((e,r)=>{const s=[t(r),r];return e&&n(e[0],s[0])===e[0]?e:s}),null)[1]}function Zd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ep(e){if(null==e)return null;if("object"!=typeof e)throw new bf("Week settings must be an object");if(!tp(e.firstDay,1,7)||!tp(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some((e=>!tp(e,1,7))))throw new bf("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function tp(e,t,n){return Wd(e)&&e>=t&&e<=n}function np(e,t=2){let n;return n=e<0?"-"+(""+-e).padStart(t,"0"):(""+e).padStart(t,"0"),n}function rp(e){return Gd(e)||null===e||""===e?void 0:parseInt(e,10)}function sp(e){return Gd(e)||null===e||""===e?void 0:parseFloat(e)}function ip(e){if(!Gd(e)&&null!==e&&""!==e){const t=1e3*parseFloat("0."+e);return Math.floor(t)}}function op(e,t,n=!1){const r=10**t;return(n?Math.trunc:Math.round)(e*r)/r}function ap(e){return e%4==0&&(e%100!=0||e%400==0)}function cp(e){return ap(e)?366:365}function lp(e,t){const n=function(e,t){return e-t*Math.floor(e/t)}(t-1,12)+1;return 2===n?ap(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function up(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function fp(e,t,n){return-$d(Dd(e,1,t),n)+t-1}function dp(e,t=4,n=1){const r=fp(e,t,n),s=fp(e+1,t,n);return(cp(e)-r+s)/7}function pp(e){return e>99?e:e>Td.twoDigitCutoffYear?1900+e:2e3+e}function hp(e,t,n,r=null){const s=new Date(e),i={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(i.timeZone=r);const o={timeZoneName:t,...i},a=new Intl.DateTimeFormat(n,o).formatToParts(s).find((e=>"timezonename"===e.type.toLowerCase()));return a?a.value:null}function mp(e,t){let n=parseInt(e,10);Number.isNaN(n)&&(n=0);const r=parseInt(t,10)||0;return 60*n+(n<0||Object.is(n,-0)?-r:r)}function yp(e){const t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new bf(`Invalid unit value ${e}`);return t}function Ap(e,t){const n={};for(const r in e)if(Zd(e,r)){const s=e[r];if(null==s)continue;n[t(r)]=yp(s)}return n}function gp(e,t){const n=Math.trunc(Math.abs(e/60)),r=Math.trunc(Math.abs(e%60)),s=e>=0?"+":"-";switch(t){case"short":return`${s}${np(n,2)}:${np(r,2)}`;case"narrow":return`${s}${n}${r>0?`:${r}`:""}`;case"techie":return`${s}${np(n,2)}${np(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function vp(e){return function(e,t){return t.reduce(((t,n)=>(t[n]=e[n],t)),{})}(e,["hour","minute","second","millisecond"])}const _p=["January","February","March","April","May","June","July","August","September","October","November","December"],bp=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wp=["J","F","M","A","M","J","J","A","S","O","N","D"];function xp(e){switch(e){case"narrow":return[...wp];case"short":return[...bp];case"long":return[..._p];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const kp=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ep=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Cp=["M","T","W","T","F","S","S"];function Bp(e){switch(e){case"narrow":return[...Cp];case"short":return[...Ep];case"long":return[...kp];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Mp=["AM","PM"],Ip=["Before Christ","Anno Domini"],Np=["BC","AD"],Tp=["B","A"];function Sp(e){switch(e){case"narrow":return[...Tp];case"short":return[...Np];case"long":return[...Ip];default:return null}}function Op(e,t){let n="";for(const r of e)r.literal?n+=r.val:n+=t(r.val);return n}const Fp={D:Cf,DD:Bf,DDD:If,DDDD:Nf,t:Tf,tt:Sf,ttt:Of,tttt:Ff,T:Rf,TT:Df,TTT:Uf,TTTT:Lf,f:$f,ff:jf,fff:zf,ffff:Hf,F:Qf,FF:Pf,FFF:Vf,FFFF:Gf};class Rp{static create(e,t={}){return new Rp(e,t)}static parseFormat(e){let t=null,n="",r=!1;const s=[];for(let i=0;i<e.length;i++){const o=e.charAt(i);"'"===o?(n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),t=null,n="",r=!r):r||o===t?n+=o:(n.length>0&&s.push({literal:/^\s+$/.test(n),val:n}),n=o,t=o)}return n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),s}static macroTokenToFormatOpts(e){return Fp[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return np(e,t);const n={...this.opts};return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,t){const n="en"===this.loc.listingMode(),r=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,s=(t,n)=>this.loc.extract(e,t,n),i=t=>e.isOffsetFixed&&0===e.offset&&t.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,t.format):"",o=()=>n?function(e){return Mp[e.hour<12?0:1]}(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),a=(t,r)=>n?function(e,t){return xp(t)[e.month-1]}(e,t):s(r?{month:t}:{month:t,day:"numeric"},"month"),c=(t,r)=>n?function(e,t){return Bp(t)[e.weekday-1]}(e,t):s(r?{weekday:t}:{weekday:t,month:"long",day:"numeric"},"weekday"),l=t=>{const n=Rp.macroTokenToFormatOpts(t);return n?this.formatWithSystemDefault(e,n):t},u=t=>n?function(e,t){return Sp(t)[e.year<0?0:1]}(e,t):s({era:t},"era");return Op(Rp.parseFormat(t),(t=>{switch(t){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12==0?12:e.hour%12);case"hh":return this.num(e.hour%12==0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return i({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return i({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return i({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return o();case"d":return r?s({day:"numeric"},"day"):this.num(e.day);case"dd":return r?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":case"E":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return r?s({month:"numeric"},"month"):this.num(e.month);case"MM":return r?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return r?s({year:"numeric"},"year"):this.num(e.year);case"yy":return r?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return u("short");case"GG":return u("long");case"GGGGG":return u("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return l(t)}}))}formatDurationFromString(e,t){const n=e=>{switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=Rp.parseFormat(t),s=r.reduce(((e,{literal:t,val:n})=>t?e:e.concat(n)),[]);return Op(r,(e=>t=>{const r=n(t);return r?this.num(e.get(r),t.length):t})(e.shiftTo(...s.map(n).filter((e=>e)))))}}const Dp=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Up(...e){const t=e.reduce(((e,t)=>e+t.source),"");return RegExp(`^${t}$`)}function Lp(...e){return t=>e.reduce((([e,n,r],s)=>{const[i,o,a]=s(t,r);return[{...e,...i},o||n,a]}),[{},null,1]).slice(0,2)}function $p(e,...t){if(null==e)return[null,null];for(const[n,r]of t){const t=n.exec(e);if(t)return r(t)}return[null,null]}function Qp(...e){return(t,n)=>{const r={};let s;for(s=0;s<e.length;s++)r[e[s]]=rp(t[n+s]);return[r,null,n+s]}}const jp=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Pp=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Yp=RegExp(`${Pp.source}${`(?:${jp.source}?(?:\\[(${Dp.source})\\])?)?`}`),zp=RegExp(`(?:T${Yp.source})?`),Vp=Qp("weekYear","weekNumber","weekDay"),Hp=Qp("year","ordinal"),Gp=RegExp(`${Pp.source} ?(?:${jp.source}|(${Dp.source}))?`),qp=RegExp(`(?: ${Gp.source})?`);function Wp(e,t,n){const r=e[t];return Gd(r)?n:rp(r)}function Jp(e,t){return[{hours:Wp(e,t,0),minutes:Wp(e,t+1,0),seconds:Wp(e,t+2,0),milliseconds:ip(e[t+3])},null,t+4]}function Kp(e,t){const n=!e[t]&&!e[t+1],r=mp(e[t+1],e[t+2]);return[{},n?null:md.instance(r),t+3]}function Xp(e,t){return[{},e[t]?ed.create(e[t]):null,t+1]}const Zp=RegExp(`^T?${Pp.source}$`),eh=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function th(e){const[t,n,r,s,i,o,a,c,l]=e,u="-"===t[0],f=c&&"-"===c[0],d=(e,t=!1)=>void 0!==e&&(t||e&&u)?-e:e;return[{years:d(sp(n)),months:d(sp(r)),weeks:d(sp(s)),days:d(sp(i)),hours:d(sp(o)),minutes:d(sp(a)),seconds:d(sp(c),"-0"===c),milliseconds:d(ip(l),f)}]}const nh={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function rh(e,t,n,r,s,i,o){const a={year:2===t.length?pp(rp(t)):rp(t),month:bp.indexOf(n)+1,day:rp(r),hour:rp(s),minute:rp(i)};return o&&(a.second=rp(o)),e&&(a.weekday=e.length>3?kp.indexOf(e)+1:Ep.indexOf(e)+1),a}const sh=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function ih(e){const[,t,n,r,s,i,o,a,c,l,u,f]=e,d=rh(t,s,r,n,i,o,a);let p;return p=c?nh[c]:l?0:mp(u,f),[d,new md(p)]}const oh=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,ah=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ch=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function lh(e){const[,t,n,r,s,i,o,a]=e;return[rh(t,s,r,n,i,o,a),md.utcInstance]}function uh(e){const[,t,n,r,s,i,o,a]=e;return[rh(t,a,n,r,s,i,o),md.utcInstance]}const fh=Up(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,zp),dh=Up(/(\d{4})-?W(\d\d)(?:-?(\d))?/,zp),ph=Up(/(\d{4})-?(\d{3})/,zp),hh=Up(Yp),mh=Lp((function(e,t){return[{year:Wp(e,t),month:Wp(e,t+1,1),day:Wp(e,t+2,1)},null,t+3]}),Jp,Kp,Xp),yh=Lp(Vp,Jp,Kp,Xp),Ah=Lp(Hp,Jp,Kp,Xp),gh=Lp(Jp,Kp,Xp);const vh=Lp(Jp);const _h=Up(/(\d{4})-(\d\d)-(\d\d)/,qp),bh=Up(Gp),wh=Lp(Jp,Kp,Xp);const xh="Invalid Duration",kh={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},Eh={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...kh},Ch=365.2425,Bh=30.436875,Mh={years:{quarters:4,months:12,weeks:52.1775,days:Ch,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:Bh,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...kh},Ih=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Nh=Ih.slice(0).reverse();function Th(e,t,n=!1){const r={values:n?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Fh(r)}function Sh(e,t){let n=t.milliseconds??0;for(const r of Nh.slice(1))t[r]&&(n+=t[r]*e[r].milliseconds);return n}function Oh(e,t){const n=Sh(e,t)<0?-1:1;Ih.reduceRight(((r,s)=>{if(Gd(t[s]))return r;if(r){const i=t[r]*n,o=e[s][r],a=Math.floor(i/o);t[s]+=a*n,t[r]-=a*o*n}return s}),null),Ih.reduce(((n,r)=>{if(Gd(t[r]))return n;if(n){const s=t[n]%1;t[n]-=s,t[r]+=s*e[n][r]}return r}),null)}class Fh{constructor(e){const t="longterm"===e.conversionAccuracy||!1;let n=t?Mh:Eh;e.matrix&&(n=e.matrix),this.values=e.values,this.loc=e.loc||pd.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=n,this.isLuxonDuration=!0}static fromMillis(e,t){return Fh.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(null==e||"object"!=typeof e)throw new bf("Duration.fromObject: argument expected to be an object, got "+(null===e?"null":typeof e));return new Fh({values:Ap(e,Fh.normalizeUnit),loc:pd.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(qd(e))return Fh.fromMillis(e);if(Fh.isDuration(e))return e;if("object"==typeof e)return Fh.fromObject(e);throw new bf(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[n]=function(e){return $p(e,[eh,th])}(e);return n?Fh.fromObject(n,t):Fh.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[n]=function(e){return $p(e,[Zp,vh])}(e);return n?Fh.fromObject(n,t):Fh.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new bf("need to specify a reason the Duration is invalid");const n=e instanceof Sd?e:new Sd(e,t);if(Td.throwOnInvalid)throw new gf(n);return new Fh({invalid:n})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new _f(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const n={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?Rp.create(this.loc,n).formatDurationFromString(this,e):xh}toHuman(e={}){if(!this.isValid)return xh;const t=Ih.map((t=>{const n=this.values[t];return Gd(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:t.slice(0,-1)}).format(n)})).filter((e=>e));return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=op(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1};return Cm.fromMillis(t,{zone:"UTC"}).toISOTime(e)}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?Sh(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Fh.fromDurationLike(e),n={};for(const e of Ih)(Zd(t.values,e)||Zd(this.values,e))&&(n[e]=t.get(e)+this.get(e));return Th(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const t=Fh.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const n of Object.keys(this.values))t[n]=yp(e(this.values[n],n));return Th(this,{values:t},!0)}get(e){return this[Fh.normalizeUnit(e)]}set(e){if(!this.isValid)return this;return Th(this,{values:{...this.values,...Ap(e,Fh.normalizeUnit)}})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:n,matrix:r}={}){return Th(this,{loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:r,conversionAccuracy:n})}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return Oh(this.matrix,e),Th(this,{values:e},!0)}rescale(){if(!this.isValid)return this;return Th(this,{values:function(e){const t={};for(const[n,r]of Object.entries(e))0!==r&&(t[n]=r);return t}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...e){if(!this.isValid)return this;if(0===e.length)return this;e=e.map((e=>Fh.normalizeUnit(e)));const t={},n={},r=this.toObject();let s;for(const i of Ih)if(e.indexOf(i)>=0){s=i;let e=0;for(const t in n)e+=this.matrix[t][i]*n[t],n[t]=0;qd(r[i])&&(e+=r[i]);const o=Math.trunc(e);t[i]=o,n[i]=(1e3*e-1e3*o)/1e3}else qd(r[i])&&(n[i]=r[i]);for(const e in n)0!==n[e]&&(t[s]+=e===s?n[e]:n[e]/this.matrix[s][e]);return Oh(this.matrix,t),Th(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=0===this.values[t]?0:-this.values[t];return Th(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(const r of Ih)if(t=this.values[r],n=e.values[r],!(void 0===t||0===t?void 0===n||0===n:t===n))return!1;var t,n;return!0}}const Rh="Invalid Interval";class Dh{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new bf("need to specify a reason the Interval is invalid");const n=e instanceof Sd?e:new Sd(e,t);if(Td.throwOnInvalid)throw new Af(n);return new Dh({invalid:n})}static fromDateTimes(e,t){const n=Bm(e),r=Bm(t),s=function(e,t){return e&&e.isValid?t&&t.isValid?t<e?Dh.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null:Dh.invalid("missing or invalid end"):Dh.invalid("missing or invalid start")}(n,r);return null==s?new Dh({start:n,end:r}):s}static after(e,t){const n=Fh.fromDurationLike(t),r=Bm(e);return Dh.fromDateTimes(r,r.plus(n))}static before(e,t){const n=Fh.fromDurationLike(t),r=Bm(e);return Dh.fromDateTimes(r.minus(n),r)}static fromISO(e,t){const[n,r]=(e||"").split("/",2);if(n&&r){let e,s,i,o;try{e=Cm.fromISO(n,t),s=e.isValid}catch(r){s=!1}try{i=Cm.fromISO(r,t),o=i.isValid}catch(r){o=!1}if(s&&o)return Dh.fromDateTimes(e,i);if(s){const n=Fh.fromISO(r,t);if(n.isValid)return Dh.after(e,n)}else if(o){const e=Fh.fromISO(n,t);if(e.isValid)return Dh.before(i,e)}}return Dh.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;const n=this.start.startOf(e,t);let r;return r=t?.useLocaleWeeks?this.end.reconfigure({locale:n.locale}):this.end,r=r.startOf(e,t),Math.floor(r.diff(n,e).get(e))+(r.valueOf()!==this.end.valueOf())}hasSame(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return!!this.isValid&&this.s>e}isBefore(e){return!!this.isValid&&this.e<=e}contains(e){return!!this.isValid&&(this.s<=e&&this.e>e)}set({start:e,end:t}={}){return this.isValid?Dh.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(Bm).filter((e=>this.contains(e))).sort(((e,t)=>e.toMillis()-t.toMillis())),n=[];let{s:r}=this,s=0;for(;r<this.e;){const e=t[s]||this.e,i=+e>+this.e?this.e:e;n.push(Dh.fromDateTimes(r,i)),r=i,s+=1}return n}splitBy(e){const t=Fh.fromDurationLike(e);if(!this.isValid||!t.isValid||0===t.as("milliseconds"))return[];let n,{s:r}=this,s=1;const i=[];for(;r<this.e;){const e=this.start.plus(t.mapUnits((e=>e*s)));n=+e>+this.e?this.e:e,i.push(Dh.fromDateTimes(r,n)),r=n,s+=1}return i}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return!!this.isValid&&+this.e==+e.s}abutsEnd(e){return!!this.isValid&&+e.e==+this.s}engulfs(e){return!!this.isValid&&(this.s<=e.s&&this.e>=e.e)}equals(e){return!(!this.isValid||!e.isValid)&&(this.s.equals(e.s)&&this.e.equals(e.e))}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return t>=n?null:Dh.fromDateTimes(t,n)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return Dh.fromDateTimes(t,n)}static merge(e){const[t,n]=e.sort(((e,t)=>e.s-t.s)).reduce((([e,t],n)=>t?t.overlaps(n)||t.abutsStart(n)?[e,t.union(n)]:[e.concat([t]),n]:[e,n]),[[],null]);return n&&t.push(n),t}static xor(e){let t=null,n=0;const r=[],s=e.map((e=>[{time:e.s,type:"s"},{time:e.e,type:"e"}])),i=Array.prototype.concat(...s).sort(((e,t)=>e.time-t.time));for(const e of i)n+="s"===e.type?1:-1,1===n?t=e.time:(t&&+t!=+e.time&&r.push(Dh.fromDateTimes(t,e.time)),t=null);return Dh.merge(r)}difference(...e){return Dh.xor([this].concat(e)).map((e=>this.intersection(e))).filter((e=>e&&!e.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Rh}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Cf,t={}){return this.isValid?Rp.create(this.s.loc.clone(t),e).formatInterval(this):Rh}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Rh}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Rh}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Rh}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:Rh}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Fh.invalid(this.invalidReason)}mapEndpoints(e){return Dh.fromDateTimes(e(this.s),e(this.e))}}class Uh{static hasDST(e=Td.defaultZone){const t=Cm.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return ed.isValidZone(e)}static normalizeZone(e){return Ad(e,Td.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||pd.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||pd.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||pd.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||pd.create(t,n,s)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||pd.create(t,n,s)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null}={}){return(r||pd.create(t,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:n=null,locObj:r=null}={}){return(r||pd.create(t,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return pd.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return pd.create(t,null,"gregory").eras(e)}static features(){return{relative:Jd(),localeWeek:Kd()}}}function Lh(e,t){const n=e=>e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(t)-n(e);return Math.floor(Fh.fromMillis(r).as("days"))}function $h(e,t,n,r){let[s,i,o,a]=function(e,t,n){const r=[["years",(e,t)=>t.year-e.year],["quarters",(e,t)=>t.quarter-e.quarter+4*(t.year-e.year)],["months",(e,t)=>t.month-e.month+12*(t.year-e.year)],["weeks",(e,t)=>{const n=Lh(e,t);return(n-n%7)/7}],["days",Lh]],s={},i=e;let o,a;for(const[c,l]of r)n.indexOf(c)>=0&&(o=c,s[c]=l(e,t),a=i.plus(s),a>t?(s[c]--,(e=i.plus(s))>t&&(a=e,s[c]--,e=i.plus(s))):e=a);return[e,s,a,o]}(e,t,n);const c=t-s,l=n.filter((e=>["hours","minutes","seconds","milliseconds"].indexOf(e)>=0));0===l.length&&(o<t&&(o=s.plus({[a]:1})),o!==s&&(i[a]=(i[a]||0)+c/(o-s)));const u=Fh.fromObject(i,r);return l.length>0?Fh.fromMillis(c,r).shiftTo(...l).plus(u):u}function Qh(e,t=e=>e){return{regex:e,deser:([e])=>t(function(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);if(-1!==e[n].search(gd.hanidec))t+=_d.indexOf(e[n]);else for(const e in vd){const[n,s]=vd[e];r>=n&&r<=s&&(t+=r-n)}}return parseInt(t,10)}return t}(e))}}const jh=`[ ${String.fromCharCode(160)}]`,Ph=new RegExp(jh,"g");function Yh(e){return e.replace(/\./g,"\\.?").replace(Ph,jh)}function zh(e){return e.replace(/\./g,"").replace(Ph," ").toLowerCase()}function Vh(e,t){return null===e?null:{regex:RegExp(e.map(Yh).join("|")),deser:([n])=>e.findIndex((e=>zh(n)===zh(e)))+t}}function Hh(e,t){return{regex:e,deser:([,e,t])=>mp(e,t),groups:t}}function Gh(e){return{regex:e,deser:([e])=>e}}const qh={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let Wh=null;function Jh(e,t){return Array.prototype.concat(...e.map((e=>function(e,t){if(e.literal)return e;const n=Zh(Rp.macroTokenToFormatOpts(e.val),t);return null==n||n.includes(void 0)?e:n}(e,t))))}class Kh{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=Jh(Rp.parseFormat(t),e),this.units=this.tokens.map((t=>function(e,t){const n=wd(t),r=wd(t,"{2}"),s=wd(t,"{3}"),i=wd(t,"{4}"),o=wd(t,"{6}"),a=wd(t,"{1,2}"),c=wd(t,"{1,3}"),l=wd(t,"{1,6}"),u=wd(t,"{1,9}"),f=wd(t,"{2,4}"),d=wd(t,"{4,6}"),p=e=>{return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([e])=>e,literal:!0};var t},h=(h=>{if(e.literal)return p(h);switch(h.val){case"G":return Vh(t.eras("short"),0);case"GG":return Vh(t.eras("long"),0);case"y":return Qh(l);case"yy":case"kk":return Qh(f,pp);case"yyyy":case"kkkk":return Qh(i);case"yyyyy":return Qh(d);case"yyyyyy":return Qh(o);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Qh(a);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Qh(r);case"MMM":return Vh(t.months("short",!0),1);case"MMMM":return Vh(t.months("long",!0),1);case"LLL":return Vh(t.months("short",!1),1);case"LLLL":return Vh(t.months("long",!1),1);case"o":case"S":return Qh(c);case"ooo":case"SSS":return Qh(s);case"u":return Gh(u);case"uu":return Gh(a);case"uuu":case"E":case"c":return Qh(n);case"a":return Vh(t.meridiems(),0);case"EEE":return Vh(t.weekdays("short",!1),1);case"EEEE":return Vh(t.weekdays("long",!1),1);case"ccc":return Vh(t.weekdays("short",!0),1);case"cccc":return Vh(t.weekdays("long",!0),1);case"Z":case"ZZ":return Hh(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return Hh(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return Gh(/[a-z_+-/]{1,256}?/i);case" ":return Gh(/[^\S\n\r]/);default:return p(h)}})(e)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return h.token=e,h}(t,e))),this.disqualifyingUnit=this.units.find((e=>e.invalidReason)),!this.disqualifyingUnit){const[e,t]=[`^${(n=this.units).map((e=>e.regex)).reduce(((e,t)=>`${e}(${t.source})`),"")}$`,n];this.regex=RegExp(e,"i"),this.handlers=t}var n}explainFromTokens(e){if(this.isValid){const[t,n]=function(e,t,n){const r=e.match(t);if(r){const e={};let t=1;for(const s in n)if(Zd(n,s)){const i=n[s],o=i.groups?i.groups+1:1;!i.literal&&i.token&&(e[i.token.val[0]]=i.deser(r.slice(t,t+o))),t+=o}return[r,e]}return[r,{}]}(e,this.regex,this.handlers),[r,s,i]=n?function(e){let t,n=null;Gd(e.z)||(n=ed.create(e.z)),Gd(e.Z)||(n||(n=new md(e.Z)),t=e.Z),Gd(e.q)||(e.M=3*(e.q-1)+1),Gd(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),Gd(e.u)||(e.S=ip(e.u));const r=Object.keys(e).reduce(((t,n)=>{const r=(e=>{switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(n);return r&&(t[r]=e[n]),t}),{});return[r,n,t]}(n):[null,null,void 0];if(Zd(n,"a")&&Zd(n,"H"))throw new vf("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:n,result:r,zone:s,specificOffset:i}}return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function Xh(e,t,n){return new Kh(e,n).explainFromTokens(t)}function Zh(e,t){if(!e)return null;const n=Rp.create(t,e).dtFormatter((Wh||(Wh=Cm.fromMillis(1555555555555)),Wh)),r=n.formatToParts(),s=n.resolvedOptions();return r.map((t=>function(e,t,n){const{type:r,value:s}=e;if("literal"===r){const e=/^\s+$/.test(s);return{literal:!e,val:e?" ":s}}const i=t[r];let o=r;"hour"===r&&(o=null!=t.hour12?t.hour12?"hour12":"hour24":null!=t.hourCycle?"h11"===t.hourCycle||"h12"===t.hourCycle?"hour12":"hour24":n.hour12?"hour12":"hour24");let a=qh[o];if("object"==typeof a&&(a=a[i]),a)return{literal:!1,val:a}}(t,e,s)))}const em="Invalid DateTime",tm=864e13;function nm(e){return new Sd("unsupported zone",`the zone "${e.name}" is not supported`)}function rm(e){return null===e.weekData&&(e.weekData=Qd(e.c)),e.weekData}function sm(e){return null===e.localWeekData&&(e.localWeekData=Qd(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function im(e,t){const n={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new Cm({...n,...t,old:n})}function om(e,t,n){let r=e-60*t*1e3;const s=n.offset(r);if(t===s)return[r,t];r-=60*(s-t)*1e3;const i=n.offset(r);return s===i?[r,s]:[e-60*Math.min(s,i)*1e3,Math.max(s,i)]}function am(e,t){const n=new Date(e+=60*t*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function cm(e,t,n){return om(up(e),t,n)}function lm(e,t){const n=e.o,r=e.c.year+Math.trunc(t.years),s=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),i={...e.c,year:r,month:s,day:Math.min(e.c.day,lp(r,s))+Math.trunc(t.days)+7*Math.trunc(t.weeks)},o=Fh.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=up(i);let[c,l]=om(a,n,e.zone);return 0!==o&&(c+=o,l=e.zone.offset(c)),{ts:c,o:l}}function um(e,t,n,r,s,i){const{setZone:o,zone:a}=n;if(e&&0!==Object.keys(e).length||t){const r=t||a,s=Cm.fromObject(e,{...n,zone:r,specificOffset:i});return o?s:s.setZone(a)}return Cm.invalid(new Sd("unparsable",`the input "${s}" can't be parsed as ${r}`))}function fm(e,t,n=!0){return e.isValid?Rp.create(pd.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(e,t):null}function dm(e,t){const n=e.c.year>9999||e.c.year<0;let r="";return n&&e.c.year>=0&&(r+="+"),r+=np(e.c.year,n?6:4),t?(r+="-",r+=np(e.c.month),r+="-",r+=np(e.c.day)):(r+=np(e.c.month),r+=np(e.c.day)),r}function pm(e,t,n,r,s,i){let o=np(e.c.hour);return t?(o+=":",o+=np(e.c.minute),0===e.c.millisecond&&0===e.c.second&&n||(o+=":")):o+=np(e.c.minute),0===e.c.millisecond&&0===e.c.second&&n||(o+=np(e.c.second),0===e.c.millisecond&&r||(o+=".",o+=np(e.c.millisecond,3))),s&&(e.isOffsetFixed&&0===e.offset&&!i?o+="Z":e.o<0?(o+="-",o+=np(Math.trunc(-e.o/60)),o+=":",o+=np(Math.trunc(-e.o%60))):(o+="+",o+=np(Math.trunc(e.o/60)),o+=":",o+=np(Math.trunc(e.o%60)))),i&&(o+="["+e.zone.ianaName+"]"),o}const hm={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},mm={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ym={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Am=["year","month","day","hour","minute","second","millisecond"],gm=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],vm=["year","ordinal","hour","minute","second","millisecond"];function _m(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return function(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new _f(e);return t}(e)}}function bm(e,t){const n=Ad(t.zone,Td.defaultZone);if(!n.isValid)return Cm.invalid(nm(n));const r=pd.fromObject(t);let s,i;if(Gd(e.year))s=Td.now();else{for(const t of Am)Gd(e[t])&&(e[t]=hm[t]);const t=Vd(e)||Hd(e);if(t)return Cm.invalid(t);const r=function(e){return Em[e]||(void 0===km&&(km=Td.now()),Em[e]=e.offset(km)),Em[e]}(n);[s,i]=cm(e,r,n)}return new Cm({ts:s,zone:n,loc:r,o:i})}function wm(e,t,n){const r=!!Gd(n.round)||n.round,s=(e,s)=>{e=op(e,r||n.calendary?0:2,!0);return t.loc.clone(n).relFormatter(n).format(e,s)},i=r=>n.calendary?t.hasSame(e,r)?0:t.startOf(r).diff(e.startOf(r),r).get(r):t.diff(e,r).get(r);if(n.unit)return s(i(n.unit),n.unit);for(const e of n.units){const t=i(e);if(Math.abs(t)>=1)return s(t,e)}return s(e>t?-0:0,n.units[n.units.length-1])}function xm(e){let t,n={};return e.length>0&&"object"==typeof e[e.length-1]?(n=e[e.length-1],t=Array.from(e).slice(0,e.length-1)):t=Array.from(e),[n,t]}let km,Em={};class Cm{constructor(e){const t=e.zone||Td.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new Sd("invalid input"):null)||(t.isValid?null:nm(t));this.ts=Gd(e.ts)?Td.now():e.ts;let r=null,s=null;if(!n){if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[r,s]=[e.old.c,e.old.o];else{const i=qd(e.o)&&!e.old?e.o:t.offset(this.ts);r=am(this.ts,i),n=Number.isNaN(r.year)?new Sd("invalid input"):null,r=n?null:r,s=n?null:i}}this._zone=t,this.loc=e.loc||pd.create(),this.invalid=n,this.weekData=null,this.localWeekData=null,this.c=r,this.o=s,this.isLuxonDateTime=!0}static now(){return new Cm({})}static local(){const[e,t]=xm(arguments),[n,r,s,i,o,a,c]=t;return bm({year:n,month:r,day:s,hour:i,minute:o,second:a,millisecond:c},e)}static utc(){const[e,t]=xm(arguments),[n,r,s,i,o,a,c]=t;return e.zone=md.utcInstance,bm({year:n,month:r,day:s,hour:i,minute:o,second:a,millisecond:c},e)}static fromJSDate(e,t={}){const n=(r=e,"[object Date]"===Object.prototype.toString.call(r)?e.valueOf():NaN);var r;if(Number.isNaN(n))return Cm.invalid("invalid input");const s=Ad(t.zone,Td.defaultZone);return s.isValid?new Cm({ts:n,zone:s,loc:pd.fromObject(t)}):Cm.invalid(nm(s))}static fromMillis(e,t={}){if(qd(e))return e<-tm||e>tm?Cm.invalid("Timestamp out of range"):new Cm({ts:e,zone:Ad(t.zone,Td.defaultZone),loc:pd.fromObject(t)});throw new bf(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(qd(e))return new Cm({ts:1e3*e,zone:Ad(t.zone,Td.defaultZone),loc:pd.fromObject(t)});throw new bf("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const n=Ad(t.zone,Td.defaultZone);if(!n.isValid)return Cm.invalid(nm(n));const r=pd.fromObject(t),s=Ap(e,_m),{minDaysInFirstWeek:i,startOfWeek:o}=zd(s,r),a=Td.now(),c=Gd(t.specificOffset)?n.offset(a):t.specificOffset,l=!Gd(s.ordinal),u=!Gd(s.year),f=!Gd(s.month)||!Gd(s.day),d=u||f,p=s.weekYear||s.weekNumber;if((d||l)&&p)throw new vf("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&l)throw new vf("Can't mix ordinal dates with month/day");const h=p||s.weekday&&!d;let m,y,A=am(a,c);h?(m=gm,y=mm,A=Qd(A,i,o)):l?(m=vm,y=ym,A=Pd(A)):(m=Am,y=hm);let g=!1;for(const e of m){Gd(s[e])?s[e]=g?y[e]:A[e]:g=!0}const v=h?function(e,t=4,n=1){const r=Wd(e.weekYear),s=tp(e.weekNumber,1,dp(e.weekYear,t,n)),i=tp(e.weekday,1,7);return r?s?!i&&Rd("weekday",e.weekday):Rd("week",e.weekNumber):Rd("weekYear",e.weekYear)}(s,i,o):l?function(e){const t=Wd(e.year),n=tp(e.ordinal,1,cp(e.year));return t?!n&&Rd("ordinal",e.ordinal):Rd("year",e.year)}(s):Vd(s),_=v||Hd(s);if(_)return Cm.invalid(_);const b=h?jd(s,i,o):l?Yd(s):s,[w,x]=cm(b,c,n),k=new Cm({ts:w,zone:n,o:x,loc:r});return s.weekday&&d&&e.weekday!==k.weekday?Cm.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${k.toISO()}`):k.isValid?k:Cm.invalid(k.invalid)}static fromISO(e,t={}){const[n,r]=function(e){return $p(e,[fh,mh],[dh,yh],[ph,Ah],[hh,gh])}(e);return um(n,r,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[n,r]=function(e){return $p(function(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[sh,ih])}(e);return um(n,r,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[n,r]=function(e){return $p(e,[oh,lh],[ah,lh],[ch,uh])}(e);return um(n,r,t,"HTTP",t)}static fromFormat(e,t,n={}){if(Gd(e)||Gd(t))throw new bf("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:s=null}=n,i=pd.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),[o,a,c,l]=function(e,t,n){const{result:r,zone:s,specificOffset:i,invalidReason:o}=Xh(e,t,n);return[r,s,i,o]}(i,e,t);return l?Cm.invalid(l):um(o,a,n,`format ${t}`,e,c)}static fromString(e,t,n={}){return Cm.fromFormat(e,t,n)}static fromSQL(e,t={}){const[n,r]=function(e){return $p(e,[_h,mh],[bh,wh])}(e);return um(n,r,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new bf("need to specify a reason the DateTime is invalid");const n=e instanceof Sd?e:new Sd(e,t);if(Td.throwOnInvalid)throw new yf(n);return new Cm({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const n=Zh(e,pd.fromObject(t));return n?n.map((e=>e?e.val:null)).join(""):null}static expandFormat(e,t={}){return Jh(Rp.parseFormat(e),pd.fromObject(t)).map((e=>e.val)).join("")}static resetCache(){km=void 0,Em={}}get(e){return this[e]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?rm(this).weekYear:NaN}get weekNumber(){return this.isValid?rm(this).weekNumber:NaN}get weekday(){return this.isValid?rm(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?sm(this).weekday:NaN}get localWeekNumber(){return this.isValid?sm(this).weekNumber:NaN}get localWeekYear(){return this.isValid?sm(this).weekYear:NaN}get ordinal(){return this.isValid?Pd(this.c).ordinal:NaN}get monthShort(){return this.isValid?Uh.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Uh.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Uh.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Uh.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,n=up(this.c),r=this.zone.offset(n-e),s=this.zone.offset(n+e),i=this.zone.offset(n-r*t),o=this.zone.offset(n-s*t);if(i===o)return[this];const a=n-i*t,c=n-o*t,l=am(a,i),u=am(c,o);return l.hour===u.hour&&l.minute===u.minute&&l.second===u.second&&l.millisecond===u.millisecond?[im(this,{ts:a}),im(this,{ts:c})]:[this]}get isInLeapYear(){return ap(this.year)}get daysInMonth(){return lp(this.year,this.month)}get daysInYear(){return this.isValid?cp(this.year):NaN}get weeksInWeekYear(){return this.isValid?dp(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?dp(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:n,calendar:r}=Rp.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:n,outputCalendar:r}}toUTC(e=0,t={}){return this.setZone(md.instance(e),t)}toLocal(){return this.setZone(Td.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:n=!1}={}){if((e=Ad(e,Td.defaultZone)).equals(this.zone))return this;if(e.isValid){let r=this.ts;if(t||n){const t=e.offset(this.ts),n=this.toObject();[r]=cm(n,t,e)}return im(this,{ts:r,zone:e})}return Cm.invalid(nm(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:n}={}){return im(this,{loc:this.loc.clone({locale:e,numberingSystem:t,outputCalendar:n})})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=Ap(e,_m),{minDaysInFirstWeek:n,startOfWeek:r}=zd(t,this.loc),s=!Gd(t.weekYear)||!Gd(t.weekNumber)||!Gd(t.weekday),i=!Gd(t.ordinal),o=!Gd(t.year),a=!Gd(t.month)||!Gd(t.day),c=o||a,l=t.weekYear||t.weekNumber;if((c||i)&&l)throw new vf("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&i)throw new vf("Can't mix ordinal dates with month/day");let u;s?u=jd({...Qd(this.c,n,r),...t},n,r):Gd(t.ordinal)?(u={...this.toObject(),...t},Gd(t.day)&&(u.day=Math.min(lp(u.year,u.month),u.day))):u=Yd({...Pd(this.c),...t});const[f,d]=cm(u,this.o,this.zone);return im(this,{ts:f,o:d})}plus(e){if(!this.isValid)return this;return im(this,lm(this,Fh.fromDurationLike(e)))}minus(e){if(!this.isValid)return this;return im(this,lm(this,Fh.fromDurationLike(e).negate()))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;const n={},r=Fh.normalizeUnit(e);switch(r){case"years":n.month=1;case"quarters":case"months":n.day=1;case"weeks":case"days":n.hour=0;case"hours":n.minute=0;case"minutes":n.second=0;case"seconds":n.millisecond=0}if("weeks"===r)if(t){const e=this.loc.getStartOfWeek(),{weekday:t}=this;t<e&&(n.weekNumber=this.weekNumber-1),n.weekday=e}else n.weekday=1;if("quarters"===r){const e=Math.ceil(this.month/3);n.month=3*(e-1)+1}return this.set(n)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?Rp.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):em}toLocaleString(e=Cf,t={}){return this.isValid?Rp.create(this.loc.clone(t),e).formatDateTime(this):em}toLocaleParts(e={}){return this.isValid?Rp.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:n=!1,includeOffset:r=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const i="extended"===e;let o=dm(this,i);return o+="T",o+=pm(this,i,t,n,r,s),o}toISODate({format:e="extended"}={}){return this.isValid?dm(this,"extended"===e):null}toISOWeekDate(){return fm(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:n=!0,includePrefix:r=!1,extendedZone:s=!1,format:i="extended"}={}){if(!this.isValid)return null;return(r?"T":"")+pm(this,"extended"===i,t,e,n,s)}toRFC2822(){return fm(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return fm(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?dm(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:n=!0}={}){let r="HH:mm:ss.SSS";return(t||e)&&(n&&(r+=" "),t?r+="z":e&&(r+="ZZ")),fm(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():em}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",n={}){if(!this.isValid||!e.isValid)return Fh.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=(a=t,Array.isArray(a)?a:[a]).map(Fh.normalizeUnit),i=e.valueOf()>this.valueOf(),o=$h(i?this:e,i?e:this,s,r);var a;return i?o.negate():o}diffNow(e="milliseconds",t={}){return this.diff(Cm.now(),e,t)}until(e){return this.isValid?Dh.fromDateTimes(this,e):this}hasSame(e,t,n){if(!this.isValid)return!1;const r=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(t,n)<=r&&r<=s.endOf(t,n)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||Cm.fromObject({},{zone:this.zone}),n=e.padding?this<t?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(r=e.unit,s=void 0),wm(t,this.plus(n),{...e,numeric:"always",units:r,unit:s})}toRelativeCalendar(e={}){return this.isValid?wm(e.base||Cm.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Cm.isDateTime))throw new bf("min requires all arguments be DateTimes");return Xd(e,(e=>e.valueOf()),Math.min)}static max(...e){if(!e.every(Cm.isDateTime))throw new bf("max requires all arguments be DateTimes");return Xd(e,(e=>e.valueOf()),Math.max)}static fromFormatExplain(e,t,n={}){const{locale:r=null,numberingSystem:s=null}=n;return Xh(pd.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),e,t)}static fromStringExplain(e,t,n={}){return Cm.fromFormatExplain(e,t,n)}static buildFormatParser(e,t={}){const{locale:n=null,numberingSystem:r=null}=t,s=pd.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0});return new Kh(s,e)}static fromFormatParser(e,t,n={}){if(Gd(e)||Gd(t))throw new bf("fromFormatParser requires an input string and a format parser");const{locale:r=null,numberingSystem:s=null}=n,i=pd.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0});if(!i.equals(t.locale))throw new bf(`fromFormatParser called with a locale of ${i}, but the format parser was created for ${t.locale}`);const{result:o,zone:a,specificOffset:c,invalidReason:l}=t.explainFromTokens(e);return l?Cm.invalid(l):um(o,a,n,`format ${t.format}`,e,c)}static get DATE_SHORT(){return Cf}static get DATE_MED(){return Bf}static get DATE_MED_WITH_WEEKDAY(){return Mf}static get DATE_FULL(){return If}static get DATE_HUGE(){return Nf}static get TIME_SIMPLE(){return Tf}static get TIME_WITH_SECONDS(){return Sf}static get TIME_WITH_SHORT_OFFSET(){return Of}static get TIME_WITH_LONG_OFFSET(){return Ff}static get TIME_24_SIMPLE(){return Rf}static get TIME_24_WITH_SECONDS(){return Df}static get TIME_24_WITH_SHORT_OFFSET(){return Uf}static get TIME_24_WITH_LONG_OFFSET(){return Lf}static get DATETIME_SHORT(){return $f}static get DATETIME_SHORT_WITH_SECONDS(){return Qf}static get DATETIME_MED(){return jf}static get DATETIME_MED_WITH_SECONDS(){return Pf}static get DATETIME_MED_WITH_WEEKDAY(){return Yf}static get DATETIME_FULL(){return zf}static get DATETIME_FULL_WITH_SECONDS(){return Vf}static get DATETIME_HUGE(){return Hf}static get DATETIME_HUGE_WITH_SECONDS(){return Gf}}function Bm(e){if(Cm.isDateTime(e))return e;if(e&&e.valueOf&&qd(e.valueOf()))return Cm.fromJSDate(e);if(e&&"object"==typeof e)return Cm.fromObject(e);throw new bf(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const Mm=Er().getLogger("atf");function Im(e,t){if(!e){throw new Error(t?"Assertion failure: "+t:"Assertion failure")}}function Nm(){return Math.floor(1e5*Math.random())+""}function Tm(e){Mm.log("utils.getPathMenuItems()",e),Im(Array.isArray(e),`path parameter must be an Array: ${e}`);let t=[],n=[];for(let r of e){n.push(r);let e=Sm(uf.exMenu,n);t.push({id:e.id,desc:e.desc,module:Boolean(e.module),allFree:Boolean(e.allFree)})}return t}function Sm(e,t){Mm.log("utils.getMenuItemAtPath()",e,t),Im(Array.isArray(e),"menu parameter must be an Array: "+e),Im(Array.isArray(t),"path parameter must be an Array: "+t),Im(t.length>0,`path must be at least ['root']: ${t}`);let n=[...t],r=e.find((e=>e.id==n[0]));return r?1==n.length?r:Sm(r.children,n.slice(1)):null}function Om(e,t){Mm.log("utils.getRandomKeyHist()",e,t);let n=Qm(t),r=Object.keys(e);if(r.length<1)throw"Cannot select a key from an empty object";let s=hf().difference(r,n);return s.length<1?null:s[Math.floor(Math.random()*s.length)]}function Fm(e){let t=e[Math.floor(Math.random()*e.length)];return Array.isArray(t)&&(t=Fm(t)),t}function Rm(e,t){for(let n of Object.keys(t))if(t[n]==e)return!0;return!1}function Dm(e){let t={};for(let n of Object.keys(e)){let r=e[n],s=Fm(r),i=0;for(;Rm(s,t);)if(s=Fm(r),i++,i>100)throw"Could not get question";t[n]=s}return t}function Um(e,t){Mm.log("utils.getPartsObj()",e,t),Im(t.length>0,"path too short");var n=e;for(let e=1;e<t.length;e++)if(!(n=n[t[e]]))return"NO_DATA";return hf().isEmpty(n)?"NO_DATA":(Mm.log("getPartsObj ==> ",n),n)}function Lm(e,t,n){let r;if(Mm.log(`utils.getExPartInfo(${JSON.stringify(e)}, '${t}', '${n}')`),n)r=df().byType[n];else{let n=df().byPath,s=e;for(let e=1;e<s.length;e++)n=n[s[e]];r=n[t]}return r}function $m(){let e;Mm.log("utils.getHistObj()");let t=localStorage.getItem("hist");try{e=JSON.parse(t),e||(e={},localStorage.setItem("hist","{}"))}catch(t){e={},localStorage.setItem("hist","{}")}return e}function Qm(e){Mm.log("utils.getHistArr()",e);let t=e.slice(1),n=$m();return hf().get(n,t)||[]}function jm(e,t){Mm.log("utils.setHistArr()",e,t);let n=e.slice(1),r=$m();hf().setWith(r,n,t,Object),localStorage.setItem("hist",JSON.stringify(r))}function Pm(e,t){Mm.log("utils.resetHistArr()",e,t),Im(e.length>1,e);let n=Qm(e);n=hf().difference(n,t),jm(e,n)}Im.ok=Im;const Ym={assert:Im,delay:function(e){return new Promise((t=>setTimeout(t,e)))},validatePath:function e(t,n){if(Mm.log("utils.validatePath()",n),n.length>1){return Sm(t,n)?[...n]:e(t,n.slice(0,-1))}return[...n]},hasFullAccess:function(e){let t=!1;if(e.loggedIn)if(e.fullAccessUntil&&Cm.fromISO(e.fullAccessUntil).diff(Cm.utc(),"minutes").minutes>0)t=!0;else if(e.subs.length>0){Cm.fromISO(e.subs[e.subs.length-1].next_billing_time).diff(Cm.utc(),"minutes").minutes>0&&(t=!0)}return t},getPathId:function(e){let t=Tm(e),n="";for(let e=1;e<t.length;e++)n+=t[e].id;return n},getPathModuleId:function(e){Mm.log("utils.getPathModuleId()",e);let t=Tm(e),n="NONE",r="";for(let e=1;e<t.length;e++){let s=t[e];if(r+=t[e].id,s.module){n=r;break}}return n},isPathModuleAllFree:function(e){Mm.log("utils.isPathModuleAllFree()",e);let t=Tm(e),n=!1;for(let e=1;e<t.length;e++){if(t[e].allFree){n=!0;break}}return n},getMenuItemAtPath:Sm,getPathMenuItems:Tm,getNextExSpec:function(e,t,n){Mm.log("utils.getNextExSpec()",e,t,n);let r=Um(e,t);if("NO_DATA"==r)return Mm.log("partsObj",r),null;let s=Sm(uf.exMenu,t),i={};for(const[e,t]of Object.entries(r))i[e]=Object.keys(t);let o=Object.keys(i),a={parts_ex_id:{}};if(s.order)for(let e=0;e<o.length;e++){let t=o[e];if(0==e){let e=0;if(n){let r=i[t].indexOf(n.parts_ex_id[t]);r>-1&&(e=++r%i[t].length)}a.parts_ex_id[t]=i[t][e]}else if(s.link&&s.link.hasOwnProperty(t)){let e=s.link[t],o=0;if(e){let n=a.parts_ex_id[e];n&&r[t][n]&&(o=n)}else{if(n){let e=i[t].indexOf(n.parts_ex_id[t]);e>-1&&(o=++e%i[t].length)}a.parts_ex_id[t]=i[t][o]}a.parts_ex_id[t]=o}else{let e=a.parts_ex_id[o[0]];i[t].indexOf(e)>-1&&(a.parts_ex_id[t]=e)}}else{let e=new Set;for(let n=0;n<o.length;n++){let c=o[n];if(hf().isEmpty(r[c]))return null;if(0==n){let n=Om(r[c],t);n||(a.end=!0,Pm(t,Object.keys(r[c])),n=Om(r[c],t)),a.parts_ex_id[c]=n,e.add(n)}else if(s.link&&s.link.hasOwnProperty(c)){let n=s.link[c];if(n){let e=a.parts_ex_id[n];if(!e||!r[c][e])throw`Cannot link ${c} to ${n} for exercise ${e}`;a.parts_ex_id[c]=e}else{let n=Om(r[c],t);n||(a.end=!0,Pm(t,Object.keys(r[c])),n=Om(r[c],t)),a.parts_ex_id[c]=n,e.add(n)}}else{let e=a.parts_ex_id[o[0]];if(!(i[c].indexOf(e)>-1))throw`Part ${c} does not have ${e}\n              corresponding to ${o[0]}`;a.parts_ex_id[c]=e}}!function(e,t){Mm.log("utils.updateHist()",e,t);let n=Qm(e);n=n.concat(Array.from(t)),jm(e,n)}(t,e)}a.parts_qkeys={};for(let e of Object.keys(a.parts_ex_id)){let n=a.parts_ex_id[e],s=Lm(t,e,r[e][n].xi);s.qkeys&&(a.parts_qkeys[e]=Dm(s.qkeys))}a.parts_qa_idx={};for(let e of Object.keys(a.parts_qkeys)){let t=a.parts_qkeys[e],n=a.parts_ex_id[e];for(let s of Object.keys(t)){let i=r[e][n].questions[t[s]];a.parts_qa_idx[e]=a.parts_qa_idx[e]||{},a.parts_qa_idx[e][s]=Math.floor(Math.random()*i.length)}}return a},getExPartInfo:Lm,getPartsObj:Um,getHelpTransitionStyle:function(e){let t="position:absolute;right:0;top:0;overflow:hidden;";return t+=`opacity:${e?"1":"0"};`,t+=`visibility:${e?"visible":"hidden"};`,t+=`transition:all ${e?1.2:.5}s;`,t},chunkSubstr:function(e,t){const n=Math.ceil(e.length/t),r=new Array(n);for(let s=0,i=0;s<n;++s,i+=t)r[s]=e.substr(i,t);return r},getSysMsg:function(e){const t={id:Nm(),type:"danger",msg:"Error",duration:7e3,autoclose:!0,countdown:!1,dismissible:!0};return e&&"DEF"==e.duration&&(e.duration=7e3),Object.assign({},t,e)},getRandomId:Nm},zm=(Er().getLogger("atf"),Ca(Ym.validatePath(uf.exMenu,["root"]))),Vm=Ca({});const Hm=Ca({loadedFreeModules:{},loadedNonFreeModules:{},exSpec:null,partIdx:0}),Gm=Ca({initApp:!0,soundfonts:!0,data:[],login:!1}),qm=Ca({currPage:"home",currSubPage:"",enableHelp:!1,hideAppMenu:!1,choices:"",volume:50,loggedIn:!1,sysMsgs:[],email:"",subs:[],fullAccessUntil:null});var Wm=nn("<!><!>",1),Jm=nn("<!><!>",1),Km=nn("<!> <!>",1),Xm=nn("<div><!></div>");function Zm(e,t){vt(t,!1);const n=pr(),r=()=>fr(qm,"$stateX",n),s=(Er().getLogger("atf"),"secondary");function i(){dr(qm,{...r(),currPage:"exercises"}),r()}nr();var o=Xm();const a=J((()=>function(e){let t=`max-height: ${e?"0":"3rem"};`;return t+=`visibility: ${e?"hidden":"visibile"};`,t+=`opacity: ${e?"0":"1"};`,t+="transition: all 1.2s;",t}(r().hideAppMenu)));rc(Ot(o),{fluid:!0,class:"bg-light bg-gradient",children:(e,t)=>{kc(e,{class:"pb-1",children:(e,t)=>{var n=Km(),o=Ft(n);tc(o,{class:"me-auto px-0",children:(e,t)=>{var n=Wm(),o=Ft(n),a=J((()=>"home"!=r().currPage));Wa(o,{color:s,class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",get outline(){return dt(a)},$$events:{click:()=>{dr(qm,{...r(),currPage:"home"}),r()}},children:(e,t)=>{Sc(e,{data:Dc})},$$slots:{default:!0}});var c=Rt(o),l=J((()=>"exercises"!=r().currPage));Wa(c,{color:s,class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",get outline(){return dt(l)},$$events:{click:i},children:(e,t)=>{Yt(),an(e,sn("Exercises"))},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),xn(Rt(o,2),(()=>!1),(e=>{tc(e,{class:"col-auto px-0",children:(e,t)=>{var n=on();xn(Ft(n),(()=>r().loggedIn),(e=>{var t=Jm(),n=Ft(t),i=J((()=>"account"!=r().currPage));Wa(n,{color:s,class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",get outline(){return dt(i)},$$events:{click:()=>{dr(qm,{...r(),currPage:"account",currSubPage:"account"})}},children:(e,t)=>{Yt(),an(e,sn("Account"))},$$slots:{default:!0}});var o=Rt(n),a=J((()=>"logout"!=r().currPage));Wa(o,{color:s,class:"btn-sm mt-1 mx-1 rounded-3 bg-gradient",get outline(){return dt(a)},$$events:{click:()=>async function(){let e=await cf("/api/logout");if(e.error){let t=Ym.getSysMsg({type:"danger",msg:e.error});hr(qm,pt(r).sysMsgs=[t],pt(r))}else{let t=e.data;if("OK"==t.type){let e=Ym.getSysMsg({type:"success",msg:t.message,duration:"DEF",autoclose:!0});hr(qm,pt(r).sysMsgs=[e],pt(r)),hr(qm,pt(r).loggedIn=!1,pt(r)),hr(qm,pt(r).currPage="login",pt(r)),hr(qm,pt(r).currSubPage="login",pt(r)),dr(Vm,{}),dr(zm,["root"]),dr(Hm,{loadedNonFreeModules:{},loadedFreeModules:{},exSpec:null,partIdx:0})}else{let e=Ym.getSysMsg({msg:t.message});hr(qm,pt(r).sysMsgs=[e],pt(r))}}}()},children:(e,t)=>{Yt(),an(e,sn("Logout"))},$$slots:{default:!0}}),an(e,t)}),(e=>{var t=J((()=>"login"!=r().currPage));Wa(e,{color:s,class:"btn-sm mt-1 me-1 rounded-3 bg-gradient",get outline(){return dt(t)},$$events:{click:()=>{dr(qm,{...r(),currPage:"login",currSubPage:"login"})}},children:(e,t)=>{Yt(),an(e,sn("Login"))},$$slots:{default:!0}})})),an(e,n)},$$slots:{default:!0}})})),an(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),Pt(o),ue((()=>Rn(o,"style",dt(a)))),an(e,o),_t()}var ey=nn('<button type="button" class="btn-close ms-2 p-0" aria-label="Close"></button>'),ty=nn(" <!>",1),ny=nn('<div class="d-flex justify-content-center align-items-center"><!></div>');function ry(e,t){vt(t,!1);const n=pr(),r=()=>fr(qm,"$stateX",n);Er().getLogger("atf");let s=_r(t,"id",8),i=_r(t,"type",8),o=_r(t,"msg",8),a=_r(t,"duration",24,(()=>-1)),c=_r(t,"autoclose",8,!1),l=_r(t,"countdown",8,!1),u=_r(t,"dismissible",8,!0);let f,d,p=Y(Math.round(a()/1e3)),h=Y();function m(e){let t=[];for(let e of r().sysMsgs)e.id!=s()&&t.push(e);hr(qm,pt(r).sysMsgs=t,pt(r))}ir((async()=>{V(h,dt(h).style.display="initial"),(a()>-1||c())&&(d=setTimeout((()=>{m()}),a()+1e3)),l()&&(f=setInterval((function(){H(p,Math.max(dt(p)-1,-1))}),1e3))})),or((()=>{s(),clearInterval(f),clearTimeout(d)})),nr();var y=ny();!function(e,t){const n=On(t),r=yr(t,["children","$$slots","$$events","$$legacy"]),s=yr(r,["class","children","closeAriaLabel","closeClassName","color","dismissible","fade","heading","isOpen","toggle","theme","transition"]);vt(t,!1);const i=Y(),o=Y(),a=Y(),c=Y();let l=_r(t,"class",8,""),u=_r(t,"children",8,void 0),f=_r(t,"closeAriaLabel",8,"Close"),d=_r(t,"closeClassName",8,""),p=_r(t,"color",8,"success"),h=_r(t,"dismissible",8,!1),m=_r(t,"fade",8,!0),y=_r(t,"heading",8,""),A=_r(t,"isOpen",12,!0),g=_r(t,"toggle",8,void 0),v=_r(t,"theme",8,void 0),_=_r(t,"transition",24,(()=>({duration:m()?400:0})));ae((()=>(bt(h()),bt(g()))),(()=>{H(i,h()||g())})),ae((()=>bt(g())),(()=>{H(o,g()||(()=>A(!1)))})),ae((()=>(bt(l()),bt(p()),dt(i))),(()=>{H(a,Ta(l(),"alert",`alert-${p()}`,{"alert-dismissible":dt(i)}))})),ae((()=>bt(d())),(()=>{H(c,Ta("btn-close",d()))})),ce(),nr();var b=on();xn(Ft(b),A,(e=>{var r=Ha();let l;var d=Ot(r);xn(d,(()=>y()||n.heading),(e=>{var n=za(),r=Ot(n,!0);Sn(Rt(r),t,"heading",{},null),Pt(n),ue((()=>yn(r,y()))),an(e,n)}));var p=Rt(d,2);xn(p,(()=>dt(i)),(e=>{var t=Va();ue((()=>{Qn(t,dt(c)),Rn(t,"aria-label",f())})),Jt("click",t,(function(...e){dt(o)?.apply(this,e)})),an(e,t)})),xn(Rt(p,2),u,(e=>{var t=sn();ue((()=>yn(t,u()))),an(e,t)}),(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)})),Pt(r),ue((()=>l=Dn(r,l,{...s,"data-bs-theme":v(),class:dt(a),role:"alert"}))),Jn(3,r,(()=>Ya),_),an(e,r)})),an(e,b),_t()}(Ot(y),{class:"d-flex align-items-center px-2 py-1 my-1",get color(){return i()},children:(e,t)=>{Yt();var n=ty(),r=Ft(n);xn(Rt(r),u,(e=>{var t=ey();Jt("click",t,m),an(e,t)})),ue((()=>yn(r,`${o()??""} ${(l()&&dt(p)>-1?`(${dt(p)})`:"")??""} `))),an(e,n)},$$slots:{default:!0}}),Pt(y),er(y,(e=>H(h,e)),(()=>dt(h))),ue((()=>Rn(y,"id",s()))),Jn(3,y,(()=>Ya),(()=>({duration:0}))),an(e,y),_t()}var sy=nn("<div></div>");function iy(e,t){vt(t,!1);const n=pr();Er().getLogger("atf");nr();var r=sy();Rn(r,"style","position:absolute;left:50%;transform:translate(-50%, 0);z-index:100;"),Cn(r,5,(()=>fr(qm,"$stateX",n).sysMsgs),(e=>e.id),((e,t)=>{ry(e,{get id(){return dt(t).id},get type(){return dt(t).type},get msg(){return dt(t).msg},get dismissible(){return dt(t).dismissible},get duration(){return dt(t).duration},get autoclose(){return dt(t).autoclose},get countdown(){return dt(t).countdown}})})),Pt(r),an(e,r),_t()}const oy={"question-circle":{width:1536,height:1792,paths:[{d:"M896 1376v-192q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v192q0 14 9 23t23 9h192q14 0 23-9t9-23zM1152 704q0-88-55.5-163t-138.5-116-170-41q-243 0-371 213-15 24 8 42l132 100q7 6 19 6 16 0 25-12 53-68 86-92 34-24 86-24 48 0 85.5 26t37.5 59q0 38-20 61t-68 45q-63 28-115.5 86.5t-52.5 125.5v36q0 14 9 23t23 9h192q14 0 23-9t9-23q0-19 21.5-49.5t54.5-49.5q32-18 49-28.5t46-35 44.5-48 28-60.5 12.5-81zM1536 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}]}};var ay=nn("<!> <!>",1),cy=nn("<!> <!>",1);function ly(e,t){vt(t,!1);let n=_r(t,"html",8,"");let r=Y(!1);function s(){H(r,!dt(r))}var i=on();return xn(Ft(i),n,(e=>{var t=cy(),i=Ft(t);Wa(i,{color:"info",class:"btn-sm rounded-3 bg-gradient",$$events:{click:s},children:(e,t)=>{Sc(e,{style:"display:flex",data:oy})},$$slots:{default:!0}}),Ac(Rt(i,2),{get isOpen(){return dt(r)},toggle:s,children:(e,t)=>{var r=ay(),i=Ft(r);cc(i,{children:(e,t)=>{var r=on();Tn(Ft(r),n,!1,!1),an(e,r)},$$slots:{default:!0}}),vc(Rt(i,2),{children:(e,t)=>{Wa(e,{color:"secondary",$$events:{click:s},children:(e,t)=>{Yt(),an(e,sn("Close"))},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,r)},$$slots:{default:!0}}),an(e,t)})),an(e,i),Xn(t,"slot",""),_t({slot:""})}var uy=nn("<em>No Title Provided</em>"),fy=nn('<div style="position:relative;" class="col me-1 px-0"><div style="background:var(--atf-gray-400)" class="text-center ms-1 mt-1 p-1 border border-light rounded-3"><!> <div class="mt-1"><!></div></div></div>');function dy(e,t){vt(t,!1);const n=pr();Er().getLogger("atf"),Ym.assert;let r=_r(t,"help",8,"");nr(),kc(e,{class:"px-0 pb-1 align-items-center",children:(e,s)=>{var i=fy(),o=Ot(i),a=Ot(o);Sn(a,t,"default",{},(e=>{an(e,uy())}));var c=Rt(a,2);const l=J((()=>Ym.getHelpTransitionStyle(fr(qm,"$stateX",n).enableHelp)));ly(Ot(c),{get html(){return r()}}),Pt(c),Pt(o),Pt(i),ue((()=>Rn(c,"style",dt(l)))),an(e,i)},$$slots:{default:!0}}),_t()}var py=nn('<div><code><pre style="background:black;color:lime;"> </pre></code></div>');function hy(e,t){vt(t,!1);const n=pr();Er().getLogger("atf"),Ym.assert;let r=yt("app");nr();var s=py(),i=Ot(s),o=Ot(i);const a=J((()=>"production")),c=J((()=>"1")),l=J((()=>"Aural Practice")),u=J((()=>"aural.ldsys.co.uk")),f=J((()=>"admin@ldsys.co.uk")),d=J((()=>"ku.oc.sysdl@nimda")),p=J((()=>"SAME_AS_APP")),h=J((()=>"WARN")),m=J((()=>"")),y=J((()=>JSON.stringify(r,0,2)??"")),A=J((()=>JSON.stringify(fr(Gm,"$wait",n).data)??"")),g=J((()=>JSON.stringify(fr(zm,"$path",n))??"")),v=J((()=>JSON.stringify(fr(qm,"$stateX",n),0,2)??"")),_=J((()=>JSON.stringify(fr(Hm,"$ex",n),0,2)??"")),b=J((()=>JSON.stringify(fr(Vm,"$exData",n),0,2)??""));var w=Ot(o);ue((()=>yn(w,`\nprocess_env_\nNODE_ENV=${dt(a)}\nSTATIC=${dt(c)}\nAPP_NAME=${dt(l)}\nAPP_DOMAIN=${dt(u)}\nCONTACT_EMAIL=${dt(f)}\nCONTACT_EMAIL_REV=${dt(d)}\nAPI_URL=${dt(p)}\nLOG_LEVEL=${dt(h)}\nPAYPAL_CLIENT_ID=${dt(m)}\nctx=${dt(y)}\n$wait.data:${dt(A)}\n$path:${dt(g)}\n$stateX:${dt(v)}\n$ex:${dt(_)}\n$exData:${dt(b)}\n  `))),Pt(o),Pt(i),Pt(s),an(e,s),_t()}const my={question:{width:1024,height:1792,paths:[{d:"M704 1256v240q0 16-12 28t-28 12h-240q-16 0-28-12t-12-28v-240q0-16 12-28t28-12h240q16 0 28 12t12 28zM1020 656q0 54-15.5 101t-35 76.5-55 59.5-57.5 43.5-61 35.5q-41 23-68.5 65t-27.5 67q0 17-12 32.5t-28 15.5h-240q-15 0-25.5-18.5t-10.5-37.5v-45q0-83 65-156.5t143-108.5q59-27 84-56t25-76q0-42-46.5-74t-107.5-32q-65 0-108 29-35 25-107 115-13 16-31 16-12 0-25-8l-164-125q-13-10-15.5-25t5.5-28q160-266 464-266 80 0 161 31t146 83 106 127.5 41 158.5z"}]}},yy=[{type:"FULL_30",amount:2,period:"30 days",desc:"Full access for 30 days"},{type:"FULL_MONTHLY",amount:2,period:"per month",desc:"Full access",plan_id:""},{type:"FULL_DAILY",amount:2,period:"per day",desc:"Full access",plan_id:""}];const Ay={getSubByType:function(e){return yy.find((t=>t.type===e))||yy[0]},getSubTypes:function(){return yy}};var gy=nn("<p>At least one sample is provided for each grade or grade section.\n                Full access to all content is by subscription.</p>"),vy=nn('<div role="alert"><p>This website presents practice exercises designed to help you\n                prepare for Trinity* and ABRSM* aural exams.\n                Grades currently covered are Initial to 5.</p> <p>Exercises consist of players, scores, and questions/answers\n                reflecting a particular part of a syllabus.</p> <!> <p>Before continuing, please ensure that you have read and accepted\n                the Terms (see below).</p> <p>* These terms are used only to identify material designed\n                to correspond to a particular syllabus.\n                This website is not associated with, or endorsed by, any external\n                organisation.</p></div>'),_y=nn("<!> <!>",1),by=nn("<tr><td> </td><td> </td></tr>"),wy=nn('<div role="alert"><p>A subscription gives access to all content.\n              There are at least 30 examples for every part of each syllabus covered,\n              some sections having many more.\n              In some cases, there are many possible combinations of questions\n              based on the same musical material.</p> <p>Currently available subscriptions are as follows:</p> <table class="table w-50 mx-auto"><thead><tr><th>Days</th><th>£</th></tr></thead><tbody></tbody></table> <p>Subscriptions do not renew automatically, but may be renewed\n              within 7 days of expiry. Payment is via PayPal.</p> <p>If you are not happy with your subscription, please contact us\n              within 7 days.</p></div>'),xy=nn("<!> <!>",1),ky=nn("<p>A valid email address is required to register and operate an account.\n                It will not be used for any other purpose, or disclosed to any third\n                parties except as required by law.</p> <p>No identifying information is collected.\n                Subscription payment details are handled entirely by PayPal.</p>",1),Ey=nn('<div role="alert"><p><!></p> <!> <p>There is no express or implied warranty that this website is fit\n                for any purpose.</p> <div>Users:</div> <div><ul><li>Should always refer to official publications, and</li> <li>Must make their own assessment as to whether they find this\n                    website helpful, and use it entirely at their own risk.</li></ul></div> <div>All content is either:</div> <ul><li>Original material, or</li> <li>Derived from material in the Public Domain, often with\n                    substantial modification.</li></ul> <p>If you would like to use anything from this website, please contact us.</p></div>'),Cy=nn("<!> <!>",1),By=nn('<div role="alert"><p>Exercises are intended to follow the prescribed syllabuses closely,\n              however the first point of reference should always be the official\n              publications of the relevant organisation.</p> <p>To get help on the role of individual elements, and additional\n                information about the exercises, click on<!> to reveal<!> buttons. When clicked, these will display the relevant help.\n                  Disable help with<!>.</p> <p>It is recommended to work through the examples slowly and carefully,\n              say one per day, rather than clicking through them quickly.</p> <p>In many cases, for example when it is required to describe\n              characteristics of pieces, answers to questions are subjective and\n              the suggested responses are not definitive or comprehensive.\n              The answers given should be considered suggestions only.</p></div>'),My=nn("<!> <!>",1),Iy=nn('<div role="alert"><bdo dir="rtl"></bdo></div>'),Ny=nn("<!> <!>",1),Ty=nn("<!> <!> <!> <!> <!>",1),Sy=nn("<!> <!> <!>",1);function Oy(e,t){vt(t,!1);Er().getLogger("atf");const n=Ay.getSubTypes(),r="warning";let s=Y({about:!0});function i(e){let t=dt(s)[e.target.id];t?H(s,{}):(H(s,{}),V(s,dt(s)[e.target.id]=!t))}nr(),rc(e,{fluid:!0,style:"",children:(e,t)=>{var o=Sy(),a=Ft(o);dy(a,{help:"",children:(e,t)=>{Yt();var n=sn();n.nodeValue="Aural Practice",an(e,n)},$$slots:{default:!0}});var c=Rt(a,2);kc(c,{children:(e,t)=>{tc(e,{class:"p-0",children:(e,t)=>{var o=Ty(),a=Ft(o);rc(a,{fluid:!0,style:"padding-bottom:.25rem",children:(e,t)=>{var n=_y(),o=Ft(n);Wa(o,{id:"about",class:"border-light",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$events:{click:e=>i(e)},children:(e,t)=>{Yt(),an(e,sn("About"))},$$slots:{default:!0}}),ja(Rt(o,2),{class:"m-2",get isOpen(){return dt(s).about},children:(e,t)=>{Za(e,{children:(e,t)=>{var n=vy();Qn(n,`alert alert-${r} m-0`),xn(Rt(Ot(n),4),(()=>!1),(e=>{an(e,gy())})),Yt(4),Pt(n),an(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}});var c=Rt(a,2);xn(c,(()=>!1),(e=>{rc(e,{fluid:!0,style:"padding-bottom:.25rem",children:(e,t)=>{var o=xy(),a=Ft(o);Wa(a,{class:"border-light",id:"subs",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$events:{click:e=>i(e)},children:(e,t)=>{Yt(),an(e,sn("Subscriptions"))},$$slots:{default:!0}}),ja(Rt(a,2),{class:"m-2",get isOpen(){return dt(s).subs},children:(e,t)=>{Za(e,{children:(e,t)=>{var s=wy();Qn(s,`alert alert-${r} m-0`);var i=Rt(Ot(s),4),o=Rt(Ot(i));Cn(o,5,(()=>n),En,((e,t)=>{var n=by(),r=Ot(n),s=Ot(r,!0);ue((()=>yn(s,dt(t).type.split("_").slice(-1)[0]))),Pt(r);var i=Rt(r),o=Ot(i,!0);ue((()=>yn(o,dt(t).amount.toFixed(2)))),Pt(i),Pt(n),an(e,n)})),Pt(o),Pt(i),Yt(4),Pt(s),an(e,s)},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,o)},$$slots:{default:!0}})}));var l=Rt(c,2);rc(l,{fluid:!0,style:"padding-bottom:.25rem",children:(e,t)=>{var n=Cy(),o=Ft(n);Wa(o,{class:"border-light",id:"priv",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$events:{click:e=>i(e)},children:(e,t)=>{Yt(),an(e,sn("Privacy, Terms, Copyright"))},$$slots:{default:!0}}),ja(Rt(o,2),{class:"m-2",get isOpen(){return dt(s).priv},children:(e,t)=>{Za(e,{children:(e,t)=>{var n=Ey();Qn(n,`alert alert-${r} m-0`);var s=Ot(n);xn(Ot(s),(()=>!1),(e=>{an(e,sn("This site does not use cookies, except to enable account logins."))}),(e=>{an(e,sn("This website does not use cookies, and does not collect or store\n                any identifying information."))})),Pt(s),xn(Rt(s,2),(()=>!1),(e=>{var t=ky();Yt(2),an(e,t)})),Yt(12),Pt(n),an(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}});var u=Rt(l,2);rc(u,{fluid:!0,style:"padding-bottom:.25rem",children:(e,t)=>{var n=My(),o=Ft(n);Wa(o,{class:"border-light",id:"tips",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$events:{click:e=>i(e)},children:(e,t)=>{Yt(),an(e,sn("Useage Tips"))},$$slots:{default:!0}}),ja(Rt(o,2),{class:"m-2",get isOpen(){return dt(s).tips},children:(e,t)=>{Za(e,{children:(e,t)=>{var n=By();Qn(n,`alert alert-${r} m-0`);var s=Rt(Ot(n),2),i=Rt(Ot(s));Wa(i,{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"info",children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:my})},$$slots:{default:!0}});var o=Rt(i,2);Wa(o,{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"info",children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:oy})},$$slots:{default:!0}}),Wa(Rt(o,2),{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"primary",children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:my})},$$slots:{default:!0}}),Yt(),Pt(s),Yt(4),Pt(n),an(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),rc(Rt(u,2),{fluid:!0,style:"padding-bottom:.25rem",children:(e,t)=>{var n=Ny(),o=Ft(n);Wa(o,{class:"border-light",id:"contact",style:"width:100%;background:var(--atf-gray-400);color:var(--bs-body-color);",$$events:{click:e=>i(e)},children:(e,t)=>{Yt(),an(e,sn("Contact"))},$$slots:{default:!0}}),ja(Rt(o,2),{class:"m-2",get isOpen(){return dt(s).contact},children:(e,t)=>{Za(e,{children:(e,t)=>{var n=Iy();Qn(n,`alert alert-${r} m-0`);var s=Ot(n);s.textContent="ku.oc.sysdl@nimda",Pt(n),ue((()=>s.dir=s.dir)),an(e,n)},$$slots:{default:!0}})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),an(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),xn(Rt(c,2),(()=>!1),(e=>{hy(e,{})})),an(e,o)},$$slots:{default:!0}}),_t()}var Fy=nn("<em>No Body</em>");var Ry=nn('<div class="pb-1"><!></div>'),Dy=nn('<div role="button" tabindex="0" style="cursor:pointer"><!></div>'),Uy=nn('<div class="pb-1"><!> <!></div>'),Ly=nn('<div style="position:relative;" class="col me-1 px-0"><div style="background:var(--atf-gray-200)" class="text-center ms-1 mt-0 px-1 pt-1 border border-light rounded-3"><!> <div><!></div></div></div>');function $y(e,t){const n=On(t);vt(t,!1);const r=pr(),s=(Er().getLogger("atf"),{I:{label:"Information",btnColor:"info",delayShow:0,delayHide:0},Q:{label:"Question",btnColor:"primary",delayShow:1200,delayHide:300},A:{label:"Answer",btnColor:"success",delayShow:400,delayHide:300},S:{label:"Score",btnColor:"dark",delayShow:0,delayHide:0},P:{label:"Player",btnColor:"secondary",delayShow:0,delayHide:0},K:{label:"Keyboard",btnColor:"dark",delayShow:0,delayHide:0}});let i=yt("app"),o=_r(t,"id",8),a=_r(t,"showsElems",24,(()=>[])),c=_r(t,"isHidden",8,!1),l=o()[0].toUpperCase(),u=Y(o()[0]==l),f=i.showElemFunctions;function d(e,t){H(u,e),t&&function(e){for(let t=0;t<a().length;(t+=1)-1){let n=a()[t];f[n](e,!0)}}(e)}ir((()=>{o(),f[o().substr(0,2).toUpperCase()]=d})),nr();var p=J((()=>`mx-0 px-0 pb-0 align-items-center ${(c()?"d-none":"")??""}`));kc(e,{get class(){return dt(p)},children:(e,i)=>{var a=Ly(),c=Ot(a),f=Ot(c);xn(f,(()=>!dt(u)),(e=>{var t=Ry();Wa(Ot(t),{outline:!0,get color(){return s[l].btnColor},size:"sm",$$events:{click:()=>"P"!=o()[0].toUpperCase()?d(!0,!0):d(!0,!1)},children:(e,t)=>{Yt();var n=sn();ue((()=>yn(n,`Show ${s[l].label??""}`))),an(e,n)},$$slots:{default:!0}}),Pt(t),Jn(1,t,(()=>Ya),(()=>({duration:s[l].delayHide}))),an(e,t)}),(e=>{var r=Uy(),i=Ot(r);xn(i,(()=>n.content_info),(e=>{kc(e,{class:"m-0 p-0",children:(e,n)=>{tc(e,{class:"px-0",children:(e,n)=>{var r=on();Sn(Ft(r),t,"content_info",{},null),an(e,r)},$$slots:{default:!0}})},$$slots:{default:!0}})})),kc(Rt(i,2),{class:"m-0 p-0",children:(e,n)=>{tc(e,{class:"px-0",children:(e,n)=>{var r=on();xn(Ft(r),(()=>o()[0]!=l),(e=>{var n=Dy();Sn(Ot(n),t,"content",{},null),Pt(n),Jt("click",n,(()=>d(!1,!1))),Jt("keypress",n,(()=>{d(!1,!1)})),an(e,n)}),(e=>{var n=on();Sn(Ft(n),t,"content",{},null),an(e,n)})),an(e,r)},$$slots:{default:!0}})},$$slots:{default:!0}}),Pt(r),Jn(1,r,(()=>Ya),(()=>({duration:s[l].delayShow}))),an(e,r)}));var p=Rt(f,2);const h=J((()=>Ym.getHelpTransitionStyle(fr(qm,"$stateX",r).enableHelp)));Sn(Ot(p),t,"info",{},null),Pt(p),Pt(c),Pt(a),ue((()=>Rn(p,"style",dt(h)))),an(e,a)},$$slots:{default:!0}}),_t()}const Qy={bars:{width:1536,height:1792,paths:[{d:"M1536 1344v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zM1536 832v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45zM1536 320v128q0 26-19 45t-45 19h-1408q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1408q26 0 45 19t19 45z"}]}},jy={"window-maximize":{width:1792,height:1792,paths:[{d:"M256 1408h1280v-768h-1280v768zM1792 288v1216q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-1216q0-66 47-113t113-47h1472q66 0 113 47t47 113z"}]}},Py={"window-minimize":{width:1792,height:1792,paths:[{d:"M1792 1312v192q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-192q0-66 47-113t113-47h1472q66 0 113 47t47 113z"}]}};var Yy=nn("<!><!><!>",1),zy=nn("<!><!>",1),Vy=nn("<!> <!>",1),Hy=nn("<!> <!>",1);function Gy(e,t){vt(t,!1);const n=pr(),r=()=>fr(zm,"$path",n),s=()=>fr(Hm,"$ex",n),i=()=>fr(qm,"$stateX",n),o=()=>fr(Vm,"$exData",n),a=()=>fr(Gm,"$wait",n),c=Y(),l=Er().getLogger("atf"),u=Ym.assert;function f(e,t=!0){let n=!1;if("NONE"!=e){let c=Ym.hasFullAccess(i()),l=Ym.getMenuItemAtPath(uf.exMenu,r()),f=Promise.resolve();s().loadedFreeModules[e]||(f=function(e){return cf(`/data/${e}.json`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}},"APP").then((t=>{if(t.error){let e=`${t.error}. Could not load data.`,n=Ym.getSysMsg({msg:e});hr(qm,pt(i).sysMsgs=[...i().sysMsgs,n],pt(i))}else{let n=Tr.cloneRot(t.data);dr(Vm,hf().merge(o(),n)),hr(Hm,pt(s).loadedFreeModules[e]=!0,pt(s))}}))}(e),n=!0);let d=Promise.resolve();s().loadedNonFreeModules[e]||!c||l.allFree||(d=function(e){return lf("/api/get_module",{id:e}).then((t=>{if(t.error){let e=`${t.error}. Could not load data.`,n=Ym.getSysMsg({msg:e});hr(qm,pt(i).sysMsgs=[...i().sysMsgs,n],pt(i))}else if("ERR"==t.data.type)if("NLI"==t.data.subtype)hr(qm,pt(i).loggedIn=!1,pt(i)),dr(Vm,{}),dr(Hm,{loadedNonFreeModules:{},loadedFreeModules:{},exSpec:null,partIdx:0});else{let e=Ym.getSysMsg({msg:t.data.message});hr(qm,pt(i).sysMsgs=[...i().sysMsgs,e],pt(i))}else{t.data;let n=Tr.cloneRot(t.data.data);dr(Vm,hf().merge(o(),n)),hr(Hm,pt(s).loadedNonFreeModules[e]=!0,pt(s))}}))}(e),n=!0),n&&hr(Gm,pt(a).data=[...a().data,!0],pt(a)),Promise.allSettled([f,d]).then((e=>{"ExContent"==l.cmpt&&t&&function(){let e=Ym.getMenuItemAtPath(uf.exMenu,r());u("ExContent"==e.cmpt),hr(Hm,pt(s).exSpec=Ym.getNextExSpec(o(),r(),s().exSpec),pt(s)),s().exSpec,hr(Hm,pt(s).partIdx=0,pt(s)),s().partIdx}(),n&&hr(Gm,pt(a).data=a().data.slice(0,-1),pt(a)),a().data}))}else l.warn(` ExMenu No module at path ${e}`)}ir((()=>{dt(c),r(),s().exSpec;let e=Ym.getPathModuleId(r());"NONE"!=e&&f(e,null==s().exSpec)})),ae((()=>(uf.exMenu,r())),(()=>{H(c,Ym.getMenuItemAtPath(uf.exMenu,r()))})),ce(),nr(),rc(e,{fluid:!0,style:"background:var(--atf-gray-500);position:relative",children:(e,t)=>{var n=Hy(),o=Ft(n);xn(o,(()=>a().data.length>0),(e=>{Rc(e,{duration_out:200})})),kc(Rt(o,2),{class:"px-0 pb-1",children:(e,t)=>{var n=Vy(),o=Ft(n);tc(o,{class:"me-auto px-0",children:(e,t)=>{var n=Yy(),i=Ft(n);Cn(i,1,(()=>Ym.getPathMenuItems(r())),En,((e,t,n)=>{var i=J((()=>n<r().length-1?"success":"warning")),o=J((()=>n==r().length-1)),c=W((()=>n==r().length-1?null:e=>function(e){if(a().data.length>0)return;r();let t=r().findIndex((t=>t==e));hr(Hm,pt(s).exSpec=null,pt(s)),dr(zm,r().slice(0,t+1)),r();let n=Ym.getPathModuleId(r());"NONE"!=n&&f(n,!1)}(dt(t).id)));Wa(e,{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",get color(){return dt(i)},get active(){return dt(o)},$$events:{click(...e){dt(c)?.apply(this,e)}},children:(e,r)=>{var s=on();xn(Ft(s),(()=>0==n),(e=>{Sc(e,{style:"position:relative;top:-1px",data:Qy})}),(e=>{var n=on();Tn(Ft(n),(()=>dt(t).desc||dt(t).id),!1,!1),an(e,n)})),an(e,s)},$$slots:{default:!0}})}));var o=Rt(i);xn(o,(()=>"ExContent"!=dt(c).cmpt),(e=>{var t=on();Cn(Ft(t),1,(()=>dt(c).children),En,((e,t)=>{Wa(e,{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",color:"primary",$$events:{click:e=>function(e){if(a().data.length>0)return;dr(zm,Ym.validatePath(uf.exMenu,[...r(),e.id]));let t=Ym.getPathModuleId(r());"NONE"!=t&&f(t,!0)}(dt(t))},children:(e,n)=>{var r=on();Tn(Ft(r),(()=>dt(t).desc||dt(t).id),!1,!1),an(e,r)},$$slots:{default:!0}})})),an(e,t)})),xn(Rt(o),(()=>"ExContent"==dt(c).cmpt),(e=>{})),an(e,n)},$$slots:{default:!0}}),tc(Rt(o,2),{class:"col-auto px-0",children:(e,t)=>{var n=zy(),r=Ft(n);xn(r,(()=>"ExContent"==dt(c).cmpt),(e=>{var t=J((()=>i().enableHelp?"primary":"info"));Wa(e,{class:"btn-sm mt-1 ms-1 rounded-3 bg-gradient",get color(){return dt(t)},$$events:{click:e=>{hr(qm,pt(i).enableHelp=!i().enableHelp,pt(i))}},children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:my})},$$slots:{default:!0}})})),Wa(Rt(r),{class:"btn-sm mt-1 mx-1 rounded-3 bg-gradient",color:"secondary",$$events:{click:()=>{hr(qm,pt(i).hideAppMenu=!i().hideAppMenu,pt(i))}},children:(e,t)=>{var n=J((()=>i().hideAppMenu?Py:jy));Sc(e,{style:"position:relative;top:-1px",get data(){return dt(n)}})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}}),_t()}var qy=nn('<div class="card m-0"><div role="alert"><!></div></div>');function Wy(e,t){vt(t,!1);Er().getLogger("atf");let n=_r(t,"html",8),r=_r(t,"color",8,"");nr();var s=qy(),i=Ot(s);Tn(Ot(i),n,!1,!1),Pt(i),Pt(s),ue((()=>Qn(i,`alert alert-${r()??""} m-0`))),an(e,s),_t()}var Jy=nn("<div><div><!></div></div>");function Ky(e,t){vt(t,!1);Er().getLogger("atf");const n={Q:"alert-primary",A:"alert-success",I:"alert-info"};let r=_r(t,"html",8),s=_r(t,"elId0",8,"");nr();var i=Jy(),o=Ot(i);return Tn(Ot(o),r,!1,!1),Pt(o),Pt(i),ue((()=>{Qn(i,`card m-0 ${("P"==s()?"mb-1":"")??""}`),Qn(o,`alert ${(n[s()]||"alert-info")??0} m-0`)})),an(e,i),Xn(t,"slot",""),_t({slot:""})}var Xy=__webpack_require__(937),Zy=nn("<div><!></div>");function eA(e,t){vt(t,!1);const n=Y(),r=Er().getLogger("atf");let s=_r(t,"abc",8);ae((()=>bt(s())),(()=>{H(n,function(e){let t="",n={errmsg:e=>r.log(e),img_out:e=>t+=e,page_format:!0,imagesize:'width="100%"'};return new Xy.l(n).tosvg("abc2svg",e),t}(s()))})),ce(),nr();var i=Zy();Tn(Ot(i),(()=>dt(n)),!1,!1),Pt(i),an(e,i),_t()}const tA={play:{width:1408,height:1792,paths:[{d:"M1384 927l-1328 738q-23 13-39.5 3t-16.5-36v-1472q0-26 16.5-36t39.5 3l1328 738q23 13 23 31t-23 31z"}]}},nA={"play-circle-o":{width:1536,height:1792,paths:[{d:"M1184 896q0 37-32 55l-544 320q-15 9-32 9-16 0-32-8-32-19-32-56v-640q0-37 32-56 33-18 64 1l544 320q32 18 32 55zM1312 896q0-148-73-273t-198-198-273-73-273 73-198 198-73 273 73 273 198 198 273 73 273-73 198-198 73-273zM1536 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}]}},rA={pause:{width:1536,height:1792,paths:[{d:"M1536 192v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45zM640 192v1408q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h512q26 0 45 19t19 45z"}]}},sA={"fast-backward":{width:1792,height:1792,paths:[{d:"M1747 141q19-19 32-13t13 32v1472q0 26-13 32t-32-13l-710-710q-9-9-13-19v710q0 26-13 32t-32-13l-710-710q-9-9-13-19v678q0 26-19 45t-45 19h-128q-26 0-45-19t-19-45v-1408q0-26 19-45t45-19h128q26 0 45 19t19 45v678q4-10 13-19l710-710q19-19 32-13t13 32v710q4-10 13-19z"}]}},iA={"volume-down":{width:1152,height:1792,paths:[{d:"M768 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45zM1152 896q0 76-42.5 141.5t-112.5 93.5q-10 5-25 5-26 0-45-18.5t-19-45.5q0-21 12-35.5t29-25 34-23 29-36 12-56.5-12-56.5-29-36-34-23-29-25-12-35.5q0-27 19-45.5t45-18.5q15 0 25 5 70 27 112.5 93t42.5 142z"}]}},oA={"volume-up":{width:1664,height:1792,paths:[{d:"M768 352v1088q0 26-19 45t-45 19-45-19l-333-333h-262q-26 0-45-19t-19-45v-384q0-26 19-45t45-19h262l333-333q19-19 45-19t45 19 19 45zM1152 896q0 76-42.5 141.5t-112.5 93.5q-10 5-25 5-26 0-45-18.5t-19-45.5q0-21 12-35.5t29-25 34-23 29-36 12-56.5-12-56.5-29-36-34-23-29-25-12-35.5q0-27 19-45.5t45-18.5q15 0 25 5 70 27 112.5 93t42.5 142zM1408 896q0 153-85 282.5t-225 188.5q-13 5-25 5-27 0-46-19t-19-45q0-39 39-59 56-29 76-44 74-54 115.5-135.5t41.5-173.5-41.5-173.5-115.5-135.5q-20-15-76-44-39-20-39-59 0-26 19-45t45-19q13 0 26 5 140 59 225 188.5t85 282.5zM1664 896q0 230-127 422.5t-338 283.5q-13 5-26 5-26 0-45-19t-19-45q0-36 39-59 7-4 22.5-10.5t22.5-10.5q46-25 82-51 123-91 192-227t69-289-69-289-192-227q-36-26-82-51-7-4-22.5-10.5t-22.5-10.5q-39-23-39-59 0-26 19-45t45-19q13 0 26 5 211 91 338 283.5t127 422.5z"}]}};var aA=nn("<!> <!>",1),cA=nn('<!> <div style="width:1rem;padding:0 0.3rem" class="svelte-1qpuo59"><div></div> <div></div></div> <!>',1),lA=nn('<div style="display:flex;justify-content:center;" class="svelte-1qpuo59"><div class="pb-1 rounded-3 bg-gradient svelte-1qpuo59" style="display:flex;\n      max-width:40rem;\n      flex-grow:1;\n      justify-content:center;\n      align-items:center;\n      flex-wrap:wrap;\n      position:relative;\n      background:var(--atf-gray-600)"><!> <div class="px-1 svelte-1qpuo59" style="flex-grow:1;min-width:6rem;"><!></div> <!> <!></div></div>');function uA(e,t){vt(t,!0);const n=pr(),r=()=>fr(qm,"$stateX",n);Er().getLogger("atf");let s="progress"+Math.floor(1e5*Math.random());or((()=>{u.stop()}));let i=xt({started:!1,replay:!1,progress:0}),o=yt("app"),a=o.playerContext,c=o.stopPlayerFunctions,l=o.showElemFunctions,u=new ka(a,(function(e){i.progress=10*e,i.progress,e<100||(i.started=!1,i.replay=!0)}),(function(){for(let e=0;e<t.showsElems.length;(e+=1)-1){let n=t.showsElems[e];l[n](!0)}}));function f(){return"STARTED"==u.status&&(u.stop(),i.started=!1,i.replay=!1,!0)}function d(e,t){t.stopPropagation(),"play-pause"==e?f()||(i.replay&&u.seek(0),function(){for(let e=0;e<c.length;(e+=1)-1)c[e]!==f&&c[e]()}(),u.start(),i.started=!0,i.replay=!1):"rewind"==e?(u.seek(0),i.started=!1,i.replay=!1,i.progress=0):"vol-down"==e?r().volume>-1&&(hr(qm,pt(r).volume=Math.max(r().volume-10,0),pt(r)),u.context.setVolume(r().volume)):"vol-up"==e&&r().volume<101&&(hr(qm,pt(r).volume=Math.min(r().volume+10,100),pt(r)),u.context.setVolume(r().volume))}function p(e){let t;e.stopPropagation(),t=e.target.id?e.target:e.target.parentElement;const n=t.getBoundingClientRect();let r=(e.clientX-n.left)/(n.right-n.left);"STARTED"==u.status?(i.replay=!1,i.progress=1e3*r,u.seek(100*r,!0)):(i.replay=!1,i.progress=1e3*r,u.seek(100*r,!1))}t.abc,u.loadAbc(t.abc),ir((()=>{document.getElementById(s).onclick=p,c.push(f)}));var h=lA(),m=Ot(h),y=Ot(m);Ka(y,{class:"mt-1 ps-1",style:"flex-grow:0;",children:(e,t)=>{var n=aA(),r=Ft(n);Wa(r,{id:"play-pause",class:"px-4 me-1 btn-dark rounded-pill bg-gradient",style:"width:4rem;background:var(--atf-gray-800)",$$events:{click:e=>d("play-pause",e)},children:(e,t)=>{var n=W((()=>i.started?rA:i.replay?nA:tA));Sc(e,{style:"position:relative;top:-1px",get data(){return dt(n)}})},$$slots:{default:!0}}),Wa(Rt(r,2),{id:"rewind",class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$events:{click:e=>d("rewind",e)},children:(e,t)=>{Sc(e,{style:"display:flex",data:sA})},$$slots:{default:!0}}),an(e,n)},$$slots:{default:!0}});var A=Rt(y,2);!function(e,t){const n=yr(t,["children","$$slots","$$events","$$legacy"]),r=yr(n,["animated","bar","barClassName","class","color","max","multi","striped","theme","value"]);vt(t,!1);const s=Y(),i=Y(),o=Y();let a=_r(t,"animated",8,!1),c=_r(t,"bar",8,!1),l=_r(t,"barClassName",8,""),u=_r(t,"class",8,""),f=_r(t,"color",8,""),d=_r(t,"max",8,100),p=_r(t,"multi",8,!1),h=_r(t,"striped",8,!1),m=_r(t,"theme",8,null),y=_r(t,"value",8,0);ae((()=>bt(u())),(()=>{H(s,Ta(u(),"progress"))})),ae((()=>(bt(c()),bt(u()),bt(l()),bt(a()),bt(f()),bt(h()))),(()=>{H(i,Ta("progress-bar",c()&&u()||l(),a()?"progress-bar-animated":null,f()?`text-bg-${f()}`:null,h()||a()?"progress-bar-striped":null))})),ae((()=>(bt(y()),bt(d()))),(()=>{H(o,parseInt(y(),10)/parseInt(d(),10)*100)})),ce(),nr();var A=on();xn(Ft(A),c,(e=>{var n=on();xn(Ft(n),p,(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)}),(e=>{var n=_c();let s;Sn(Ot(n),t,"default",{},null),Pt(n),ue((()=>s=Dn(n,s,{...r,class:dt(i),style:`width: ${dt(o)??""}%`,"data-bs-theme":m(),role:"progressbar","aria-valuenow":y(),"aria-valuemin":"0","aria-valuemax":d()}))),an(e,n)})),an(e,n)}),(e=>{var n=wc();let a;xn(Ot(n),p,(e=>{var n=on();Sn(Ft(n),t,"default",{},null),an(e,n)}),(e=>{var n=bc();Sn(Ot(n),t,"default",{},null),Pt(n),ue((()=>{Qn(n,dt(i)),Rn(n,"style",`width: ${dt(o)??""}%`),Rn(n,"data-bs-theme",m()),Rn(n,"aria-valuenow",y()),Rn(n,"aria-valuemax",d())})),an(e,n)})),Pt(n),ue((()=>a=Dn(n,a,{...r,"data-bs-theme":m(),class:dt(s)}))),an(e,n)})),an(e,A),_t()}(Ot(A),{id:s,class:"mt-1 rounded-1",max:1e3,get value(){return i.progress}}),Pt(A);var g=Rt(A,2);Ka(g,{class:"mt-1 pe-1",children:(e,t)=>{var n=cA(),s=Ft(n),i=W((()=>r().volume<5));Wa(s,{id:"vol-down",get disabled(){return dt(i)},class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$events:{click:e=>d("vol-down",e)},children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:iA})},$$slots:{default:!0}});var o=Rt(s,2),a=Ot(o),c=Rt(a,2);Pt(o);var l=Rt(o,2),u=W((()=>r().volume>95));Wa(l,{id:"vol-up",get disabled(){return dt(u)},class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800)",$$events:{click:e=>d("vol-up",e)},children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:oA})},$$slots:{default:!0}}),ue((()=>{Qn(a,`${(r().volume<5?"rounded-bottom":"")+" rounded-top bg-gradient"??0} svelte-1qpuo59`),Rn(a,"style",`background:white;height:${100-r().volume??""}%`),Qn(c,`${(r().volume>95?"rounded-top":"")+" rounded-bottom bg-gradient"??0} svelte-1qpuo59`),Rn(c,"style",`background:var(--bs-primary);height:${r().volume??""}%`)})),an(e,n)},$$slots:{default:!0}}),xn(Rt(g,2),(()=>fr(Gm,"$wait",n).soundfonts),(e=>{Rc(e,{})})),Pt(m),Pt(h),an(e,h),_t()}var fA=nn('<div class="label kmark svelte-1xz4lh1"><!></div>'),dA=nn('<div class="label svelte-1xz4lh1"> <!></div>'),pA=nn('<div class="label svelte-1xz4lh1"> <!></div>'),hA=nn('<div class="bk-half svelte-1xz4lh1"><div class="bk-key bk-key-right pb-1 svelte-1xz4lh1"><!> <!> <!></div> <div></div></div>'),mA=nn('<div class="label kmark svelte-1xz4lh1"><!></div>'),yA=nn('<div class="label svelte-1xz4lh1"> <!></div>'),AA=nn('<div class="label svelte-1xz4lh1"> <!></div>'),gA=nn('<div class="bk svelte-1xz4lh1"><div></div> <div><!> <!> <!></div> <div></div></div>'),vA=nn('<div class="label kmark svelte-1xz4lh1"><!></div>'),_A=nn('<div class="label svelte-1xz4lh1"> <!></div>'),bA=nn('<div class="label svelte-1xz4lh1"> <!></div>'),wA=nn('<div class="bk-half svelte-1xz4lh1"><div></div> <div class="bk-key bk-key-left pb-1 svelte-1xz4lh1"><!> <!> <!></div></div>'),xA=nn("<!> <!>",1),kA=nn('<div class="label kmark svelte-1xz4lh1"><!></div>'),EA=nn('<div class="label svelte-1xz4lh1"> </div>'),CA=nn('<div class="wk pb-1 svelte-1xz4lh1"><!> <!></div>'),BA=nn('<!> <div class="p-1" style="width:1rem;"><div></div> <div></div></div> <!>',1),MA=nn('<div style="position:absolute;top:0px;right:0px;z-index:20"><div class="rounded-3 bg-gradient" style="height:100%;background:var(--atf-gray-600);"><!></div></div>'),IA=nn('<div id="container" style="position:relative;" class="svelte-1xz4lh1"><div class="keyboard svelte-1xz4lh1"><div class="black-keys svelte-1xz4lh1" style="pointer-events:none;"></div> <div class="white-keys svelte-1xz4lh1"></div> <!></div> <!></div>');function NA(e,t){vt(t,!1);const n=pr(),r=()=>fr(qm,"$stateX",n),s=(Er().getLogger("atf"),Ym.assert);let i=_r(t,"playable",8,!0),o=_r(t,"low",8,"C3"),a=_r(t,"range",8,15),c=_r(t,"mark",24,(()=>[])),l=_r(t,"label",8,"");const u="&#11044;",f="&sharp;",d="&flat;",p=l().indexOf("#")>-1,h=l().indexOf("b")>-1,m=l().indexOf("W")>-1;let y=yt("app").playerContext,A=y.instr.acoustic_grand_piano,g=Y();const v=100,_=72,b=25.2,w=28*(1-.9),x={G:[14,_,14],C:[w,_,b],F:[w,_,b],D:[b,_,w],A:[b,_,w],B:[0,0,v],E:[0,0,v]},k={G:[24.8,b],D:[24.8,b],A:[_,28],B:[47.2,w],E:[47.2,w],C:[0,v],F:[0,v]},E={G:[28,_],C:[w,47.2],F:[w,47.2],D:[b,24.8],A:[b,24.8],B:[v,0],E:[v,0]};let C=function(e,t){s(2==e.length,"Keyboard.getKeyArray() bad low: "+e);let n=e,r=[n];for(let e=1;e<t;(e+=1)-1)n=Js.incAbsNote(n,1,0),r.push(n);return r}(o(),a());function B(e,t=1){s(1==t||-1==t,`Keyboard.getNextKey() Bad param step: ${t}`);const n=["A","B","C","D","E","F","G"];let r=n.indexOf(e);s(r>-1,`Keyboard.getNextKey() Bad param k: ${e}`);const i=n.length;return n[t<0?(t+r+i)%i:(t+r)%i]}function M(e){let t=e[0]+"#"+e[1];if(c().indexOf(t)>-1)return!0;let n=Js.incAbsNote(e,1);return c().indexOf(n[0]+"b"+n[1])>-1}let I={};function N(e){let t=e.target.getAttribute("absNote"),n=t.length>2?"bk":"wk";e.target.style["background-image"]=`var(--${n}-down-gradient)`;let r=I[t];r&&(A.stop(y.audioCtx.currentTime,[r.id]),I[t]=null);let s=A.start(t,y.audioCtx.currentTime+0,{gain:1});I[t]=s}function T(e){let t=e.target.getAttribute("absNote"),n=t.length>2?"bk":"wk";e.target.style["background-image"]=`var(--${n}-up-gradient)`;let r=I[t];r&&(A.stop(y.audioCtx.currentTime+.5,[r.id]),I[t]=null)}function S(e,t){"vol-down"==e?r().volume>-1&&(hr(qm,pt(r).volume=Math.max(r().volume-10,0),pt(r)),y.setVolume(r().volume)):"vol-up"==e&&r().volume<101&&(hr(qm,pt(r).volume=Math.min(r().volume+10,100),pt(r)),y.setVolume(r().volume))}nr();var O=IA(),F=Ot(O),R=Ot(F);Cn(R,5,(()=>C),En,((e,t,n)=>{var r=xA(),s=Ft(r);xn(s,(()=>0==n),(e=>{var n=hA(),r=Ot(n),s=W((()=>i()?e=>N(e):null)),o=W((()=>i()?e=>T(e):null));ue((()=>Rn(r,"absnote",ns.getNote(ns.getMidiKey(dt(t),-1)))));var a=Ot(r);xn(a,(()=>M(Js.incAbsNote(dt(t),-1))),(e=>{var t=fA();Tn(Ot(t),(()=>u),!1,!1),Pt(t),an(e,t)}));var c=Rt(a,2);xn(c,(()=>p),(e=>{var n=dA(),r=Ot(n,!0);ue((()=>yn(r,B(dt(t)[0],-1)))),Tn(Rt(r),(()=>f),!1,!1),Pt(n),an(e,n)})),xn(Rt(c,2),(()=>h),(e=>{var n=pA(),r=Ot(n,!0);Tn(Rt(r),(()=>d),!1,!1),Pt(n),ue((()=>yn(r,dt(t)[0]))),an(e,n)})),Pt(r);var l=Rt(r,2);Pt(n),ue((()=>{Rn(r,"style",`flex-grow:${k[dt(t)[0]][0]??""};`),Rn(l,"style",`flex-grow:${k[dt(t)[0]][1]??""}`)})),Jt("pointerdown",r,(function(...e){dt(s)?.apply(this,e)})),Jt("pointerup",r,(function(...e){dt(o)?.apply(this,e)})),an(e,n)})),xn(Rt(s,2),(()=>n<C.length-1),(e=>{var n=gA(),r=Ot(n),s=Rt(r,2),o=W((()=>i()?e=>N(e):null)),a=W((()=>i()?e=>T(e):null));ue((()=>Rn(s,"absnote",ns.getNote(ns.getMidiKey(dt(t),1)))));var c=Ot(s);xn(c,(()=>M(dt(t))),(e=>{var t=mA();Tn(Ot(t),(()=>u),!1,!1),Pt(t),an(e,t)}));var l=Rt(c,2);xn(l,(()=>p),(e=>{var n=yA(),r=Ot(n,!0);Tn(Rt(r),(()=>f),!1,!1),Pt(n),ue((()=>yn(r,dt(t)[0]))),an(e,n)})),xn(Rt(l,2),(()=>h),(e=>{var n=AA(),r=Ot(n,!0);ue((()=>yn(r,B(dt(t)[0])))),Tn(Rt(r),(()=>d),!1,!1),Pt(n),an(e,n)})),Pt(s);var m=Rt(s,2);Pt(n),ue((()=>{Rn(r,"style",`flex-grow:${x[dt(t)[0]][0]??""}`),Qn(s,`bk-key ${(0==x[dt(t)[0]][1]?"bk-key-no-border ":"")??""}pb-1 svelte-1xz4lh1`),Rn(s,"style",`flex-grow:${x[dt(t)[0]][1]??""}`),Rn(m,"style",`flex-grow:${x[dt(t)[0]][2]??""}`)})),Jt("pointerdown",s,(function(...e){dt(o)?.apply(this,e)})),Jt("pointerup",s,(function(...e){dt(a)?.apply(this,e)})),an(e,n)}),(e=>{var n=wA(),r=Ot(n),s=Rt(r,2),o=W((()=>i()?e=>N(e):null)),a=W((()=>i()?e=>T(e):null));ue((()=>Rn(s,"absnote",ns.getNote(ns.getMidiKey(dt(t),1)))));var c=Ot(s);xn(c,(()=>M(dt(t))),(e=>{var t=vA();Tn(Ot(t),(()=>u),!1,!1),Pt(t),an(e,t)}));var l=Rt(c,2);xn(l,(()=>p),(e=>{var n=_A(),r=Ot(n,!0);Tn(Rt(r),(()=>f),!1,!1),Pt(n),ue((()=>yn(r,dt(t)[0]))),an(e,n)})),xn(Rt(l,2),(()=>h),(e=>{var n=bA(),r=Ot(n,!0);ue((()=>yn(r,B(dt(t)[0],1)))),Tn(Rt(r),(()=>d),!1,!1),Pt(n),an(e,n)})),Pt(s),Pt(n),ue((()=>{Rn(r,"style",`flex-grow:${E[dt(t)[0]][0]??""}`),Rn(s,"style",`flex-grow:${E[dt(t)[0]][1]??""};`)})),Jt("pointerdown",s,(function(...e){dt(o)?.apply(this,e)})),Jt("pointerup",s,(function(...e){dt(a)?.apply(this,e)})),an(e,n)})),an(e,r)})),Pt(R);var D=Rt(R,2);Cn(D,5,(()=>C),En,((e,t)=>{var n=CA(),r=W((()=>i()?e=>N(e):null)),s=W((()=>i()?e=>T(e):null)),o=Ot(n);xn(o,(()=>c().indexOf(dt(t))>-1),(e=>{var t=kA();Tn(Ot(t),(()=>u),!1,!1),Pt(t),an(e,t)})),xn(Rt(o,2),(()=>m),(e=>{var n=EA(),r=Ot(n,!0);Pt(n),ue((()=>yn(r,dt(t)[0]))),an(e,n)})),Pt(n),ue((()=>Rn(n,"absnote",dt(t)))),Jt("pointerdown",n,(function(...e){dt(r)?.apply(this,e)})),Jt("pointerup",n,(function(...e){dt(s)?.apply(this,e)})),an(e,n)})),Pt(D),xn(Rt(D,2),i,(e=>{var t=MA(),n=Ot(t);Ka(Ot(n),{class:"p-1",children:(e,t)=>{var n=BA(),s=Ft(n),i=J((()=>r().volume<5));Wa(s,{id:"vol-down",get disabled(){return dt(i)},class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800);",$$events:{click:e=>S("vol-down")},children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:iA})},$$slots:{default:!0}});var o=Rt(s,2),a=Ot(o),c=Rt(a,2);Pt(o);var l=Rt(o,2),u=J((()=>r().volume>95));Wa(l,{id:"vol-up",get disabled(){return dt(u)},class:"btn-dark rounded-pill bg-gradient",style:"background:var(--atf-gray-800);",$$events:{click:e=>S("vol-up")},children:(e,t)=>{Sc(e,{style:"position:relative;top:-1px",data:oA})},$$slots:{default:!0}}),ue((()=>{Qn(a,`${(r().volume<5?"rounded-bottom":"")+" rounded-top bg-gradient"??0} svelte-1xz4lh1`),Rn(a,"style",`background:white;height:${100-r().volume??""}%`),Qn(c,`${(r().volume>95?"rounded-top":"")+" rounded-bottom bg-gradient"??0} svelte-1xz4lh1`),Rn(c,"style",`background:var(--bs-primary);height:${r().volume??""}%`)})),an(e,n)},$$slots:{default:!0}}),Pt(n),Pt(t),an(e,t)})),Pt(F),er(F,(e=>H(g,e)),(()=>dt(g))),xn(Rt(F,2),(()=>i()&&fr(Gm,"$wait",n).soundfonts),(e=>{Rc(e,{})})),Pt(O),an(e,O),_t()}var TA=nn("<div></div>");function SA(e,t){vt(t,!1);const n=pr();Er().getLogger("atf"),Ym.assert;let r=_r(t,"ex",8),s=_r(t,"partInfo",8),i=_r(t,"qkeys",8),o=_r(t,"qaidx",8),a={i:Ky,I:Ky,q:Ky,Q:Ky,a:Ky,A:Ky,s:eA,S:eA,p:uA,P:uA,k:NA,K:NA},c=yt("app");function l(){let e=Object.entries(i()).sort(),t=e.length,n=`Your question${t>1?"s":""} will be about`;return e.forEach((([e,s],i)=>{let o=i==t-1;t>1&&i>0&&(n+=", ",o&&(n+="and")),n+=` ${r().questions_desc[s]}`,o&&(n+=".")})),n}function u(e,t){return"P"==e.toUpperCase()&&r().players[t].info?r().players[t].info:""}function f(e){let t=e.split(":")[0].split("#"),n=[];return t.length>1&&(n=Ym.chunkSubstr(t[1],2)),n}function d(e){let t=e[0].toUpperCase(),n=e[1];if("Q"==t)return{elId0:t,html:r().questions[i()[n]][o()[n]]};if("A"==t)return{elId0:t,html:`<i>${r().answers[i()[n]][o()[n]]}</i>`};if("I"==t)return{elId0:t,html:l()};if("S"==t)return{abc:r().scores[n].data};if("P"==t)return{abc:r().players[n].data,showsElems:f(e)};if("K"==t)return r().keyboards&&r().keyboards[n]?r().keyboards[n]:{};throw"Unknown element type: "+t}ir((()=>{})),or((()=>{c.stopPlayerFunctions=[],c.toggleElemFunctions={}})),nr();var p=TA();Cn(p,5,(()=>s().layout),En,((e,t)=>{var r=on();xn(Ft(r),(()=>function(e,t){let n=e.split(":");if(n.length>1){let e=n[1];if(t.indexOf(e)>-1)return!0;for(let e of s().choices)for(let n of e.choices)if(t.indexOf(n.id)>-1)return!1;for(let t of s().choices)if(t.choices[0].id==e)return!0;return!1}return!0}(dt(t).id,fr(qm,"$stateX",n).choices)),(e=>{var n=on();xn(Ft(n),(()=>"iIqQaAsSpPkK".indexOf(dt(t).id[0])>-1),(e=>{var n=on();xn(Ft(n),(()=>u(dt(t).id[0],dt(t).id[1])),(e=>{var n=J((()=>f(dt(t).id)));$y(e,{get id(){return dt(t).id},get showsElems(){return dt(n)},$$slots:{content_info:(e,n)=>{var r=J((()=>dt(t).id[0].toUpperCase())),s=J((()=>u(dt(t).id[0],dt(t).id[1])));Ky(e,{slot:"content_info",get elId0(){return dt(r)},get html(){return dt(s)}})},content:(e,n)=>{var r=on(),s=Ft(r),i=W((()=>d(dt(t).id)));Fn(s,(()=>a[dt(t).id[0]]),((e,t)=>{t(e,gr({slot:"content"},(()=>dt(i))))})),an(e,r)},info:(e,n)=>{var r=J((()=>dt(t).info||""));ly(e,{slot:"info",get html(){return dt(r)}})}}})}),(e=>{var n=J((()=>f(dt(t).id)));$y(e,{get id(){return dt(t).id},get showsElems(){return dt(n)},$$slots:{content:(e,n)=>{var r=on(),s=Ft(r),i=W((()=>d(dt(t).id)));Fn(s,(()=>a[dt(t).id[0]]),((e,t)=>{t(e,gr({slot:"content"},(()=>dt(i))))})),an(e,r)},info:(e,n)=>{var r=J((()=>dt(t).info||""));ly(e,{slot:"info",get html(){return dt(r)}})}}})})),an(e,n)})),an(e,n)})),an(e,r)})),Pt(p),an(e,p),_t()}var OA=nn('<div style="background:var(--atf-gray-400)" class="ms-1 mt-0 px-2 py-1 border border-light rounded-3"> <!></div>');function FA(e,t){vt(t,!1);const n=pr(),r=()=>fr(qm,"$stateX",n),s=Y();Er().getLogger("atf");let i=_r(t,"choice",8);ae((()=>r()),(()=>{H(s,function(e){for(let t=0;t<i().choices.length;(t+=1)-1){let n=i().choices[t];if(e.indexOf(n.id)>-1)return n.id}return i().choices[0].id}(r().choices))})),ce(),nr();var o=OA(),a=Ot(o);Cn(Rt(a),1,(()=>i().choices),En,((e,t,n)=>{var o=J((()=>"btn-sm rounded-3 bg-gradient "+(n<i().choices.length-1?" me-1":""))),a=J((()=>dt(s)!=dt(t).id)),c=W((()=>function(e){for(let t=0;t<i().choices.length;(t+=1)-1){let n=i().choices[t];if(r().choices.indexOf(n.id)>-1)return hr(qm,pt(r).choices=r().choices.replace(n.id,e),pt(r)),void r().choices}hr(qm,pt(r).choices+=e,pt(r)),r().choices}(dt(t).id)));Wa(e,{get class(){return dt(o)},get outline(){return dt(a)},$$events:{click(...e){dt(c)?.apply(this,e)}},children:(e,n)=>{Yt();var r=sn();ue((()=>yn(r,dt(t).desc))),an(e,r)},$$slots:{default:!0}})})),Pt(o),ue((()=>yn(a,`${i().desc+":"??""} `))),an(e,o),_t()}var RA=nn('<div class="p-0 m-0" slot="content_info"><!></div>'),DA=nn('<div style="display:flex"><div style="display:flex;\n      flex-grow:1;\n      align-items:center;\n      position:relative;\n      background:var(--atf-gray-400)" class="m-2">  <!></div></div>'),UA=nn('<div style="position:relative;" class="col me-1 px-0"><div style="background:var(--atf-gray-200)" class="text-center ms-1 mt-0 p-1 border border-light rounded-3"></div></div>'),LA=nn('<div class="container-fluid mb-1" style="background:var(--atf-gray-400)"><!> <!></div>'),$A=nn('<div class="container-fluid"><!> <!> <!> <!></div> <!>',1),QA=nn('<code><pre style="background:black;color:lime;"> </pre></code> <!>',1),jA=nn("<div><!> <!> <!></div>");function PA(e,t){vt(t,!1);const n=pr(),s=()=>fr(Hm,"$ex",n),i=()=>fr(Vm,"$exData",n),o=()=>fr(zm,"$path",n),a=Y(),c=(Er().getLogger("atf"),Ym.assert);var l;ir((()=>{dt(u)})),l=()=>{},null===Ke&&Ne(),null===Ke.l&&$(),lr(Ke).b.push(l),cr((()=>{}));let u=Y(),f=Y();function d(e){hr(Hm,pt(s).partIdx=e,pt(s))}ae((()=>(uf.exMenu,o())),(()=>{H(u,Ym.getMenuItemAtPath(uf.exMenu,o()))})),ae((()=>s()),(()=>{H(a,function(e){dt(u);let t=s().exSpec;if("ExContent"==dt(u).cmpt&&t){let n=Ym.getPartsObj(i(),o()),r=Object.keys(t.parts_ex_id),s=r[e],a=s;"num"==dt(u).partLabel&&(a=e+1);let c={id:s,desc:a},l=n[s][t.parts_ex_id[s]],d=Ym.getExPartInfo(o(),s,l.xi),p=(r.length>1?`(${c.desc}) `:"")+d.title;return t.end,H(f,new Set([t,s])),{title:p,info:d,partId:s,partIdArray:r,part:c,data:l}}return{title:"No Data",info:{instruction:"No Data"},partId:null,partIdArray:[],part:{id:"No Data",desc:"No Data"},data:null}}(s().partIdx))})),ce(),nr();var p=jA(),h=Ot(p);Gy(h,{});var m=Rt(h,2);xn(m,(()=>"MsgContent"==dt(u).cmpt),(e=>{$y(e,{id:"I1",$$slots:{content_info:(e,t)=>{var n=RA();kc(Ot(n),{children:(e,t)=>{tc(e,{children:(e,t)=>{Wy(e,{color:"warning",get html(){return dt(u).msg}})},$$slots:{default:!0}})},$$slots:{default:!0}}),Pt(n),an(e,n)}}})}),(e=>{var t=on();xn(Ft(t),(()=>"ExContent"==dt(u).cmpt),(e=>{var t=on();xn(Ft(t),(()=>fr(Gm,"$wait",n).data.length>0),(e=>{var t=DA(),n=Ot(t);Rc(Rt(Ot(n)),{duration_out:0}),Pt(n),Pt(t),an(e,t)}),(e=>{var t=$A(),n=Ft(t),l=Ot(n);dy(l,{get help(){return dt(a).info.instruction},children:(e,t)=>{Yt();var n=sn();ue((()=>yn(n,dt(a).title))),an(e,n)},$$slots:{default:!0}});var p=Rt(l,2);xn(p,(()=>dt(a).info.choices),(e=>{var t=on();Cn(Ft(t),1,(()=>dt(a).info.choices),En,((e,t)=>{kc(e,{class:"pb-1",children:(e,n)=>{tc(e,{class:"me-1 px-0",children:(e,n)=>{FA(e,{get choice(){return dt(t)}})},$$slots:{default:!0}})},$$slots:{default:!0}})})),an(e,t)}));var h=Rt(p,2);xn(h,(()=>s().exSpec),(e=>{!function(e,t){vt(t,!1),Er().getLogger("atf"),nr(),kc(e,{children:(e,n)=>{tc(e,{class:"px-0",children:(e,n)=>{rc(e,{fluid:!0,class:"p-0 m-0",children:(e,n)=>{var r=on();Sn(Ft(r),t,"default",{},(e=>{an(e,Fy())})),an(e,r)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),_t()}(e,{children:(e,t)=>{var n=on();!function(e,t,n){Lt&&jt();var s,i=e,o=r,a=Ze()?D:R;fe((()=>{a(o,o=t())&&(s&&ge(s),s=de((()=>n(i))))})),Lt&&(i=Ut)}(Ft(n),(()=>dt(f)),(e=>{SA(e,{get partInfo(){return dt(a).info},get ex(){return dt(a).data},get qkeys(){return s().exSpec.parts_qkeys[dt(a).partId]},get qaidx(){return s().exSpec.parts_qa_idx[dt(a).partId]}})})),an(e,n)},$$slots:{default:!0}})}),(e=>{})),xn(Rt(h,2),(()=>dt(a).partIdArray.length>1),(e=>{kc(e,{class:"px-0 pb-1 align-items-center",children:(e,t)=>{var n=UA(),r=Ot(n);Cn(r,5,(()=>dt(a).partIdArray),En,((e,t,n)=>{var r=J((()=>n<s().partIdx?"success":n>s().partIdx?"primary":"warning")),i=J((()=>dt(t)==dt(a).partId)),o=W((()=>dt(t)!=dt(a).partId?e=>function(e){d(e)}(n):null));Wa(e,{get color(){return dt(r)},class:"btn-sm ms-1 pt-0 rounded-3 bg-gradient",get active(){return dt(i)},$$events:{click(...e){dt(o)?.apply(this,e)}},children:(e,r)=>{Yt();var i=sn();ue((()=>yn(i,`${n==s().partIdx?dt(u).partDesc:""} (${"num"==dt(u).partLabel?n+1:dt(t)})`))),an(e,i)},$$slots:{default:!0}})})),Pt(r),Pt(n),an(e,n)},$$slots:{default:!0}})})),Pt(n),xn(Rt(n,2),(()=>null!=s().exSpec),(e=>{var t=LA(),n=Ot(t);xn(n,(()=>!1),(e=>{kc(e,{class:"justify-content-center py-1",style:"background:var(--atf-gray-200)",children:(e,t)=>{tc(e,{class:"col-auto m-0 p-0",children:(e,t)=>{Wy(e,{color:"warning",html:"For more content, please subscribe."})},$$slots:{default:!0}})},$$slots:{default:!0}})})),kc(Rt(n,2),{class:"justify-content-end p-1",children:(e,t)=>{tc(e,{class:"col-auto m-0 p-0",children:(e,t)=>{Wa(e,{class:"btn-sm btn-light btn-outline-secondary rounded-3 bg-gradient",$$events:{click:()=>{JSON.stringify(dt(u)),c.ok("ExContent"==dt(u).cmpt),hr(Hm,pt(s).exSpec=Ym.getNextExSpec(i(),o(),s().exSpec),pt(s)),d(0)}},children:(e,t)=>{Yt(),an(e,sn("New Exercise ..."))},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),Pt(t),an(e,t)})),an(e,t)})),an(e,t)}),null,!0),an(e,t)})),xn(Rt(m,2),(()=>!1),(e=>{var t=QA(),n=Ft(t),r=Ot(n);const i=J((()=>JSON.stringify(s().exSpec,0,2)??"")),o=J((()=>JSON.stringify(dt(a),0,2)??""));var c=Ot(r);ue((()=>yn(c,`\n$ex.exSpec ${dt(i)}\nexPartInfo ${dt(o)}\n    `))),Pt(r),Pt(n),hy(Rt(n,2),{}),an(e,t)})),Pt(p),an(e,p),_t()}nn("<div><span><!></span> <span><!></span></div>");nn('<span slot="msg"><!></span>');nn('<span slot="msg"><!></span>'),nn('<span slot="msg"><!></span>'),nn('<span slot="msg"><!></span>'),nn("<div><!> <!> <!></div>");nn('<span slot="content"><!></span>'),nn('<span slot="msg"><!></span>'),nn('<span slot="msg"><!></span>'),nn("<div><!> <!></div>");nn('<span slot="msg"><!></span>');nn("<!> <!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!>",1),nn('<span slot="msg"><!></span>'),nn("<!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!>",1),nn("<!> <!>",1);nn('<div id="paypal-button-container"></div>');nn("<!> <!>",1),nn("<!> <!> <!>",1),nn("<span><!> <!></span>");nn("Account <!>",1),nn(" <br> (irrespective of subscriptions)",1),nn('<span style="margin-right:8px"></span> <!>',1),nn("Status: <span> </span> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!>",1),nn("<!> <!>",1),nn("<!> <!> <!> <!> <!> <!> <!>",1),nn("<!> <!>",1);var YA=nn("  <!>",1),zA=nn("<!> <!>",1),VA=nn("<!> <!> <!>",1);if("aural.ldsys.co.uk"==window.location.hostname){An((function(e,t){vt(t,!0);const n=pr(),r=()=>fr(Gm,"$wait",n),s=()=>fr(qm,"$stateX",n),i=Er().getLogger("atf");try{let e="WARN";i.setLevel(e),ba.setLevel(e),ra.setLevel(e)}catch(e){let t="WARN";i.setLevel(t),ba.setLevel(t),ra.setLevel(t)}document.getElementById("loading").remove();const o={home:Oy,exercises:PA};let a={playerContext:new xa,stopPlayerFunctions:[],showElemFunctions:{},exData:{}};var c,l;c="app",l=a,At().set(c,l),async function(){hr(Gm,pt(r).initApp=!1,pt(r))}();let u=a.playerContext.loadInstrument("acoustic_grand_piano","sm").then((e=>{i.info("loaded piano")})),f=a.playerContext.loadInstrument("flute","mk").then((e=>{i.info("loaded flute")})),d=a.playerContext.loadInstrument("woodblock","mk","woodblockx").then((e=>{i.info("loaded woodblockx")}));Promise.all([u,f,d]).then((e=>{hr(Gm,pt(r).soundfonts=!1,pt(r))}));var p=on();Jt("keyup",Et,(function({key:e}){"Escape"===e&&"exercises"==s().currPage&&s().hideAppMenu&&hr(qm,pt(s).hideAppMenu=!1,pt(s))})),function(e){let t=null,n=Lt;var r;if(Lt){for(t=Ut,void 0===Zt&&(Zt=Tt(document.head));null!==Zt&&(8!==Zt.nodeType||"["!==Zt.data);)Zt=St(Zt);null===Zt?$t(!1):Zt=Qt(St(Zt))}Lt||(r=document.head.appendChild(Nt()));try{fe((()=>e(r)),M)}finally{n&&($t(!0),Zt=Ut,Qt(t))}}((e=>{Ct.title="Aural Practice"})),xn(Ft(p),(()=>r().initApp),(e=>{rc(e,{fluid:!0,class:"d-flex",style:"height:100%;justify-content:center;",children:(e,n)=>{kc(e,{class:"d-flex",style:"flex-direction:column;align-self:center;",children:(e,n)=>{var r=zA(),s=Ft(r);tc(s,{class:"display-4 p-2 rounded-3",style:"opacity:0.5",children:(e,n)=>{Yt();var r=sn();ue((()=>yn(r,t.name))),an(e,r)},$$slots:{default:!0}}),tc(Rt(s,2),{class:"p-2",style:"width:40px;align-self:center;position:relative;",children:(e,t)=>{Yt();var n=YA();Rc(Rt(Ft(n)),{duration_out:0}),an(e,n)},$$slots:{default:!0}}),an(e,r)},$$slots:{default:!0}})},$$slots:{default:!0}})}),(e=>{rc(e,{fluid:!0,class:"p-0 bg-gradient",style:"background:var(--atf-gray-300)",children:(e,t)=>{var n=VA(),r=Ft(n);iy(r,{});var i=Rt(r,2);Zm(i,{}),Fn(Rt(i,2),(()=>o[s().currPage]),((e,t)=>{t(e,{})})),an(e,n)},$$slots:{default:!0}})})),an(e,p),_t()}),{target:document.body,props:{name:"Aural Practice"}})}})()})();